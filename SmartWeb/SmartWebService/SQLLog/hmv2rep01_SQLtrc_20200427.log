SELECT * FROM RWEBUSRDEF WHERE FACTORY = :FACTORY AND USER_ID= :USER_ID
-------------------------------------------------------------
SELECT A.FUNC_GRP_SEQ,A.SEC_GRP_ID,A.FUNC_GRP_ID,NVL(A.FUNC_NAME, ' ') FUNC_NAME, NVL(B.FUNC_DESC, ' ') FUNC_DESC, LANGUAGE_1, LANGUAGE_2, LANGUAGE_3
  FROM RWEBGRPFUN A, RWEBFUNDEF B
 WHERE A.FACTORY = :p_FACTORY
   AND A.SEC_GRP_ID = :p_SEC_GRP_ID
   AND A.FUNC_NAME=B.FUNC_NAME(+)
 ORDER BY A.FUNC_GRP_SEQ, A.FUNC_SEQ
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT PLAN_WEEK V1    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_DATE = TO_CHAR(SYSDATE,'yyyymmdd')      AND ROWNUM = 1  
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('2020', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('2020', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT LANGUAGE_2 FROM RWEBFUNDEF WHERE FUNC_NAME = 'PRD010401'
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT FACTORY Code, FAC_DESC Data
  FROM MWIPFACDEF
 WHERE FAC_GRP_5 = 'Y' 
 ORDER BY FAC_GRP_4 ASC
-------------------------------------------------------------
SELECT OPER, OPER_DESC  FROM MWIPOPRDEF
  WHERE FACTORY = 'HMVA2'  AND OPER NOT IN ('00001', '00002') AND OPER NOT LIKE 'V%' ORDER BY DECODE(OPER_CMF_2, ' ', 99999, TO_NUMBER(OPER_CMF_2)), OPER
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
        SELECT (SELECT DATA_1 FROM MGCMTBLDAT WHERE TABLE_NAME = 'H_CUSTOMER' AND KEY_1 = MAT_GRP_1 AND ROWNUM=1) AS CUSTOMER,  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ', MAT_CMF_10, MAT_ID, OPER,  ' ', CASE WHEN OPER <= 'A0200' THEN VENDOR_MAT_ID ELSE BASE_MAT_ID END SAP_CODE
             , SUM(TOTAL) AS TOTAL
             , SUM(ASSY_END_QTY0 ) VAL0
             , SUM(ASSY_END_QTY1 ) VAL1
             , SUM(ASSY_END_QTY2 ) VAL2
             , SUM(ASSY_END_QTY3 ) VAL3
             , SUM(ASSY_END_QTY4 ) VAL4
             , SUM(ASSY_END_QTY5 ) VAL5
             , ROUND(SUM(TOTAL)/6, 1) AVG
          FROM (
               SELECT B.MAT_GRP_1,  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ', B.MAT_CMF_10, B.MAT_ID, A.OPER,  ' ', BASE_MAT_ID,VENDOR_MAT_ID 
                    , DECODE(WORK_DATE, '20200422', (CASE WHEN OPER IN ('AZ010','SHIP','TZ010','F0000','EZ010', 'SZ010', 'BZ010') THEN SHIP_QTY_1 ELSE END_QTY_1 END),0) ASSY_END_QTY0
                    , DECODE(WORK_DATE, '20200423', (CASE WHEN OPER IN ('AZ010','SHIP','TZ010','F0000','EZ010', 'SZ010', 'BZ010') THEN SHIP_QTY_1 ELSE END_QTY_1 END),0) ASSY_END_QTY1
                    , DECODE(WORK_DATE, '20200424', (CASE WHEN OPER IN ('AZ010','SHIP','TZ010','F0000','EZ010', 'SZ010', 'BZ010') THEN SHIP_QTY_1 ELSE END_QTY_1 END),0) ASSY_END_QTY2
                    , DECODE(WORK_DATE, '20200425', (CASE WHEN OPER IN ('AZ010','SHIP','TZ010','F0000','EZ010', 'SZ010', 'BZ010') THEN SHIP_QTY_1 ELSE END_QTY_1 END),0) ASSY_END_QTY3
                    , DECODE(WORK_DATE, '20200426', (CASE WHEN OPER IN ('AZ010','SHIP','TZ010','F0000','EZ010', 'SZ010', 'BZ010') THEN SHIP_QTY_1 ELSE END_QTY_1 END),0) ASSY_END_QTY4
                    , DECODE(WORK_DATE, '20200427', (CASE WHEN OPER IN ('AZ010','SHIP','TZ010','F0000','EZ010', 'SZ010', 'BZ010') THEN SHIP_QTY_1 ELSE END_QTY_1 END),0) ASSY_END_QTY5
                    , (CASE WHEN OPER IN ('AZ010','SHIP','TZ010','F0000','EZ010', 'SZ010', 'BZ010') THEN SHIP_QTY_1 ELSE END_QTY_1 END) TOTAL
                 FROM (
                      SELECT FACTORY, MAT_ID, OPER, LOT_TYPE, MAT_VER, WORK_DATE, CM_KEY_3
                           , SUM(END_LOT) AS END_LOT
                           , SUM(END_QTY_1) AS END_QTY_1
                           , SUM(END_QTY_2) AS END_QTY_2
                           , SUM(SHIP_QTY_1) AS SHIP_QTY_1
                           , SUM(SHIP_QTY_2) AS SHIP_QTY_2
                        FROM (
                             SELECT FACTORY, MAT_ID, OPER, LOT_TYPE, MAT_VER, WORK_DATE, CM_KEY_3
                           , DECODE(SUBSTR(OPER,2,4),'0000',SUM(S1_OPER_IN_LOT+S2_OPER_IN_LOT+S3_OPER_IN_LOT),SUM(S1_END_LOT+S2_END_LOT+S3_END_LOT)) END_LOT
                           , DECODE(SUBSTR(OPER,2,4),'0000',SUM(S1_OPER_IN_QTY_1+S2_OPER_IN_QTY_1+S3_OPER_IN_QTY_1),SUM(S1_END_QTY_1+S2_END_QTY_1+S3_END_QTY_1+S1_END_RWK_QTY_1 + S2_END_RWK_QTY_1 + S3_END_RWK_QTY_1)) END_QTY_1
                           , DECODE(SUBSTR(OPER,2,4),'0000',SUM(S1_OPER_IN_QTY_2+S2_OPER_IN_QTY_2+S3_OPER_IN_QTY_2),SUM(S1_END_QTY_2+S2_END_QTY_2+S3_END_QTY_2+S1_END_RWK_QTY_2 + S2_END_RWK_QTY_2 + S3_END_RWK_QTY_2)) END_QTY_2
                           , 0 SHIP_QTY_1
                           , 0 SHIP_QTY_2
                        FROM RSUMWIPMOV 
                       WHERE OPER NOT IN ('AZ010','TZ010','F0000','EZ010', 'SZ010', 'BZ010')
                    GROUP BY FACTORY, MAT_ID, OPER, LOT_TYPE, MAT_VER, WORK_DATE, CM_KEY_3
                   UNION ALL
                      SELECT CM_KEY_1 AS FACTORY, MAT_ID
                           , DECODE(CM_KEY_1,'HMVA2','AZ010','HMKT1','TZ010','FGS','F0000','HMKE1','EZ010','HMKS1','SZ010', 'BZ010') OPER
                           , LOT_TYPE, MAT_VER,  WORK_DATE,CM_KEY_3
                           , 0 END_LOT
                           , 0 END_QTY_1
                           , 0 END_QTY_2
                           , SUM(S1_FAC_OUT_QTY_1+S2_FAC_OUT_QTY_1+S3_FAC_OUT_QTY_1) SHIP_QTY_1
                           , SUM(S1_FAC_OUT_QTY_2+S2_FAC_OUT_QTY_2+S3_FAC_OUT_QTY_2) SHIP_QTY_2
                        FROM RSUMFACMOV 
                       WHERE FACTORY NOT IN ('RETURN')
                    GROUP BY CM_KEY_1, MAT_ID, OPER, LOT_TYPE, MAT_VER, WORK_DATE, CM_KEY_3
                             )
                    GROUP BY FACTORY, MAT_ID, OPER, LOT_TYPE, MAT_VER, WORK_DATE, CM_KEY_3
                    )A
                  , MWIPMATDEF B 
              WHERE 1=1 
                AND A.FACTORY  = 'HMVA2' 
                AND A.FACTORY = B.FACTORY 
                AND A.MAT_ID = B.MAT_ID                
                AND A.MAT_VER = 1 
                AND B.MAT_VER = 1 
                AND B.MAT_TYPE = 'FG' 
                AND A.OPER LIKE '%'
                AND A.MAT_ID LIKE '%'  
                AND A.CM_KEY_3 LIKE 'P%'
                AND A.OPER NOT IN ('00001','00002') 
                AND A.WORK_DATE BETWEEN '20200422' AND '20200427' 
         )   
   WHERE TOTAL > 0           
GROUP BY MAT_GRP_1,  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ', MAT_CMF_10, MAT_ID, OPER,  ' ', BASE_MAT_ID,VENDOR_MAT_ID
ORDER BY MAT_GRP_1,  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ', MAT_CMF_10, MAT_ID, DECODE(OPER,'AISSUE','A0001','TISSUE','T0001','EISSUE','E0001',OPER),  ' ', BASE_MAT_ID,VENDOR_MAT_ID

-------------------------------------------------------------
SELECT * FROM RWEBUSRDEF WHERE FACTORY = :FACTORY AND USER_ID= :USER_ID
-------------------------------------------------------------
SELECT A.FUNC_GRP_SEQ,A.SEC_GRP_ID,A.FUNC_GRP_ID,NVL(A.FUNC_NAME, ' ') FUNC_NAME, NVL(B.FUNC_DESC, ' ') FUNC_DESC, LANGUAGE_1, LANGUAGE_2, LANGUAGE_3
  FROM RWEBGRPFUN A, RWEBFUNDEF B
 WHERE A.FACTORY = :p_FACTORY
   AND A.SEC_GRP_ID = :p_SEC_GRP_ID
   AND A.FUNC_NAME=B.FUNC_NAME(+)
 ORDER BY A.FUNC_GRP_SEQ, A.FUNC_SEQ
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
SELECT LANGUAGE_2 FROM RWEBFUNDEF WHERE FUNC_NAME = 'PRD010503'
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT PLAN_WEEK V1    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_DATE = TO_CHAR(SYSDATE,'yyyymmdd')      AND ROWNUM = 1  
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('2020', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('2020', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT LANGUAGE_2 FROM RWEBFUNDEF WHERE FUNC_NAME = 'PRD010401'
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT FACTORY Code, FAC_DESC Data
  FROM MWIPFACDEF
 WHERE FAC_GRP_5 = 'Y' 
 ORDER BY FAC_GRP_4 ASC
-------------------------------------------------------------
SELECT OPER, OPER_DESC  FROM MWIPOPRDEF
  WHERE FACTORY = 'HMVA2'  AND OPER NOT IN ('00001', '00002') AND OPER NOT LIKE 'V%' ORDER BY DECODE(OPER_CMF_2, ' ', 99999, TO_NUMBER(OPER_CMF_2)), OPER
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
        SELECT (SELECT DATA_1 FROM MGCMTBLDAT WHERE TABLE_NAME = 'H_CUSTOMER' AND KEY_1 = MAT_GRP_1 AND ROWNUM=1) AS CUSTOMER,  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ', MAT_CMF_10, MAT_ID, OPER,  ' ', CASE WHEN OPER <= 'A0200' THEN VENDOR_MAT_ID ELSE BASE_MAT_ID END SAP_CODE
             , SUM(TOTAL) AS TOTAL
             , SUM(ASSY_END_QTY0 ) VAL0
             , SUM(ASSY_END_QTY1 ) VAL1
             , SUM(ASSY_END_QTY2 ) VAL2
             , SUM(ASSY_END_QTY3 ) VAL3
             , ROUND(SUM(TOTAL)/4, 1) AVG
          FROM (
               SELECT B.MAT_GRP_1,  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ', B.MAT_CMF_10, B.MAT_ID, A.OPER,  ' ', BASE_MAT_ID,VENDOR_MAT_ID 
                    , DECODE(WORK_DATE, '20200422', (CASE WHEN OPER IN ('AZ010','SHIP','TZ010','F0000','EZ010', 'SZ010', 'BZ010') THEN SHIP_QTY_1 ELSE END_QTY_1 END),0) ASSY_END_QTY0
                    , DECODE(WORK_DATE, '20200423', (CASE WHEN OPER IN ('AZ010','SHIP','TZ010','F0000','EZ010', 'SZ010', 'BZ010') THEN SHIP_QTY_1 ELSE END_QTY_1 END),0) ASSY_END_QTY1
                    , DECODE(WORK_DATE, '20200424', (CASE WHEN OPER IN ('AZ010','SHIP','TZ010','F0000','EZ010', 'SZ010', 'BZ010') THEN SHIP_QTY_1 ELSE END_QTY_1 END),0) ASSY_END_QTY2
                    , DECODE(WORK_DATE, '20200425', (CASE WHEN OPER IN ('AZ010','SHIP','TZ010','F0000','EZ010', 'SZ010', 'BZ010') THEN SHIP_QTY_1 ELSE END_QTY_1 END),0) ASSY_END_QTY3
                    , (CASE WHEN OPER IN ('AZ010','SHIP','TZ010','F0000','EZ010', 'SZ010', 'BZ010') THEN SHIP_QTY_1 ELSE END_QTY_1 END) TOTAL
                 FROM (
                      SELECT FACTORY, MAT_ID, OPER, LOT_TYPE, MAT_VER, WORK_DATE, CM_KEY_3
                           , SUM(END_LOT) AS END_LOT
                           , SUM(END_QTY_1) AS END_QTY_1
                           , SUM(END_QTY_2) AS END_QTY_2
                           , SUM(SHIP_QTY_1) AS SHIP_QTY_1
                           , SUM(SHIP_QTY_2) AS SHIP_QTY_2
                        FROM (
                             SELECT FACTORY, MAT_ID, OPER, LOT_TYPE, MAT_VER, WORK_DATE, CM_KEY_3
                           , DECODE(SUBSTR(OPER,2,4),'0000',SUM(S1_OPER_IN_LOT+S2_OPER_IN_LOT+S3_OPER_IN_LOT),SUM(S1_END_LOT+S2_END_LOT+S3_END_LOT)) END_LOT
                           , DECODE(SUBSTR(OPER,2,4),'0000',SUM(S1_OPER_IN_QTY_1+S2_OPER_IN_QTY_1+S3_OPER_IN_QTY_1),SUM(S1_END_QTY_1+S2_END_QTY_1+S3_END_QTY_1+S1_END_RWK_QTY_1 + S2_END_RWK_QTY_1 + S3_END_RWK_QTY_1)) END_QTY_1
                           , DECODE(SUBSTR(OPER,2,4),'0000',SUM(S1_OPER_IN_QTY_2+S2_OPER_IN_QTY_2+S3_OPER_IN_QTY_2),SUM(S1_END_QTY_2+S2_END_QTY_2+S3_END_QTY_2+S1_END_RWK_QTY_2 + S2_END_RWK_QTY_2 + S3_END_RWK_QTY_2)) END_QTY_2
                           , 0 SHIP_QTY_1
                           , 0 SHIP_QTY_2
                        FROM RSUMWIPMOV 
                       WHERE OPER NOT IN ('AZ010','TZ010','F0000','EZ010', 'SZ010', 'BZ010')
                    GROUP BY FACTORY, MAT_ID, OPER, LOT_TYPE, MAT_VER, WORK_DATE, CM_KEY_3
                   UNION ALL
                      SELECT CM_KEY_1 AS FACTORY, MAT_ID
                           , DECODE(CM_KEY_1,'HMVA2','AZ010','HMKT1','TZ010','FGS','F0000','HMKE1','EZ010','HMKS1','SZ010', 'BZ010') OPER
                           , LOT_TYPE, MAT_VER,  WORK_DATE,CM_KEY_3
                           , 0 END_LOT
                           , 0 END_QTY_1
                           , 0 END_QTY_2
                           , SUM(S1_FAC_OUT_QTY_1+S2_FAC_OUT_QTY_1+S3_FAC_OUT_QTY_1) SHIP_QTY_1
                           , SUM(S1_FAC_OUT_QTY_2+S2_FAC_OUT_QTY_2+S3_FAC_OUT_QTY_2) SHIP_QTY_2
                        FROM RSUMFACMOV 
                       WHERE FACTORY NOT IN ('RETURN')
                    GROUP BY CM_KEY_1, MAT_ID, OPER, LOT_TYPE, MAT_VER, WORK_DATE, CM_KEY_3
                             )
                    GROUP BY FACTORY, MAT_ID, OPER, LOT_TYPE, MAT_VER, WORK_DATE, CM_KEY_3
                    )A
                  , MWIPMATDEF B 
              WHERE 1=1 
                AND A.FACTORY  = 'HMVA2' 
                AND A.FACTORY = B.FACTORY 
                AND A.MAT_ID = B.MAT_ID                
                AND A.MAT_VER = 1 
                AND B.MAT_VER = 1 
                AND B.MAT_TYPE = 'FG' 
                AND A.OPER LIKE '%'
                AND A.MAT_ID LIKE '%'  
                AND A.CM_KEY_3 LIKE 'P%'
                AND A.OPER NOT IN ('00001','00002') 
                AND A.WORK_DATE BETWEEN '20200422' AND '20200425' 
         )   
   WHERE TOTAL > 0           
GROUP BY MAT_GRP_1,  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ', MAT_CMF_10, MAT_ID, OPER,  ' ', BASE_MAT_ID,VENDOR_MAT_ID
ORDER BY MAT_GRP_1,  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ', MAT_CMF_10, MAT_ID, DECODE(OPER,'AISSUE','A0001','TISSUE','T0001','EISSUE','E0001',OPER),  ' ', BASE_MAT_ID,VENDOR_MAT_ID

-------------------------------------------------------------
SELECT * FROM RWEBUSRDEF WHERE FACTORY = :FACTORY AND USER_ID= :USER_ID
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
SELECT A.FUNC_GRP_SEQ,A.SEC_GRP_ID,A.FUNC_GRP_ID,NVL(A.FUNC_NAME, ' ') FUNC_NAME, NVL(B.FUNC_DESC, ' ') FUNC_DESC, LANGUAGE_1, LANGUAGE_2, LANGUAGE_3
  FROM RWEBGRPFUN A, RWEBFUNDEF B
 WHERE A.FACTORY = :p_FACTORY
   AND A.SEC_GRP_ID = :p_SEC_GRP_ID
   AND A.FUNC_NAME=B.FUNC_NAME(+)
 ORDER BY A.FUNC_GRP_SEQ, A.FUNC_SEQ
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
SELECT LANGUAGE_2 FROM RWEBFUNDEF WHERE FUNC_NAME = 'PRD010503'
-------------------------------------------------------------
SELECT * FROM RWEBUSRDEF WHERE FACTORY = :FACTORY AND USER_ID= :USER_ID
-------------------------------------------------------------
SELECT A.FUNC_GRP_SEQ,A.SEC_GRP_ID,A.FUNC_GRP_ID,NVL(A.FUNC_NAME, ' ') FUNC_NAME, NVL(B.FUNC_DESC, ' ') FUNC_DESC, LANGUAGE_1, LANGUAGE_2, LANGUAGE_3
  FROM RWEBGRPFUN A, RWEBFUNDEF B
 WHERE A.FACTORY = :p_FACTORY
   AND A.SEC_GRP_ID = :p_SEC_GRP_ID
   AND A.FUNC_NAME=B.FUNC_NAME(+)
 ORDER BY A.FUNC_GRP_SEQ, A.FUNC_SEQ
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT PLAN_WEEK V1    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_DATE = TO_CHAR(SYSDATE,'yyyymmdd')      AND ROWNUM = 1  
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('2020', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('2020', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT DISTINCT PLAN_YEAR||LPAD(PLAN_WEEK,2,'0') AS PLAN_WEEK 
  FROM MWIPCALDEF
 WHERE 1=1 
   AND CALENDAR_ID = 'OTD' 
   AND SYS_YEAR||LPAD(SYS_MONTH,2,'0') = '202004' 
 ORDER BY PLAN_WEEK

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT DISTINCT PLAN_YEAR||LPAD(PLAN_WEEK,2,'0') AS PLAN_WEEK 
  FROM MWIPCALDEF
 WHERE 1=1 
   AND CALENDAR_ID = 'OTD' 
   AND SYS_YEAR||LPAD(SYS_MONTH,2,'0') = '202004' 
   AND SYS_DATE <= '20200427' 
 ORDER BY PLAN_WEEK

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT LANGUAGE_2 FROM RWEBFUNDEF WHERE FUNC_NAME = 'PRD010907'
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT DISTINCT PLAN_YEAR||LPAD(PLAN_WEEK,2,'0') AS PLAN_WEEK 
  FROM MWIPCALDEF
 WHERE 1=1 
   AND CALENDAR_ID = 'OTD' 
   AND SYS_YEAR||LPAD(SYS_MONTH,2,'0') = '202004' 
 ORDER BY PLAN_WEEK

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT DISTINCT PLAN_YEAR||LPAD(PLAN_WEEK,2,'0') AS PLAN_WEEK 
  FROM MWIPCALDEF
 WHERE 1=1 
   AND CALENDAR_ID = 'OTD' 
   AND SYS_YEAR||LPAD(SYS_MONTH,2,'0') = '202004' 
   AND SYS_DATE <= '20200427' 
 ORDER BY PLAN_WEEK

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT MIN(SYS_DATE) AS START_DAY 
     , MAX(SYS_DATE) AS END_DAY 
     , PLAN_YEAR||DECODE(LENGTH(PLAN_WEEK), 1, '0'||PLAN_WEEK, PLAN_WEEK) AS WEEK
  FROM MWIPCALDEF 
 WHERE CALENDAR_ID = 'OTD'
   AND (PLAN_YEAR || LPAD(PLAN_WEEK,2,'0')) IN ( 
                                                SELECT WW
                                                  FROM (
                                                        SELECT WW
                                                             , ROW_NUMBER() OVER(ORDER BY WW) AS RNK
                                                          FROM (
                                                                SELECT DISTINCT PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') AS WW
                                                                  FROM MWIPCALDEF
                                                                 WHERE CALENDAR_ID = 'OTD'
                                                                   AND PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') >= (
                                                                                                              SELECT MAX(PLAN_YEAR || LPAD(PLAN_WEEK,2,'0')) AS WW
                                                                                                                FROM MWIPCALDEF
                                                                                                               WHERE CALENDAR_ID = 'OTD'
                                                                                                                 AND PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') < (SELECT PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') AS WW FROM MWIPCALDEF WHERE CALENDAR_ID = 'OTD' AND SYS_DATE = '20200427')
                                                                                                                 AND SYS_DATE >= TO_CHAR(TO_DATE('20200427', 'YYYYMMDD')-14, 'YYYYMMDD')
                                                                                                             )
                                                               ) 
                                                       )
                                                 WHERE RNK <= 7
                                               ) 
 GROUP BY PLAN_YEAR, PLAN_WEEK 
 ORDER BY PLAN_YEAR, PLAN_WEEK

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
WITH DT AS
(
 SELECT B.PLAN_MONTH, A.PLAN_WEEK, A.GUBUN, B.CKD_WEEK, A.MAT_ID, A.WW_QTY, B.CNT
      , ROUND((A.WW_QTY / 7) * B.CNT, 0) AS REV_QTY
   FROM RWIPPLNWEK A
      , (
         SELECT MAX(TRIM(TO_CHAR(PLAN_YEAR))||LPAD(PLAN_MONTH,2,'0')) PLAN_MONTH
              , MAX(TRIM(TO_CHAR(PLAN_YEAR))||LPAD(PLAN_WEEK,2,'0')) PLAN_WEEK
              , COUNT(*) AS CNT
              , (SELECT MAX(TRIM(TO_CHAR(PLAN_YEAR))||LPAD(PLAN_WEEK,2,'0')) PLAN_WEEK FROM MWIPCALDEF WHERE CALENDAR_ID = 'OTD' AND SYS_DATE = '20200427') AS CKD_WEEK
           FROM MWIPCALDEF
          WHERE 1=1
            AND CALENDAR_ID = 'OTD'
            AND SYS_YEAR||LPAD(SYS_MONTH,2,'0') IN ('202004','202005','202006')
          GROUP BY PLAN_MONTH, PLAN_WEEK
        ) B
  WHERE 1=1
    AND A.PLAN_WEEK = B.PLAN_WEEK
    AND A.FACTORY = 'HMVA2' 
)
SELECT CUST_TYPE, NVL((SELECT DATA_1 FROM MGCMTBLDAT WHERE TABLE_NAME = 'H_CUSTOMER' AND KEY_1 = MAT_GRP_1 AND ROWNUM=1), '-') AS CUSTOMER, MAT_GRP_9 AS MAJOR_CODE, MAT_GRP_2 AS FAMILY,  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' 
     , ROUND(SUM(MON_PLN * CONVERT_QTY) /1000,0) AS MON_PLN
     , ROUND(SUM(REV_PLN * CONVERT_QTY) /1000,0) AS REV_PLN
     , ROUND(SUM(SOP_PLN * CONVERT_QTY) /1000,0) AS SOP_PLN
     , ROUND(SUM(W0 * CONVERT_QTY) /1000,0) AS W0
     , ROUND(SUM(W1 * CONVERT_QTY) /1000,0) AS W1
     , ROUND(SUM(W2 * CONVERT_QTY) /1000,0) AS W2
     , ROUND(SUM(W3 * CONVERT_QTY) /1000,0) AS W3
     , ROUND(SUM(W4 * CONVERT_QTY) /1000,0) AS W4
     , ROUND(SUM(SHP_W0 * CONVERT_QTY) /1000,0) AS SHP_W0
     , ROUND(SUM(SHP_W1 * CONVERT_QTY) /1000,0) AS SHP_W1
     , ROUND(SUM(SHP_W2 * CONVERT_QTY) /1000,0) AS SHP_W2
     , ROUND(SUM(SHP_W3 * CONVERT_QTY) /1000,0) AS SHP_W3
     , ROUND(SUM(SHP_W4 * CONVERT_QTY) /1000,0) AS SHP_W4
     , ROUND(SUM(M1 * CONVERT_QTY) /1000,0) AS M1
     , ROUND(SUM(M2 * CONVERT_QTY) /1000,0) AS M2
  FROM (
        SELECT MAT.* 
             , NVL((SELECT DATA_10 FROM MGCMTBLDAT WHERE TABLE_NAME = 'H_CUSTOMER' AND FACTORY = 'HMVA2' AND  KEY_1 = MAT_GRP_1), '-') AS CUST_TYPE 
             , CASE WHEN MAT.MAT_GRP_3 IN ('COB', 'BGN') THEN M_PLN.MON_PLN / TO_NUMBER(DECODE(MAT.MAT_CMF_13,' ',1,MAT.MAT_CMF_13)) ELSE M_PLN.MON_PLN END AS MON_PLN
             , CASE WHEN MAT.MAT_GRP_3 IN ('COB', 'BGN') THEN M_PLN.REV_PLN / TO_NUMBER(DECODE(MAT.MAT_CMF_13,' ',1,MAT.MAT_CMF_13)) ELSE M_PLN.REV_PLN END AS REV_PLN
             , CASE WHEN MAT.MAT_GRP_3 IN ('COB', 'BGN') THEN M_PLN.SOP_PLN / TO_NUMBER(DECODE(MAT.MAT_CMF_13,' ',1,MAT.MAT_CMF_13)) ELSE M_PLN.SOP_PLN END AS SOP_PLN
             , CASE WHEN MAT.MAT_GRP_3 IN ('COB', 'BGN') THEN W0 / TO_NUMBER(DECODE(MAT.MAT_CMF_13,' ',1,MAT.MAT_CMF_13)) ELSE W0 END AS W0
             , CASE WHEN MAT.MAT_GRP_3 IN ('COB', 'BGN') THEN W1 / TO_NUMBER(DECODE(MAT.MAT_CMF_13,' ',1,MAT.MAT_CMF_13)) ELSE W1 END AS W1
             , CASE WHEN MAT.MAT_GRP_3 IN ('COB', 'BGN') THEN W2 / TO_NUMBER(DECODE(MAT.MAT_CMF_13,' ',1,MAT.MAT_CMF_13)) ELSE W2 END AS W2
             , CASE WHEN MAT.MAT_GRP_3 IN ('COB', 'BGN') THEN W3 / TO_NUMBER(DECODE(MAT.MAT_CMF_13,' ',1,MAT.MAT_CMF_13)) ELSE W3 END AS W3
             , CASE WHEN MAT.MAT_GRP_3 IN ('COB', 'BGN') THEN W4 / TO_NUMBER(DECODE(MAT.MAT_CMF_13,' ',1,MAT.MAT_CMF_13)) ELSE W4 END AS W4
             , CASE WHEN MAT.MAT_GRP_3 IN ('COB', 'BGN') THEN SHP_W0 / TO_NUMBER(DECODE(MAT.MAT_CMF_13,' ',1,MAT.MAT_CMF_13)) ELSE SHP_W0 END AS SHP_W0
             , CASE WHEN MAT.MAT_GRP_3 IN ('COB', 'BGN') THEN SHP_W1 / TO_NUMBER(DECODE(MAT.MAT_CMF_13,' ',1,MAT.MAT_CMF_13)) ELSE SHP_W1 END AS SHP_W1
             , CASE WHEN MAT.MAT_GRP_3 IN ('COB', 'BGN') THEN SHP_W2 / TO_NUMBER(DECODE(MAT.MAT_CMF_13,' ',1,MAT.MAT_CMF_13)) ELSE SHP_W2 END AS SHP_W2
             , CASE WHEN MAT.MAT_GRP_3 IN ('COB', 'BGN') THEN SHP_W3 / TO_NUMBER(DECODE(MAT.MAT_CMF_13,' ',1,MAT.MAT_CMF_13)) ELSE SHP_W3 END AS SHP_W3
             , CASE WHEN MAT.MAT_GRP_3 IN ('COB', 'BGN') THEN SHP_W4 / TO_NUMBER(DECODE(MAT.MAT_CMF_13,' ',1,MAT.MAT_CMF_13)) ELSE SHP_W4 END AS SHP_W4
             , CASE WHEN MAT.MAT_GRP_3 IN ('COB', 'BGN') THEN M0 / TO_NUMBER(DECODE(MAT.MAT_CMF_13,' ',1,MAT.MAT_CMF_13)) ELSE M0 END AS M0
             , CASE WHEN MAT.MAT_GRP_3 IN ('COB', 'BGN') THEN M1 / TO_NUMBER(DECODE(MAT.MAT_CMF_13,' ',1,MAT.MAT_CMF_13)) ELSE M1 END AS M1
             , CASE WHEN MAT.MAT_GRP_3 IN ('COB', 'BGN') THEN M2 / TO_NUMBER(DECODE(MAT.MAT_CMF_13,' ',1,MAT.MAT_CMF_13)) ELSE M2 END AS M2
             , 1 AS CONVERT_QTY
          FROM MWIPMATDEF MAT
             , (
                SELECT MAT_ID
                     , SUM(PLAN_QTY_ASSY) AS MON_PLN
                     , SUM(DECODE(RESV_FIELD1, ' ', 0, RESV_FIELD1)) AS REV_PLN
                     , SUM(DECODE(RESV_FIELD3, ' ', 0, RESV_FIELD3)) AS SOP_PLN
                  FROM CWIPPLNMON 
                 WHERE 1=1 
                   AND FACTORY = 'HMVA2' 
                   AND PLAN_MONTH = '202004'
                 GROUP BY MAT_ID
               ) M_PLN
             , (
                SELECT MAT_ID
                     , SUM(DECODE(PLAN_WEEK, '202014', SHP_QTY, 0)) AS SHP_W0 
                     , SUM(DECODE(PLAN_WEEK, '202015', SHP_QTY, 0)) AS SHP_W1 
                     , SUM(DECODE(PLAN_WEEK, '202016', SHP_QTY, 0)) AS SHP_W2 
                     , SUM(DECODE(PLAN_WEEK, '202017', SHP_QTY, 0)) AS SHP_W3 
                     , SUM(DECODE(PLAN_WEEK, '202018', SHP_QTY, 0)) AS SHP_W4 
                  FROM (
                        SELECT TRIM(TO_CHAR(PLAN_YEAR))||LPAD(PLAN_WEEK,2,'0') AS PLAN_WEEK, MAT_ID
                             , SUM(SHP_QTY_1) AS SHP_QTY
                          FROM VSUMWIPOUT A
                             , MWIPCALDEF B 
                         WHERE 1=1 
                           AND A.WORK_DATE = B.SYS_DATE(+) 
                           AND A.WORK_DATE LIKE '202004%'
                           AND A.LOT_TYPE = 'W' 
                           AND A.FACTORY = 'HMVA2' 
                           AND A.CM_KEY_2 = 'PROD' 
                           AND A.CM_KEY_3 LIKE 'P%'
                           AND B.CALENDAR_ID(+) = 'OTD'
                           AND B.PLAN_YEAR||LPAD(B.PLAN_WEEK,2,'0') <= '202018'
                         GROUP BY TRIM(TO_CHAR(PLAN_YEAR))||LPAD(PLAN_WEEK,2,'0'), MAT_ID 
                         UNION ALL 
                        SELECT PLAN_WEEK, MAT_ID, SUM(REV_QTY) 
                          FROM DT 
                         WHERE GUBUN = '3' 
                           AND PLAN_WEEK = '202018'
                           AND PLAN_MONTH = '202004'
                         GROUP BY PLAN_WEEK, MAT_ID 
                       )
                 GROUP BY MAT_ID
               ) SHP
             , (
                SELECT MAT_ID
                     , SUM(CASE WHEN PLAN_MONTH = '202004' AND PLAN_WEEK = '202014' THEN REV_QTY ELSE 0 END) AS W0 
                     , SUM(CASE WHEN PLAN_MONTH = '202004' AND PLAN_WEEK = '202015' THEN REV_QTY ELSE 0 END) AS W1 
                     , SUM(CASE WHEN PLAN_MONTH = '202004' AND PLAN_WEEK = '202016' THEN REV_QTY ELSE 0 END) AS W2 
                     , SUM(CASE WHEN PLAN_MONTH = '202004' AND PLAN_WEEK = '202017' THEN REV_QTY ELSE 0 END) AS W3 
                     , SUM(CASE WHEN PLAN_MONTH = '202004' AND PLAN_WEEK = '202018' THEN REV_QTY ELSE 0 END) AS W4 
                     , SUM(CASE WHEN PLAN_WEEK >= CKD_WEEK THEN REV_QTY ELSE 0 END) AS W_LAST
                     , SUM(DECODE(PLAN_MONTH, '202004', REV_QTY, 0)) AS M0
                     , SUM(DECODE(PLAN_MONTH, '202005', REV_QTY, 0)) AS M1
                     , SUM(DECODE(PLAN_MONTH, '202006', REV_QTY, 0)) AS M2
                  FROM (
                        SELECT * FROM DT WHERE GUBUN = '3'
                       )
                 GROUP BY MAT_ID
               ) W_PLN
         WHERE 1=1
           AND MAT.MAT_ID = M_PLN.MAT_ID(+)
           AND MAT.MAT_ID = SHP.MAT_ID(+)
           AND MAT.MAT_ID = W_PLN.MAT_ID(+)
           AND MAT.FACTORY = 'HMVA2'
           AND MAT.DELETE_FLAG = ' '
           AND MAT.MAT_TYPE = 'FG'
           AND MAT.MAT_ID LIKE '%'
       )
 GROUP BY CUST_TYPE, MAT_GRP_1, MAT_GRP_9, MAT_GRP_2,  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' 
HAVING SUM(NVL(MON_PLN,0) + NVL(REV_PLN,0) + NVL(SOP_PLN,0) +  + NVL(W0,0) + NVL(W1,0) + NVL(W2,0) + NVL(W3,0) + NVL(W4,0) + NVL(SHP_W0,0) + NVL(SHP_W1,0) + NVL(SHP_W2,0) + NVL(SHP_W3,0) + NVL(SHP_W4,0) + NVL(M0,0) + NVL(M1,0) + NVL(M2,0)) > 0
 ORDER BY DECODE(CUST_TYPE, 'SEC', 1, 'Hynix', 2, 'Fabless', 3, 4), MAT_GRP_1, MAT_GRP_9, MAT_GRP_2,  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT PLAN_WEEK V1    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_DATE = TO_CHAR(SYSDATE,'yyyymmdd')      AND ROWNUM = 1  
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('2020', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('2020', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT LANGUAGE_2 FROM RWEBFUNDEF WHERE FUNC_NAME = 'MAT070602'
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
SELECT LANGUAGE_2 FROM RWEBFUNDEF WHERE FUNC_NAME = 'MAT070501'
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT KEY_1 Code, DATA_1 Data
  FROM MGCMTBLDAT
 WHERE 1=1 
   AND FACTORY = 'HMVA2' 
   AND TABLE_NAME = 'MATERIAL_TYPE' 
   AND DATA_2 = 'Y' 
 ORDER BY KEY_1 ASC
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT A.MAT_TYPE, A.MAT_ID, A.MAT_DESC, A.UNIT_1
     , SUM(B.INV_QTY) AS INV_QTY
     , SUM(B.INV_L_QTY) AS INV_L_QTY
     , SUM(E.WIK_WIP) AS WIK_WIP 
     , SUM(C.SMT_BEFORE) AS SMT_BEFORE 
     , SUM(C.SMT_AFTER) AS SMT_AFTER 
     , SUM(NVL(B.INV_QTY,0)) + SUM(NVL(B.INV_L_QTY,0)) + SUM(NVL(C.QTY_TTL,0)) + SUM(NVL(E.WIK_WIP,0)) AS TTL
     , SUM(B.QTY_1004) AS QTY_1004 
     , SUM(D.ORDER_QTY) AS ORDER_QTY
     , SUM(C.GRADE_A) AS GRADE_A
     , SUM(C.GRADE_B) AS GRADE_B
     , SUM(C.IN_QTY) AS IN_QTY
     , SUM(C.LOT_TTL) AS LOT_TTL
  FROM MWIPMATDEF A 
     , ( 
        SELECT MAT_ID 
             , SUM(INV_QTY) AS INV_QTY 
             , SUM(INV_L_QTY) AS INV_L_QTY 
             , SUM(QTY_1004) AS QTY_1004 
          FROM ( 
                SELECT MAT_ID 
                     , SUM(DECODE(STORAGE_LOCATION, '1000', QUANTITY, '1002', QUANTITY, '1003', QUANTITY, 0)) AS INV_QTY 
                     , SUM(DECODE(STORAGE_LOCATION, '1001', QUANTITY, 0)) AS INV_L_QTY 
                     , SUM(DECODE(STORAGE_LOCATION, '1004', QUANTITY, 0)) AS QTY_1004 
                  FROM CWMSLOTSTS@RPTTOMES 
                 WHERE 1=1 
                   AND QUANTITY> 0 
                   AND STORAGE_LOCATION IN ('1000', '1001', '1002', '1003', '1004') 
                 GROUP BY MAT_ID 
                 UNION ALL 
                SELECT MAT_ID, 0 AS INV_QTY, SUM(QTY_1) AS INV_L_QTY, 0 AS QTY_1004 
                  FROM CWIPMATSLP@RPTTOMES 
                 WHERE 1=1 
                   AND RECV_FLAG = ' ' 
                   AND IN_TIME BETWEEN '20200425000000' AND '20200427235959' 
                 GROUP BY MAT_ID 
               ) 
         GROUP BY MAT_ID 
       ) B 
     , ( 
        SELECT MAT_ID
             , SUM(CASE WHEN A.LOT_CMF_9 = 'A' AND B.LOT_ID IS NULL THEN 1 ELSE 0 END) AS GRADE_A
             , SUM(CASE WHEN A.LOT_CMF_9 = 'B' AND B.LOT_ID IS NULL THEN 1 ELSE 0 END) AS GRADE_B
             , SUM(CASE WHEN B.LOT_ID IS NOT NULL THEN 1 ELSE 0 END) AS IN_QTY
             , SUM(CASE WHEN OPER LIKE 'M%' AND OPER <= 'M0330' THEN QTY_1 ELSE 0 END) AS SMT_BEFORE 
             , SUM(CASE WHEN OPER LIKE 'A%' OR OPER > 'M0330' THEN QTY_1 ELSE 0 END) AS SMT_AFTER 
             , COUNT(*) AS LOT_TTL 
             , SUM(QTY_1) AS QTY_TTL 
          FROM RWIPLOTSTS A 
             , CRASRESMAT B 
         WHERE 1=1  
           AND A.FACTORY = B.FACTORY(+) 
           AND A.LOT_ID = B.LOT_ID(+) 
           AND A.FACTORY = 'HMVA2'
           AND A.LOT_TYPE != 'W'
           AND A.LOT_DEL_FLAG = ' '
           AND A.LOT_CMF_2 = '-' 
           AND A.LOT_CMF_9 != ' ' 
           AND A.QTY_1 > 0 
           AND A.OPER NOT IN  ('00001', '00002', 'V0000') 
         GROUP BY A.MAT_ID  
       ) C 
     , ( 
        SELECT MAT_ID, SUM(ORDER_QUAN) AS ORDER_QTY 
          FROM RSAPORDQNT 
         WHERE 1=1 
           AND CREATE_TIME = TO_CHAR(SYSDATE, 'YYYYMMDD') 
         GROUP BY MAT_ID 
       ) D 
     , ( 
        SELECT MAT_ID, SUM(LOT_QTY) AS WIK_WIP 
          FROM ISTMWIKWIP@RPTTOMES 
         WHERE 1=1 
           AND CUTOFF_DT = '20200427' || TO_CHAR(SYSDATE, 'HH24')
         GROUP BY MAT_ID 
       ) E 
 WHERE 1=1
   AND A.MAT_ID = B.MAT_ID(+)
   AND A.MAT_ID = C.MAT_ID(+)
   AND A.MAT_ID = D.MAT_ID(+)
   AND A.MAT_ID = E.MAT_ID(+)
   AND A.FACTORY = 'HMVA2'
   AND A.MAT_TYPE IN ('PB')
 GROUP BY A.MAT_TYPE, A.MAT_ID, A.MAT_DESC, A.UNIT_1
 HAVING SUM(NVL(B.INV_QTY,0)) + SUM(NVL(B.INV_L_QTY,0)) + SUM(NVL(C.LOT_TTL,0)) + SUM(NVL(D.ORDER_QTY,0)) + SUM(NVL(E.WIK_WIP,0)) > 0
 ORDER BY A.MAT_TYPE, A.MAT_ID 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
SELECT LANGUAGE_2 FROM RWEBFUNDEF WHERE FUNC_NAME = 'MAT070202'
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
SELECT DISTINCT LPAD(PLAN_WEEK,2,'0') AS PLAN_WEEK 
  FROM MWIPCALDEF 
 WHERE 1=1 
   AND CALENDAR_ID = 'OTD' 
   AND SYS_YEAR = '2020' 
   AND SYS_MONTH = '04' 
   AND SYS_DAY = '27' 
 ORDER BY PLAN_WEEK 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT MIN(SYS_DATE) 
  FROM MWIPCALDEF 
 WHERE 1=1 
   AND CALENDAR_ID='OTD' 
   AND PLAN_YEAR='2020' 
   AND PLAN_WEEK='18' 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT DISTINCT PLAN_YEAR|| LPAD(PLAN_WEEK,2,'0') 
  FROM MWIPCALDEF 
 WHERE CALENDAR_ID = 'OTD' 
   AND SYS_YEAR || LPAD(SYS_MONTH,2,'0') IN ('202004', '202005' ,'202006') 
   AND SYS_DATE >= '20200427' 
 ORDER BY 1 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT MIN(SYS_DATE) AS START_DAY 
     , MAX(SYS_DATE) AS END_DAY 
     , PLAN_YEAR||DECODE(LENGTH(PLAN_WEEK), 1, '0'||PLAN_WEEK, PLAN_WEEK) AS WEEK
  FROM MWIPCALDEF 
 WHERE CALENDAR_ID = 'OTD'
   AND (PLAN_YEAR || LPAD(PLAN_WEEK,2,'0')) IN ( 
                                                SELECT WW
                                                  FROM (
                                                        SELECT WW
                                                             , ROW_NUMBER() OVER(ORDER BY WW) AS RNK
                                                          FROM (
                                                                SELECT DISTINCT PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') AS WW
                                                                  FROM MWIPCALDEF
                                                                 WHERE CALENDAR_ID = 'OTD'
                                                                   AND PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') >= (
                                                                                                              SELECT MAX(PLAN_YEAR || LPAD(PLAN_WEEK,2,'0')) AS WW
                                                                                                                FROM MWIPCALDEF
                                                                                                               WHERE CALENDAR_ID = 'OTD'
                                                                                                                 AND PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') < (SELECT PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') AS WW FROM MWIPCALDEF WHERE CALENDAR_ID = 'OTD' AND SYS_DATE = '20200427')
                                                                                                                 AND SYS_DATE >= TO_CHAR(TO_DATE('20200427', 'YYYYMMDD')-14, 'YYYYMMDD')
                                                                                                             )
                                                               ) 
                                                       )
                                                 WHERE RNK <= 7
                                               ) 
 GROUP BY PLAN_YEAR, PLAN_WEEK 
 ORDER BY PLAN_YEAR, PLAN_WEEK

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT LANGUAGE_2 FROM RWEBFUNDEF WHERE FUNC_NAME = 'MAT070503'
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT KEY_1 AS Code, DATA_1 AS Data 
  FROM MGCMTBLDAT 
 WHERE FACTORY = 'HMVA2' 
   AND TABLE_NAME = 'MATERIAL_TYPE' 
   AND KEY_1 IN ('TE','PB','LF','GW','SW','CW','MC', 'SB', 'RC') 
 ORDER BY KEY_1 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT DISTINCT TO_DATE(UPDATE_TIME,'YYYY-MM-DD HH24MISS') FROM RSUMWIPMAT
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT DISTINCT LPAD(PLAN_WEEK,2,'0') AS PLAN_WEEK 
  FROM MWIPCALDEF 
 WHERE 1=1 
   AND CALENDAR_ID = 'OTD' 
   AND SYS_YEAR = '2020' 
   AND SYS_MONTH = '04' 
   AND SYS_DAY = '27' 
 ORDER BY PLAN_WEEK 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT MIN(SYS_DATE) 
  FROM MWIPCALDEF 
 WHERE 1=1 
   AND CALENDAR_ID='OTD' 
   AND PLAN_YEAR='2020' 
   AND PLAN_WEEK='18' 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT DISTINCT PLAN_YEAR|| LPAD(PLAN_WEEK,2,'0') 
  FROM MWIPCALDEF 
 WHERE CALENDAR_ID = 'OTD' 
   AND SYS_YEAR || LPAD(SYS_MONTH,2,'0') IN ('202004', '202005' ,'202006') 
   AND SYS_DATE >= '20200427' 
 ORDER BY 1 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT MIN(SYS_DATE) AS START_DAY 
     , MAX(SYS_DATE) AS END_DAY 
     , PLAN_YEAR||DECODE(LENGTH(PLAN_WEEK), 1, '0'||PLAN_WEEK, PLAN_WEEK) AS WEEK
  FROM MWIPCALDEF 
 WHERE CALENDAR_ID = 'OTD'
   AND (PLAN_YEAR || LPAD(PLAN_WEEK,2,'0')) IN ( 
                                                SELECT WW
                                                  FROM (
                                                        SELECT WW
                                                             , ROW_NUMBER() OVER(ORDER BY WW) AS RNK
                                                          FROM (
                                                                SELECT DISTINCT PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') AS WW
                                                                  FROM MWIPCALDEF
                                                                 WHERE CALENDAR_ID = 'OTD'
                                                                   AND PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') >= (
                                                                                                              SELECT MAX(PLAN_YEAR || LPAD(PLAN_WEEK,2,'0')) AS WW
                                                                                                                FROM MWIPCALDEF
                                                                                                               WHERE CALENDAR_ID = 'OTD'
                                                                                                                 AND PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') < (SELECT PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') AS WW FROM MWIPCALDEF WHERE CALENDAR_ID = 'OTD' AND SYS_DATE = '20200427')
                                                                                                                 AND SYS_DATE >= TO_CHAR(TO_DATE('20200427', 'YYYYMMDD')-14, 'YYYYMMDD')
                                                                                                             )
                                                               ) 
                                                       )
                                                 WHERE RNK <= 7
                                               ) 
 GROUP BY PLAN_YEAR, PLAN_WEEK 
 ORDER BY PLAN_YEAR, PLAN_WEEK

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
(SELECT TO_CHAR(LAST_DAY(TO_DATE('202003', 'YYYYMM')),'YYYYMMDD') FROM DUAL)
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT MIN(SYS_DATE-1) 
  FROM MWIPCALDEF 
 WHERE 1=1
   AND CALENDAR_ID='SE'
   AND PLAN_YEAR='2020'
   AND PLAN_WEEK=(
                  SELECT PLAN_WEEK 
                    FROM MWIPCALDEF 
                   WHERE 1=1 
                     AND CALENDAR_ID='SE' 
                     AND SYS_DATE=TO_CHAR(TO_DATE('20200427','YYYYMMDD'),'YYYYMMDD')
                 )

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT  ' ', (SELECT DATA_1 FROM MGCMTBLDAT@RPTTOMES WHERE FACTORY = 'HMVA2' AND TABLE_NAME = 'H_CUSTOMER' AND KEY_1 = CUSTOMER) AS CUSTOMER, FAMILY, PACKAGE,  ' ',  ' ', LD_COUNT, PKG_CODE,  ' ', MATCODE,  ' ',  ' ',  ' ', OPER 
     , RTRIM(TO_CHAR(USAGE, 'FM9990D9999'), '.') AS USAGE 
     , ROUND(WIP_STOCK/1000,0) AS WIP_STOCK 
     , ROUND(((MAT_TTL/USAGE*1000)-REV_QTY)/1000,0) AS CMM 
     , ROUND((((MAT_TTL/USAGE*1000)-REV_QTY)-WIP_STOCK)/1000,0) AS "재공대비과부족" 
     , CASE WHEN ((MAT_TTL/USAGE*1000)-REV_QTY)-WIP_STOCK<0 THEN ROUND((ABS(((MAT_TTL/USAGE*1000)-REV_QTY)-WIP_STOCK)*USAGE/1000)/1000,1) ELSE 0 END "원부자재입고필요" 
     , ROUND(SOP_PLN_WEEK/1000,0) AS SOP_PLN
     , ROUND(ASSY_WEEK/1000,0) AS ASSY_WEEK 
     , ROUND((SOP_PLN_WEEK-ASSY_WEEK)/1000,1) AS "공정기준잔량" 
     , ROUND(((SOP_PLN_WEEK-ASSY_WEEK)*USAGE/1000)/1000,1) AS "원부자재필요" 
     , ROUND((MAT_TTL-((SOP_PLN_WEEK-ASSY_WEEK)*USAGE/1000))/1000,0) AS "계획대비과부족" 
     , ROUND(MAT_TTL/1000,0) AS MAT_TTL 
     , ROUND(MAT_SMT_IN/1000,0) AS MAT_SMT_IN 
     , ROUND(MAT_L_IN/1000,0) AS MAT_L_IN 
     , ROUND(WIK_WIP/1000,0) AS WIK_WIP 
     , ROUND(MAT_INV_L_QTY/1000,0) AS MAT_INV_L_QTY 
     , ROUND(MAT_INV_QTY/1000,0) AS MAT_INV_QTY 
     , ROUND(ORDER_QTY/1000,0) AS ORDER_QTY 
     , ROUND((SOP_PLN_WEEK-ASSY_WEEK)/1000,0) AS W0 
     , ROUND(W1/1000,0) AS W1 
     , ROUND(W2/1000,0) AS W2 
     , ROUND(W3/1000,0) AS W3 
     , ROUND(W4/1000,0) AS W4 
     , ROUND(W5/1000,0) AS W5 
     , ROUND(W6/1000,0) AS W6 
     , ROUND(W7/1000,0) AS W7 
     , ROUND((MAT_TTL-((SOP_PLN_WEEK-ASSY_WEEK)*USAGE/1000))/1000,0) AS MW0 
     , ROUND((MAT_TTL-((SOP_PLN_WEEK-ASSY_WEEK)*USAGE/1000) - (W1*USAGE/1000))/1000,0) AS MW1 
     , ROUND((MAT_TTL-((SOP_PLN_WEEK-ASSY_WEEK)*USAGE/1000) - (W1*USAGE/1000) - (W2*USAGE/1000))/1000,0) AS MW2 
     , ROUND((MAT_TTL-((SOP_PLN_WEEK-ASSY_WEEK)*USAGE/1000) - (W1*USAGE/1000) - (W2*USAGE/1000) - (W3*USAGE/1000))/1000,0) AS MW3 
     , ROUND((MAT_TTL-((SOP_PLN_WEEK-ASSY_WEEK)*USAGE/1000) - (W1*USAGE/1000) - (W2*USAGE/1000) - (W3*USAGE/1000) - (W4*USAGE/1000))/1000,0) AS MW4 
     , ROUND((MAT_TTL-((SOP_PLN_WEEK-ASSY_WEEK)*USAGE/1000) - (W1*USAGE/1000) - (W2*USAGE/1000) - (W3*USAGE/1000) - (W4*USAGE/1000) - (W5*USAGE/1000))/1000,0) AS MW5 
     , ROUND((MAT_TTL-((SOP_PLN_WEEK-ASSY_WEEK)*USAGE/1000) - (W1*USAGE/1000) - (W2*USAGE/1000) - (W3*USAGE/1000) - (W4*USAGE/1000) - (W5*USAGE/1000) - (W6*USAGE/1000))/1000,0) AS MW6 
     , ROUND((MAT_TTL-((SOP_PLN_WEEK-ASSY_WEEK)*USAGE/1000) - (W1*USAGE/1000) - (W2*USAGE/1000) - (W3*USAGE/1000) - (W4*USAGE/1000) - (W5*USAGE/1000) - (W6*USAGE/1000) - (W7*USAGE/1000))/1000,0) AS MW7 
  FROM ( 
        SELECT  ' ', MAT.MAT_GRP_1 AS CUSTOMER, MAT.MAT_GRP_2 AS FAMILY, MAT_GRP_10 AS PACKAGE,  ' ',  ' ', MAT.MAT_GRP_6 AS LD_COUNT, MAT.MAT_CMF_11 AS PKG_CODE,  ' ', REPLACE(A.MATCODE, '-O','') AS MATCODE,  ' ',  ' ',  ' ', A.OPER
             , SUM(A.SOP_PLN_MON) AS SOP_PLN_MON 
             , SUM(A.SOP_PLN_WEEK) AS SOP_PLN_WEEK 
             , SUM(A.WEEK_AO+A.WIP_STOCK_NEXT) AS ASSY_WEEK 
             , SUM(A.ASSY_MON+A.WIP_STOCK_NEXT) AS ASSY_MON 
             , SUM(A.WIP_STOCK) AS WIP_STOCK 
             , SUM(A.REV_QTY) AS REV_QTY 
             , MAX(A.USAGE) AS USAGE 
             , MAX(A.TTL) AS MAT_TTL 
             , MAX(A.SMT_IN) AS MAT_SMT_IN 
             , MAX(A.L_IN) AS MAT_L_IN 
             , MAX(A.WIK_WIP) AS WIK_WIP 
             , MAX(A.INV_L_QTY) AS MAT_INV_L_QTY 
             , MAX(A.INV_QTY) AS MAT_INV_QTY 
             , MAX(A.ORDER_QTY) AS ORDER_QTY 
             , MAX(A.WIP_STOCK-A.IN_QTY) AS  IN_QTY 
             , SUM(A.W0) AS W0 
             , SUM(A.W1) AS W1 
             , SUM(A.W2) AS W2 
             , SUM(A.W3) AS W3 
             , SUM(A.W4) AS W4 
             , SUM(A.W5) AS W5 
             , SUM(A.W6) AS W6 
             , SUM(A.W7) AS W7 
        FROM MWIPMATDEF MAT 
           ,  ( 
              SELECT MAT.MAT_ID 
                   , C.MATTYPE 
                   , C.MATCODE 
                   , C.DESCRIPT 
                   , C.OPER 
                   , C.UNIT 
                   , MAX(A.SOP_PLN_MON) AS  SOP_PLN_MON 
                   , MAX(A.SOP_PLN_WEEK) AS  SOP_PLN_WEEK 
                   , MAX(USAGE) AS USAGE 
                   , MAX(A.WEEK_AO) AS WEEK_AO 
                   , MAX(A.ASSY_MON) AS ASSY_MON 
                   , SUM(NVL((CASE WHEN MAT.MAT_GRP_4 NOT IN ('-','FD','FU') AND MAT.MAT_GRP_5 <> '-' THEN CASE WHEN MAT.MAT_GRP_5 IN ('1st','Merge') OR MAT.MAT_GRP_5 LIKE 'Middle%' THEN CASE WHEN B.OPER = 'A0000' THEN NVL(B.VO,0) ELSE 0 END ELSE 0 END  
                               ELSE CASE WHEN B.OPER = 'A0000' THEN NVL(B.VO,0) ELSE 0 END 
                           END),0)) AS WIP_STOCK 
                   , SUM(NVL((CASE WHEN MAT.MAT_GRP_4 NOT IN ('-','FD','FU') AND MAT.MAT_GRP_5 <> '-' THEN CASE WHEN MAT.MAT_GRP_5 IN ('1st','Merge') OR MAT.MAT_GRP_5 LIKE 'Middle%' THEN CASE WHEN (B.OPER BETWEEN C.OPER AND 'AZ010') AND B.OPER <> C.OPER THEN NVL(B.VO,0) ELSE 0 END ELSE 0 END  
                               ELSE CASE WHEN (B.OPER BETWEEN C.OPER AND 'AZ010') AND B.OPER <> C.OPER THEN NVL(B.VO,0) ELSE 0 END  
                           END),0)) AS WIP_STOCK_NEXT 
                   , SUM(NVL((CASE WHEN MAT.MAT_GRP_4 NOT IN ('-','FD','FU') AND MAT.MAT_GRP_5 <> '-' THEN CASE WHEN MAT.MAT_GRP_5 IN ('1st','Merge') OR MAT.MAT_GRP_5 LIKE 'Middle%' THEN CASE WHEN (B.OPER BETWEEN 'A0000' AND C.OPER) AND B.OPER <> 'A0000' THEN NVL(B.VO,0) ELSE 0 END ELSE 0 END  
                               ELSE CASE WHEN (B.OPER BETWEEN 'A0000' AND C.OPER) AND B.OPER <> 'A0000' THEN NVL(B.VO,0) ELSE 0 END  
                           END),0)) AS REV_QTY 
                   , MAX(C.TTL) AS TTL 
                   , MAX(C.SMT_IN) AS SMT_IN 
                   , MAX(C.L_IN) AS L_IN 
                   , MAX(C.WIK_WIP) AS WIK_WIP 
                   , MAX(C.INV_L_QTY) AS INV_L_QTY 
                   , MAX(C.INV_QTY) AS INV_QTY 
                   , MAX(C.ORDER_QTY) AS ORDER_QTY 
                   , MAX(C.IN_QTY) AS IN_QTY 
                   , MAX(A.W0) AS W0 
                   , MAX(A.W1) AS W1 
                   , MAX(A.W2) AS W2 
                   , MAX(A.W3) AS W3 
                   , MAX(A.W4) AS W4 
                   , MAX(A.W5) AS W5 
                   , MAX(A.W6) AS W6 
                   , MAX(A.W7) AS W7 
                FROM MWIPMATDEF MAT 
                   , ( 
                      SELECT MAT.MAT_ID   
                           , MAX(CASE WHEN MAT.MAT_GRP_3 IN ('COB') THEN ROUND(NVL(PLAN.RESV_FIELD1,0)/TO_NUMBER(DECODE(MAT.MAT_CMF_13,' ',1,MAT.MAT_CMF_13)),0) ELSE NVL(PLAN.RESV_FIELD1,0) END) AS SOP_PLN_MON 
                           , MAX(CASE WHEN MAT.MAT_GRP_3 IN ('COB', 'BGN') THEN NVL(W_PLN.W0,0) / TO_NUMBER(DECODE(MAT.MAT_CMF_13,' ',1,MAT.MAT_CMF_13)) ELSE NVL(W_PLN.W0,0) END) AS SOP_PLN_WEEK  
                           , MAX(CASE WHEN MAT.MAT_GRP_3 IN ('COB', 'BGN') THEN ROUND(NVL(WEEK_AO.WEEK_AO,0)/TO_NUMBER(DECODE(MAT.MAT_CMF_13,' ',1,MAT.MAT_CMF_13)),0) ELSE NVL(WEEK_AO.WEEK_AO,0) END) WEEK_AO 
                           , MAX(CASE WHEN MAT.MAT_GRP_3 IN ('COB', 'BGN') THEN ROUND(NVL(MON_AO.ASSY_MON,0)/TO_NUMBER(DECODE(MAT.MAT_CMF_13,' ',1,MAT.MAT_CMF_13)),0) ELSE NVL(MON_AO.ASSY_MON,0) END) ASSY_MON 
                           , MAX(CASE WHEN MAT.MAT_GRP_3 IN ('COB', 'BGN') THEN NVL(W0,0) / TO_NUMBER(DECODE(MAT.MAT_CMF_13,' ',1,MAT.MAT_CMF_13)) ELSE NVL(W0,0) END) AS W0 
                           , MAX(CASE WHEN MAT.MAT_GRP_3 IN ('COB', 'BGN') THEN NVL(W1,0) / TO_NUMBER(DECODE(MAT.MAT_CMF_13,' ',1,MAT.MAT_CMF_13)) ELSE NVL(W1,0) END) AS W1 
                           , MAX(CASE WHEN MAT.MAT_GRP_3 IN ('COB', 'BGN') THEN NVL(W2,0) / TO_NUMBER(DECODE(MAT.MAT_CMF_13,' ',1,MAT.MAT_CMF_13)) ELSE NVL(W2,0) END) AS W2 
                           , MAX(CASE WHEN MAT.MAT_GRP_3 IN ('COB', 'BGN') THEN NVL(W3,0) / TO_NUMBER(DECODE(MAT.MAT_CMF_13,' ',1,MAT.MAT_CMF_13)) ELSE NVL(W3,0) END) AS W3 
                           , MAX(CASE WHEN MAT.MAT_GRP_3 IN ('COB', 'BGN') THEN NVL(W4,0) / TO_NUMBER(DECODE(MAT.MAT_CMF_13,' ',1,MAT.MAT_CMF_13)) ELSE NVL(W4,0) END) AS W4 
                           , MAX(CASE WHEN MAT.MAT_GRP_3 IN ('COB', 'BGN') THEN NVL(W5,0) / TO_NUMBER(DECODE(MAT.MAT_CMF_13,' ',1,MAT.MAT_CMF_13)) ELSE NVL(W5,0) END) AS W5 
                           , MAX(CASE WHEN MAT.MAT_GRP_3 IN ('COB', 'BGN') THEN NVL(W6,0) / TO_NUMBER(DECODE(MAT.MAT_CMF_13,' ',1,MAT.MAT_CMF_13)) ELSE NVL(W6,0) END) AS W6 
                           , MAX(CASE WHEN MAT.MAT_GRP_3 IN ('COB', 'BGN') THEN NVL(W7,0) / TO_NUMBER(DECODE(MAT.MAT_CMF_13,' ',1,MAT.MAT_CMF_13)) ELSE NVL(W7,0) END) AS W7 
                           , MAX(W_PLN.W_LAST) AS W_LAST 
                        FROM MWIPMATDEF MAT  
                           , (    
                              SELECT MAT_ID, SUM(S1_FAC_OUT_QTY_1+S2_FAC_OUT_QTY_1+S3_FAC_OUT_QTY_1) AS SHP_QTY  
                                FROM RSUMFACMOV   
                               WHERE 1=1   
                                 AND WORK_DATE BETWEEN '20200425' AND '20200427' 
                                 AND LOT_TYPE = 'W'   
                                 AND CM_KEY_1 = 'HMVA2'   
                                 AND CM_KEY_2 = 'PROD'   
                                 AND CM_KEY_3 LIKE 'P%' 
                                 AND FACTORY NOT IN ('RETURN')  
                               GROUP BY MAT_ID     
                             ) SHP   
                          , ( 
                             SELECT MAT_ID 
                                  , SUM(DECODE(WORK_DATE,'20200331', 0, NVL(S1_FAC_OUT_QTY_1 + S2_FAC_OUT_QTY_1 + S3_FAC_OUT_QTY_1 + S4_FAC_OUT_QTY_1, 0))) AS ASSY_MON 
                               FROM RSUMFACMOV 
                               WHERE 1=1 
                                 AND WORK_DATE BETWEEN '20200331' AND '20200427'
                                 AND LOT_TYPE = 'W' 
                                 AND CM_KEY_1 = 'HMVA2' 
                                 AND CM_KEY_2 = 'PROD' 
                                 AND CM_KEY_3 LIKE 'P%' 
                                 AND FACTORY NOT IN ('RETURN') 
                               GROUP BY MAT_ID 
                             ) MON_AO 
                           , ( 
                              SELECT MAT_ID 
                                   , SUM(NVL(S1_FAC_OUT_QTY_1 + S2_FAC_OUT_QTY_1 + S3_FAC_OUT_QTY_1 + S4_FAC_OUT_QTY_1, 0)) AS WEEK_AO  
                                FROM RSUMFACMOV 
                               WHERE 1=1 
                                 AND WORK_DATE BETWEEN '20200425' AND '20200501'
                                 AND LOT_TYPE = 'W' 
                                 AND CM_KEY_1 = 'HMVA2' 
                                 AND CM_KEY_2 = 'PROD' 
                                 AND CM_KEY_3 LIKE 'P%' 
                                 AND FACTORY NOT IN ('RETURN') 
                               GROUP BY MAT_ID 
                             ) WEEK_AO 
                           , (  
                              SELECT FACTORY,MAT_ID,PLAN_QTY_ASSY,PLAN_MONTH, RESV_FIELD1  
                                FROM (  
                                      SELECT FACTORY, MAT_ID, SUM(PLAN_QTY_ASSY) AS PLAN_QTY_ASSY, PLAN_MONTH, SUM(RESV_FIELD1) AS RESV_FIELD1   
                                        FROM (  
                                              SELECT FACTORY, MAT_ID, SUM(PLAN_QTY_ASSY) AS PLAN_QTY_ASSY, PLAN_MONTH, SUM(TO_NUMBER(DECODE(RESV_FIELD1,' ',0,RESV_FIELD1))) AS RESV_FIELD1  
                                                FROM CWIPPLNMON  
                                               WHERE 1=1  
                                                 AND FACTORY = 'HMVA2'  
                                               GROUP BY FACTORY, MAT_ID, PLAN_MONTH  
                                             )  
                                       GROUP BY FACTORY, MAT_ID,PLAN_MONTH  
                                     )  
                                WHERE PLAN_MONTH = '202004' 
                             ) PLAN 
                           , (   
                              SELECT MAT_ID   
                                   , SUM(DECODE(PLAN_WEEK, '202018', WW_QTY, 0)) AS W0  
                                   , SUM(DECODE(PLAN_WEEK, '202019', WW_QTY, 0)) AS W1  
                                   , SUM(DECODE(PLAN_WEEK, '202020', WW_QTY, 0)) AS W2  
                                   , SUM(DECODE(PLAN_WEEK, '202021', WW_QTY, 0)) AS W3  
                                   , SUM(DECODE(PLAN_WEEK, '202022', WW_QTY, 0)) AS W4  
                                   , SUM(DECODE(PLAN_WEEK, '202023', WW_QTY, 0)) AS W5  
                                   , SUM(DECODE(PLAN_WEEK, '202024', WW_QTY, 0)) AS W6  
                                   , SUM(DECODE(PLAN_WEEK, '202025', WW_QTY, 0)) AS W7  
                                   , SUM(CASE WHEN PLAN_WEEK >= CKD_S_WEEK AND PLAN_WEEK <= CKD_L_WEEK THEN REV_QTY ELSE 0 END) AS W_LAST   
                                FROM (   
                                      SELECT A.PLAN_WEEK, B.CKD_S_WEEK, B.CKD_L_WEEK, A.MAT_ID, A.WW_QTY, B.CNT   
                                           , ROUND((A.WW_QTY / 7) * B.CNT, 0) AS REV_QTY   
                                        FROM RWIPPLNWEK A   
                                           , (   
                                              SELECT MAX(TRIM(TO_CHAR(PLAN_YEAR))||LPAD(PLAN_WEEK,2,'0')) PLAN_WEEK, COUNT(*) AS CNT  
                                                   , (SELECT MAX(TRIM(TO_CHAR(PLAN_YEAR))||LPAD(PLAN_WEEK,2,'0')) PLAN_WEEK FROM MWIPCALDEF WHERE CALENDAR_ID = 'OTD' AND SYS_DATE = '20200425') AS CKD_S_WEEK 
                                                   , (SELECT MAX(TRIM(TO_CHAR(PLAN_YEAR))||LPAD(PLAN_WEEK,2,'0')) PLAN_WEEK FROM MWIPCALDEF WHERE CALENDAR_ID = 'OTD' AND SYS_DATE = '20200427') AS CKD_L_WEEK 
                                                FROM MWIPCALDEF  
                                               WHERE 1=1  
                                                 AND CALENDAR_ID = 'OTD'  
                                                 AND PLAN_YEAR||LPAD(PLAN_MONTH,2,'0') IN('202004','202005','202006') 
                                               GROUP BY PLAN_WEEK  
                                             ) B   
                                       WHERE 1=1   
                                         AND A.PLAN_WEEK = B.PLAN_WEEK   
                                         AND A.FACTORY = 'HMVA2'     
                                         AND A.GUBUN = '3'    
                                     )   
                               GROUP BY MAT_ID   
                             ) W_PLN   
                       WHERE 1=1  
                         AND MAT.MAT_ID = PLAN.MAT_ID(+) 
                         AND MAT.MAT_ID = SHP.MAT_ID(+)  
                         AND MAT.MAT_ID = W_PLN.MAT_ID(+)  
                         AND MAT.MAT_ID = MON_AO.MAT_ID(+)  
                         AND MAT.MAT_ID = WEEK_AO.MAT_ID(+)  
                         AND MAT.FACTORY = 'HMVA2'  
                         AND MAT.DELETE_FLAG = ' '  
                         AND MAT.MAT_TYPE = 'FG'  
                         AND MAT.MAT_ID LIKE '%'  
                       GROUP BY MAT.MAT_ID 
                     ) A 
                   , ( 
                      SELECT LOT.MAT_ID, MAT.MAT_GRP_3, LOT.OPER_GRP_1, LOT.OPER 
                           , DECODE(MAT.MAT_GRP_3,'COB',ROUND(QTY/TO_NUMBER(DECODE(MAT.MAT_CMF_13,' ',1,MAT.MAT_CMF_13)),0),'BGN',ROUND(QTY/TO_NUMBER(DECODE(MAT.MAT_CMF_13,' ',1,MAT.MAT_CMF_13)),0),QTY) AS VO 
                        FROM ( 
                              SELECT FACTORY, MAT_ID, OPER_GRP_1, OPER 
                                   , SUM(CASE WHEN OPER <= 'A0395' THEN QTY_1 / NVL(COMP_CNT,1) 
                                              ELSE QTY_1 
                                         END) QTY 
                                FROM ( 
                                      SELECT A.FACTORY, A.MAT_ID, B.OPER_GRP_1, B.OPER, A.QTY_1 
                                           , (SELECT DATA_1 FROM MGCMTBLDAT WHERE FACTORY = 'HMVA2' AND TABLE_NAME IN ('H_SEC_AUTO_LOSS','H_HX_AUTO_LOSS') AND KEY_1 = A.MAT_ID) AS COMP_CNT 
                                        FROM RWIPLOTSTS A 
                                           , MWIPOPRDEF B 
                                       WHERE 1 = 1 
                                         AND A.FACTORY = B.FACTORY(+) 
                                         AND A.OPER = B.OPER(+) 
                                         AND A.FACTORY = 'HMVA2' 
                                         AND A.LOT_TYPE = 'W' 
                                         AND A.LOT_DEL_FLAG = ' ' 
                                         AND B.OPER_GRP_1 NOT IN (' ', '-') 
                                         AND B.OPER BETWEEN 'A0000' AND 'AZ010' 
                                         AND A.LOT_CMF_5 LIKE 'P%' 
                                     ) 
                               GROUP BY FACTORY, MAT_ID, OPER_GRP_1, OPER 
                               ORDER BY MAT_ID, OPER, OPER_GRP_1 
                             ) LOT 
                           , MWIPMATDEF MAT 
                       WHERE 1 = 1 
                         AND LOT.FACTORY = MAT.FACTORY 
                         AND LOT.MAT_ID = MAT.MAT_ID 
                         AND MAT.DELETE_FLAG <> 'Y' 
                         AND MAT.MAT_GRP_2 <> '-' 
                       ORDER BY LOT.OPER, LOT.OPER_GRP_1 
                     ) B 
                   , ( 
                      SELECT MAT.MAT_ID    
                           , SMM.MAT_TYPE AS MATTYPE   
                           , MAX(NVL(SMM.UNIT_QTY,0)) AS USAGE   
                           , SMM.MATCODE AS MATCODE 
                           , SMM.DESCRIPT AS DESCRIPT 
                           , SMM.OPER AS OPER  
                           , SMM.UNIT_1 AS UNIT  
                           , MAX(WIP_MAT.TTL) AS TTL 
                           , MAX(WIP_MAT.SMT_IN) AS SMT_IN 
                           , MAX(WIP_MAT.L_IN) AS L_IN 
                           , MAX(WIP_MAT.WIK_WIP) AS WIK_WIP 
                           , MAX(WIP_MAT.INV_L_QTY) AS INV_L_QTY 
                           , MAX(WIP_MAT.INV_QTY) AS INV_QTY 
                           , MAX(WIP_MAT.ORDER_QTY) AS ORDER_QTY 
                           , MAX(WIP_MAT.IN_QTY) AS IN_QTY 
                        FROM MWIPMATDEF MAT  
                           , (   
                              SELECT DISTINCT NVL(P.MAT_ID,B.PARTNUMBER) PARTNUMBER, B.MATCODE, B.DESCRIPT, B.RESV_FIELD_2 AS MAT_TYPE, B.UNIT AS UNIT_1, B.UNIT_QTY, B.STEPID AS OPER 
                                FROM CWIPMATDEF@RPTTOMES A  
                                   , CWIPBOMDEF B  
                                   , RWIPMCPBOM P    
                               WHERE 1=1  
                                 AND A.MAT_ID = B.MATCODE  
                                 AND A.FACTORY = 'HMVA2'  
                                 AND B.RESV_FIELD_2 IN ('CW','GW','MC','SB','SW','TE', 'LF', 'PB', 'RC')  
                                 AND B.RESV_FIELD_2 <> ' '  
                                 AND B.RESV_FLAG_1 = 'Y'  
                                 AND B.STEPID <> 'A0300'  
                                 AND B.MATCODE NOT LIKE '%-O'  
                                 AND B.PARTNUMBER = P.MCP_TO_PART(+) 
                                 AND B.RESV_FIELD_2 IN ('PB')
                               ORDER BY MATCODE 
                             ) SMM 
                           , (  
                              SELECT REPLACE(A.MAT_ID, '-O', '') AS MAT_ID 
                                   , SUM(NVL(B.INV_QTY,0)) + SUM(NVL(B.INV_L_QTY,0))+SUM(NVL(C.QTY_SMT,0))+SUM(NVL(C.QTY_TTL,0))+SUM(NVL(E.WIK_WIP,0)) AS TTL 
                                   , SUM(NVL(C.QTY_SMT,0)) AS SMT_IN  
                                   , SUM(NVL(C.QTY_TTL,0)) AS L_IN  
                                   , SUM(NVL(E.WIK_WIP,0)) AS WIK_WIP  
                                   , SUM(NVL(B.INV_L_QTY,0)) AS INV_L_QTY  
                                   , SUM(NVL(B.INV_QTY,0)) AS INV_QTY  
                                   , SUM(NVL(D.ORDER_QTY,0)) AS ORDER_QTY  
                                   , SUM(NVL(C.IN_QTY,0)) AS IN_QTY  
                                FROM MWIPMATDEF A     
                                   , (     
                                      SELECT MAT_ID 
                                           , SUM(INV_QTY) AS INV_QTY 
                                           , SUM(INV_L_QTY) AS INV_L_QTY 
                                        FROM ( 
                                              SELECT MAT_ID  
                                                   , SUM(DECODE(STORAGE_LOCATION, '1000', QUANTITY, '1003', QUANTITY, 0)) AS INV_QTY  
                                                   , SUM(DECODE(STORAGE_LOCATION, '1001', QUANTITY, 0)) AS INV_L_QTY    
                                                FROM CWMSLOTSTS@RPTTOMES 
                                               WHERE 1=1 
                                                 AND QUANTITY> 0 
                                                 AND STORAGE_LOCATION IN ('1000', '1001', '1003') 
                                               GROUP BY MAT_ID  
                                               UNION ALL 
                                              SELECT MAT_ID, 0 AS INV_QTY, SUM(QTY_1) AS INV_L_QTY 
                                                FROM CWIPMATSLP@RPTTOMES 
                                               WHERE 1=1 
                                                 AND RECV_FLAG = ' ' 
                                                 AND IN_TIME BETWEEN '20200425000000' AND '20200427235959' 
                                               GROUP BY MAT_ID 
                                             ) 
                                       GROUP BY MAT_ID 
                                     ) B     
                                   , (     
                                      SELECT MAT_ID  
                                           , SUM(CASE WHEN B.LOT_ID IS NOT NULL THEN 1   
                                                      ELSE 0   
                                                 END) AS IN_QTY   
                                           , COUNT(*) AS LOT_TTL   
                                           , SUM(CASE WHEN OPER LIKE 'M%' AND OPER <= 'M0330' THEN QTY_1 ELSE 0 END) AS QTY_SMT  
                                           , SUM(CASE WHEN OPER LIKE 'A%' OR OPER > 'M0330' THEN QTY_1 ELSE 0 END) AS QTY_TTL  
                                        FROM RWIPLOTSTS A   
                                           , CRASRESMAT B   
                                       WHERE 1=1    
                                         AND A.FACTORY = B.FACTORY(+)   
                                         AND A.LOT_ID = B.LOT_ID(+)   
                                         AND A.FACTORY = 'HMVA2'  
                                         AND A.LOT_TYPE != 'W'  
                                         AND A.LOT_DEL_FLAG = ' '  
                                         AND A.LOT_CMF_2 = '-'   
                                         AND A.LOT_CMF_9 != ' '   
                                         AND A.QTY_1 > 0   
                                         AND A.OPER NOT IN  ('00001', '00002', 'V0000')   
                                       GROUP BY A.MAT_ID    
                                     ) C     
                                   , (     
                                      SELECT MAT_ID, SUM(ORDER_QUAN) AS ORDER_QTY     
                                        FROM RSAPORDQNT     
                                       WHERE 1=1     
                                         AND CREATE_TIME = TO_CHAR(SYSDATE, 'YYYYMMDD')     
                                       GROUP BY MAT_ID     
                                     ) D 
                                   , ( 
                                      SELECT MAT_ID, SUM(LOT_QTY) AS WIK_WIP 
                                        FROM ISTMWIKWIP@RPTTOMES 
                                       WHERE 1=1 
                                         AND CUTOFF_DT = '20200427' || TO_CHAR(SYSDATE, 'HH24')
                                       GROUP BY MAT_ID 
                                     ) E 
                               WHERE 1=1 
                                 AND A.MAT_ID = B.MAT_ID(+) 
                                 AND A.MAT_ID = C.MAT_ID(+) 
                                 AND A.MAT_ID = D.MAT_ID(+) 
                                 AND A.MAT_ID = E.MAT_ID(+) 
                                 AND A.FACTORY = 'HMVA2' 
                               GROUP BY REPLACE(A.MAT_ID, '-O', '') 
                               HAVING SUM(NVL(B.INV_QTY,0)) + SUM(NVL(C.QTY_SMT,0)) + SUM(NVL(C.QTY_TTL,0)) + SUM(NVL(B.INV_L_QTY,0)) + SUM(NVL(D.ORDER_QTY,0)) + SUM(NVL(E.WIK_WIP,0)) + SUM(NVL(C.IN_QTY,0)) > 0 
                             ) WIP_MAT 
                       WHERE 1=1 
                         AND MAT.MAT_ID = SMM.PARTNUMBER(+) 
                         AND SMM.MATCODE = WIP_MAT.MAT_ID(+) 
                         AND MAT.FACTORY = 'HMVA2' 
                         AND MAT.DELETE_FLAG = ' ' 
                         AND MAT.MAT_TYPE = 'FG' 
                         AND MAT.MAT_ID LIKE '%' 
                         AND SMM.UNIT_QTY > 0 
                       GROUP BY MAT.MAT_ID, SMM.MAT_TYPE, SMM.DESCRIPT, SMM.MATCODE, SMM.DESCRIPT, SMM.OPER, SMM.UNIT_1 
                     ) C 
               WHERE 1=1 
                 AND MAT.MAT_ID = A.MAT_ID(+) 
                 AND MAT.MAT_ID = B.MAT_ID(+) 
                 AND MAT.MAT_ID = C.MAT_ID(+) 
                 AND MAT.FACTORY = 'HMVA2' 
                 AND MAT.DELETE_FLAG = ' ' 
                 AND MAT.VENDOR_ID <> ' ' 
               GROUP BY MAT.MAT_ID, C.MATTYPE, C.MATCODE, C.DESCRIPT, C.OPER, C.UNIT 
             ) A 
        WHERE 1=1  
          AND MAT.MAT_ID = A.MAT_ID(+) 
          AND MAT.FACTORY = 'HMVA2' 
          AND MAT.DELETE_FLAG = ' ' 
          AND A.MATCODE <> ' ' 
        GROUP BY  ' ', MAT.MAT_GRP_1, MAT.MAT_GRP_2, MAT.MAT_GRP_10,  ' ',  ' ', MAT.MAT_GRP_6, MAT.MAT_CMF_11,  ' ', REPLACE(A.MATCODE, '-O',''),  ' ',  ' ',  ' ', A.OPER
        HAVING ( 
                SUM(NVL(SOP_PLN_MON,0))+SUM(NVL(SOP_PLN_WEEK,0))+SUM(NVL(WEEK_AO,0))+SUM(NVL(WIP_STOCK,0))+SUM(NVL(REV_QTY,0))+MAX(NVL(TTL,0)) 
               +SUM(NVL(W0,0))+SUM(NVL(W1,0))+SUM(NVL(W2,0))+SUM(NVL(W3,0))+SUM(NVL(W4,0))+SUM(NVL(W5,0))+SUM(NVL(W6,0))+SUM(NVL(W7,0)) 
               ) > 0 
       ) A 
 WHERE 1=1  
   AND NVL(WIP_STOCK,0)+NVL(SOP_PLN_MON,0)+NVL(SOP_PLN_WEEK,0)+NVL(ASSY_WEEK,0)+NVL(REV_QTY,0)+NVL(MAT_TTL,0)+NVL(MAT_L_IN,0)+NVL(WIK_WIP,0)+NVL(MAT_INV_L_QTY,0)+NVL(MAT_INV_QTY,0)+NVL(ORDER_QTY,0)+NVL(W1,0)+NVL(W2,0)+NVL(W3,0)+NVL(W4,0)+NVL(W5,0)+NVL(W6,0)+NVL(W7,0) > 0 
 ORDER BY  ' ', DECODE(A.CUSTOMER, 'SE', 1, 'HX', 2, 'IM', 3, 'FC', 4, 'IG', 5, 6),CUSTOMER, FAMILY, PACKAGE,  ' ',  ' ', LD_COUNT, PKG_CODE,  ' ', MATCODE,  ' ',  ' ',  ' ', OPER

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT DISTINCT MAT_ID FROM CMATPLNINP@RPTTOMES WHERE PLAN_DATE <> ' '
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
SELECT MIN(SYS_DATE) AS START_DAY 
     , MAX(SYS_DATE) AS END_DAY 
     , PLAN_YEAR||DECODE(LENGTH(PLAN_WEEK), 1, '0'||PLAN_WEEK, PLAN_WEEK) AS WEEK
  FROM MWIPCALDEF 
 WHERE CALENDAR_ID = 'OTD'
   AND (PLAN_YEAR || LPAD(PLAN_WEEK,2,'0')) IN ( 
                                                SELECT WW
                                                  FROM (
                                                        SELECT WW
                                                             , ROW_NUMBER() OVER(ORDER BY WW) AS RNK
                                                          FROM (
                                                                SELECT DISTINCT PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') AS WW
                                                                  FROM MWIPCALDEF
                                                                 WHERE CALENDAR_ID = 'OTD'
                                                                   AND PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') >= (
                                                                                                              SELECT MAX(PLAN_YEAR || LPAD(PLAN_WEEK,2,'0')) AS WW
                                                                                                                FROM MWIPCALDEF
                                                                                                               WHERE CALENDAR_ID = 'OTD'
                                                                                                                 AND PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') < (SELECT PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') AS WW FROM MWIPCALDEF WHERE CALENDAR_ID = 'OTD' AND SYS_DATE = '20200427')
                                                                                                                 AND SYS_DATE >= TO_CHAR(TO_DATE('20200427', 'YYYYMMDD')-14, 'YYYYMMDD')
                                                                                                             )
                                                               ) 
                                                       )
                                                 WHERE RNK <= 7
                                               ) 
 GROUP BY PLAN_YEAR, PLAN_WEEK 
 ORDER BY PLAN_YEAR, PLAN_WEEK

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT LANGUAGE_2 FROM RWEBFUNDEF WHERE FUNC_NAME = 'MAT070402'
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT MIN(SYS_DATE) AS START_DAY 
     , MAX(SYS_DATE) AS END_DAY 
     , PLAN_YEAR||DECODE(LENGTH(PLAN_WEEK), 1, '0'||PLAN_WEEK, PLAN_WEEK) AS WEEK
  FROM MWIPCALDEF 
 WHERE CALENDAR_ID = 'OTD'
   AND (PLAN_YEAR || LPAD(PLAN_WEEK,2,'0')) IN ( 
                                                SELECT WW
                                                  FROM (
                                                        SELECT WW
                                                             , ROW_NUMBER() OVER(ORDER BY WW) AS RNK
                                                          FROM (
                                                                SELECT DISTINCT PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') AS WW
                                                                  FROM MWIPCALDEF
                                                                 WHERE CALENDAR_ID = 'OTD'
                                                                   AND PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') >= (
                                                                                                              SELECT MAX(PLAN_YEAR || LPAD(PLAN_WEEK,2,'0')) AS WW
                                                                                                                FROM MWIPCALDEF
                                                                                                               WHERE CALENDAR_ID = 'OTD'
                                                                                                                 AND PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') < (SELECT PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') AS WW FROM MWIPCALDEF WHERE CALENDAR_ID = 'OTD' AND SYS_DATE = '20200427')
                                                                                                                 AND SYS_DATE >= TO_CHAR(TO_DATE('20200427', 'YYYYMMDD')-14, 'YYYYMMDD')
                                                                                                             )
                                                               ) 
                                                       )
                                                 WHERE RNK <= 7
                                               ) 
 GROUP BY PLAN_YEAR, PLAN_WEEK 
 ORDER BY PLAN_YEAR, PLAN_WEEK

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT MAT_ID,  ' ', MAT_TYPE, MATCODE, MAT_DESC, MAT_OPER, OPER, UNIT_QTY
       , REMAIN_W0, REMAIN_W1, REMAIN_W2, REMAIN_W3, REMAIN_W4, REMAIN_W5 
       , MAT_L, MAT_INV_QTY, SAFTY_WARNING, MAT_NEED, MAT_FORECAST_DAY, DELIVERY_WEEK, MAT_ORDER_QTY, ORDER_WARNING 
       , SHORTAGE_W0, SHORTAGE_W1, SHORTAGE_W2, SHORTAGE_W3, SHORTAGE_W4, SHORTAGE_W5 
  FROM (SELECT MAT_ID,  ' ', MAT_TYPE, MATCODE, MAT_DESC, MAT_OPER, OPER, UNIT_QTY
             , REMAIN_W0, REMAIN_W1, REMAIN_W2, REMAIN_W3, REMAIN_W4, REMAIN_W5 
             , MAT_L, MAT_INV_QTY 
             , CASE WHEN MAT_TYPE = 'PB' AND DECODE(DELIVERY_DATE, 0, 4, DELIVERY_DATE) * MAT_NEED * 0.5 > MAT_TTL THEN 'Y' 
                    WHEN MAT_TYPE = 'RC' AND DECODE(DELIVERY_DATE, 0, 4, DELIVERY_DATE) * MAT_NEED * 0.5 > MAT_TTL THEN 'Y' 
                    WHEN DECODE(DELIVERY_DATE, 0, 4, DELIVERY_DATE) * MAT_NEED * 0.5 > MAT_INV_QTY THEN 'Y' 
                    ELSE 'N' 
               END SAFTY_WARNING 
             , MAT_NEED, MAT_FORECAST_DAY 
             , CEIL(DELIVERY_DATE / 7) || 'W' AS DELIVERY_WEEK 
             , MAT_ORDER_QTY 
             , CASE WHEN CEIL(DELIVERY_DATE / 7) = 0 AND SHORTAGE_W4 < 0 AND ABS(SHORTAGE_W4) > MAT_ORDER_QTY THEN 'Y' 
                    WHEN CEIL(DELIVERY_DATE / 7) = 1 AND SHORTAGE_W1 < 0 AND ABS(SHORTAGE_W1) > MAT_ORDER_QTY THEN 'Y' 
                    WHEN CEIL(DELIVERY_DATE / 7) = 2 AND SHORTAGE_W2 < 0 AND ABS(SHORTAGE_W2) > MAT_ORDER_QTY THEN 'Y' 
                    WHEN CEIL(DELIVERY_DATE / 7) = 3 AND SHORTAGE_W3 < 0 AND ABS(SHORTAGE_W3) > MAT_ORDER_QTY THEN 'Y' 
                    WHEN CEIL(DELIVERY_DATE / 7) = 4 AND SHORTAGE_W4 < 0 AND ABS(SHORTAGE_W4) > MAT_ORDER_QTY THEN 'Y' 
                    WHEN CEIL(DELIVERY_DATE / 7) = 5 AND SHORTAGE_W5 < 0 AND ABS(SHORTAGE_W5) > MAT_ORDER_QTY THEN 'Y' 
                    WHEN CEIL(DELIVERY_DATE / 7) = 6 AND SHORTAGE_W6 < 0 AND ABS(SHORTAGE_W6) > MAT_ORDER_QTY THEN 'Y' 
                    WHEN CEIL(DELIVERY_DATE / 7) = 7 AND SHORTAGE_W7 < 0 AND ABS(SHORTAGE_W7) > MAT_ORDER_QTY THEN 'Y' 
                    WHEN CEIL(DELIVERY_DATE / 7) = 8 AND SHORTAGE_W8 < 0 AND ABS(SHORTAGE_W8) > MAT_ORDER_QTY THEN 'Y' 
                    WHEN CEIL(DELIVERY_DATE / 7) = 9 AND SHORTAGE_W9 < 0 AND ABS(SHORTAGE_W9) > MAT_ORDER_QTY THEN 'Y' 
                    WHEN CEIL(DELIVERY_DATE / 7) = 10 AND SHORTAGE_W10 < 0 AND ABS(SHORTAGE_W10) > MAT_ORDER_QTY THEN 'Y' 
                    WHEN CEIL(DELIVERY_DATE / 7) = 11 AND SHORTAGE_W11 < 0 AND ABS(SHORTAGE_W11) > MAT_ORDER_QTY THEN 'Y' 
                    ELSE 'N' 
               END ORDER_WARNING  
             , SHORTAGE_W0, SHORTAGE_W1, SHORTAGE_W2, SHORTAGE_W3, SHORTAGE_W4, SHORTAGE_W5 
         FROM (SELECT A.MAT_ID,  ' ', A.MAT_TYPE, A.MATCODE, A.MAT_DESC, A.MAT_OPER, A.OPER, MAX(UNIT_QTY) AS UNIT_QTY
                   , SUM(ROUND(REMAIN_W0,0)) AS REMAIN_W0 
                   , SUM(ROUND(REMAIN_W1,0)) AS REMAIN_W1 
                   , SUM(ROUND(REMAIN_W2,0)) AS REMAIN_W2 
                   , SUM(ROUND(REMAIN_W3,0)) AS REMAIN_W3 
                   , SUM(ROUND(REMAIN_W4,0)) AS REMAIN_W4 
                   , SUM(ROUND(REMAIN_W5,0)) AS REMAIN_W5 
                   , MAX(TRUNC(MAT_SMT_IN + MAT_L_IN + MAT_WIK_WIP + MAT_INV_L_QTY)) AS MAT_L
                   , MAX(TRUNC(MAT_INV_QTY)) AS MAT_INV_QTY
                   , MAX(TRUNC(MAT_TTL)) AS MAT_TTL
                   , SUM(TRUNC(MAT_NEED)) AS MAT_NEED
                   , TO_CHAR(CASE WHEN SUM(TRUNC(MAT_NEED)) = 0 THEN TO_DATE('20200427', 'YYYYMMDD')
                                  WHEN (MAX(TRUNC(MAT_TTL)) / SUM(TRUNC(MAT_NEED))) >= 60 THEN TO_DATE('20200427', 'YYYYMMDD') + 60
                                  ELSE (MAX(TRUNC(MAT_TTL)) / SUM(TRUNC(MAT_NEED))) + TO_DATE('20200427', 'YYYYMMDD')
                             END, 'YY/MM/DD') MAT_FORECAST_DAY
                   , MAX(TRUNC(MAT_ORDER_QTY)) AS MAT_ORDER_QTY
                   , MAX(TRUNC(MAT_TTL)) - SUM(ROUND(REMAIN_W0,0)) AS SHORTAGE_W0
                   , MAX(TRUNC(MAT_TTL)) - SUM(ROUND(REMAIN_W0 + REMAIN_W1,0)) AS SHORTAGE_W1
                   , MAX(TRUNC(MAT_TTL)) - SUM(ROUND(REMAIN_W0 + REMAIN_W1 + REMAIN_W2,0)) AS SHORTAGE_W2
                   , MAX(TRUNC(MAT_TTL)) - SUM(ROUND(REMAIN_W0 + REMAIN_W1 + REMAIN_W2 + REMAIN_W3,0)) AS SHORTAGE_W3
                   , MAX(TRUNC(MAT_TTL)) - SUM(ROUND(REMAIN_W0 + REMAIN_W1 + REMAIN_W2 + REMAIN_W3 + REMAIN_W4,0)) AS SHORTAGE_W4
                   , MAX(TRUNC(MAT_TTL)) - SUM(ROUND(REMAIN_W0 + REMAIN_W1 + REMAIN_W2 + REMAIN_W3 + REMAIN_W4 + REMAIN_W5,0)) AS SHORTAGE_W5
                   , MAX(TRUNC(MAT_TTL)) - SUM(ROUND(REMAIN_W0 + REMAIN_W1 + REMAIN_W2 + REMAIN_W3 + REMAIN_W4 + REMAIN_W5 + REMAIN_W6,0)) AS SHORTAGE_W6
                   , MAX(TRUNC(MAT_TTL)) - SUM(ROUND(REMAIN_W0 + REMAIN_W1 + REMAIN_W2 + REMAIN_W3 + REMAIN_W4 + REMAIN_W5 + REMAIN_W6 + REMAIN_W7,0)) AS SHORTAGE_W7
                   , MAX(TRUNC(MAT_TTL)) - SUM(ROUND(REMAIN_W0 + REMAIN_W1 + REMAIN_W2 + REMAIN_W3 + REMAIN_W4 + REMAIN_W5 + REMAIN_W6 + REMAIN_W7 + REMAIN_W8,0)) AS SHORTAGE_W8
                   , MAX(TRUNC(MAT_TTL)) - SUM(ROUND(REMAIN_W0 + REMAIN_W1 + REMAIN_W2 + REMAIN_W3 + REMAIN_W4 + REMAIN_W5 + REMAIN_W6 + REMAIN_W7 + REMAIN_W8 + REMAIN_W9,0)) AS SHORTAGE_W9
                   , MAX(TRUNC(MAT_TTL)) - SUM(ROUND(REMAIN_W0 + REMAIN_W1 + REMAIN_W2 + REMAIN_W3 + REMAIN_W4 + REMAIN_W5 + REMAIN_W6 + REMAIN_W7 + REMAIN_W8 + REMAIN_W9 + REMAIN_W10,0)) AS SHORTAGE_W10
                   , MAX(TRUNC(MAT_TTL)) - SUM(ROUND(REMAIN_W0 + REMAIN_W1 + REMAIN_W2 + REMAIN_W3 + REMAIN_W4 + REMAIN_W5 + REMAIN_W6 + REMAIN_W7 + REMAIN_W8 + REMAIN_W9 + REMAIN_W10 + REMAIN_W11,0)) AS SHORTAGE_W11
                   , MAX(NVL(A.DELIVERY_DATE, 0)) AS DELIVERY_DATE
                FROM RSUMMATMRP A 
                   , MWIPMATDEF B 
               WHERE 1=1 
                 AND A.FACTORY = B.FACTORY 
                 AND A.MAT_ID = B.MAT_ID 
                 AND A.WORK_DATE = '20200427'
            GROUP BY A.MAT_ID,  ' ', A.MAT_TYPE, A.MATCODE, A.MAT_DESC, A.MAT_OPER, A.OPER, 1
            ORDER BY A.MAT_ID,  ' ', A.MAT_TYPE, A.MATCODE, A.MAT_DESC, A.MAT_OPER, A.OPER, 1)) 
 WHERE 1 = 1

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
  SELECT ORD.MATNR, ORD.TXZ01, ORD.EBELN,  ORD.MENGE 
       , ORD.MENGE - SUM(NVL(IN_ORD.IN_QTY, 0)) + SUM(NVL(OUT_ORD.OUT_QTY, 0)) AS REMAIN 
       , ORD.MEINS 
       , TO_CHAR(TO_DATE(ORD.PRDAT, 'YYYYMMDD'), 'YYYY.MM.DD') AS PRDAT 
       , TO_CHAR(TO_DATE(ORD.EINDT, 'YYYYMMDD'), 'YYYY.MM.DD') AS EINDT 
    FROM (SELECT *
            FROM ZHMMV003@SAPREAL
           WHERE MATNR = 'G80V200690'
             AND LOEKZ = ' '
             AND ELIKZ = ' ') ORD 
       , (SELECT MANDT, EBELN, EBELP, BEWTP, BWART, SUM(NVL(MENGE, 0)) IN_QTY
            FROM ZHMMV004@SAPREAL
           WHERE BEWTP = 'E'
             AND BWART IN ('101')
             GROUP BY MANDT, EBELN, EBELP, BEWTP, BWART) IN_ORD
       , (SELECT MANDT, EBELN, EBELP, BEWTP, BWART, SUM(NVL(MENGE, 0)) OUT_QTY
            FROM ZHMMV004@SAPREAL
           WHERE BEWTP = 'E'
             AND BWART IN ('102', '122', '123', '161')
             GROUP BY MANDT, EBELN, EBELP, BEWTP, BWART) OUT_ORD
   WHERE ORD.EBELN = IN_ORD.EBELN(+)
     AND ORD.EBELP = IN_ORD.EBELP(+)
     AND ORD.EBELN = OUT_ORD.EBELN(+)
     AND ORD.EBELP = OUT_ORD.EBELP(+)
GROUP BY ORD.MANDT, ORD.EBELN, ORD.EBELP, ORD.TXZ01, ORD.MATNR, ORD.MENGE, ORD.MEINS, ORD.PRDAT, ORD.EINDT
ORDER BY EBELN

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
  SELECT ORD.MATNR, ORD.TXZ01, ORD.EBELN,  ORD.MENGE 
       , ORD.MENGE - SUM(NVL(IN_ORD.IN_QTY, 0)) + SUM(NVL(OUT_ORD.OUT_QTY, 0)) AS REMAIN 
       , ORD.MEINS 
       , TO_CHAR(TO_DATE(ORD.PRDAT, 'YYYYMMDD'), 'YYYY.MM.DD') AS PRDAT 
       , TO_CHAR(TO_DATE(ORD.EINDT, 'YYYYMMDD'), 'YYYY.MM.DD') AS EINDT 
    FROM (SELECT *
            FROM ZHMMV003@SAPREAL
           WHERE MATNR = 'G23V200001'
             AND LOEKZ = ' '
             AND ELIKZ = ' ') ORD 
       , (SELECT MANDT, EBELN, EBELP, BEWTP, BWART, SUM(NVL(MENGE, 0)) IN_QTY
            FROM ZHMMV004@SAPREAL
           WHERE BEWTP = 'E'
             AND BWART IN ('101')
             GROUP BY MANDT, EBELN, EBELP, BEWTP, BWART) IN_ORD
       , (SELECT MANDT, EBELN, EBELP, BEWTP, BWART, SUM(NVL(MENGE, 0)) OUT_QTY
            FROM ZHMMV004@SAPREAL
           WHERE BEWTP = 'E'
             AND BWART IN ('102', '122', '123', '161')
             GROUP BY MANDT, EBELN, EBELP, BEWTP, BWART) OUT_ORD
   WHERE ORD.EBELN = IN_ORD.EBELN(+)
     AND ORD.EBELP = IN_ORD.EBELP(+)
     AND ORD.EBELN = OUT_ORD.EBELN(+)
     AND ORD.EBELP = OUT_ORD.EBELP(+)
GROUP BY ORD.MANDT, ORD.EBELN, ORD.EBELP, ORD.TXZ01, ORD.MATNR, ORD.MENGE, ORD.MEINS, ORD.PRDAT, ORD.EINDT
ORDER BY EBELN

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT MAX(PLAN_DATE) AS PLAN_DATE FROM CMATPLNINP@RPTTOMES WHERE MAT_ID = 'G16V200002'
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT SYS_DATE 
  FROM MWIPCALDEF 
 WHERE CALENDAR_ID = 'OTD' 
   AND (SYS_YEAR = '2020' AND LPAD(SYS_MONTH,2,'0') = '04' OR SYS_YEAR = '2020' AND LPAD(SYS_MONTH,2,'0') = '05') 
 ORDER BY SYS_DATE ASC 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
WITH OUTPUT AS ( 
                SELECT BU_DATE 
                     , MAT_ID 
                     , VENDOR_CODE 
                     , SUM(NVL(QUANTITY,0)) AS QUANTITY 
                 FROM CWMSLOTHIS@RPTTOMES 
                WHERE MOVEMENT_CODE IN ('A01','A02','A31') 
                  AND BU_DATE BETWEEN '20200401' AND '20200427' 
                  AND RESV_FIELD_3 = ' ' 
                GROUP BY BU_DATE, MAT_ID, VENDOR_CODE 
               ) 
   , PLAN AS ( 
              SELECT FACTORY 
                   , CUSTOMER 
                   , MAT_ID 
                   , PRODUCT 
                   , PKG 
                   , VENDOR_CODE 
                   , SUPPLY 
                   , RN AS DAY_SEQ 
                   , TO_CHAR(TO_DATE(SUBSTR(PLAN_DATE,1,6)||'01', 'YYYYMMDD') + RN - 1, 'YYYYMMDD') AS PLAN_DATE 
                   , CASE 
            WHEN RN = 1  THEN D_1 
            WHEN RN = 2  THEN D_2 
            WHEN RN = 3  THEN D_3 
            WHEN RN = 4  THEN D_4 
            WHEN RN = 5  THEN D_5 
            WHEN RN = 6  THEN D_6 
            WHEN RN = 7  THEN D_7 
            WHEN RN = 8  THEN D_8 
            WHEN RN = 9  THEN D_9 
            WHEN RN = 10  THEN D_10 
            WHEN RN = 11  THEN D_11 
            WHEN RN = 12  THEN D_12 
            WHEN RN = 13  THEN D_13 
            WHEN RN = 14  THEN D_14 
            WHEN RN = 15  THEN D_15 
            WHEN RN = 16  THEN D_16 
            WHEN RN = 17  THEN D_17 
            WHEN RN = 18  THEN D_18 
            WHEN RN = 19  THEN D_19 
            WHEN RN = 20  THEN D_20 
            WHEN RN = 21  THEN D_21 
            WHEN RN = 22  THEN D_22 
            WHEN RN = 23  THEN D_23 
            WHEN RN = 24  THEN D_24 
            WHEN RN = 25  THEN D_25 
            WHEN RN = 26  THEN D_26 
            WHEN RN = 27  THEN D_27 
            WHEN RN = 28  THEN D_28 
            WHEN RN = 29  THEN D_29 
            WHEN RN = 30  THEN D_30 
            WHEN RN = 31  THEN D_31 
            WHEN RN = 32  THEN D_32 
            WHEN RN = 33  THEN D_33 
            WHEN RN = 34  THEN D_34 
            WHEN RN = 35  THEN D_35 
            WHEN RN = 36  THEN D_36 
            WHEN RN = 37  THEN D_37 
            WHEN RN = 38  THEN D_38 
            WHEN RN = 39  THEN D_39 
            WHEN RN = 40  THEN D_40 
            WHEN RN = 41  THEN D_41 
            WHEN RN = 42  THEN D_42 
            WHEN RN = 43  THEN D_43 
            WHEN RN = 44  THEN D_44 
            WHEN RN = 45  THEN D_45 
            WHEN RN = 46  THEN D_46 
            WHEN RN = 47  THEN D_47 
            WHEN RN = 48  THEN D_48 
            WHEN RN = 49  THEN D_49 
            WHEN RN = 50  THEN D_50 
            WHEN RN = 51  THEN D_51 
            WHEN RN = 52  THEN D_52 
            WHEN RN = 53  THEN D_53 
            WHEN RN = 54  THEN D_54 
            WHEN RN = 55  THEN D_55 
            WHEN RN = 56  THEN D_56 
            WHEN RN = 57  THEN D_57 
            WHEN RN = 58  THEN D_58 
            WHEN RN = 59  THEN D_59 
            WHEN RN = 60  THEN D_60 
            WHEN RN = 61  THEN D_61 
       ELSE 0 END PLN_QTY 
  FROM CMATPLNINP@RPTTOMES 
     , (SELECT ROWNUM RN FROM DUAL CONNECT BY LEVEL <= 62) SEQ 
 WHERE PLAN_DATE <> ' ' 
   AND MAT_ID = 'G16V200002' 
   AND PLAN_DATE BETWEEN '20200401' AND '20200501' 
) 
SELECT "코드", "업체", GUBUN 
                 , ROUND(SUM("20200401")/1000,0) AS D1 
                 , ROUND(SUM("20200402")/1000,0) AS D2 
                 , ROUND(SUM("20200403")/1000,0) AS D3 
                 , ROUND(SUM("20200404")/1000,0) AS D4 
                 , ROUND(SUM("20200405")/1000,0) AS D5 
                 , ROUND(SUM("20200406")/1000,0) AS D6 
                 , ROUND(SUM("20200407")/1000,0) AS D7 
                 , ROUND(SUM("20200408")/1000,0) AS D8 
                 , ROUND(SUM("20200409")/1000,0) AS D9 
                 , ROUND(SUM("20200410")/1000,0) AS D10 
                 , ROUND(SUM("20200411")/1000,0) AS D11 
                 , ROUND(SUM("20200412")/1000,0) AS D12 
                 , ROUND(SUM("20200413")/1000,0) AS D13 
                 , ROUND(SUM("20200414")/1000,0) AS D14 
                 , ROUND(SUM("20200415")/1000,0) AS D15 
                 , ROUND(SUM("20200416")/1000,0) AS D16 
                 , ROUND(SUM("20200417")/1000,0) AS D17 
                 , ROUND(SUM("20200418")/1000,0) AS D18 
                 , ROUND(SUM("20200419")/1000,0) AS D19 
                 , ROUND(SUM("20200420")/1000,0) AS D20 
                 , ROUND(SUM("20200421")/1000,0) AS D21 
                 , ROUND(SUM("20200422")/1000,0) AS D22 
                 , ROUND(SUM("20200423")/1000,0) AS D23 
                 , ROUND(SUM("20200424")/1000,0) AS D24 
                 , ROUND(SUM("20200425")/1000,0) AS D25 
                 , ROUND(SUM("20200426")/1000,0) AS D26 
                 , ROUND(SUM("20200427")/1000,0) AS D27 
                 , ROUND(SUM("20200428")/1000,0) AS D28 
                 , ROUND(SUM("20200429")/1000,0) AS D29 
                 , ROUND(SUM("20200430")/1000,0) AS D30 
                 , ROUND(SUM("20200501")/1000,0) AS D31 
                 , ROUND(SUM("20200502")/1000,0) AS D32 
                 , ROUND(SUM("20200503")/1000,0) AS D33 
                 , ROUND(SUM("20200504")/1000,0) AS D34 
                 , ROUND(SUM("20200505")/1000,0) AS D35 
                 , ROUND(SUM("20200506")/1000,0) AS D36 
                 , ROUND(SUM("20200507")/1000,0) AS D37 
                 , ROUND(SUM("20200508")/1000,0) AS D38 
                 , ROUND(SUM("20200509")/1000,0) AS D39 
                 , ROUND(SUM("20200510")/1000,0) AS D40 
                 , ROUND(SUM("20200511")/1000,0) AS D41 
                 , ROUND(SUM("20200512")/1000,0) AS D42 
                 , ROUND(SUM("20200513")/1000,0) AS D43 
                 , ROUND(SUM("20200514")/1000,0) AS D44 
                 , ROUND(SUM("20200515")/1000,0) AS D45 
                 , ROUND(SUM("20200516")/1000,0) AS D46 
                 , ROUND(SUM("20200517")/1000,0) AS D47 
                 , ROUND(SUM("20200518")/1000,0) AS D48 
                 , ROUND(SUM("20200519")/1000,0) AS D49 
                 , ROUND(SUM("20200520")/1000,0) AS D50 
                 , ROUND(SUM("20200521")/1000,0) AS D51 
                 , ROUND(SUM("20200522")/1000,0) AS D52 
                 , ROUND(SUM("20200523")/1000,0) AS D53 
                 , ROUND(SUM("20200524")/1000,0) AS D54 
                 , ROUND(SUM("20200525")/1000,0) AS D55 
                 , ROUND(SUM("20200526")/1000,0) AS D56 
                 , ROUND(SUM("20200527")/1000,0) AS D57 
                 , ROUND(SUM("20200528")/1000,0) AS D58 
                 , ROUND(SUM("20200529")/1000,0) AS D59 
                 , ROUND(SUM("20200530")/1000,0) AS D60 
                 , ROUND(SUM("20200531")/1000,0) AS D61 
  FROM ( 
        SELECT "코드" 
             , "업체" 
             , DECODE( RN, 1, '계획', 2, '실적', 3, '누계차') AS GUBUN 
             , CASE WHEN "날짜" = '20200401' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200401' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200401' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200401" 
             , CASE WHEN "날짜" = '20200402' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200402' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200402' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200402" 
             , CASE WHEN "날짜" = '20200403' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200403' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200403' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200403" 
             , CASE WHEN "날짜" = '20200404' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200404' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200404' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200404" 
             , CASE WHEN "날짜" = '20200405' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200405' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200405' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200405" 
             , CASE WHEN "날짜" = '20200406' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200406' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200406' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200406" 
             , CASE WHEN "날짜" = '20200407' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200407' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200407' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200407" 
             , CASE WHEN "날짜" = '20200408' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200408' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200408' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200408" 
             , CASE WHEN "날짜" = '20200409' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200409' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200409' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200409" 
             , CASE WHEN "날짜" = '20200410' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200410' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200410' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200410" 
             , CASE WHEN "날짜" = '20200411' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200411' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200411' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200411" 
             , CASE WHEN "날짜" = '20200412' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200412' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200412' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200412" 
             , CASE WHEN "날짜" = '20200413' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200413' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200413' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200413" 
             , CASE WHEN "날짜" = '20200414' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200414' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200414' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200414" 
             , CASE WHEN "날짜" = '20200415' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200415' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200415' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200415" 
             , CASE WHEN "날짜" = '20200416' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200416' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200416' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200416" 
             , CASE WHEN "날짜" = '20200417' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200417' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200417' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200417" 
             , CASE WHEN "날짜" = '20200418' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200418' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200418' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200418" 
             , CASE WHEN "날짜" = '20200419' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200419' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200419' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200419" 
             , CASE WHEN "날짜" = '20200420' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200420' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200420' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200420" 
             , CASE WHEN "날짜" = '20200421' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200421' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200421' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200421" 
             , CASE WHEN "날짜" = '20200422' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200422' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200422' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200422" 
             , CASE WHEN "날짜" = '20200423' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200423' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200423' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200423" 
             , CASE WHEN "날짜" = '20200424' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200424' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200424' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200424" 
             , CASE WHEN "날짜" = '20200425' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200425' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200425' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200425" 
             , CASE WHEN "날짜" = '20200426' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200426' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200426' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200426" 
             , CASE WHEN "날짜" = '20200427' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200427' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200427' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200427" 
             , CASE WHEN "날짜" = '20200428' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200428' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200428' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200428" 
             , CASE WHEN "날짜" = '20200429' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200429' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200429' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200429" 
             , CASE WHEN "날짜" = '20200430' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200430' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200430' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200430" 
             , CASE WHEN "날짜" = '20200501' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200501' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200501' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200501" 
             , CASE WHEN "날짜" = '20200502' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200502' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200502' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200502" 
             , CASE WHEN "날짜" = '20200503' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200503' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200503' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200503" 
             , CASE WHEN "날짜" = '20200504' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200504' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200504' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200504" 
             , CASE WHEN "날짜" = '20200505' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200505' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200505' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200505" 
             , CASE WHEN "날짜" = '20200506' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200506' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200506' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200506" 
             , CASE WHEN "날짜" = '20200507' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200507' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200507' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200507" 
             , CASE WHEN "날짜" = '20200508' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200508' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200508' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200508" 
             , CASE WHEN "날짜" = '20200509' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200509' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200509' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200509" 
             , CASE WHEN "날짜" = '20200510' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200510' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200510' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200510" 
             , CASE WHEN "날짜" = '20200511' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200511' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200511' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200511" 
             , CASE WHEN "날짜" = '20200512' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200512' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200512' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200512" 
             , CASE WHEN "날짜" = '20200513' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200513' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200513' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200513" 
             , CASE WHEN "날짜" = '20200514' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200514' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200514' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200514" 
             , CASE WHEN "날짜" = '20200515' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200515' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200515' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200515" 
             , CASE WHEN "날짜" = '20200516' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200516' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200516' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200516" 
             , CASE WHEN "날짜" = '20200517' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200517' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200517' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200517" 
             , CASE WHEN "날짜" = '20200518' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200518' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200518' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200518" 
             , CASE WHEN "날짜" = '20200519' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200519' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200519' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200519" 
             , CASE WHEN "날짜" = '20200520' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200520' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200520' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200520" 
             , CASE WHEN "날짜" = '20200521' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200521' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200521' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200521" 
             , CASE WHEN "날짜" = '20200522' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200522' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200522' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200522" 
             , CASE WHEN "날짜" = '20200523' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200523' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200523' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200523" 
             , CASE WHEN "날짜" = '20200524' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200524' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200524' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200524" 
             , CASE WHEN "날짜" = '20200525' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200525' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200525' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200525" 
             , CASE WHEN "날짜" = '20200526' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200526' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200526' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200526" 
             , CASE WHEN "날짜" = '20200527' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200527' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200527' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200527" 
             , CASE WHEN "날짜" = '20200528' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200528' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200528' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200528" 
             , CASE WHEN "날짜" = '20200529' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200529' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200529' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200529" 
             , CASE WHEN "날짜" = '20200530' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200530' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200530' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200530" 
             , CASE WHEN "날짜" = '20200531' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200531' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200531' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200531" 
          FROM ( 
                SELECT PLAN.MAT_ID "코드" 
                     , (SELECT DATA_1 FROM MGCMTBLDAT WHERE FACTORY = 'HMVA2' AND TABLE_NAME = 'VENDOR' AND KEY_1 = PLAN.VENDOR_CODE) AS "업체" 
                     , PLAN.PLAN_DATE "날짜" 
                     , PLAN.PLN_QTY "계획수량" 
                     , OUTPUT.QUANTITY "실적수량" 
                     , SUM(CASE WHEN PLAN.PLAN_DATE < '20200401' THEN 0 ELSE PLAN.PLN_QTY END) OVER(PARTITION BY PLAN.MAT_ID, PLAN.VENDOR_CODE ORDER BY PLAN.PLAN_DATE) CUM_SUM_PLAN 
                     , SUM(CASE WHEN PLAN.PLAN_DATE < '20200401' THEN 0 ELSE NVL(OUTPUT.QUANTITY,0) END) OVER(PARTITION BY PLAN.MAT_ID, PLAN.VENDOR_CODE ORDER BY PLAN.PLAN_DATE) CUM_SUM_QUANTITY 
                     , SUM(CASE WHEN PLAN.PLAN_DATE < '20200401' THEN 0 ELSE NVL(OUTPUT.QUANTITY,0) END) OVER(PARTITION BY PLAN.MAT_ID, PLAN.VENDOR_CODE ORDER BY PLAN.PLAN_DATE) - SUM(CASE WHEN PLAN.PLAN_DATE < '20200401' THEN 0 ELSE PLAN.PLN_QTY END) OVER(PARTITION BY PLAN.MAT_ID, PLAN.VENDOR_CODE ORDER BY PLAN.PLAN_DATE) "누계차" 
                  FROM PLAN, OUTPUT 
                 WHERE PLAN.MAT_ID = OUTPUT.MAT_ID(+) 
                   AND PLAN.VENDOR_CODE = OUTPUT.VENDOR_CODE(+) 
                   AND PLAN.PLAN_DATE = OUTPUT.BU_DATE(+) 
               ) A 
             , (SELECT ROWNUM RN FROM DUAL CONNECT BY LEVEL <= 3) SEQ 
        ) 
 GROUP BY GROUPING SETS ( ("코드", "업체", GUBUN), (GUBUN) ) 
 ORDER BY DECODE("업체", NULL, 1, 2), "업체", DECODE(GUBUN, '계획', 1, '실적', 2, '누계차',3, 4)         

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT MAX(PLAN_DATE) AS PLAN_DATE FROM CMATPLNINP@RPTTOMES WHERE MAT_ID = 'R160001107'
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT SYS_DATE 
  FROM MWIPCALDEF 
 WHERE CALENDAR_ID = 'OTD' 
   AND (SYS_YEAR = '2020' AND LPAD(SYS_MONTH,2,'0') = '04' OR SYS_YEAR = '2020' AND LPAD(SYS_MONTH,2,'0') = '05') 
 ORDER BY SYS_DATE ASC 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
WITH OUTPUT AS ( 
                SELECT BU_DATE 
                     , MAT_ID 
                     , VENDOR_CODE 
                     , SUM(NVL(QUANTITY,0)) AS QUANTITY 
                 FROM CWMSLOTHIS@RPTTOMES 
                WHERE MOVEMENT_CODE IN ('A01','A02','A31') 
                  AND BU_DATE BETWEEN '20200401' AND '20200427' 
                  AND RESV_FIELD_3 = ' ' 
                GROUP BY BU_DATE, MAT_ID, VENDOR_CODE 
               ) 
   , PLAN AS ( 
              SELECT FACTORY 
                   , CUSTOMER 
                   , MAT_ID 
                   , PRODUCT 
                   , PKG 
                   , VENDOR_CODE 
                   , SUPPLY 
                   , RN AS DAY_SEQ 
                   , TO_CHAR(TO_DATE(SUBSTR(PLAN_DATE,1,6)||'01', 'YYYYMMDD') + RN - 1, 'YYYYMMDD') AS PLAN_DATE 
                   , CASE 
            WHEN RN = 1  THEN D_1 
            WHEN RN = 2  THEN D_2 
            WHEN RN = 3  THEN D_3 
            WHEN RN = 4  THEN D_4 
            WHEN RN = 5  THEN D_5 
            WHEN RN = 6  THEN D_6 
            WHEN RN = 7  THEN D_7 
            WHEN RN = 8  THEN D_8 
            WHEN RN = 9  THEN D_9 
            WHEN RN = 10  THEN D_10 
            WHEN RN = 11  THEN D_11 
            WHEN RN = 12  THEN D_12 
            WHEN RN = 13  THEN D_13 
            WHEN RN = 14  THEN D_14 
            WHEN RN = 15  THEN D_15 
            WHEN RN = 16  THEN D_16 
            WHEN RN = 17  THEN D_17 
            WHEN RN = 18  THEN D_18 
            WHEN RN = 19  THEN D_19 
            WHEN RN = 20  THEN D_20 
            WHEN RN = 21  THEN D_21 
            WHEN RN = 22  THEN D_22 
            WHEN RN = 23  THEN D_23 
            WHEN RN = 24  THEN D_24 
            WHEN RN = 25  THEN D_25 
            WHEN RN = 26  THEN D_26 
            WHEN RN = 27  THEN D_27 
            WHEN RN = 28  THEN D_28 
            WHEN RN = 29  THEN D_29 
            WHEN RN = 30  THEN D_30 
            WHEN RN = 31  THEN D_31 
            WHEN RN = 32  THEN D_32 
            WHEN RN = 33  THEN D_33 
            WHEN RN = 34  THEN D_34 
            WHEN RN = 35  THEN D_35 
            WHEN RN = 36  THEN D_36 
            WHEN RN = 37  THEN D_37 
            WHEN RN = 38  THEN D_38 
            WHEN RN = 39  THEN D_39 
            WHEN RN = 40  THEN D_40 
            WHEN RN = 41  THEN D_41 
            WHEN RN = 42  THEN D_42 
            WHEN RN = 43  THEN D_43 
            WHEN RN = 44  THEN D_44 
            WHEN RN = 45  THEN D_45 
            WHEN RN = 46  THEN D_46 
            WHEN RN = 47  THEN D_47 
            WHEN RN = 48  THEN D_48 
            WHEN RN = 49  THEN D_49 
            WHEN RN = 50  THEN D_50 
            WHEN RN = 51  THEN D_51 
            WHEN RN = 52  THEN D_52 
            WHEN RN = 53  THEN D_53 
            WHEN RN = 54  THEN D_54 
            WHEN RN = 55  THEN D_55 
            WHEN RN = 56  THEN D_56 
            WHEN RN = 57  THEN D_57 
            WHEN RN = 58  THEN D_58 
            WHEN RN = 59  THEN D_59 
            WHEN RN = 60  THEN D_60 
            WHEN RN = 61  THEN D_61 
       ELSE 0 END PLN_QTY 
  FROM CMATPLNINP@RPTTOMES 
     , (SELECT ROWNUM RN FROM DUAL CONNECT BY LEVEL <= 62) SEQ 
 WHERE PLAN_DATE <> ' ' 
   AND MAT_ID = 'R160001107' 
   AND PLAN_DATE BETWEEN '20200401' AND '20200501' 
) 
SELECT "코드", "업체", GUBUN 
                 , ROUND(SUM("20200401")/1000,0) AS D1 
                 , ROUND(SUM("20200402")/1000,0) AS D2 
                 , ROUND(SUM("20200403")/1000,0) AS D3 
                 , ROUND(SUM("20200404")/1000,0) AS D4 
                 , ROUND(SUM("20200405")/1000,0) AS D5 
                 , ROUND(SUM("20200406")/1000,0) AS D6 
                 , ROUND(SUM("20200407")/1000,0) AS D7 
                 , ROUND(SUM("20200408")/1000,0) AS D8 
                 , ROUND(SUM("20200409")/1000,0) AS D9 
                 , ROUND(SUM("20200410")/1000,0) AS D10 
                 , ROUND(SUM("20200411")/1000,0) AS D11 
                 , ROUND(SUM("20200412")/1000,0) AS D12 
                 , ROUND(SUM("20200413")/1000,0) AS D13 
                 , ROUND(SUM("20200414")/1000,0) AS D14 
                 , ROUND(SUM("20200415")/1000,0) AS D15 
                 , ROUND(SUM("20200416")/1000,0) AS D16 
                 , ROUND(SUM("20200417")/1000,0) AS D17 
                 , ROUND(SUM("20200418")/1000,0) AS D18 
                 , ROUND(SUM("20200419")/1000,0) AS D19 
                 , ROUND(SUM("20200420")/1000,0) AS D20 
                 , ROUND(SUM("20200421")/1000,0) AS D21 
                 , ROUND(SUM("20200422")/1000,0) AS D22 
                 , ROUND(SUM("20200423")/1000,0) AS D23 
                 , ROUND(SUM("20200424")/1000,0) AS D24 
                 , ROUND(SUM("20200425")/1000,0) AS D25 
                 , ROUND(SUM("20200426")/1000,0) AS D26 
                 , ROUND(SUM("20200427")/1000,0) AS D27 
                 , ROUND(SUM("20200428")/1000,0) AS D28 
                 , ROUND(SUM("20200429")/1000,0) AS D29 
                 , ROUND(SUM("20200430")/1000,0) AS D30 
                 , ROUND(SUM("20200501")/1000,0) AS D31 
                 , ROUND(SUM("20200502")/1000,0) AS D32 
                 , ROUND(SUM("20200503")/1000,0) AS D33 
                 , ROUND(SUM("20200504")/1000,0) AS D34 
                 , ROUND(SUM("20200505")/1000,0) AS D35 
                 , ROUND(SUM("20200506")/1000,0) AS D36 
                 , ROUND(SUM("20200507")/1000,0) AS D37 
                 , ROUND(SUM("20200508")/1000,0) AS D38 
                 , ROUND(SUM("20200509")/1000,0) AS D39 
                 , ROUND(SUM("20200510")/1000,0) AS D40 
                 , ROUND(SUM("20200511")/1000,0) AS D41 
                 , ROUND(SUM("20200512")/1000,0) AS D42 
                 , ROUND(SUM("20200513")/1000,0) AS D43 
                 , ROUND(SUM("20200514")/1000,0) AS D44 
                 , ROUND(SUM("20200515")/1000,0) AS D45 
                 , ROUND(SUM("20200516")/1000,0) AS D46 
                 , ROUND(SUM("20200517")/1000,0) AS D47 
                 , ROUND(SUM("20200518")/1000,0) AS D48 
                 , ROUND(SUM("20200519")/1000,0) AS D49 
                 , ROUND(SUM("20200520")/1000,0) AS D50 
                 , ROUND(SUM("20200521")/1000,0) AS D51 
                 , ROUND(SUM("20200522")/1000,0) AS D52 
                 , ROUND(SUM("20200523")/1000,0) AS D53 
                 , ROUND(SUM("20200524")/1000,0) AS D54 
                 , ROUND(SUM("20200525")/1000,0) AS D55 
                 , ROUND(SUM("20200526")/1000,0) AS D56 
                 , ROUND(SUM("20200527")/1000,0) AS D57 
                 , ROUND(SUM("20200528")/1000,0) AS D58 
                 , ROUND(SUM("20200529")/1000,0) AS D59 
                 , ROUND(SUM("20200530")/1000,0) AS D60 
                 , ROUND(SUM("20200531")/1000,0) AS D61 
  FROM ( 
        SELECT "코드" 
             , "업체" 
             , DECODE( RN, 1, '계획', 2, '실적', 3, '누계차') AS GUBUN 
             , CASE WHEN "날짜" = '20200401' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200401' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200401' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200401" 
             , CASE WHEN "날짜" = '20200402' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200402' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200402' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200402" 
             , CASE WHEN "날짜" = '20200403' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200403' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200403' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200403" 
             , CASE WHEN "날짜" = '20200404' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200404' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200404' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200404" 
             , CASE WHEN "날짜" = '20200405' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200405' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200405' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200405" 
             , CASE WHEN "날짜" = '20200406' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200406' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200406' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200406" 
             , CASE WHEN "날짜" = '20200407' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200407' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200407' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200407" 
             , CASE WHEN "날짜" = '20200408' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200408' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200408' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200408" 
             , CASE WHEN "날짜" = '20200409' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200409' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200409' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200409" 
             , CASE WHEN "날짜" = '20200410' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200410' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200410' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200410" 
             , CASE WHEN "날짜" = '20200411' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200411' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200411' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200411" 
             , CASE WHEN "날짜" = '20200412' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200412' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200412' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200412" 
             , CASE WHEN "날짜" = '20200413' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200413' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200413' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200413" 
             , CASE WHEN "날짜" = '20200414' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200414' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200414' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200414" 
             , CASE WHEN "날짜" = '20200415' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200415' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200415' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200415" 
             , CASE WHEN "날짜" = '20200416' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200416' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200416' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200416" 
             , CASE WHEN "날짜" = '20200417' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200417' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200417' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200417" 
             , CASE WHEN "날짜" = '20200418' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200418' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200418' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200418" 
             , CASE WHEN "날짜" = '20200419' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200419' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200419' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200419" 
             , CASE WHEN "날짜" = '20200420' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200420' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200420' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200420" 
             , CASE WHEN "날짜" = '20200421' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200421' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200421' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200421" 
             , CASE WHEN "날짜" = '20200422' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200422' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200422' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200422" 
             , CASE WHEN "날짜" = '20200423' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200423' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200423' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200423" 
             , CASE WHEN "날짜" = '20200424' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200424' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200424' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200424" 
             , CASE WHEN "날짜" = '20200425' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200425' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200425' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200425" 
             , CASE WHEN "날짜" = '20200426' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200426' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200426' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200426" 
             , CASE WHEN "날짜" = '20200427' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200427' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200427' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200427" 
             , CASE WHEN "날짜" = '20200428' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200428' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200428' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200428" 
             , CASE WHEN "날짜" = '20200429' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200429' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200429' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200429" 
             , CASE WHEN "날짜" = '20200430' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200430' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200430' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200430" 
             , CASE WHEN "날짜" = '20200501' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200501' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200501' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200501" 
             , CASE WHEN "날짜" = '20200502' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200502' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200502' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200502" 
             , CASE WHEN "날짜" = '20200503' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200503' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200503' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200503" 
             , CASE WHEN "날짜" = '20200504' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200504' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200504' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200504" 
             , CASE WHEN "날짜" = '20200505' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200505' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200505' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200505" 
             , CASE WHEN "날짜" = '20200506' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200506' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200506' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200506" 
             , CASE WHEN "날짜" = '20200507' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200507' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200507' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200507" 
             , CASE WHEN "날짜" = '20200508' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200508' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200508' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200508" 
             , CASE WHEN "날짜" = '20200509' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200509' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200509' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200509" 
             , CASE WHEN "날짜" = '20200510' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200510' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200510' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200510" 
             , CASE WHEN "날짜" = '20200511' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200511' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200511' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200511" 
             , CASE WHEN "날짜" = '20200512' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200512' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200512' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200512" 
             , CASE WHEN "날짜" = '20200513' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200513' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200513' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200513" 
             , CASE WHEN "날짜" = '20200514' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200514' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200514' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200514" 
             , CASE WHEN "날짜" = '20200515' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200515' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200515' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200515" 
             , CASE WHEN "날짜" = '20200516' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200516' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200516' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200516" 
             , CASE WHEN "날짜" = '20200517' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200517' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200517' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200517" 
             , CASE WHEN "날짜" = '20200518' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200518' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200518' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200518" 
             , CASE WHEN "날짜" = '20200519' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200519' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200519' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200519" 
             , CASE WHEN "날짜" = '20200520' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200520' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200520' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200520" 
             , CASE WHEN "날짜" = '20200521' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200521' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200521' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200521" 
             , CASE WHEN "날짜" = '20200522' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200522' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200522' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200522" 
             , CASE WHEN "날짜" = '20200523' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200523' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200523' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200523" 
             , CASE WHEN "날짜" = '20200524' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200524' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200524' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200524" 
             , CASE WHEN "날짜" = '20200525' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200525' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200525' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200525" 
             , CASE WHEN "날짜" = '20200526' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200526' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200526' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200526" 
             , CASE WHEN "날짜" = '20200527' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200527' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200527' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200527" 
             , CASE WHEN "날짜" = '20200528' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200528' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200528' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200528" 
             , CASE WHEN "날짜" = '20200529' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200529' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200529' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200529" 
             , CASE WHEN "날짜" = '20200530' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200530' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200530' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200530" 
             , CASE WHEN "날짜" = '20200531' AND RN = 1 THEN "계획수량"  
                    WHEN "날짜" = '20200531' AND RN = 2 THEN "실적수량"  
                    WHEN "날짜" = '20200531' AND RN = 3 THEN "누계차" ELSE 0 END AS "20200531" 
          FROM ( 
                SELECT PLAN.MAT_ID "코드" 
                     , (SELECT DATA_1 FROM MGCMTBLDAT WHERE FACTORY = 'HMVA2' AND TABLE_NAME = 'VENDOR' AND KEY_1 = PLAN.VENDOR_CODE) AS "업체" 
                     , PLAN.PLAN_DATE "날짜" 
                     , PLAN.PLN_QTY "계획수량" 
                     , OUTPUT.QUANTITY "실적수량" 
                     , SUM(CASE WHEN PLAN.PLAN_DATE < '20200401' THEN 0 ELSE PLAN.PLN_QTY END) OVER(PARTITION BY PLAN.MAT_ID, PLAN.VENDOR_CODE ORDER BY PLAN.PLAN_DATE) CUM_SUM_PLAN 
                     , SUM(CASE WHEN PLAN.PLAN_DATE < '20200401' THEN 0 ELSE NVL(OUTPUT.QUANTITY,0) END) OVER(PARTITION BY PLAN.MAT_ID, PLAN.VENDOR_CODE ORDER BY PLAN.PLAN_DATE) CUM_SUM_QUANTITY 
                     , SUM(CASE WHEN PLAN.PLAN_DATE < '20200401' THEN 0 ELSE NVL(OUTPUT.QUANTITY,0) END) OVER(PARTITION BY PLAN.MAT_ID, PLAN.VENDOR_CODE ORDER BY PLAN.PLAN_DATE) - SUM(CASE WHEN PLAN.PLAN_DATE < '20200401' THEN 0 ELSE PLAN.PLN_QTY END) OVER(PARTITION BY PLAN.MAT_ID, PLAN.VENDOR_CODE ORDER BY PLAN.PLAN_DATE) "누계차" 
                  FROM PLAN, OUTPUT 
                 WHERE PLAN.MAT_ID = OUTPUT.MAT_ID(+) 
                   AND PLAN.VENDOR_CODE = OUTPUT.VENDOR_CODE(+) 
                   AND PLAN.PLAN_DATE = OUTPUT.BU_DATE(+) 
               ) A 
             , (SELECT ROWNUM RN FROM DUAL CONNECT BY LEVEL <= 3) SEQ 
        ) 
 GROUP BY GROUPING SETS ( ("코드", "업체", GUBUN), (GUBUN) ) 
 ORDER BY DECODE("업체", NULL, 1, 2), "업체", DECODE(GUBUN, '계획', 1, '실적', 2, '누계차',3, 4)         

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
SELECT MIN(SYS_DATE) AS START_DAY 
     , MAX(SYS_DATE) AS END_DAY 
     , PLAN_YEAR||DECODE(LENGTH(PLAN_WEEK), 1, '0'||PLAN_WEEK, PLAN_WEEK) AS WEEK
  FROM MWIPCALDEF 
 WHERE CALENDAR_ID = 'OTD'
   AND (PLAN_YEAR || LPAD(PLAN_WEEK,2,'0')) IN ( 
                                                SELECT WW
                                                  FROM (
                                                        SELECT WW
                                                             , ROW_NUMBER() OVER(ORDER BY WW) AS RNK
                                                          FROM (
                                                                SELECT DISTINCT PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') AS WW
                                                                  FROM MWIPCALDEF
                                                                 WHERE CALENDAR_ID = 'OTD'
                                                                   AND PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') >= (
                                                                                                              SELECT MAX(PLAN_YEAR || LPAD(PLAN_WEEK,2,'0')) AS WW
                                                                                                                FROM MWIPCALDEF
                                                                                                               WHERE CALENDAR_ID = 'OTD'
                                                                                                                 AND PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') < (SELECT PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') AS WW FROM MWIPCALDEF WHERE CALENDAR_ID = 'OTD' AND SYS_DATE = '20200427')
                                                                                                                 AND SYS_DATE >= TO_CHAR(TO_DATE('20200427', 'YYYYMMDD')-14, 'YYYYMMDD')
                                                                                                             )
                                                               ) 
                                                       )
                                                 WHERE RNK <= 7
                                               ) 
 GROUP BY PLAN_YEAR, PLAN_WEEK 
 ORDER BY PLAN_YEAR, PLAN_WEEK

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT MAT_ID,  ' ', MAT_TYPE, MATCODE, MAT_DESC, MAT_OPER, OPER, UNIT_QTY
       , REMAIN_W0, REMAIN_W1, REMAIN_W2, REMAIN_W3, REMAIN_W4, REMAIN_W5 
       , MAT_L, MAT_INV_QTY, SAFTY_WARNING, MAT_NEED, MAT_FORECAST_DAY, DELIVERY_WEEK, MAT_ORDER_QTY, ORDER_WARNING 
       , SHORTAGE_W0, SHORTAGE_W1, SHORTAGE_W2, SHORTAGE_W3, SHORTAGE_W4, SHORTAGE_W5 
  FROM (SELECT MAT_ID,  ' ', MAT_TYPE, MATCODE, MAT_DESC, MAT_OPER, OPER, UNIT_QTY
             , REMAIN_W0, REMAIN_W1, REMAIN_W2, REMAIN_W3, REMAIN_W4, REMAIN_W5 
             , MAT_L, MAT_INV_QTY 
             , CASE WHEN MAT_TYPE = 'PB' AND DECODE(DELIVERY_DATE, 0, 4, DELIVERY_DATE) * MAT_NEED * 0.5 > MAT_TTL THEN 'Y' 
                    WHEN MAT_TYPE = 'RC' AND DECODE(DELIVERY_DATE, 0, 4, DELIVERY_DATE) * MAT_NEED * 0.5 > MAT_TTL THEN 'Y' 
                    WHEN DECODE(DELIVERY_DATE, 0, 4, DELIVERY_DATE) * MAT_NEED * 0.5 > MAT_INV_QTY THEN 'Y' 
                    ELSE 'N' 
               END SAFTY_WARNING 
             , MAT_NEED, MAT_FORECAST_DAY 
             , CEIL(DELIVERY_DATE / 7) || 'W' AS DELIVERY_WEEK 
             , MAT_ORDER_QTY 
             , CASE WHEN CEIL(DELIVERY_DATE / 7) = 0 AND SHORTAGE_W4 < 0 AND ABS(SHORTAGE_W4) > MAT_ORDER_QTY THEN 'Y' 
                    WHEN CEIL(DELIVERY_DATE / 7) = 1 AND SHORTAGE_W1 < 0 AND ABS(SHORTAGE_W1) > MAT_ORDER_QTY THEN 'Y' 
                    WHEN CEIL(DELIVERY_DATE / 7) = 2 AND SHORTAGE_W2 < 0 AND ABS(SHORTAGE_W2) > MAT_ORDER_QTY THEN 'Y' 
                    WHEN CEIL(DELIVERY_DATE / 7) = 3 AND SHORTAGE_W3 < 0 AND ABS(SHORTAGE_W3) > MAT_ORDER_QTY THEN 'Y' 
                    WHEN CEIL(DELIVERY_DATE / 7) = 4 AND SHORTAGE_W4 < 0 AND ABS(SHORTAGE_W4) > MAT_ORDER_QTY THEN 'Y' 
                    WHEN CEIL(DELIVERY_DATE / 7) = 5 AND SHORTAGE_W5 < 0 AND ABS(SHORTAGE_W5) > MAT_ORDER_QTY THEN 'Y' 
                    WHEN CEIL(DELIVERY_DATE / 7) = 6 AND SHORTAGE_W6 < 0 AND ABS(SHORTAGE_W6) > MAT_ORDER_QTY THEN 'Y' 
                    WHEN CEIL(DELIVERY_DATE / 7) = 7 AND SHORTAGE_W7 < 0 AND ABS(SHORTAGE_W7) > MAT_ORDER_QTY THEN 'Y' 
                    WHEN CEIL(DELIVERY_DATE / 7) = 8 AND SHORTAGE_W8 < 0 AND ABS(SHORTAGE_W8) > MAT_ORDER_QTY THEN 'Y' 
                    WHEN CEIL(DELIVERY_DATE / 7) = 9 AND SHORTAGE_W9 < 0 AND ABS(SHORTAGE_W9) > MAT_ORDER_QTY THEN 'Y' 
                    WHEN CEIL(DELIVERY_DATE / 7) = 10 AND SHORTAGE_W10 < 0 AND ABS(SHORTAGE_W10) > MAT_ORDER_QTY THEN 'Y' 
                    WHEN CEIL(DELIVERY_DATE / 7) = 11 AND SHORTAGE_W11 < 0 AND ABS(SHORTAGE_W11) > MAT_ORDER_QTY THEN 'Y' 
                    ELSE 'N' 
               END ORDER_WARNING  
             , SHORTAGE_W0, SHORTAGE_W1, SHORTAGE_W2, SHORTAGE_W3, SHORTAGE_W4, SHORTAGE_W5 
         FROM (SELECT A.MAT_ID,  ' ', A.MAT_TYPE, A.MATCODE, A.MAT_DESC, A.MAT_OPER, A.OPER, MAX(UNIT_QTY) AS UNIT_QTY
                   , SUM(ROUND(REMAIN_W0,0)) AS REMAIN_W0 
                   , SUM(ROUND(REMAIN_W1,0)) AS REMAIN_W1 
                   , SUM(ROUND(REMAIN_W2,0)) AS REMAIN_W2 
                   , SUM(ROUND(REMAIN_W3,0)) AS REMAIN_W3 
                   , SUM(ROUND(REMAIN_W4,0)) AS REMAIN_W4 
                   , SUM(ROUND(REMAIN_W5,0)) AS REMAIN_W5 
                   , MAX(TRUNC(MAT_SMT_IN + MAT_L_IN + MAT_WIK_WIP + MAT_INV_L_QTY)) AS MAT_L
                   , MAX(TRUNC(MAT_INV_QTY)) AS MAT_INV_QTY
                   , MAX(TRUNC(MAT_TTL)) AS MAT_TTL
                   , SUM(TRUNC(MAT_NEED)) AS MAT_NEED
                   , TO_CHAR(CASE WHEN SUM(TRUNC(MAT_NEED)) = 0 THEN TO_DATE('20200427', 'YYYYMMDD')
                                  WHEN (MAX(TRUNC(MAT_TTL)) / SUM(TRUNC(MAT_NEED))) >= 60 THEN TO_DATE('20200427', 'YYYYMMDD') + 60
                                  ELSE (MAX(TRUNC(MAT_TTL)) / SUM(TRUNC(MAT_NEED))) + TO_DATE('20200427', 'YYYYMMDD')
                             END, 'YY/MM/DD') MAT_FORECAST_DAY
                   , MAX(TRUNC(MAT_ORDER_QTY)) AS MAT_ORDER_QTY
                   , MAX(TRUNC(MAT_TTL)) - SUM(ROUND(REMAIN_W0,0)) AS SHORTAGE_W0
                   , MAX(TRUNC(MAT_TTL)) - SUM(ROUND(REMAIN_W0 + REMAIN_W1,0)) AS SHORTAGE_W1
                   , MAX(TRUNC(MAT_TTL)) - SUM(ROUND(REMAIN_W0 + REMAIN_W1 + REMAIN_W2,0)) AS SHORTAGE_W2
                   , MAX(TRUNC(MAT_TTL)) - SUM(ROUND(REMAIN_W0 + REMAIN_W1 + REMAIN_W2 + REMAIN_W3,0)) AS SHORTAGE_W3
                   , MAX(TRUNC(MAT_TTL)) - SUM(ROUND(REMAIN_W0 + REMAIN_W1 + REMAIN_W2 + REMAIN_W3 + REMAIN_W4,0)) AS SHORTAGE_W4
                   , MAX(TRUNC(MAT_TTL)) - SUM(ROUND(REMAIN_W0 + REMAIN_W1 + REMAIN_W2 + REMAIN_W3 + REMAIN_W4 + REMAIN_W5,0)) AS SHORTAGE_W5
                   , MAX(TRUNC(MAT_TTL)) - SUM(ROUND(REMAIN_W0 + REMAIN_W1 + REMAIN_W2 + REMAIN_W3 + REMAIN_W4 + REMAIN_W5 + REMAIN_W6,0)) AS SHORTAGE_W6
                   , MAX(TRUNC(MAT_TTL)) - SUM(ROUND(REMAIN_W0 + REMAIN_W1 + REMAIN_W2 + REMAIN_W3 + REMAIN_W4 + REMAIN_W5 + REMAIN_W6 + REMAIN_W7,0)) AS SHORTAGE_W7
                   , MAX(TRUNC(MAT_TTL)) - SUM(ROUND(REMAIN_W0 + REMAIN_W1 + REMAIN_W2 + REMAIN_W3 + REMAIN_W4 + REMAIN_W5 + REMAIN_W6 + REMAIN_W7 + REMAIN_W8,0)) AS SHORTAGE_W8
                   , MAX(TRUNC(MAT_TTL)) - SUM(ROUND(REMAIN_W0 + REMAIN_W1 + REMAIN_W2 + REMAIN_W3 + REMAIN_W4 + REMAIN_W5 + REMAIN_W6 + REMAIN_W7 + REMAIN_W8 + REMAIN_W9,0)) AS SHORTAGE_W9
                   , MAX(TRUNC(MAT_TTL)) - SUM(ROUND(REMAIN_W0 + REMAIN_W1 + REMAIN_W2 + REMAIN_W3 + REMAIN_W4 + REMAIN_W5 + REMAIN_W6 + REMAIN_W7 + REMAIN_W8 + REMAIN_W9 + REMAIN_W10,0)) AS SHORTAGE_W10
                   , MAX(TRUNC(MAT_TTL)) - SUM(ROUND(REMAIN_W0 + REMAIN_W1 + REMAIN_W2 + REMAIN_W3 + REMAIN_W4 + REMAIN_W5 + REMAIN_W6 + REMAIN_W7 + REMAIN_W8 + REMAIN_W9 + REMAIN_W10 + REMAIN_W11,0)) AS SHORTAGE_W11
                   , MAX(NVL(A.DELIVERY_DATE, 0)) AS DELIVERY_DATE
                FROM RSUMMATMRP A 
                   , MWIPMATDEF B 
               WHERE 1=1 
                 AND A.FACTORY = B.FACTORY 
                 AND A.MAT_ID = B.MAT_ID 
                 AND A.WORK_DATE = '20200427'
            GROUP BY A.MAT_ID,  ' ', A.MAT_TYPE, A.MATCODE, A.MAT_DESC, A.MAT_OPER, A.OPER, 1
            ORDER BY A.MAT_ID,  ' ', A.MAT_TYPE, A.MATCODE, A.MAT_DESC, A.MAT_OPER, A.OPER, 1)) 
 WHERE 1 = 1
   AND SAFTY_WARNING = 'Y'

-------------------------------------------------------------
SELECT * FROM RWEBUSRDEF WHERE FACTORY = :FACTORY AND USER_ID= :USER_ID
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
SELECT A.FUNC_GRP_SEQ,A.SEC_GRP_ID,A.FUNC_GRP_ID,NVL(A.FUNC_NAME, ' ') FUNC_NAME, NVL(B.FUNC_DESC, ' ') FUNC_DESC, LANGUAGE_1, LANGUAGE_2, LANGUAGE_3
  FROM RWEBGRPFUN A, RWEBFUNDEF B
 WHERE A.FACTORY = :p_FACTORY
   AND A.SEC_GRP_ID = :p_SEC_GRP_ID
   AND A.FUNC_NAME=B.FUNC_NAME(+)
 ORDER BY A.FUNC_GRP_SEQ, A.FUNC_SEQ
-------------------------------------------------------------
SELECT * FROM RWEBUSRDEF WHERE FACTORY = :FACTORY AND USER_ID= :USER_ID
-------------------------------------------------------------
SELECT A.FUNC_GRP_SEQ,A.SEC_GRP_ID,A.FUNC_GRP_ID,NVL(A.FUNC_NAME, ' ') FUNC_NAME, NVL(B.FUNC_DESC, ' ') FUNC_DESC, LANGUAGE_1, LANGUAGE_2, LANGUAGE_3
  FROM RWEBGRPFUN A, RWEBFUNDEF B
 WHERE A.FACTORY = :p_FACTORY
   AND A.SEC_GRP_ID = :p_SEC_GRP_ID
   AND A.FUNC_NAME=B.FUNC_NAME(+)
 ORDER BY A.FUNC_GRP_SEQ, A.FUNC_SEQ
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
SELECT MIN(SYS_DATE) AS START_DAY 
     , MAX(SYS_DATE) AS END_DAY 
     , PLAN_YEAR||DECODE(LENGTH(PLAN_WEEK), 1, '0'||PLAN_WEEK, PLAN_WEEK) AS WEEK
  FROM MWIPCALDEF 
 WHERE CALENDAR_ID = 'OTD'
   AND (PLAN_YEAR || LPAD(PLAN_WEEK,2,'0')) IN ( 
                                                SELECT WW
                                                  FROM (
                                                        SELECT WW
                                                             , ROW_NUMBER() OVER(ORDER BY WW) AS RNK
                                                          FROM (
                                                                SELECT DISTINCT PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') AS WW
                                                                  FROM MWIPCALDEF
                                                                 WHERE CALENDAR_ID = 'OTD'
                                                                   AND PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') >= (
                                                                                                              SELECT MAX(PLAN_YEAR || LPAD(PLAN_WEEK,2,'0')) AS WW
                                                                                                                FROM MWIPCALDEF
                                                                                                               WHERE CALENDAR_ID = 'OTD'
                                                                                                                 AND PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') < (SELECT PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') AS WW FROM MWIPCALDEF WHERE CALENDAR_ID = 'OTD' AND SYS_DATE = '20200427')
                                                                                                                 AND SYS_DATE >= TO_CHAR(TO_DATE('20200427', 'YYYYMMDD')-14, 'YYYYMMDD')
                                                                                                             )
                                                               ) 
                                                       )
                                                 WHERE RNK <= 7
                                               ) 
 GROUP BY PLAN_YEAR, PLAN_WEEK 
 ORDER BY PLAN_YEAR, PLAN_WEEK

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT MIN(SYS_DATE) AS START_DAY 
     , MAX(SYS_DATE) AS END_DAY 
     , PLAN_YEAR||DECODE(LENGTH(PLAN_WEEK), 1, '0'||PLAN_WEEK, PLAN_WEEK) AS WEEK
  FROM MWIPCALDEF 
 WHERE CALENDAR_ID = 'SE'
   AND (PLAN_YEAR || LPAD(PLAN_WEEK,2,'0')) IN ( 
                                                SELECT WW
                                                  FROM (
                                                        SELECT WW
                                                             , ROW_NUMBER() OVER(ORDER BY WW) AS RNK
                                                          FROM (
                                                                SELECT DISTINCT PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') AS WW
                                                                  FROM MWIPCALDEF
                                                                 WHERE CALENDAR_ID = 'SE'
                                                                   AND PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') >= (
                                                                                                              SELECT MAX(PLAN_YEAR || LPAD(PLAN_WEEK,2,'0')) AS WW
                                                                                                                FROM MWIPCALDEF
                                                                                                               WHERE CALENDAR_ID = 'SE'
                                                                                                                 AND PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') < (SELECT PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') AS WW FROM MWIPCALDEF WHERE CALENDAR_ID = 'SE' AND SYS_DATE = '20200427')
                                                                                                                 AND SYS_DATE >= TO_CHAR(TO_DATE('20200427', 'YYYYMMDD')-14, 'YYYYMMDD')
                                                                                                             )
                                                               ) 
                                                       )
                                                 WHERE RNK <= 7
                                               ) 
 GROUP BY PLAN_YEAR, PLAN_WEEK 
 ORDER BY PLAN_YEAR, PLAN_WEEK

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT LANGUAGE_2 FROM RWEBFUNDEF WHERE FUNC_NAME = 'PRD010216'
-------------------------------------------------------------
SELECT * FROM RWEBUSRDEF WHERE FACTORY = :FACTORY AND USER_ID= :USER_ID
-------------------------------------------------------------
SELECT A.FUNC_GRP_SEQ,A.SEC_GRP_ID,A.FUNC_GRP_ID,NVL(A.FUNC_NAME, ' ') FUNC_NAME, NVL(B.FUNC_DESC, ' ') FUNC_DESC, LANGUAGE_1, LANGUAGE_2, LANGUAGE_3
  FROM RWEBGRPFUN A, RWEBFUNDEF B
 WHERE A.FACTORY = :p_FACTORY
   AND A.SEC_GRP_ID = :p_SEC_GRP_ID
   AND A.FUNC_NAME=B.FUNC_NAME(+)
 ORDER BY A.FUNC_GRP_SEQ, A.FUNC_SEQ
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT MIN(SYS_DATE) AS START_DAY 
     , MAX(SYS_DATE) AS END_DAY 
     , PLAN_YEAR||DECODE(LENGTH(PLAN_WEEK), 1, '0'||PLAN_WEEK, PLAN_WEEK) AS WEEK
  FROM MWIPCALDEF 
 WHERE CALENDAR_ID = 'OTD'
   AND (PLAN_YEAR || LPAD(PLAN_WEEK,2,'0')) IN ( 
                                                SELECT WW
                                                  FROM (
                                                        SELECT WW
                                                             , ROW_NUMBER() OVER(ORDER BY WW) AS RNK
                                                          FROM (
                                                                SELECT DISTINCT PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') AS WW
                                                                  FROM MWIPCALDEF
                                                                 WHERE CALENDAR_ID = 'OTD'
                                                                   AND PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') >= (
                                                                                                              SELECT MAX(PLAN_YEAR || LPAD(PLAN_WEEK,2,'0')) AS WW
                                                                                                                FROM MWIPCALDEF
                                                                                                               WHERE CALENDAR_ID = 'OTD'
                                                                                                                 AND PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') < (SELECT PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') AS WW FROM MWIPCALDEF WHERE CALENDAR_ID = 'OTD' AND SYS_DATE = '20200427')
                                                                                                                 AND SYS_DATE >= TO_CHAR(TO_DATE('20200427', 'YYYYMMDD')-14, 'YYYYMMDD')
                                                                                                             )
                                                               ) 
                                                       )
                                                 WHERE RNK <= 7
                                               ) 
 GROUP BY PLAN_YEAR, PLAN_WEEK 
 ORDER BY PLAN_YEAR, PLAN_WEEK

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT MIN(SYS_DATE) AS START_DAY 
     , MAX(SYS_DATE) AS END_DAY 
     , PLAN_YEAR||DECODE(LENGTH(PLAN_WEEK), 1, '0'||PLAN_WEEK, PLAN_WEEK) AS WEEK
  FROM MWIPCALDEF 
 WHERE CALENDAR_ID = 'SE'
   AND (PLAN_YEAR || LPAD(PLAN_WEEK,2,'0')) IN ( 
                                                SELECT WW
                                                  FROM (
                                                        SELECT WW
                                                             , ROW_NUMBER() OVER(ORDER BY WW) AS RNK
                                                          FROM (
                                                                SELECT DISTINCT PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') AS WW
                                                                  FROM MWIPCALDEF
                                                                 WHERE CALENDAR_ID = 'SE'
                                                                   AND PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') >= (
                                                                                                              SELECT MAX(PLAN_YEAR || LPAD(PLAN_WEEK,2,'0')) AS WW
                                                                                                                FROM MWIPCALDEF
                                                                                                               WHERE CALENDAR_ID = 'SE'
                                                                                                                 AND PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') < (SELECT PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') AS WW FROM MWIPCALDEF WHERE CALENDAR_ID = 'SE' AND SYS_DATE = '20200427')
                                                                                                                 AND SYS_DATE >= TO_CHAR(TO_DATE('20200427', 'YYYYMMDD')-14, 'YYYYMMDD')
                                                                                                             )
                                                               ) 
                                                       )
                                                 WHERE RNK <= 7
                                               ) 
 GROUP BY PLAN_YEAR, PLAN_WEEK 
 ORDER BY PLAN_YEAR, PLAN_WEEK

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT LANGUAGE_2 FROM RWEBFUNDEF WHERE FUNC_NAME = 'PRD010216'
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
SELECT MIN(SYS_DATE) AS START_DAY 
     , MAX(SYS_DATE) AS END_DAY 
     , PLAN_YEAR||DECODE(LENGTH(PLAN_WEEK), 1, '0'||PLAN_WEEK, PLAN_WEEK) AS WEEK
  FROM MWIPCALDEF 
 WHERE CALENDAR_ID = 'OTD'
   AND (PLAN_YEAR || LPAD(PLAN_WEEK,2,'0')) IN ( 
                                                SELECT WW
                                                  FROM (
                                                        SELECT WW
                                                             , ROW_NUMBER() OVER(ORDER BY WW) AS RNK
                                                          FROM (
                                                                SELECT DISTINCT PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') AS WW
                                                                  FROM MWIPCALDEF
                                                                 WHERE CALENDAR_ID = 'OTD'
                                                                   AND PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') >= (
                                                                                                              SELECT MAX(PLAN_YEAR || LPAD(PLAN_WEEK,2,'0')) AS WW
                                                                                                                FROM MWIPCALDEF
                                                                                                               WHERE CALENDAR_ID = 'OTD'
                                                                                                                 AND PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') < (SELECT PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') AS WW FROM MWIPCALDEF WHERE CALENDAR_ID = 'OTD' AND SYS_DATE = '20200427')
                                                                                                                 AND SYS_DATE >= TO_CHAR(TO_DATE('20200427', 'YYYYMMDD')-14, 'YYYYMMDD')
                                                                                                             )
                                                               ) 
                                                       )
                                                 WHERE RNK <= 7
                                               ) 
 GROUP BY PLAN_YEAR, PLAN_WEEK 
 ORDER BY PLAN_YEAR, PLAN_WEEK

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT MIN(SYS_DATE) AS START_DAY 
     , MAX(SYS_DATE) AS END_DAY 
     , PLAN_YEAR||DECODE(LENGTH(PLAN_WEEK), 1, '0'||PLAN_WEEK, PLAN_WEEK) AS WEEK
  FROM MWIPCALDEF 
 WHERE CALENDAR_ID = 'SE'
   AND (PLAN_YEAR || LPAD(PLAN_WEEK,2,'0')) IN ( 
                                                SELECT WW
                                                  FROM (
                                                        SELECT WW
                                                             , ROW_NUMBER() OVER(ORDER BY WW) AS RNK
                                                          FROM (
                                                                SELECT DISTINCT PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') AS WW
                                                                  FROM MWIPCALDEF
                                                                 WHERE CALENDAR_ID = 'SE'
                                                                   AND PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') >= (
                                                                                                              SELECT MAX(PLAN_YEAR || LPAD(PLAN_WEEK,2,'0')) AS WW
                                                                                                                FROM MWIPCALDEF
                                                                                                               WHERE CALENDAR_ID = 'SE'
                                                                                                                 AND PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') < (SELECT PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') AS WW FROM MWIPCALDEF WHERE CALENDAR_ID = 'SE' AND SYS_DATE = '20200427')
                                                                                                                 AND SYS_DATE >= TO_CHAR(TO_DATE('20200427', 'YYYYMMDD')-14, 'YYYYMMDD')
                                                                                                             )
                                                               ) 
                                                       )
                                                 WHERE RNK <= 7
                                               ) 
 GROUP BY PLAN_YEAR, PLAN_WEEK 
 ORDER BY PLAN_YEAR, PLAN_WEEK

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT LANGUAGE_2 FROM RWEBFUNDEF WHERE FUNC_NAME = 'PRD011015'
-------------------------------------------------------------
SELECT * FROM RWEBUSRDEF WHERE FACTORY = :FACTORY AND USER_ID= :USER_ID
-------------------------------------------------------------
SELECT A.FUNC_GRP_SEQ,A.SEC_GRP_ID,A.FUNC_GRP_ID,NVL(A.FUNC_NAME, ' ') FUNC_NAME, NVL(B.FUNC_DESC, ' ') FUNC_DESC, LANGUAGE_1, LANGUAGE_2, LANGUAGE_3
  FROM RWEBGRPFUN A, RWEBFUNDEF B
 WHERE A.FACTORY = :p_FACTORY
   AND A.SEC_GRP_ID = :p_SEC_GRP_ID
   AND A.FUNC_NAME=B.FUNC_NAME(+)
 ORDER BY A.FUNC_GRP_SEQ, A.FUNC_SEQ
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT MIN(SYS_DATE) AS START_DAY 
     , MAX(SYS_DATE) AS END_DAY 
     , PLAN_YEAR||DECODE(LENGTH(PLAN_WEEK), 1, '0'||PLAN_WEEK, PLAN_WEEK) AS WEEK
  FROM MWIPCALDEF 
 WHERE CALENDAR_ID = 'OTD'
   AND (PLAN_YEAR || LPAD(PLAN_WEEK,2,'0')) IN ( 
                                                SELECT WW
                                                  FROM (
                                                        SELECT WW
                                                             , ROW_NUMBER() OVER(ORDER BY WW) AS RNK
                                                          FROM (
                                                                SELECT DISTINCT PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') AS WW
                                                                  FROM MWIPCALDEF
                                                                 WHERE CALENDAR_ID = 'OTD'
                                                                   AND PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') >= (
                                                                                                              SELECT MAX(PLAN_YEAR || LPAD(PLAN_WEEK,2,'0')) AS WW
                                                                                                                FROM MWIPCALDEF
                                                                                                               WHERE CALENDAR_ID = 'OTD'
                                                                                                                 AND PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') < (SELECT PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') AS WW FROM MWIPCALDEF WHERE CALENDAR_ID = 'OTD' AND SYS_DATE = '20200427')
                                                                                                                 AND SYS_DATE >= TO_CHAR(TO_DATE('20200427', 'YYYYMMDD')-14, 'YYYYMMDD')
                                                                                                             )
                                                               ) 
                                                       )
                                                 WHERE RNK <= 7
                                               ) 
 GROUP BY PLAN_YEAR, PLAN_WEEK 
 ORDER BY PLAN_YEAR, PLAN_WEEK

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT MIN(SYS_DATE) AS START_DAY 
     , MAX(SYS_DATE) AS END_DAY 
     , PLAN_YEAR||DECODE(LENGTH(PLAN_WEEK), 1, '0'||PLAN_WEEK, PLAN_WEEK) AS WEEK
  FROM MWIPCALDEF 
 WHERE CALENDAR_ID = 'SE'
   AND (PLAN_YEAR || LPAD(PLAN_WEEK,2,'0')) IN ( 
                                                SELECT WW
                                                  FROM (
                                                        SELECT WW
                                                             , ROW_NUMBER() OVER(ORDER BY WW) AS RNK
                                                          FROM (
                                                                SELECT DISTINCT PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') AS WW
                                                                  FROM MWIPCALDEF
                                                                 WHERE CALENDAR_ID = 'SE'
                                                                   AND PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') >= (
                                                                                                              SELECT MAX(PLAN_YEAR || LPAD(PLAN_WEEK,2,'0')) AS WW
                                                                                                                FROM MWIPCALDEF
                                                                                                               WHERE CALENDAR_ID = 'SE'
                                                                                                                 AND PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') < (SELECT PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') AS WW FROM MWIPCALDEF WHERE CALENDAR_ID = 'SE' AND SYS_DATE = '20200427')
                                                                                                                 AND SYS_DATE >= TO_CHAR(TO_DATE('20200427', 'YYYYMMDD')-14, 'YYYYMMDD')
                                                                                                             )
                                                               ) 
                                                       )
                                                 WHERE RNK <= 7
                                               ) 
 GROUP BY PLAN_YEAR, PLAN_WEEK 
 ORDER BY PLAN_YEAR, PLAN_WEEK

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT LANGUAGE_2 FROM RWEBFUNDEF WHERE FUNC_NAME = 'PRD010216'
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT PLAN_WEEK V1    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_DATE = TO_CHAR(SYSDATE,'yyyymmdd')      AND ROWNUM = 1  
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('2020', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('2020', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT LANGUAGE_2 FROM RWEBFUNDEF WHERE FUNC_NAME = 'STD1701'
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT FACTORY Code, FAC_DESC Data
  FROM MWIPFACDEF
 WHERE FAC_GRP_5 = 'Y' 
 ORDER BY FAC_GRP_4 ASC
-------------------------------------------------------------
SELECT OPER, OPER_DESC  FROM MWIPOPRDEF
  WHERE FACTORY = 'HMVA2'  AND OPER NOT IN ('00001', '00002') AND OPER NOT LIKE 'V%' ORDER BY DECODE(OPER_CMF_2, ' ', 99999, TO_NUMBER(OPER_CMF_2)), OPER
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT (SELECT DATA_1 FROM MGCMTBLDAT WHERE TABLE_NAME = 'H_CUSTOMER' AND KEY_1 = B.MAT_GRP_1 AND ROWNUM=1) AS MAT_GRP_1,  ' ', B.MAT_GRP_3,  ' ',  ' ',  ' ',  ' ',  ' ', B.MAT_CMF_10, B.MAT_ID, A.FLOW 
     , (SELECT FLOW_DESC FROM MWIPFLWDEF WHERE FACTORY = 'HMVA2' AND FLOW = A.FLOW) AS FLOW_DESC 
     , MAX(DECODE(OPER, 'A0000',  '■', '')) AS  V0
     , MAX(DECODE(OPER, 'A0005',  '■', '')) AS  V1
     , MAX(DECODE(OPER, 'A000N',  '■', '')) AS  V2
     , MAX(DECODE(OPER, 'A0010',  '■', '')) AS  V3
     , MAX(DECODE(OPER, 'A0012',  '■', '')) AS  V4
     , MAX(DECODE(OPER, 'A0013',  '■', '')) AS  V5
     , MAX(DECODE(OPER, 'A0015',  '■', '')) AS  V6
     , MAX(DECODE(OPER, 'A0020',  '■', '')) AS  V7
     , MAX(DECODE(OPER, 'A0055',  '■', '')) AS  V8
     , MAX(DECODE(OPER, 'A0023',  '■', '')) AS  V9
     , MAX(DECODE(OPER, 'A0025',  '■', '')) AS  V10
     , MAX(DECODE(OPER, 'A0030',  '■', '')) AS  V11
     , MAX(DECODE(OPER, 'A0190',  '■', '')) AS  V12
     , MAX(DECODE(OPER, 'A0033',  '■', '')) AS  V13
     , MAX(DECODE(OPER, 'A0040',  '■', '')) AS  V14
     , MAX(DECODE(OPER, 'A0041',  '■', '')) AS  V15
     , MAX(DECODE(OPER, 'A0042',  '■', '')) AS  V16
     , MAX(DECODE(OPER, 'A0045',  '■', '')) AS  V17
     , MAX(DECODE(OPER, 'A0050',  '■', '')) AS  V18
     , MAX(DECODE(OPER, 'A0060',  '■', '')) AS  V19
     , MAX(DECODE(OPER, 'A0070',  '■', '')) AS  V20
     , MAX(DECODE(OPER, 'A0080',  '■', '')) AS  V21
     , MAX(DECODE(OPER, 'A0090',  '■', '')) AS  V22
     , MAX(DECODE(OPER, 'A0095',  '■', '')) AS  V23
     , MAX(DECODE(OPER, 'A0110',  '■', '')) AS  V24
     , MAX(DECODE(OPER, 'A0120',  '■', '')) AS  V25
     , MAX(DECODE(OPER, 'A0130',  '■', '')) AS  V26
     , MAX(DECODE(OPER, 'A0140',  '■', '')) AS  V27
     , MAX(DECODE(OPER, 'A0160',  '■', '')) AS  V28
     , MAX(DECODE(OPER, 'A0161',  '■', '')) AS  V29
     , MAX(DECODE(OPER, 'A0165',  '■', '')) AS  V30
     , MAX(DECODE(OPER, 'A0065',  '■', '')) AS  V31
     , MAX(DECODE(OPER, 'A0100',  '■', '')) AS  V32
     , MAX(DECODE(OPER, 'A0150',  '■', '')) AS  V33
     , MAX(DECODE(OPER, 'A0175',  '■', '')) AS  V34
     , MAX(DECODE(OPER, 'A0176',  '■', '')) AS  V35
     , MAX(DECODE(OPER, 'A0170',  '■', '')) AS  V36
     , MAX(DECODE(OPER, 'A0180',  '■', '')) AS  V37
     , MAX(DECODE(OPER, 'A0200',  '■', '')) AS  V38
     , MAX(DECODE(OPER, 'A0201',  '■', '')) AS  V39
     , MAX(DECODE(OPER, 'A0202',  '■', '')) AS  V40
     , MAX(DECODE(OPER, 'A0210',  '■', '')) AS  V41
     , MAX(DECODE(OPER, 'A0215',  '■', '')) AS  V42
     , MAX(DECODE(OPER, 'A0220',  '■', '')) AS  V43
     , MAX(DECODE(OPER, 'A0230',  '■', '')) AS  V44
     , MAX(DECODE(OPER, 'A0300',  '■', '')) AS  V45
     , MAX(DECODE(OPER, 'A0250',  '■', '')) AS  V46
     , MAX(DECODE(OPER, 'A0305',  '■', '')) AS  V47
     , MAX(DECODE(OPER, 'A0240',  '■', '')) AS  V48
     , MAX(DECODE(OPER, 'A0260',  '■', '')) AS  V49
     , MAX(DECODE(OPER, 'A0270',  '■', '')) AS  V50
     , MAX(DECODE(OPER, 'A0290',  '■', '')) AS  V51
     , MAX(DECODE(OPER, 'A0295',  '■', '')) AS  V52
     , MAX(DECODE(OPER, 'A0280',  '■', '')) AS  V53
     , MAX(DECODE(OPER, 'A0306',  '■', '')) AS  V54
     , MAX(DECODE(OPER, 'A0307',  '■', '')) AS  V55
     , MAX(DECODE(OPER, 'A0308',  '■', '')) AS  V56
     , MAX(DECODE(OPER, 'A0310',  '■', '')) AS  V57
     , MAX(DECODE(OPER, 'A0320',  '■', '')) AS  V58
     , MAX(DECODE(OPER, 'A0330',  '■', '')) AS  V59
     , MAX(DECODE(OPER, 'A1280',  '■', '')) AS  V60
     , MAX(DECODE(OPER, 'A0333',  '■', '')) AS  V61
     , MAX(DECODE(OPER, 'A0335',  '■', '')) AS  V62
     , MAX(DECODE(OPER, 'A0337',  '■', '')) AS  V63
     , MAX(DECODE(OPER, 'A0372',  '■', '')) AS  V64
     , MAX(DECODE(OPER, 'A0395',  '■', '')) AS  V65
     , MAX(DECODE(OPER, 'A0397',  '■', '')) AS  V66
     , MAX(DECODE(OPER, 'A0340',  '■', '')) AS  V67
     , MAX(DECODE(OPER, 'A0345',  '■', '')) AS  V68
     , MAX(DECODE(OPER, 'A0350',  '■', '')) AS  V69
     , MAX(DECODE(OPER, 'A0360',  '■', '')) AS  V70
     , MAX(DECODE(OPER, 'A0370',  '■', '')) AS  V71
     , MAX(DECODE(OPER, 'A0375',  '■', '')) AS  V72
     , MAX(DECODE(OPER, 'A0380',  '■', '')) AS  V73
     , MAX(DECODE(OPER, 'A0381',  '■', '')) AS  V74
     , MAX(DECODE(OPER, 'A0382',  '■', '')) AS  V75
     , MAX(DECODE(OPER, 'A0383',  '■', '')) AS  V76
     , MAX(DECODE(OPER, 'A0385',  '■', '')) AS  V77
     , MAX(DECODE(OPER, 'A0391',  '■', '')) AS  V78
     , MAX(DECODE(OPER, 'A0399',  '■', '')) AS  V79
     , MAX(DECODE(OPER, 'A0390',  '■', '')) AS  V80
     , MAX(DECODE(OPER, 'A0400',  '■', '')) AS  V81
     , MAX(DECODE(OPER, 'A0401',  '■', '')) AS  V82
     , MAX(DECODE(OPER, 'A0500',  '■', '')) AS  V83
     , MAX(DECODE(OPER, 'A0530',  '■', '')) AS  V84
     , MAX(DECODE(OPER, 'A0531',  '■', '')) AS  V85
     , MAX(DECODE(OPER, 'A0501',  '■', '')) AS  V86
     , MAX(DECODE(OPER, 'A0540',  '■', '')) AS  V87
     , MAX(DECODE(OPER, 'A0550',  '■', '')) AS  V88
     , MAX(DECODE(OPER, 'A0600',  '■', '')) AS  V89
     , MAX(DECODE(OPER, 'A0620',  '■', '')) AS  V90
     , MAX(DECODE(OPER, 'A0660',  '■', '')) AS  V91
     , MAX(DECODE(OPER, 'A0630',  '■', '')) AS  V92
     , MAX(DECODE(OPER, 'A0650',  '■', '')) AS  V93
     , MAX(DECODE(OPER, 'A0670',  '■', '')) AS  V94
     , MAX(DECODE(OPER, 'A0720',  '■', '')) AS  V95
     , MAX(DECODE(OPER, 'A0700',  '■', '')) AS  V96
     , MAX(DECODE(OPER, 'A0339',  '■', '')) AS  V97
     , MAX(DECODE(OPER, 'A0541',  '■', '')) AS  V98
     , MAX(DECODE(OPER, 'A0551',  '■', '')) AS  V99
     , MAX(DECODE(OPER, 'A0561',  '■', '')) AS  V100
     , MAX(DECODE(OPER, 'A0601',  '■', '')) AS  V101
     , MAX(DECODE(OPER, 'A0710',  '■', '')) AS  V102
     , MAX(DECODE(OPER, 'A0800',  '■', '')) AS  V103
     , MAX(DECODE(OPER, 'A0402',  '■', '')) AS  V104
     , MAX(DECODE(OPER, 'A0502',  '■', '')) AS  V105
     , MAX(DECODE(OPER, 'A0532',  '■', '')) AS  V106
     , MAX(DECODE(OPER, 'A0801',  '■', '')) AS  V107
     , MAX(DECODE(OPER, 'A0542',  '■', '')) AS  V108
     , MAX(DECODE(OPER, 'A0552',  '■', '')) AS  V109
     , MAX(DECODE(OPER, 'A0562',  '■', '')) AS  V110
     , MAX(DECODE(OPER, 'A0602',  '■', '')) AS  V111
     , MAX(DECODE(OPER, 'A0711',  '■', '')) AS  V112
     , MAX(DECODE(OPER, 'A0802',  '■', '')) AS  V113
     , MAX(DECODE(OPER, 'A0403',  '■', '')) AS  V114
     , MAX(DECODE(OPER, 'A0503',  '■', '')) AS  V115
     , MAX(DECODE(OPER, 'A0533',  '■', '')) AS  V116
     , MAX(DECODE(OPER, 'A0543',  '■', '')) AS  V117
     , MAX(DECODE(OPER, 'A0553',  '■', '')) AS  V118
     , MAX(DECODE(OPER, 'A0563',  '■', '')) AS  V119
     , MAX(DECODE(OPER, 'A0603',  '■', '')) AS  V120
     , MAX(DECODE(OPER, 'A0712',  '■', '')) AS  V121
     , MAX(DECODE(OPER, 'A0713',  '■', '')) AS  V122
     , MAX(DECODE(OPER, 'A0803',  '■', '')) AS  V123
     , MAX(DECODE(OPER, 'A0404',  '■', '')) AS  V124
     , MAX(DECODE(OPER, 'A0504',  '■', '')) AS  V125
     , MAX(DECODE(OPER, 'A0534',  '■', '')) AS  V126
     , MAX(DECODE(OPER, 'A0544',  '■', '')) AS  V127
     , MAX(DECODE(OPER, 'A0554',  '■', '')) AS  V128
     , MAX(DECODE(OPER, 'A0564',  '■', '')) AS  V129
     , MAX(DECODE(OPER, 'A0604',  '■', '')) AS  V130
     , MAX(DECODE(OPER, 'A0714',  '■', '')) AS  V131
     , MAX(DECODE(OPER, 'A0804',  '■', '')) AS  V132
     , MAX(DECODE(OPER, 'A0405',  '■', '')) AS  V133
     , MAX(DECODE(OPER, 'A0505',  '■', '')) AS  V134
     , MAX(DECODE(OPER, 'A0535',  '■', '')) AS  V135
     , MAX(DECODE(OPER, 'A0545',  '■', '')) AS  V136
     , MAX(DECODE(OPER, 'A0555',  '■', '')) AS  V137
     , MAX(DECODE(OPER, 'A0565',  '■', '')) AS  V138
     , MAX(DECODE(OPER, 'A0605',  '■', '')) AS  V139
     , MAX(DECODE(OPER, 'A0715',  '■', '')) AS  V140
     , MAX(DECODE(OPER, 'A0805',  '■', '')) AS  V141
     , MAX(DECODE(OPER, 'A0406',  '■', '')) AS  V142
     , MAX(DECODE(OPER, 'A0506',  '■', '')) AS  V143
     , MAX(DECODE(OPER, 'A0536',  '■', '')) AS  V144
     , MAX(DECODE(OPER, 'A0546',  '■', '')) AS  V145
     , MAX(DECODE(OPER, 'A0556',  '■', '')) AS  V146
     , MAX(DECODE(OPER, 'A0566',  '■', '')) AS  V147
     , MAX(DECODE(OPER, 'A0606',  '■', '')) AS  V148
     , MAX(DECODE(OPER, 'A0716',  '■', '')) AS  V149
     , MAX(DECODE(OPER, 'A0806',  '■', '')) AS  V150
     , MAX(DECODE(OPER, 'A0407',  '■', '')) AS  V151
     , MAX(DECODE(OPER, 'A0507',  '■', '')) AS  V152
     , MAX(DECODE(OPER, 'A0537',  '■', '')) AS  V153
     , MAX(DECODE(OPER, 'A0547',  '■', '')) AS  V154
     , MAX(DECODE(OPER, 'A0557',  '■', '')) AS  V155
     , MAX(DECODE(OPER, 'A0567',  '■', '')) AS  V156
     , MAX(DECODE(OPER, 'A0607',  '■', '')) AS  V157
     , MAX(DECODE(OPER, 'A0717',  '■', '')) AS  V158
     , MAX(DECODE(OPER, 'A0807',  '■', '')) AS  V159
     , MAX(DECODE(OPER, 'A0408',  '■', '')) AS  V160
     , MAX(DECODE(OPER, 'A0508',  '■', '')) AS  V161
     , MAX(DECODE(OPER, 'A0538',  '■', '')) AS  V162
     , MAX(DECODE(OPER, 'A0558',  '■', '')) AS  V163
     , MAX(DECODE(OPER, 'A0568',  '■', '')) AS  V164
     , MAX(DECODE(OPER, 'A0608',  '■', '')) AS  V165
     , MAX(DECODE(OPER, 'A0808',  '■', '')) AS  V166
     , MAX(DECODE(OPER, 'A0409',  '■', '')) AS  V167
     , MAX(DECODE(OPER, 'A0509',  '■', '')) AS  V168
     , MAX(DECODE(OPER, 'A0539',  '■', '')) AS  V169
     , MAX(DECODE(OPER, 'A0559',  '■', '')) AS  V170
     , MAX(DECODE(OPER, 'A0569',  '■', '')) AS  V171
     , MAX(DECODE(OPER, 'A0609',  '■', '')) AS  V172
     , MAX(DECODE(OPER, 'A0809',  '■', '')) AS  V173
     , MAX(DECODE(OPER, 'A080A',  '■', '')) AS  V174
     , MAX(DECODE(OPER, 'A0890',  '■', '')) AS  V175
     , MAX(DECODE(OPER, 'A0900',  '■', '')) AS  V176
     , MAX(DECODE(OPER, 'A0910',  '■', '')) AS  V177
     , MAX(DECODE(OPER, 'A0920',  '■', '')) AS  V178
     , MAX(DECODE(OPER, 'A0930',  '■', '')) AS  V179
     , MAX(DECODE(OPER, 'A0935',  '■', '')) AS  V180
     , MAX(DECODE(OPER, 'A040A',  '■', '')) AS  V181
     , MAX(DECODE(OPER, 'A0950',  '■', '')) AS  V182
     , MAX(DECODE(OPER, 'A053A',  '■', '')) AS  V183
     , MAX(DECODE(OPER, 'A0970',  '■', '')) AS  V184
     , MAX(DECODE(OPER, 'A0940',  '■', '')) AS  V185
     , MAX(DECODE(OPER, 'A0980',  '■', '')) AS  V186
     , MAX(DECODE(OPER, 'A1000',  '■', '')) AS  V187
     , MAX(DECODE(OPER, 'A055A',  '■', '')) AS  V188
     , MAX(DECODE(OPER, 'A060A',  '■', '')) AS  V189
     , MAX(DECODE(OPER, 'A1040',  '■', '')) AS  V190
     , MAX(DECODE(OPER, 'A1070',  '■', '')) AS  V191
     , MAX(DECODE(OPER, 'A1020',  '■', '')) AS  V192
     , MAX(DECODE(OPER, 'A1100',  '■', '')) AS  V193
     , MAX(DECODE(OPER, 'A1110',  '■', '')) AS  V194
     , MAX(DECODE(OPER, 'A1120',  '■', '')) AS  V195
     , MAX(DECODE(OPER, 'A1130',  '■', '')) AS  V196
     , MAX(DECODE(OPER, 'A1140',  '■', '')) AS  V197
     , MAX(DECODE(OPER, 'A1150',  '■', '')) AS  V198
     , MAX(DECODE(OPER, 'A1600',  '■', '')) AS  V199
     , MAX(DECODE(OPER, 'A1650',  '■', '')) AS  V200
     , MAX(DECODE(OPER, 'A1170',  '■', '')) AS  V201
     , MAX(DECODE(OPER, 'A1180',  '■', '')) AS  V202
     , MAX(DECODE(OPER, 'A1200',  '■', '')) AS  V203
     , MAX(DECODE(OPER, 'A1230',  '■', '')) AS  V204
     , MAX(DECODE(OPER, 'A1240',  '■', '')) AS  V205
     , MAX(DECODE(OPER, 'A1250',  '■', '')) AS  V206
     , MAX(DECODE(OPER, 'A1260',  '■', '')) AS  V207
     , MAX(DECODE(OPER, 'A1270',  '■', '')) AS  V208
     , MAX(DECODE(OPER, 'A1300',  '■', '')) AS  V209
     , MAX(DECODE(OPER, 'A1350',  '■', '')) AS  V210
     , MAX(DECODE(OPER, 'A1370',  '■', '')) AS  V211
     , MAX(DECODE(OPER, 'A1380',  '■', '')) AS  V212
     , MAX(DECODE(OPER, 'A1050',  '■', '')) AS  V213
     , MAX(DECODE(OPER, 'A1420',  '■', '')) AS  V214
     , MAX(DECODE(OPER, 'A1440',  '■', '')) AS  V215
     , MAX(DECODE(OPER, 'A1450',  '■', '')) AS  V216
     , MAX(DECODE(OPER, 'A1821',  '■', '')) AS  V217
     , MAX(DECODE(OPER, 'A1460',  '■', '')) AS  V218
     , MAX(DECODE(OPER, 'A1470',  '■', '')) AS  V219
     , MAX(DECODE(OPER, 'A1500',  '■', '')) AS  V220
     , MAX(DECODE(OPER, 'A1550',  '■', '')) AS  V221
     , MAX(DECODE(OPER, 'A1610',  '■', '')) AS  V222
     , MAX(DECODE(OPER, 'A1560',  '■', '')) AS  V223
     , MAX(DECODE(OPER, 'A1720',  '■', '')) AS  V224
     , MAX(DECODE(OPER, 'A1730',  '■', '')) AS  V225
     , MAX(DECODE(OPER, 'A1740',  '■', '')) AS  V226
     , MAX(DECODE(OPER, 'A1750',  '■', '')) AS  V227
     , MAX(DECODE(OPER, 'A1755',  '■', '')) AS  V228
     , MAX(DECODE(OPER, 'A1760',  '■', '')) AS  V229
     , MAX(DECODE(OPER, 'A1765',  '■', '')) AS  V230
     , MAX(DECODE(OPER, 'A1766',  '■', '')) AS  V231
     , MAX(DECODE(OPER, 'A1763',  '■', '')) AS  V232
     , MAX(DECODE(OPER, 'A1770',  '■', '')) AS  V233
     , MAX(DECODE(OPER, 'A1780',  '■', '')) AS  V234
     , MAX(DECODE(OPER, 'A1790',  '■', '')) AS  V235
     , MAX(DECODE(OPER, 'A1795',  '■', '')) AS  V236
     , MAX(DECODE(OPER, 'A1860',  '■', '')) AS  V237
     , MAX(DECODE(OPER, 'A1850',  '■', '')) AS  V238
     , MAX(DECODE(OPER, 'A1390',  '■', '')) AS  V239
     , MAX(DECODE(OPER, 'A1800',  '■', '')) AS  V240
     , MAX(DECODE(OPER, 'A1805',  '■', '')) AS  V241
     , MAX(DECODE(OPER, 'A1810',  '■', '')) AS  V242
     , MAX(DECODE(OPER, 'A1811',  '■', '')) AS  V243
     , MAX(DECODE(OPER, 'A1812',  '■', '')) AS  V244
     , MAX(DECODE(OPER, 'A1816',  '■', '')) AS  V245
     , MAX(DECODE(OPER, 'A1820',  '■', '')) AS  V246
     , MAX(DECODE(OPER, 'A1825',  '■', '')) AS  V247
     , MAX(DECODE(OPER, 'A1826',  '■', '')) AS  V248
     , MAX(DECODE(OPER, 'A1920',  '■', '')) AS  V249
     , MAX(DECODE(OPER, 'A1960',  '■', '')) AS  V250
     , MAX(DECODE(OPER, 'A1815',  '■', '')) AS  V251
     , MAX(DECODE(OPER, 'A1830',  '■', '')) AS  V252
     , MAX(DECODE(OPER, 'A1710',  '■', '')) AS  V253
     , MAX(DECODE(OPER, 'A1840',  '■', '')) AS  V254
     , MAX(DECODE(OPER, 'A1900',  '■', '')) AS  V255
     , MAX(DECODE(OPER, 'A1910',  '■', '')) AS  V256
     , MAX(DECODE(OPER, 'A1950',  '■', '')) AS  V257
     , MAX(DECODE(OPER, 'A2000',  '■', '')) AS  V258
     , MAX(DECODE(OPER, 'A2010',  '■', '')) AS  V259
     , MAX(DECODE(OPER, 'A2020',  '■', '')) AS  V260
     , MAX(DECODE(OPER, 'A2025',  '■', '')) AS  V261
     , MAX(DECODE(OPER, 'A1819',  '■', '')) AS  V262
     , MAX(DECODE(OPER, 'A2030',  '■', '')) AS  V263
     , MAX(DECODE(OPER, 'A2040',  '■', '')) AS  V264
     , MAX(DECODE(OPER, 'A2041',  '■', '')) AS  V265
     , MAX(DECODE(OPER, 'A2042',  '■', '')) AS  V266
     , MAX(DECODE(OPER, 'A2070',  '■', '')) AS  V267
     , MAX(DECODE(OPER, 'A2050',  '■', '')) AS  V268
     , MAX(DECODE(OPER, 'A2150',  '■', '')) AS  V269
     , MAX(DECODE(OPER, 'A2200',  '■', '')) AS  V270
     , MAX(DECODE(OPER, 'A2100',  '■', '')) AS  V271
     , MAX(DECODE(OPER, 'A2300',  '■', '')) AS  V272
     , MAX(DECODE(OPER, 'A2350',  '■', '')) AS  V273
     , MAX(DECODE(OPER, 'AZ009',  '■', '')) AS  V274
     , MAX(DECODE(OPER, 'AZ010',  '■', '')) AS  V275
     , MAX(DECODE(OPER, 'M0300',  '■', '')) AS  V276
     , MAX(DECODE(OPER, 'M0315',  '■', '')) AS  V277
     , MAX(DECODE(OPER, 'M0320',  '■', '')) AS  V278
     , MAX(DECODE(OPER, 'M0339',  '■', '')) AS  V279
     , MAX(DECODE(OPER, 'M0345',  '■', '')) AS  V280
     , MAX(DECODE(OPER, 'M0323',  '■', '')) AS  V281
     , MAX(DECODE(OPER, 'M0329',  '■', '')) AS  V282
     , MAX(DECODE(OPER, 'Q0001',  '■', '')) AS  V283
     , MAX(DECODE(OPER, 'Q0002',  '■', '')) AS  V284
     , MAX(DECODE(OPER, 'M0325',  '■', '')) AS  V285
     , MAX(DECODE(OPER, 'M0330',  '■', '')) AS  V286
     , MAX(DECODE(OPER, 'M0337',  '■', '')) AS  V287
     , MAX(DECODE(OPER, 'M0391',  '■', '')) AS  V288
     , MAX(DECODE(OPER, 'M0336',  '■', '')) AS  V289
     , MAX(DECODE(OPER, 'M0340',  '■', '')) AS  V290
     , MAX(DECODE(OPER, 'M0400',  '■', '')) AS  V291
     , MAX(DECODE(OPER, 'M0500',  '■', '')) AS  V292
     , MAX(DECODE(OPER, 'M0550',  '■', '')) AS  V293
     , MAX(DECODE(OPER, 'M0110',  '■', '')) AS  V294
     , MAX(DECODE(OPER, 'M0120',  '■', '')) AS  V295
     , MAX(DECODE(OPER, 'M0160',  '■', '')) AS  V296
     , MAX(DECODE(OPER, 'M0161',  '■', '')) AS  V297
     , MAX(DECODE(OPER, 'M0401',  '■', '')) AS  V298
     , MAX(DECODE(OPER, 'M1750',  '■', '')) AS  V299
   FROM MWIPFLWOPR@RPTTOMES A 
     , MWIPMATDEF B 
 WHERE 1 = 1 
   AND A.FACTORY = B.FACTORY 
   AND A.FLOW = B.FIRST_FLOW 
   AND A.FACTORY = 'HMVA2'
   AND B.MAT_TYPE = 'FG'  
   AND B.DELETE_FLAG = ' ' 
 GROUP BY B.MAT_GRP_1,  ' ', B.MAT_GRP_3,  ' ',  ' ',  ' ',  ' ',  ' ', B.MAT_CMF_10, B.MAT_ID, A.FLOW 
 ORDER BY B.MAT_GRP_1,  ' ', B.MAT_GRP_3,  ' ',  ' ',  ' ',  ' ',  ' ', B.MAT_CMF_10, B.MAT_ID, A.FLOW 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
SELECT LANGUAGE_2 FROM RWEBFUNDEF WHERE FUNC_NAME = 'PRD010803'
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT FACTORY Code, FAC_DESC Data
  FROM MWIPFACDEF
 WHERE FAC_GRP_5 = 'Y' 
 ORDER BY FAC_GRP_4 ASC
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT KEY_1 AS Code, DATA_1 AS Data 
  FROM MGCMTBLDAT 
 WHERE FACTORY= 'HMVA2'
   AND TABLE_NAME = 'MATERIAL_TYPE' 
   AND KEY_1 <> 'ALL' 
 ORDER BY KEY_1 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT A.MAT_ID AS PRODUCT, (SELECT DATA_1 FROM MGCMTBLDAT WHERE TABLE_NAME = 'H_CUSTOMER' AND KEY_1 = A.MAT_GRP_1 AND ROWNUM=1) AS CUSTOMER, MAT_GRP_2 AS FAMILY, MAT_GRP_3 AS PKG, MAT_GRP_4 AS TYPE1, MAT_GRP_5 AS TYPE2, MAT_GRP_6 AS LEAD_COUNT, MAT_GRP_7 AS DENSITY, MAT_GRP_8 AS GENERATION, MAT_GRP_9 AS MAJOR_CODE, MAT_GRP_10 AS PACKAGE2 
     , MAT_DESC, MAT_TYPE 
     , MAT_CMF_1 AS PLATING, MAT_CMF_2 AS LEAD_FREE, MAT_CMF_3 AS HALOGEN_FREE, MAT_CMF_4 AS STD_MG_QTY, MAT_CMF_5 AS STD_SP_QTY 
     , MAT_CMF_6 AS MA_RULE, MAT_CMF_7 AS CUSTOMER_DEVICE, MAT_CMF_8 AS SALES_CODE, MAT_CMF_9 AS BODY_SIZE, MAT_CMF_10 AS PIN_TYPE 
     , MAT_CMF_11 AS PACK_CODE, MAT_CMF_12 AS EMP_NO, MAT_CMF_13 AS NET_DIE, MAT_CMF_14 AS WF_INCH 
     , FIRST_FLOW, LAST_FLOW, VENDOR_MAT_ID AS ERP_CODE_BG, BASE_MAT_ID AS ERP_CODE_ASSY_TEST 
     , LF_MATERIAL, BD_DIAGRAM, MK_DIAGRAM 
     , GW_1, CAP_1, EMC_1, SB, TRAY, LM_1, BG_1, WM_TYPE1, BLADE_1 
     , RESV_FIELD_1 AS CUT_METHOD, BLADE_8 AS PMC_TIME 
     , BOM_LF_PB, BOM_GW_CW, BOM_LM, BOM_WBL, BOM_AE, BOM_NT, BOM_MC, BOM_SB, BOM_PKG_SAW 
     , UNIT, ADH_8 AS POLISHING, ADH_6 AS GDP, ADH_5 AS NCH, ADH_9 AS GEMAN 
     , (SELECT SUM(DECODE(TCD_CMF_2, ' ', 0, TCD_CMF_2)) FROM CWIPTCDDEF@RPTTOMES WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID) AS WIRE_COUNT 
  FROM MWIPMATDEF A 
     , CLOTCRDDAT@RPTTOMES B 
     , ( 
        SELECT MAT_ID, MAX(UNIT) AS UNIT 
          FROM ( 
                SELECT DISTINCT B.PARTNUMBER AS MAT_ID, A.C_MAT_CMF_4 AS UNIT 
                  FROM CWIPMATDEF@RPTTOMES A 
                     , CWIPBOMDEF B 
                 WHERE 1=1 
                   AND A.MAT_ID = B.MATCODE 
                   AND A.FACTORY = 'HMVA2' 
                   AND B.RESV_FIELD_2 IN ('LF','PB') 
                   AND B.RESV_FLAG_1 = 'Y' 
                   AND A.C_MAT_CMF_4 <> ' ' 
               ) 
         GROUP BY MAT_ID 
       ) C
     , ( 
        SELECT MAT_ID 
             , MAX(CASE WHEN RESV_FIELD_2 IN ('LF', 'PB') THEN MATCODE ELSE ' ' END) BOM_LF_PB 
             , MAX(CASE WHEN RESV_FIELD_2 IN ('GW', 'CW') THEN MATCODE ELSE ' ' END) BOM_GW_CW 
             , MAX(CASE WHEN RESV_FIELD_2 = 'LM' THEN MATCODE ELSE ' ' END) BOM_LM 
             , MAX(CASE WHEN RESV_FIELD_2 = 'WBL' THEN MATCODE ELSE ' ' END) BOM_WBL 
             , MAX(CASE WHEN RESV_FIELD_2 = 'AE' THEN MATCODE ELSE ' ' END) BOM_AE 
             , MAX(CASE WHEN RESV_FIELD_2 = 'NT' THEN MATCODE ELSE ' ' END) BOM_NT 
             , MAX(CASE WHEN RESV_FIELD_2 = 'MC' THEN MATCODE ELSE ' ' END) BOM_MC 
             , MAX(CASE WHEN RESV_FIELD_2 = 'SB' THEN MATCODE ELSE ' ' END) BOM_SB 
             , MAX(CASE WHEN RESV_FIELD_2 = 'BD' THEN MATCODE ELSE ' ' END) BOM_PKG_SAW 
          FROM ( 
                SELECT MAT_ID, RESV_FIELD_2 
                     , MAX(MATCODE) KEEP(DENSE_RANK FIRST ORDER BY CREATE_DT DESC) MATCODE 
                  FROM ( 
                        SELECT PARTNUMBER AS MAT_ID, MATCODE
                             , CASE WHEN RESV_FIELD_2 = 'TE' AND STEPID = 'A0020' THEN 'LM'
                                    WHEN RESV_FIELD_2 = 'TE' AND STEPID = 'A0040' THEN 'WBL'
                                    ELSE RESV_FIELD_2
                               END AS RESV_FIELD_2
                             , CREATE_DT 
                          FROM CWIPBOMDEF 
                         WHERE 1=1 
                           AND RESV_FLAG_1 = 'Y' 
                           AND (RESV_FIELD_2 IN ('LF', 'PB', 'GW', 'CW', 'TE', 'AE', 'NT', 'MC', 'SB') OR (RESV_FIELD_2 = 'BD' AND STEPID = 'A1750'))
                       ) 
                 GROUP BY MAT_ID, RESV_FIELD_2 
               ) 
         GROUP BY MAT_ID 
       ) D
 WHERE 1=1 
   AND A.FACTORY = B.FACTORY(+)
   AND A.MAT_ID = B.MAT_ID(+)
   AND A.MAT_ID = C.MAT_ID(+)
   AND A.MAT_ID = D.MAT_ID(+)
   AND A.FACTORY = 'HMVA2'
   AND A.DELETE_FLAG = ' ' 
   AND A.MAT_ID LIKE '%' 
   AND A.MAT_TYPE = 'FG'
 ORDER BY A.MAT_ID, A.MAT_GRP_1, A.MAT_GRP_2, A.MAT_GRP_3, A.MAT_GRP_4, A.MAT_GRP_5, A.MAT_GRP_6, A.MAT_GRP_7, A.MAT_GRP_8, A.MAT_GRP_9, A.MAT_GRP_10 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
SELECT LANGUAGE_2 FROM RWEBFUNDEF WHERE FUNC_NAME = 'PRD010804'
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT DISTINCT RES_STS_8 AS CODE, ' ' AS NAME
  FROM MRASRESDEF@RPTTOMES
 WHERE FACTORY = 'HMVA2' 
   AND RES_CMF_9 = 'Y' 
   AND DELETE_FLAG = ' ' 
   AND RES_STS_8 != ' ' 
   AND RES_ID NOT LIKE 'BSP%' 
 ORDER BY CODE 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT   RES_ID as RES_ID,  ' ',  ' ', C.MAT_GRP_3 as Package,  ' ',  ' ',  ' ',  ' ',  ' ',  ' ', RES_STS_2 AS MAT_ID 
     , RES_STS_8 AS OPER, A.RES_UP_DOWN_FLAG AS RES_UP_DOWN_FLAG, LM_1 AS TAPE, WM_TYPE1 AS WBL_TAPE, BG_1 AS TARGET, BLADE_1 AS BLADE 
     , LF_MATERIAL AS SUBSTRATE, CAP_1 AS CAP, GW_1 AS GOLDWIRE, EMC_1 AS EMC, SB as SB, TRAY as TRAY 
  FROM MRASRESDEF A 
     , CLOTCRDDAT@RPTTOMES B 
     , MWIPMATDEF C 
 WHERE 1 = 1 
  AND A.FACTORY = B.FACTORY(+) 
  AND A.FACTORY = C.FACTORY(+) 
  AND A.RES_STS_2 = B.MAT_ID(+) 
  AND A.RES_STS_2 = C.MAT_ID(+) 
  AND A.FACTORY  = 'HMVA2' 
  AND A.DELETE_FLAG = ' ' 
  AND A.RES_STS_8 != ' ' 
  AND A.RES_ID NOT LIKE 'BSP%' 
  AND A.RES_STS_8 LIKE '%'
  AND A.RES_STS_2 LIKE '%' 

 GROUP BY RES_ID,  ' ',  ' ', C.MAT_GRP_3,  ' ',  ' ',  ' ',  ' ',  ' ',  ' ', RES_STS_2, RES_STS_8, A.RES_UP_DOWN_FLAG, LM_1, WM_TYPE1, BG_1, BLADE_1, LF_MATERIAL, CAP_1, GW_1, EMC_1, SB, TRAY 
 ORDER BY RES_ID, OPER 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
SELECT LANGUAGE_2 FROM RWEBFUNDEF WHERE FUNC_NAME = 'PRD011017'
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT FACTORY Code, FAC_DESC Data
  FROM MWIPFACDEF
 WHERE FAC_GRP_5 = 'Y' 
 ORDER BY FAC_GRP_4 ASC
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT DISTINCT OPR.OPER CODE, OPR.OPER_DESC DATA
  FROM MRASRESMFO RES, MWIPOPRDEF OPR 
 WHERE RES.FACTORY  = 'HMVA2' 
   AND REL_LEVEL='R' 
   AND RES.OPER NOT IN ('A0100','A0150','A0250','A0320','A0330','A0340','A0350','A0370','A0380','A0390','A0500','A0501','A0502','A0503','A0504','A0505','A0506','A0507','A0508','A0509','A0550','A0950','A1100','A1110','A1180','A1230','A1720','A1950', 'A2050', 'A2100')
   AND OPR.OPER LIKE 'A%'
   AND RES.FACTORY=OPR.FACTORY 
   AND RES.OPER=OPR.OPER 
ORDER BY OPR.OPER 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT (SELECT DATA_1 FROM MGCMTBLDAT WHERE TABLE_NAME = 'H_CUSTOMER' AND KEY_1 = MAT_GRP_1 AND ROWNUM=1) AS CUSTOMER,  ' ', MAT_GRP_10 AS PKG, MAT_GRP_6 AS LD_COUNT, CONV_MAT_ID, MAT_CMF_11 AS PKG_CODE,  ' ',  ' ', MAT_GRP_5 AS TYPE2,  ' ',  ' ',  ' ' 
     , OPER, RES_MODEL
     , ROUND(AVG(UPEH), 1) AS UPEH
     , ROUND(MIN(UPEH), 1) AS MIN_UPEH
     , ROUND(MAX(UPEH), 1) AS MAX_UPEH
     , ROUND(AVG(WPH), 1) AS WPH
  FROM (
        SELECT B.*
             , CASE WHEN B.MAT_GRP_1 = 'HX' THEN B.MAT_CMF_10
                    WHEN B.MAT_ID LIKE 'SEK%' THEN 'SEK_________-___' || SUBSTR(B.MAT_ID, -3)
                    ELSE B.MAT_ID
               END CONV_MAT_ID
             , A.OPER, A.RES_MODEL, A.UPEH
             , A.UPEH / (B.NET_DIE * (NVL(C.DAY_YIELD, 90) / 100)) AS WPH 
          FROM CRASUPHDEF A
             , VWIPMATDEF B
             , (
                SELECT MAT_ID, NET_DIE, DECODE(DAY_YIELD, 0, 90, DAY_YIELD) AS DAY_YIELD
                  FROM RSUMWAFYLD
                 WHERE 1=1
                   AND FACTORY = 'HMVA2'
                   AND WORK_DATE = TO_CHAR(SYSDATE-1, 'YYYYMMDD')
               ) C
         WHERE 1=1
           AND A.FACTORY = B.FACTORY
           AND A.MAT_ID = B.MAT_ID
           AND A.MAT_ID = C.MAT_ID(+)
           AND A.FACTORY = 'HMVA2'
           AND B.DELETE_FLAG = ' '
           AND B.MAT_TYPE = 'FG'
       )
 WHERE 1=1
   AND OPER LIKE '%'
 GROUP BY MAT_GRP_1,  ' ', MAT_GRP_10, MAT_GRP_6, CONV_MAT_ID, MAT_CMF_11,  ' ',  ' ', MAT_GRP_5,  ' ',  ' ',  ' ', OPER, RES_MODEL 
 ORDER BY MAT_GRP_1,  ' ', MAT_GRP_10, MAT_GRP_6, CONV_MAT_ID, MAT_CMF_11,  ' ',  ' ', MAT_GRP_5,  ' ',  ' ',  ' ', OPER, RES_MODEL 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
SELECT LANGUAGE_2 FROM RWEBFUNDEF WHERE FUNC_NAME = 'PRD010802'
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT FACTORY Code, FAC_DESC Data
  FROM MWIPFACDEF
 WHERE FAC_GRP_5 = 'Y' 
 ORDER BY FAC_GRP_4 ASC
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT KEY_1 AS CODE, DATA_1 AS DATA 
  FROM MGCMTBLDAT 
 WHERE 1=1 
   AND FACTORY = 'HMVA2'
   AND TABLE_NAME = 'H_RPT_GCM_DISP_ITEM' 
 ORDER BY KEY_1 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT KEY_1 AS CODE, DATA_1 AS DATA 
  FROM MGCMTBLDAT 
 WHERE 1=1 
   AND FACTORY = 'HMVA2'
   AND TABLE_NAME = 'H_RPT_GCM_DISP_ITEM' 
 ORDER BY KEY_1 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT KEY_1 AS CODE, DATA_1 AS DATA 
  FROM MGCMTBLDAT 
 WHERE 1=1 
   AND FACTORY = 'HMVA2'
   AND TABLE_NAME = 'H_RPT_GCM_DISP_ITEM' 
 ORDER BY KEY_1 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT PLAN_WEEK V1    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_DATE = TO_CHAR(SYSDATE,'yyyymmdd')      AND ROWNUM = 1  
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('2020', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('2020', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT LANGUAGE_2 FROM RWEBFUNDEF WHERE FUNC_NAME = 'PRD010910'
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
WITH MD AS
(
SELECT *
  FROM (
        SELECT '계획' AS GUBUN1 FROM DUAL UNION
        SELECT '일목표' AS GUBUN1 FROM DUAL
       ) A
     , (
        SELECT 'Wafer' AS GUBUN2, 'Half cut' AS GUBUN3 FROM DUAL UNION
        SELECT 'Wafer' AS GUBUN2, 'B/G' AS GUBUN3 FROM DUAL UNION
        SELECT 'Wafer' AS GUBUN2, 'Pre_G' AS GUBUN3 FROM DUAL UNION
        SELECT 'Wafer' AS GUBUN2, 'Saw' AS GUBUN3 FROM DUAL UNION
        SELECT 'Wafer' AS GUBUN2, 'Stealth saw' AS GUBUN3 FROM DUAL UNION
        SELECT 'Wafer' AS GUBUN2, 'Laser G/V' AS GUBUN3 FROM DUAL UNION
        SELECT 'Wafer' AS GUBUN2, 'DAF Cut' AS GUBUN3 FROM DUAL UNION
        SELECT 'Wafer' AS GUBUN2, 'DDS' AS GUBUN3 FROM DUAL UNION
        SELECT 'CHIP수' AS GUBUN2, 'Epoxy' AS GUBUN3 FROM DUAL UNION
        SELECT 'CHIP수' AS GUBUN2, 'BOC' AS GUBUN3 FROM DUAL UNION
        SELECT 'CHIP수' AS GUBUN2, 'Others' AS GUBUN3 FROM DUAL UNION
        SELECT 'Wire수' AS GUBUN2, ' ' AS GUBUN3 FROM DUAL UNION
        SELECT 'PKG수' AS GUBUN2, 'C-Mold' AS GUBUN3 FROM DUAL UNION
        SELECT 'PKG수' AS GUBUN2, 'ORP' AS GUBUN3 FROM DUAL UNION
        SELECT 'PKG수' AS GUBUN2, 'SBA' AS GUBUN3 FROM DUAL UNION
        SELECT 'PKG수' AS GUBUN2, 'SST' AS GUBUN3 FROM DUAL UNION
        SELECT '95mm' AS GUBUN2, 'Mold' AS GUBUN3 FROM DUAL UNION
        SELECT '95mm' AS GUBUN2, 'SBA' AS GUBUN3 FROM DUAL UNION
        SELECT '95mm' AS GUBUN2, 'SST' AS GUBUN3 FROM DUAL
       ) B      
)
SELECT MDL.GUBUN1, MDL.GUBUN2, MDL.GUBUN3
     , ROUND(CASE WHEN MDL.GUBUN1 = '계획' THEN V0 ELSE V0 / TO_CHAR(LAST_DAY(TO_DATE('202001', 'YYYYMM')), 'DD') END / 1000, 0) V0
     , ROUND(CASE WHEN MDL.GUBUN1 = '계획' THEN V1 ELSE V1 / TO_CHAR(LAST_DAY(TO_DATE('202002', 'YYYYMM')), 'DD') END / 1000, 0) V1
     , ROUND(CASE WHEN MDL.GUBUN1 = '계획' THEN V2 ELSE V2 / TO_CHAR(LAST_DAY(TO_DATE('202003', 'YYYYMM')), 'DD') END / 1000, 0) V2
     , ROUND(CASE WHEN MDL.GUBUN1 = '계획' THEN V3 ELSE V3 / TO_CHAR(LAST_DAY(TO_DATE('202004', 'YYYYMM')), 'DD') END / 1000, 0) V3
  FROM MD MDL
     , (
        SELECT *
          FROM (
                SELECT '계획' AS GUBUN1 FROM DUAL UNION
                SELECT '일목표' AS GUBUN1 FROM DUAL
               ) A
             , (
                SELECT GUBUN2, GUBUN3
                     , SUM(DECODE(PLAN_DATE, '202001', CONV_QTY, 0)) V0
                     , SUM(DECODE(PLAN_DATE, '202002', CONV_QTY, 0)) V1
                     , SUM(DECODE(PLAN_DATE, '202003', CONV_QTY, 0)) V2
                     , SUM(DECODE(PLAN_DATE, '202004', CONV_QTY, 0)) V3
                  FROM (
                        SELECT PLAN_DATE 
                             , CASE WHEN OPER IN ('C-Mold', 'ORP', 'SBA', 'SST') THEN 'PKG수'
                                    ELSE 'Wafer' 
                               END AS GUBUN2 
                             , OPER AS GUBUN3
                             , CASE WHEN OPER IN ('C-Mold', 'ORP', 'SBA', 'SST') THEN PLAN_QTY
                                    ELSE PLAN_QTY * NVL(COMP_CNT,1) 
                               END AS PLAN_QTY
                             , ROUND(CASE WHEN OPER IN ('C-Mold', 'ORP', 'SBA', 'SST') THEN PLAN_QTY
                                          ELSE PLAN_QTY * NVL(COMP_CNT,1) / (MAT_CMF_13 * 0.85) 
                                     END, 0) AS CONV_QTY
                          FROM (
                                SELECT PLAN_DATE, MAT_ID
                                     , CASE WHEN OPER = 'A0010' THEN 'Half cut'
                                            WHEN OPER = 'A0040' THEN 'B/G'
                                            WHEN OPER = 'A0030' THEN 'Pre_G'
                                            WHEN OPER = 'A0200' THEN 'Saw'
                                            WHEN OPER IN ('A0012', 'A0033') THEN 'Stealth saw'
                                            WHEN OPER = 'A0170' THEN 'Laser G/V'
                                            WHEN OPER = 'A0180' THEN 'DAF Cut'
                                            WHEN OPER = 'A0230' THEN 'DDS'
                                            WHEN OPER = 'A1000' THEN 'C-Mold'
                                            WHEN OPER IN ('A1250', 'A1260') THEN 'ORP'
                                            WHEN OPER = 'A1300' THEN 'SBA'
                                            WHEN OPER = 'A1750' THEN 'SST'
                                            ELSE ''
                                       END OPER
                                     , PLAN_QTY
                                     , MAT_CMF_13
                                     , (SELECT DATA_1 FROM MGCMTBLDAT WHERE FACTORY = 'HMVA2' AND TABLE_NAME IN ('H_SEC_AUTO_LOSS','H_HX_AUTO_LOSS') AND KEY_1 = A.MAT_ID) AS COMP_CNT
                                     , (SELECT KEY_3 FROM MGCMTBLDAT WHERE TABLE_NAME = 'H_PKG_2D_CMOLD' AND KEY_1 = 'C-MOLD' AND KEY_2 = A.MAT_GRP_1 AND KEY_3 = A.MAT_CMF_11 AND (KEY_4 = '%' OR KEY_4 = A.MAT_ID)) AS C_MOLD
                                  FROM (
                                        SELECT A.PLAN_DATE, A.MAT_KEY, A.MAT_ID, TO_NUMBER(PLAN_QTY) AS PLAN_QTY
                                             , B.MAT_GRP_1, B.MAT_GRP_2, B.MAT_GRP_4, B.MAT_GRP_5
                                             , TO_NUMBER(DECODE(B.MAT_GRP_6, '-', 1, ' ', 1, B.MAT_GRP_6)) AS MAT_GRP_6
                                             , B.MAT_CMF_11, TO_NUMBER(DECODE(B.MAT_CMF_13,' ',1,B.MAT_CMF_13)) AS MAT_CMF_13
                                             , CASE WHEN B.MAT_GRP_4 IN ('-', 'FD', 'FU') THEN '1'
                                                    ELSE SUBSTR(B.MAT_GRP_4, 3) 
                                               END AS STACK
                                             , B.OPER
                                          FROM (
                                                SELECT DISTINCT A.PLAN_MONTH AS PLAN_DATE
                                                     , CASE WHEN B.MAT_ID IS NULL THEN A.MAT_ID ELSE B.MCP_TO_PART END AS MAT_KEY
                                                     , CASE WHEN B.MAT_ID IS NULL THEN A.MAT_ID ELSE B.MAT_ID END AS MAT_ID
                                                     , A.RESV_FIELD1 AS PLAN_QTY
                                                  FROM CWIPPLNMON A
                                                     , RWIPMCPBOM B
                                                 WHERE 1=1   
                                                   AND A.MAT_ID = B.MCP_TO_PART(+)
                                                   AND A.FACTORY = 'HMVA2'   
                                                   AND A.PLAN_MONTH BETWEEN '202001' AND '202004'
                                                   AND DECODE(A.RESV_FIELD1, ' ', 0, A.RESV_FIELD1) > 0
                                               ) A
                                             , (
                                                SELECT DISTINCT MAT_ID, MAT_GRP_1, MAT_GRP_2, MAT_GRP_4, MAT_GRP_5, MAT_GRP_6, MAT_CMF_11, MAT_CMF_13, KTSCH AS OPER
                                                  FROM MWIPMATDEF MAT
                                                     , ZHPPT120@SAPREAL SAP
                                                 WHERE 1=1
                                                   AND MAT.FIRST_FLOW = SUBSTR(PLNNR, 1, 4) 
                                                   AND MAT.FACTORY = 'HMVA2'
                                                   AND MAT.DELETE_FLAG = ' '
                                                   AND MAT.MAT_TYPE = 'FG'
                                                   AND SAP.ARBPL != 'DUMMY'
                                                   AND SAP.KTSCH LIKE 'A%'
                                               ) B   
                                         WHERE 1=1
                                           AND A.MAT_ID = B.MAT_ID
                                           AND (B.OPER IN ('A0010', 'A0200', 'A0030', 'A0040', 'A0012', 'A0033', 'A0170', 'A0180', 'A0230', 'A1250', 'A1260', 'A1300', 'A1750', 'A1000')
                                               OR B.OPER LIKE 'A06%')   
                                       ) A
                                 WHERE 1=1
                                   AND OPER IN ('A0010', 'A0200', 'A0030', 'A0040', 'A0012', 'A0033', 'A0170', 'A0180', 'A0230', 'A1000', 'A1250', 'A1260', 'A1300', 'A1750')
                               )
                         WHERE 1=1
                           AND (OPER <> 'C-Mold' OR (OPER = 'C-Mold' AND C_MOLD IS NOT NULL))
                         UNION ALL
                        SELECT PLAN_DATE
                             , 'CHIP수' AS GUBUN2
                             , FAMILY AS GUBUN3
                             , SUM(PLAN_QTY * STACK) AS PLAN_QTY
                             , SUM(PLAN_QTY * STACK) AS CONV_QTY
                          FROM (
                                SELECT DISTINCT A.PLAN_DATE, A.MAT_KEY, A.STACK, A.PLAN_QTY 
                                     , (SELECT DATA_2 FROM MGCMTBLDAT WHERE FACTORY = 'HMVA2' AND TABLE_NAME = 'H_FAMILY' AND KEY_1 = A.MAT_GRP_2) AS FAMILY
                                  FROM (
                                        SELECT A.PLAN_DATE, A.MAT_KEY, A.MAT_ID, TO_NUMBER(PLAN_QTY) AS PLAN_QTY
                                             , B.MAT_GRP_1, B.MAT_GRP_2, B.MAT_GRP_4, B.MAT_GRP_5
                                             , TO_NUMBER(DECODE(B.MAT_GRP_6, '-', 1, ' ', 1, B.MAT_GRP_6)) AS MAT_GRP_6
                                             , B.MAT_CMF_11, TO_NUMBER(DECODE(B.MAT_CMF_13,' ',1,B.MAT_CMF_13)) AS MAT_CMF_13
                                             , CASE WHEN B.MAT_GRP_4 IN ('-', 'FD', 'FU') THEN '1'
                                                    ELSE SUBSTR(B.MAT_GRP_4, 3) 
                                               END AS STACK
                                             , B.OPER
                                          FROM (
                                                SELECT DISTINCT A.PLAN_MONTH AS PLAN_DATE
                                                     , CASE WHEN B.MAT_ID IS NULL THEN A.MAT_ID ELSE B.MCP_TO_PART END AS MAT_KEY
                                                     , CASE WHEN B.MAT_ID IS NULL THEN A.MAT_ID ELSE B.MAT_ID END AS MAT_ID
                                                     , A.RESV_FIELD1 AS PLAN_QTY
                                                  FROM CWIPPLNMON A
                                                     , RWIPMCPBOM B
                                                 WHERE 1=1   
                                                   AND A.MAT_ID = B.MCP_TO_PART(+)
                                                   AND A.FACTORY = 'HMVA2'   
                                                   AND A.PLAN_MONTH BETWEEN '202001' AND '202004'
                                                   AND DECODE(A.RESV_FIELD1, ' ', 0, A.RESV_FIELD1) > 0
                                               ) A
                                             , (
                                                SELECT DISTINCT MAT_ID, MAT_GRP_1, MAT_GRP_2, MAT_GRP_4, MAT_GRP_5, MAT_GRP_6, MAT_CMF_11, MAT_CMF_13, KTSCH AS OPER
                                                  FROM MWIPMATDEF MAT
                                                     , ZHPPT120@SAPREAL SAP
                                                 WHERE 1=1
                                                   AND MAT.FIRST_FLOW = SUBSTR(PLNNR, 1, 4) 
                                                   AND MAT.FACTORY = 'HMVA2'
                                                   AND MAT.DELETE_FLAG = ' '
                                                   AND MAT.MAT_TYPE = 'FG'
                                                   AND SAP.ARBPL != 'DUMMY'
                                                   AND SAP.KTSCH LIKE 'A%'
                                               ) B   
                                         WHERE 1=1
                                           AND A.MAT_ID = B.MAT_ID
                                           AND (B.OPER IN ('A0010', 'A0200', 'A0030', 'A0040', 'A0012', 'A0033', 'A0170', 'A0180', 'A0230', 'A1250', 'A1260', 'A1300', 'A1750', 'A1000')
                                               OR B.OPER LIKE 'A06%')   
                                       ) A
                               )
                         WHERE 1=1
                           AND FAMILY IN ('Epoxy', 'BOC', 'Others')
                         GROUP BY PLAN_DATE, FAMILY
                         UNION ALL
                        SELECT PLAN_DATE
                             , 'Wire수' AS GUBUN2     
                             , ' ' AS GUBUN3
                             , PLAN_QTY
                             , PLAN_QTY * NVL(WIRE_QTY, MAT_GRP_6) AS CONV_QTY
                          FROM (
                                SELECT PLAN_DATE
                                     , OPER
                                     , PLAN_QTY
                                     , MAT_ID
                                     , MAT_GRP_6
                                     , (SELECT MAX(TO_NUMBER(TCD_CMF_2)) FROM CWIPTCDDEF@RPTTOMES WHERE FACTORY = 'HMVA2' AND SET_FLAG = 'Y' AND TCD_CMF_2 <> ' ' AND MAT_ID = A.MAT_ID AND OPER = A.OPER) AS WIRE_QTY
                                  FROM (
                                        SELECT A.PLAN_DATE, A.MAT_KEY, A.MAT_ID, TO_NUMBER(PLAN_QTY) AS PLAN_QTY
                                             , B.MAT_GRP_1, B.MAT_GRP_2, B.MAT_GRP_4, B.MAT_GRP_5
                                             , TO_NUMBER(DECODE(B.MAT_GRP_6, '-', 1, ' ', 1, B.MAT_GRP_6)) AS MAT_GRP_6
                                             , B.MAT_CMF_11, TO_NUMBER(DECODE(B.MAT_CMF_13,' ',1,B.MAT_CMF_13)) AS MAT_CMF_13
                                             , CASE WHEN B.MAT_GRP_4 IN ('-', 'FD', 'FU') THEN '1'
                                                    ELSE SUBSTR(B.MAT_GRP_4, 3) 
                                               END AS STACK
                                             , B.OPER
                                          FROM (
                                                SELECT DISTINCT A.PLAN_MONTH AS PLAN_DATE
                                                     , CASE WHEN B.MAT_ID IS NULL THEN A.MAT_ID ELSE B.MCP_TO_PART END AS MAT_KEY
                                                     , CASE WHEN B.MAT_ID IS NULL THEN A.MAT_ID ELSE B.MAT_ID END AS MAT_ID
                                                     , A.RESV_FIELD1 AS PLAN_QTY
                                                  FROM CWIPPLNMON A
                                                     , RWIPMCPBOM B
                                                 WHERE 1=1   
                                                   AND A.MAT_ID = B.MCP_TO_PART(+)
                                                   AND A.FACTORY = 'HMVA2'   
                                                   AND A.PLAN_MONTH BETWEEN '202001' AND '202004'
                                                   AND DECODE(A.RESV_FIELD1, ' ', 0, A.RESV_FIELD1) > 0
                                               ) A
                                             , (
                                                SELECT DISTINCT MAT_ID, MAT_GRP_1, MAT_GRP_2, MAT_GRP_4, MAT_GRP_5, MAT_GRP_6, MAT_CMF_11, MAT_CMF_13, KTSCH AS OPER
                                                  FROM MWIPMATDEF MAT
                                                     , ZHPPT120@SAPREAL SAP
                                                 WHERE 1=1
                                                   AND MAT.FIRST_FLOW = SUBSTR(PLNNR, 1, 4) 
                                                   AND MAT.FACTORY = 'HMVA2'
                                                   AND MAT.DELETE_FLAG = ' '
                                                   AND MAT.MAT_TYPE = 'FG'
                                                   AND SAP.ARBPL != 'DUMMY'
                                                   AND SAP.KTSCH LIKE 'A%'
                                               ) B   
                                         WHERE 1=1
                                           AND A.MAT_ID = B.MAT_ID
                                           AND (B.OPER IN ('A0010', 'A0200', 'A0030', 'A0040', 'A0012', 'A0033', 'A0170', 'A0180', 'A0230', 'A1250', 'A1260', 'A1300', 'A1750', 'A1000')
                                               OR B.OPER LIKE 'A06%')   
                                       ) A
                                 WHERE 1=1
                                   AND OPER LIKE 'A06%'
                               )
                         UNION ALL
                        SELECT PLAN_DATE
                             , '95mm' AS GUBUN2
                             , CASE WHEN OPER = 'A1000' THEN 'Mold'
                                    WHEN OPER = 'A1300' THEN 'SBA'
                                    ELSE 'SST'
                               END GUBUN3
                             , SUM(PLAN_QTY) AS PLAN_QTY
                             , SUM(PLAN_QTY) AS CONV_QTY
                          FROM (
                                        SELECT A.PLAN_DATE, A.MAT_KEY, A.MAT_ID, TO_NUMBER(PLAN_QTY) AS PLAN_QTY
                                             , B.MAT_GRP_1, B.MAT_GRP_2, B.MAT_GRP_4, B.MAT_GRP_5
                                             , TO_NUMBER(DECODE(B.MAT_GRP_6, '-', 1, ' ', 1, B.MAT_GRP_6)) AS MAT_GRP_6
                                             , B.MAT_CMF_11, TO_NUMBER(DECODE(B.MAT_CMF_13,' ',1,B.MAT_CMF_13)) AS MAT_CMF_13
                                             , CASE WHEN B.MAT_GRP_4 IN ('-', 'FD', 'FU') THEN '1'
                                                    ELSE SUBSTR(B.MAT_GRP_4, 3) 
                                               END AS STACK
                                             , B.OPER
                                          FROM (
                                                SELECT DISTINCT A.PLAN_MONTH AS PLAN_DATE
                                                     , CASE WHEN B.MAT_ID IS NULL THEN A.MAT_ID ELSE B.MCP_TO_PART END AS MAT_KEY
                                                     , CASE WHEN B.MAT_ID IS NULL THEN A.MAT_ID ELSE B.MAT_ID END AS MAT_ID
                                                     , A.RESV_FIELD1 AS PLAN_QTY
                                                  FROM CWIPPLNMON A
                                                     , RWIPMCPBOM B
                                                 WHERE 1=1   
                                                   AND A.MAT_ID = B.MCP_TO_PART(+)
                                                   AND A.FACTORY = 'HMVA2'   
                                                   AND A.PLAN_MONTH BETWEEN '202001' AND '202004'
                                                   AND DECODE(A.RESV_FIELD1, ' ', 0, A.RESV_FIELD1) > 0
                                               ) A
                                             , (
                                                SELECT DISTINCT MAT_ID, MAT_GRP_1, MAT_GRP_2, MAT_GRP_4, MAT_GRP_5, MAT_GRP_6, MAT_CMF_11, MAT_CMF_13, KTSCH AS OPER
                                                  FROM MWIPMATDEF MAT
                                                     , ZHPPT120@SAPREAL SAP
                                                 WHERE 1=1
                                                   AND MAT.FIRST_FLOW = SUBSTR(PLNNR, 1, 4) 
                                                   AND MAT.FACTORY = 'HMVA2'
                                                   AND MAT.DELETE_FLAG = ' '
                                                   AND MAT.MAT_TYPE = 'FG'
                                                   AND SAP.ARBPL != 'DUMMY'
                                                   AND SAP.KTSCH LIKE 'A%'
                                               ) B   
                                         WHERE 1=1
                                           AND A.MAT_ID = B.MAT_ID
                                           AND (B.OPER IN ('A0010', 'A0200', 'A0030', 'A0040', 'A0012', 'A0033', 'A0170', 'A0180', 'A0230', 'A1250', 'A1260', 'A1300', 'A1750', 'A1000')
                                               OR B.OPER LIKE 'A06%')   
                                       ) A
                             , (
                                SELECT * 
                                  FROM MATRNAMSTS@RPTTOMES 
                                 WHERE FACTORY = 'HMVA2'
                                   AND ATTR_TYPE = 'MAT_ETC'
                                   AND ATTR_NAME = 'MAGAZINE_TYPE' 
                                   AND ATTR_VALUE = '95'
                               ) B
                         WHERE 1=1
                           AND A.MAT_ID = B.ATTR_KEY
                           AND A.OPER IN ('A1000', 'A1300', 'A1750')
                         GROUP BY PLAN_DATE, OPER
                       )
                 GROUP BY GUBUN2, GUBUN3
               )
       ) PLN
 WHERE 1=1
   AND MDL.GUBUN1 = PLN.GUBUN1(+)   
   AND MDL.GUBUN2 = PLN.GUBUN2(+)   
   AND MDL.GUBUN3 = PLN.GUBUN3(+)   
 ORDER BY GUBUN1, DECODE(GUBUN2, 'Wafer', 1, 'CHIP수', 2, 'Wire수', 3, 'PKG수', 4, 5), GUBUN3

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
SELECT MIN(SYS_DATE) AS START_DAY 
     , MAX(SYS_DATE) AS END_DAY 
     , PLAN_YEAR||DECODE(LENGTH(PLAN_WEEK), 1, '0'||PLAN_WEEK, PLAN_WEEK) AS WEEK
  FROM MWIPCALDEF 
 WHERE CALENDAR_ID = 'OTD'
   AND (PLAN_YEAR || LPAD(PLAN_WEEK,2,'0')) IN ( 
                                                SELECT WW
                                                  FROM (
                                                        SELECT WW
                                                             , ROW_NUMBER() OVER(ORDER BY WW) AS RNK
                                                          FROM (
                                                                SELECT DISTINCT PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') AS WW
                                                                  FROM MWIPCALDEF
                                                                 WHERE CALENDAR_ID = 'OTD'
                                                                   AND PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') >= (
                                                                                                              SELECT MAX(PLAN_YEAR || LPAD(PLAN_WEEK,2,'0')) AS WW
                                                                                                                FROM MWIPCALDEF
                                                                                                               WHERE CALENDAR_ID = 'OTD'
                                                                                                                 AND PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') < (SELECT PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') AS WW FROM MWIPCALDEF WHERE CALENDAR_ID = 'OTD' AND SYS_DATE = '20200427')
                                                                                                                 AND SYS_DATE >= TO_CHAR(TO_DATE('20200427', 'YYYYMMDD')-14, 'YYYYMMDD')
                                                                                                             )
                                                               ) 
                                                       )
                                                 WHERE RNK <= 7
                                               ) 
 GROUP BY PLAN_YEAR, PLAN_WEEK 
 ORDER BY PLAN_YEAR, PLAN_WEEK

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT MIN(SYS_DATE) AS START_DAY 
     , MAX(SYS_DATE) AS END_DAY 
     , PLAN_YEAR||DECODE(LENGTH(PLAN_WEEK), 1, '0'||PLAN_WEEK, PLAN_WEEK) AS WEEK
  FROM MWIPCALDEF 
 WHERE CALENDAR_ID = 'SE'
   AND (PLAN_YEAR || LPAD(PLAN_WEEK,2,'0')) IN ( 
                                                SELECT WW
                                                  FROM (
                                                        SELECT WW
                                                             , ROW_NUMBER() OVER(ORDER BY WW) AS RNK
                                                          FROM (
                                                                SELECT DISTINCT PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') AS WW
                                                                  FROM MWIPCALDEF
                                                                 WHERE CALENDAR_ID = 'SE'
                                                                   AND PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') >= (
                                                                                                              SELECT MAX(PLAN_YEAR || LPAD(PLAN_WEEK,2,'0')) AS WW
                                                                                                                FROM MWIPCALDEF
                                                                                                               WHERE CALENDAR_ID = 'SE'
                                                                                                                 AND PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') < (SELECT PLAN_YEAR || LPAD(PLAN_WEEK,2,'0') AS WW FROM MWIPCALDEF WHERE CALENDAR_ID = 'SE' AND SYS_DATE = '20200427')
                                                                                                                 AND SYS_DATE >= TO_CHAR(TO_DATE('20200427', 'YYYYMMDD')-14, 'YYYYMMDD')
                                                                                                             )
                                                               ) 
                                                       )
                                                 WHERE RNK <= 7
                                               ) 
 GROUP BY PLAN_YEAR, PLAN_WEEK 
 ORDER BY PLAN_YEAR, PLAN_WEEK

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT CUSTOMER,  ' ', MAT_GRP_2, MAT_GRP_3, MAT_GRP_4,  ' ', MAT_GRP_6,  ' ',  ' ',  ' ', CONV_MAT_ID,  ' ',  ' ',  ' ' 
     , WEEK_PLAN, SHP_WEEK, WEEK_DEF, REMAIN_MOLD, REMAIN_WB, REMAIN_DA, REMAIN_BG, REMAIN_INPUT, REMAIN_WF, DA_CAPA, WB_CAPA
     , D0_PLAN2, D0_DEF, SHP_TODAY, HMK3A, QC_GATE, PVI, BAKE, AVI, DC2, DC1, SIG, SBA, TRIM, MK, TIN, CURE, MOLD, PLASMA, GATE
     , WB9, DA9, WB8, DA8, WB7, DA7, WB6, DA6, WB5, DA5, WB4, DA4, WB3, DA3, WB2, DA2, WB1, DA1, SP, SAW, BG, HMK2A
     , D0_PLAN, D1_PLAN, D2_PLAN, D3_PLAN, D4_PLAN, DA1_CAPA, WB1_CAPA, DA2_CAPA, WB2_CAPA, DA3_CAPA, WB3_CAPA, DA4_CAPA, WB4_CAPA, DA5_CAPA, WB5_CAPA
     , DA6_CAPA, WB6_CAPA, DA7_CAPA, WB7_CAPA, DA8_CAPA, WB8_CAPA, DA9_CAPA, WB9_CAPA, WEEK2_PLAN, WEEK3_PLAN, WEEK4_PLAN, WEEK5_PLAN, ORI_PLAN, SHP_MONTH, MONTH_DEF, REV_PLAN, PER
  FROM(
SELECT (SELECT DATA_1 FROM MGCMTBLDAT WHERE TABLE_NAME = 'H_CUSTOMER' AND KEY_1 = MAT.MAT_GRP_1 AND ROWNUM=1) AS CUSTOMER,  ' ', MAT.MAT_GRP_2, MAT.MAT_GRP_3, MAT.MAT_GRP_4,  ' ', MAT.MAT_GRP_6,  ' ',  ' ',  ' ', MAT.CONV_MAT_ID,  ' ',  ' ',  ' ' 
     , ROUND(SUM(NVL(WEEK1_PLAN, 0)) / 1, 0) AS WEEK_PLAN
     , ROUND(SUM(NVL(SHP_WEEK, 0)) / 1, 0) AS SHP_WEEK
     , CASE WHEN SUM(NVL(WEEK1_PLAN, 0) - NVL(SHP_WEEK, 0)) < 0 THEN 0
            ELSE ROUND(SUM(NVL(WEEK1_PLAN, 0) - NVL(SHP_WEEK, 0)) / 1, 0) END AS WEEK_DEF
     , CASE WHEN SUM(NVL(WEEK1_PLAN, 0) - NVL(SHP_WEEK, 0) - NVL(W_MOLD, 0)) < 0 THEN 0 
            ELSE ROUND(SUM(NVL(WEEK1_PLAN, 0) - NVL(SHP_WEEK, 0) - NVL(W_MOLD, 0)) / 1, 0) END AS REMAIN_MOLD
     , CASE WHEN SUM(NVL(WEEK1_PLAN, 0) - NVL(SHP_WEEK, 0) - NVL(W_WB, 0)) < 0 THEN 0
            ELSE ROUND(SUM(NVL(WEEK1_PLAN, 0) - NVL(SHP_WEEK, 0) - NVL(W_WB, 0)) / 1, 0) END AS REMAIN_WB
     , CASE WHEN SUM(NVL(WEEK1_PLAN, 0) - NVL(SHP_WEEK, 0) - NVL(W_DA, 0)) < 0 THEN 0
            ELSE ROUND(SUM(NVL(WEEK1_PLAN, 0) - NVL(SHP_WEEK, 0) - NVL(W_DA, 0)) / 1, 0) END AS REMAIN_DA
     , CASE WHEN SUM(NVL(WEEK1_PLAN, 0) - NVL(SHP_WEEK, 0) - NVL(W_BG, 0)) < 0 THEN 0
            ELSE ROUND(SUM(NVL(WEEK1_PLAN, 0) - NVL(SHP_WEEK, 0) - NVL(W_BG, 0)) / 1, 0) END AS REMAIN_BG
     , CASE WHEN SUM(NVL(WEEK1_PLAN, 0) - NVL(SHP_WEEK, 0) - NVL(W_ISSUE, 0)) < 0 THEN 0
            ELSE ROUND(SUM(NVL(WEEK1_PLAN, 0) - NVL(SHP_WEEK, 0) - NVL(W_ISSUE, 0)) / 1, 0) END AS REMAIN_INPUT
     , CASE WHEN SUM(NVL(WEEK1_PLAN, 0) - NVL(SHP_WEEK, 0) - NVL(TOTAL, 0)) < 0 THEN 0
            ELSE ROUND(SUM(NVL(WEEK1_PLAN, 0) - NVL(SHP_WEEK, 0) - NVL(TOTAL, 0)) / 1, 0) END AS REMAIN_WF
     , ROUND(SUM(NVL(DA_CAPA, 0)) / 1, 0) AS DA_CAPA
     , ROUND(SUM(NVL(WB_CAPA, 0)) / 1, 0) AS WB_CAPA
     , CASE WHEN SUM(NVL(D0_PLAN, 0) + (NVL(WEEK1_TTL, 0) - NVL(SHP_WEEK_TTL, 0))) < 0 THEN 0
            ELSE ROUND(SUM(NVL(D0_PLAN, 0) + (NVL(WEEK1_TTL, 0) - NVL(SHP_WEEK_TTL, 0))) / 1, 0) END AS D0_PLAN2
     , CASE WHEN SUM(NVL(D0_PLAN, 0) + (NVL(WEEK1_TTL, 0) - NVL(SHP_WEEK_TTL, 0)) - NVL(SHP_TODAY, 0)) < 0 THEN 0
            ELSE ROUND(SUM(NVL(D0_PLAN, 0) + (NVL(WEEK1_TTL, 0) - NVL(SHP_WEEK_TTL, 0)) - NVL(SHP_TODAY, 0)) / 1, 0) END AS D0_DEF
     , ROUND(SUM(NVL(SHP_TODAY, 0)) / 1, 0) AS SHP_TODAY
     , ROUND(SUM(NVL(WIP.HMK3A, 0)) / 1, 0) AS HMK3A
     , ROUND(SUM(NVL(WIP.QC_GATE, 0)) / 1, 0) AS QC_GATE
     , ROUND(SUM(NVL(WIP.PVI, 0)) / 1, 0) AS PVI
     , ROUND(SUM(NVL(WIP.BAKE,0)) / 1, 0) AS BAKE
     , ROUND(SUM(NVL(WIP.AVI,0)) / 1, 0) AS AVI
     , ROUND(SUM(NVL(WIP.DC2,0)) / 1, 0) AS DC2
     , ROUND(SUM(NVL(WIP.DC1,0)) / 1, 0) AS DC1
     , ROUND(SUM(NVL(WIP.SIG,0)) / 1, 0) AS SIG
     , ROUND(SUM(NVL(WIP.SBA,0)) / 1, 0) AS SBA
     , ROUND(SUM(NVL(WIP.TIN,0)) / 1, 0) AS TIN
     , ROUND(SUM(NVL(WIP.TRIM,0)) / 1, 0) AS TRIM
     , ROUND(SUM(NVL(WIP.MK,0)) / 1, 0) AS MK
     , ROUND(SUM(NVL(WIP.CURE,0)) / 1, 0) AS CURE
     , ROUND(SUM(NVL(WIP.MOLD,0)) / 1, 0) AS MOLD
     , ROUND(SUM(NVL(WIP.PLASMA,0)) / 1, 0) AS PLASMA
     , ROUND(SUM(NVL(WIP.GATE,0)) / 1, 0) AS GATE
     , ROUND(SUM(NVL(WIP.WB9,0)) / 1, 0) AS WB9
     , ROUND(SUM(NVL(WIP.DA9,0)) / 1, 0) AS DA9
     , ROUND(SUM(NVL(WIP.WB8,0)) / 1, 0) AS WB8
     , ROUND(SUM(NVL(WIP.DA8,0)) / 1, 0) AS DA8
     , ROUND(SUM(NVL(WIP.WB7,0)) / 1, 0) AS WB7
     , ROUND(SUM(NVL(WIP.DA7,0)) / 1, 0) AS DA7
     , ROUND(SUM(NVL(WIP.WB6,0)) / 1, 0) AS WB6
     , ROUND(SUM(NVL(WIP.DA6,0)) / 1, 0) AS DA6
     , ROUND(SUM(NVL(WIP.WB5,0)) / 1, 0) AS WB5
     , ROUND(SUM(NVL(WIP.DA5,0)) / 1, 0) AS DA5
     , ROUND(SUM(NVL(WIP.WB4,0)) / 1, 0) AS WB4
     , ROUND(SUM(NVL(WIP.DA4,0)) / 1, 0) AS DA4
     , ROUND(SUM(NVL(WIP.WB3,0)) / 1, 0) AS WB3
     , ROUND(SUM(NVL(WIP.DA3,0)) / 1, 0) AS DA3
     , ROUND(SUM(NVL(WIP.WB2,0)) / 1, 0) AS WB2
     , ROUND(SUM(NVL(WIP.DA2,0)) / 1, 0) AS DA2
     , ROUND(SUM(NVL(WIP.WB1,0)) / 1, 0) AS WB1
     , ROUND(SUM(NVL(WIP.DA1,0)) / 1, 0) AS DA1
     , ROUND(SUM(NVL(WIP.SP,0)) / 1, 0) AS SP
     , ROUND(SUM(NVL(WIP.SAW,0)) / 1, 0) AS SAW
     , ROUND(SUM(NVL(WIP.BG,0)) / 1, 0) AS BG
     , ROUND(SUM(NVL(WIP.HMK2A,0)) / 1, 0) AS HMK2A
     , ROUND(SUM(NVL(D0_PLAN, 0) + (NVL(WEEK1_TTL, 0) - NVL(SHP_WEEK_TTL, 0))) / 1, 0) AS D0_PLAN
     , ROUND(SUM(NVL(D1_PLAN, 0)) / 1, 0) AS D1_PLAN
     , ROUND(SUM(NVL(D2_PLAN, 0)) / 1, 0) AS D2_PLAN
     , ROUND(SUM(NVL(D3_PLAN, 0)) / 1, 0) AS D3_PLAN
     , ROUND(SUM(NVL(D4_PLAN, 0)) / 1, 0) AS D4_PLAN
     , ROUND(SUM(NVL(DA1_CAPA, 0)) / 1, 0) AS DA1_CAPA
     , ROUND(SUM(NVL(WB1_CAPA, 0)) / 1, 0) AS WB1_CAPA
     , ROUND(SUM(NVL(DA2_CAPA, 0)) / 1, 0) AS DA2_CAPA
     , ROUND(SUM(NVL(WB2_CAPA, 0)) / 1, 0) AS WB2_CAPA
     , ROUND(SUM(NVL(DA3_CAPA, 0)) / 1, 0) AS DA3_CAPA
     , ROUND(SUM(NVL(WB3_CAPA, 0)) / 1, 0) AS WB3_CAPA
     , ROUND(SUM(NVL(DA4_CAPA, 0)) / 1, 0) AS DA4_CAPA
     , ROUND(SUM(NVL(WB4_CAPA, 0)) / 1, 0) AS WB4_CAPA
     , ROUND(SUM(NVL(DA5_CAPA, 0)) / 1, 0) AS DA5_CAPA
     , ROUND(SUM(NVL(WB5_CAPA, 0)) / 1, 0) AS WB5_CAPA
     , ROUND(SUM(NVL(DA6_CAPA, 0)) / 1, 0) AS DA6_CAPA
     , ROUND(SUM(NVL(WB6_CAPA, 0)) / 1, 0) AS WB6_CAPA
     , ROUND(SUM(NVL(DA7_CAPA, 0)) / 1, 0) AS DA7_CAPA
     , ROUND(SUM(NVL(WB7_CAPA, 0)) / 1, 0) AS WB7_CAPA
     , ROUND(SUM(NVL(DA8_CAPA, 0)) / 1, 0) AS DA8_CAPA
     , ROUND(SUM(NVL(WB8_CAPA, 0)) / 1, 0) AS WB8_CAPA
     , ROUND(SUM(NVL(DA9_CAPA, 0)) / 1, 0) AS DA9_CAPA
     , ROUND(SUM(NVL(WB9_CAPA, 0)) / 1, 0) AS WB9_CAPA
     , ROUND(SUM(NVL(WEEK2_PLAN, 0)) / 1, 0) AS WEEK2_PLAN
     , ROUND(SUM(NVL(WEEK3_PLAN, 0)) / 1, 0) AS WEEK3_PLAN
     , ROUND(SUM(NVL(WEEK4_PLAN, 0)) / 1, 0) AS WEEK4_PLAN
     , ROUND(SUM(NVL(WEEK5_PLAN, 0)) / 1, 0) AS WEEK5_PLAN
     , ROUND(SUM(NVL(ORI_PLAN, 0)) / 1, 0) AS ORI_PLAN
     , ROUND(SUM(NVL(SHP_MONTH, 0)) / 1, 0) AS SHP_MONTH
     , ROUND(SUM(NVL(ORI_PLAN, 0) - NVL(SHP_MONTH, 0)) / 1, 0) AS MONTH_DEF
     , ROUND(SUM(NVL(REV_PLAN, 0)) / 1, 0) AS REV_PLAN
     , CASE WHEN SUM(NVL(ORI_PLAN, 0)) = 0 THEN 0
            ELSE ROUND(SUM(NVL(REV_PLAN, 0)) / SUM(NVL(ORI_PLAN, 0)) * 100, 0)
       END PER
     , ROUND(SUM(NVL(W_MOLD, 0)) / 1, 0) AS W_MOLD 
     , ROUND(SUM(NVL(W_WB, 0)) / 1, 0) AS W_WB
     , ROUND(SUM(NVL(W_DA, 0)) / 1, 0) AS W_DA
     , ROUND(SUM(NVL(W_BG, 0)) / 1, 0) AS W_BG
     , ROUND(SUM(NVL(W_ISSUE, 0)) / 1, 0) AS W_ISSUE
     , ROUND(SUM(NVL(TOTAL, 0)) / 1, 0) AS TOTAL
  FROM (
        SELECT MAT_GRP_1, MAT_GRP_2, MAT_GRP_3, MAT_GRP_4, MAT_GRP_5, MAT_GRP_6
             , MAT_GRP_7, MAT_GRP_8, MAT_GRP_9, MAT_GRP_10, MAT_CMF_7, MAT_CMF_10, MAT_ID, MAT_CMF_11
             , CASE WHEN MAT_GRP_9 = 'MEMORY' AND MAT_GRP_1 = 'HX' AND INSTR(MAT_ID, '_') = 0 THEN SUBSTR(MAT_ID, 1, 12) || '%' || SUBSTR(MAT_ID, -3)
                    WHEN MAT_GRP_9 = 'MEMORY' AND MAT_GRP_1 = 'HX' AND INSTR(MAT_ID, '_') > 0 THEN SUBSTR(MAT_ID, 1, INSTR(MAT_ID, '_')) || '%' || SUBSTR(MAT_ID, -3)
                    WHEN MAT_GRP_9 = 'MEMORY' AND MAT_GRP_1 = 'SE' THEN 'SEK_________-___' || SUBSTR(MAT_ID, -3)
                    ELSE MAT_ID
               END CONV_MAT_ID
             , VENDOR_ID AS SAP_CODE
          FROM MWIPMATDEF
         WHERE FACTORY = 'HMVA2'
           AND MAT_TYPE = 'FG' 
           AND DELETE_FLAG = ' ' 
           AND (MAT_GRP_5 IN ('1st','Merge', '-') OR MAT_GRP_5 LIKE 'Middle%') 
           AND MAT_GRP_3 <> 'COB' 
           AND MAT_ID LIKE 'SEK%'
       ) MAT 
     , ( 
        SELECT FACTORY, MAT_ID 
             , SUM(CASE WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 1 THEN D0_QTY
                        WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 2 THEN D0_QTY + D1_QTY
                        WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 3 THEN D0_QTY + D1_QTY + D2_QTY
                        WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 4 THEN D0_QTY + D1_QTY + D2_QTY + D3_QTY
                        WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 5 THEN D0_QTY + D1_QTY + D2_QTY + D3_QTY + D4_QTY
                        WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 6 THEN D0_QTY + D1_QTY + D2_QTY + D3_QTY + D4_QTY + D5_QTY
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 3 THEN D0_QTY 
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 4 THEN D0_QTY + D1_QTY 
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 5 THEN D0_QTY + D1_QTY + D2_QTY 
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 6 THEN D0_QTY + D1_QTY + D2_QTY + D3_QTY 
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 7 THEN D0_QTY + D1_QTY + D2_QTY + D3_QTY + D4_QTY 
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 1 THEN D0_QTY + D1_QTY + D2_QTY + D3_QTY + D4_QTY + D5_QTY 
                        ELSE 0
                   END) AS WEEK1_TTL 
             , SUM(W1_QTY) AS WEEK1_PLAN 
             , SUM(W2_QTY) AS WEEK2_PLAN 
             , SUM(W3_QTY) AS WEEK3_PLAN 
             , SUM(W4_QTY) AS WEEK4_PLAN 
             , SUM(W5_QTY) AS WEEK5_PLAN 
             , SUM(NVL(W1_QTY,0) + NVL(W2_QTY,0)) AS WEEK_TTL 
             , SUM(CASE WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 7 THEN D0_QTY
                        WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 1 THEN D1_QTY
                        WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 2 THEN D2_QTY
                        WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 3 THEN D3_QTY
                        WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 4 THEN D4_QTY
                        WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 5 THEN D5_QTY
                        WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 6 THEN D6_QTY
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 2 THEN D0_QTY 
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 3 THEN D1_QTY 
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 4 THEN D2_QTY 
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 5 THEN D3_QTY 
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 6 THEN D4_QTY 
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 7 THEN D5_QTY 
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 1 THEN D6_QTY 
                        ELSE 0
                   END) AS D0_PLAN 
             , SUM(CASE WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 7 THEN D1_QTY
                        WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 1 THEN D2_QTY
                        WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 2 THEN D3_QTY
                        WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 3 THEN D4_QTY
                        WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 4 THEN D5_QTY
                        WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 5 THEN D6_QTY
                        WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 6 THEN D7_QTY
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 2 THEN D1_QTY 
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 3 THEN D2_QTY 
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 4 THEN D3_QTY 
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 5 THEN D4_QTY 
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 6 THEN D5_QTY 
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 7 THEN D6_QTY 
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 1 THEN D7_QTY 
                        ELSE 0
                   END) AS D1_PLAN 
             , SUM(CASE WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 7 THEN D2_QTY
                        WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 1 THEN D3_QTY
                        WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 2 THEN D4_QTY
                        WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 3 THEN D5_QTY
                        WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 4 THEN D6_QTY
                        WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 5 THEN D7_QTY
                        WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 6 THEN D8_QTY
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 2 THEN D2_QTY 
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 3 THEN D3_QTY 
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 4 THEN D4_QTY 
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 5 THEN D5_QTY 
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 6 THEN D6_QTY 
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 7 THEN D7_QTY 
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 1 THEN D8_QTY 
                        ELSE 0
                   END) AS D2_PLAN 
             , SUM(CASE WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 7 THEN D3_QTY
                        WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 1 THEN D4_QTY
                        WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 2 THEN D5_QTY
                        WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 3 THEN D6_QTY
                        WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 4 THEN D7_QTY
                        WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 5 THEN D8_QTY
                        WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 6 THEN D9_QTY
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 2 THEN D3_QTY 
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 3 THEN D4_QTY 
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 4 THEN D5_QTY 
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 5 THEN D6_QTY 
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 6 THEN D7_QTY 
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 7 THEN D8_QTY 
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 1 THEN D9_QTY 
                        ELSE 0
                   END) AS D3_PLAN 
             , SUM(CASE WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 7 THEN D4_QTY
                        WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 1 THEN D5_QTY
                        WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 2 THEN D6_QTY
                        WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 3 THEN D7_QTY
                        WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 4 THEN D8_QTY
                        WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 5 THEN D9_QTY
                        WHEN CALENDAR_ID = 'OTD' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 6 THEN D10_QTY
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 2 THEN D4_QTY 
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 3 THEN D5_QTY 
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 4 THEN D6_QTY 
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 5 THEN D7_QTY 
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 6 THEN D8_QTY 
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 7 THEN D9_QTY 
                        WHEN CALENDAR_ID = 'SE' AND TO_CHAR(TO_DATE('20200427', 'YYYYMMDD'), 'D') = 1 THEN D10_QTY 
                        ELSE 0
                   END) AS D4_PLAN 
          FROM ( 
                SELECT FACTORY, MAT_ID, 'OTD' AS CALENDAR_ID 
                     , SUM(DECODE(PLAN_WEEK, '202018', D0_QTY, 0)) AS D0_QTY 
                     , SUM(DECODE(PLAN_WEEK, '202018', D1_QTY, 0)) AS D1_QTY 
                     , SUM(DECODE(PLAN_WEEK, '202018', D2_QTY, 0)) AS D2_QTY 
                     , SUM(DECODE(PLAN_WEEK, '202018', D3_QTY, 0)) AS D3_QTY 
                     , SUM(DECODE(PLAN_WEEK, '202018', D4_QTY, 0)) AS D4_QTY 
                     , SUM(DECODE(PLAN_WEEK, '202018', D5_QTY, 0)) AS D5_QTY 
                     , SUM(DECODE(PLAN_WEEK, '202018', D6_QTY, 0)) AS D6_QTY 
                     , SUM(DECODE(PLAN_WEEK, '202019', D0_QTY, 0)) AS D7_QTY 
                     , SUM(DECODE(PLAN_WEEK, '202019', D1_QTY, 0)) AS D8_QTY 
                     , SUM(DECODE(PLAN_WEEK, '202019', D2_QTY, 0)) AS D9_QTY 
                     , SUM(DECODE(PLAN_WEEK, '202019', D3_QTY, 0)) AS D10_QTY 
                     , SUM(DECODE(PLAN_WEEK, '202019', D4_QTY, 0)) AS D11_QTY 
                     , SUM(DECODE(PLAN_WEEK, '202019', D5_QTY, 0)) AS D12_QTY 
                     , SUM(DECODE(PLAN_WEEK, '202019', D6_QTY, 0)) AS D13_QTY 
                     , SUM(DECODE(PLAN_WEEK, '202018', WW_QTY, 0)) AS W1_QTY 
                     , SUM(DECODE(PLAN_WEEK, '202019', WW_QTY, 0)) AS W2_QTY 
                     , SUM(DECODE(PLAN_WEEK, '202020', WW_QTY, 0)) AS W3_QTY 
                     , SUM(DECODE(PLAN_WEEK, '202021', WW_QTY, 0)) AS W4_QTY 
                     , SUM(DECODE(PLAN_WEEK, '202022', WW_QTY, 0)) AS W5_QTY 
                  FROM RWIPPLNWEK 
                 WHERE 1=1 
                   AND FACTORY = 'HMVA2' 
                   AND GUBUN = '3' 
                   AND MAT_ID NOT LIKE 'SES%' 
                   AND PLAN_WEEK IN ('202018','202019','202020','202021','202022')
                 GROUP BY FACTORY, MAT_ID 
                 UNION ALL 
                SELECT FACTORY, MAT_ID, 'SE' AS CALENDAR_ID 
                     , SUM(DECODE(PLAN_WEEK, '202018', D0_QTY, 0)) AS D0_QTY 
                     , SUM(DECODE(PLAN_WEEK, '202018', D1_QTY, 0)) AS D1_QTY 
                     , SUM(DECODE(PLAN_WEEK, '202018', D2_QTY, 0)) AS D2_QTY 
                     , SUM(DECODE(PLAN_WEEK, '202018', D3_QTY, 0)) AS D3_QTY 
                     , SUM(DECODE(PLAN_WEEK, '202018', D4_QTY, 0)) AS D4_QTY 
                     , SUM(DECODE(PLAN_WEEK, '202018', D5_QTY, 0)) AS D5_QTY 
                     , SUM(DECODE(PLAN_WEEK, '202018', D6_QTY, 0)) AS D6_QTY 
                     , SUM(DECODE(PLAN_WEEK, '202019', D0_QTY, 0)) AS D7_QTY 
                     , SUM(DECODE(PLAN_WEEK, '202019', D1_QTY, 0)) AS D8_QTY 
                     , SUM(DECODE(PLAN_WEEK, '202019', D2_QTY, 0)) AS D9_QTY 
                     , SUM(DECODE(PLAN_WEEK, '202019', D3_QTY, 0)) AS D10_QTY 
                     , SUM(DECODE(PLAN_WEEK, '202019', D4_QTY, 0)) AS D11_QTY 
                     , SUM(DECODE(PLAN_WEEK, '202019', D5_QTY, 0)) AS D12_QTY 
                     , SUM(DECODE(PLAN_WEEK, '202019', D6_QTY, 0)) AS D13_QTY 
                     , SUM(DECODE(PLAN_WEEK, '202018', WW_QTY, 0)) AS W1_QTY 
                     , SUM(DECODE(PLAN_WEEK, '202019', WW_QTY, 0)) AS W2_QTY 
                     , SUM(DECODE(PLAN_WEEK, '202020', WW_QTY, 0)) AS W3_QTY 
                     , SUM(DECODE(PLAN_WEEK, '202021', WW_QTY, 0)) AS W4_QTY 
                     , SUM(DECODE(PLAN_WEEK, '202022', WW_QTY, 0)) AS W5_QTY 
                  FROM RWIPPLNWEK 
                 WHERE 1=1 
                   AND FACTORY = 'HMVA2' 
                   AND GUBUN = '3' 
                   AND MAT_ID LIKE 'SES%' 
                   AND PLAN_WEEK IN ('202018','202019','202020','202021','202022')
                 GROUP BY FACTORY, MAT_ID 
               ) 
         GROUP BY FACTORY, MAT_ID 
       ) PLN 
     , ( 
        SELECT MAT_ID 
             , SUM(CASE WHEN SHP_QTY_1 > 0 AND WORK_DATE = '20200427' THEN NVL(SHP_QTY_1, 0) ELSE 0 END) AS SHP_TODAY 
             , SUM(CASE WHEN SHP_QTY_1 > 0 AND MAT_ID LIKE 'SES%' AND WORK_DATE BETWEEN '20200427' AND '20200427' THEN NVL(SHP_QTY_1, 0)  
                        WHEN SHP_QTY_1 > 0 AND MAT_ID NOT LIKE 'SES%' AND WORK_DATE BETWEEN '20200425' AND '20200427' THEN NVL(SHP_QTY_1, 0) 
                        ELSE 0 END) AS SHP_WEEK  
             , SUM(CASE WHEN SHP_QTY_1 > 0 AND MAT_ID LIKE 'SES%' AND WORK_DATE BETWEEN '20200427' AND '20200426' THEN NVL(SHP_QTY_1, 0) 
                        WHEN SHP_QTY_1 > 0 AND MAT_ID NOT LIKE 'SES%' AND WORK_DATE BETWEEN '20200425' AND '20200426' THEN NVL(SHP_QTY_1, 0) 
                        ELSE 0 END) AS SHP_WEEK_TTL  
             , SUM(CASE WHEN WORK_DATE BETWEEN '20200401' AND '20200427' THEN NVL(SHP_QTY_1, 0) END) AS SHP_MONTH  
          FROM VSUMWIPOUT
         WHERE 1=1 
           AND FACTORY  = 'HMVA2' 
           AND CM_KEY_2 = 'PROD' 
           AND CM_KEY_3 LIKE 'P%' 
           AND LOT_TYPE = 'W' 
           AND MAT_ID NOT LIKE 'HX%' 
           AND WORK_DATE BETWEEN LEAST('20200401', '20200425', '20200427') AND '20200427' 
         GROUP BY MAT_ID 
         UNION ALL 
        SELECT MAT_ID 
             , SUM(CASE WHEN SHP_QTY_1 > 0 AND WORK_DATE = '20200427' THEN NVL(SHP_QTY_1, 0) ELSE 0 END) AS SHP_TODAY 
             , SUM(CASE WHEN SHP_QTY_1 > 0 AND WORK_DATE BETWEEN '20200425' AND '20200427' THEN NVL(SHP_QTY_1, 0) ELSE 0 END) AS SHP_WEEK 
             , SUM(CASE WHEN SHP_QTY_1 > 0 AND WORK_DATE BETWEEN '20200425' AND '20200426' THEN NVL(SHP_QTY_1, 0) ELSE 0 END) AS SHP_WEEK_TTL 
             , SUM(CASE WHEN WORK_DATE BETWEEN '20200401' AND '20200427' THEN NVL(SHP_QTY_1, 0) END) AS SHP_MONTH 
          FROM VSUMWIPOUT_06
         WHERE 1=1 
           AND FACTORY  = 'HMVA2' 
           AND CM_KEY_2 = 'PROD' 
           AND CM_KEY_3 LIKE 'P%' 
           AND LOT_TYPE = 'W' 
           AND MAT_ID LIKE 'HX%' 
           AND WORK_DATE BETWEEN '20200401' AND '20200427' 
         GROUP BY MAT_ID 
       ) SHP 
     , ( 
        SELECT MAT_ID
             , SUM(QTY) TOTAL
             , SUM(DECODE(OPER_GRP_1, 'HMK2A', QTY, 0)) AS HMK2A
             , SUM(DECODE(OPER_GRP_1, 'B/G', QTY, 0)) AS BG
             , SUM(DECODE(OPER_GRP_1, 'SAW', QTY, 0)) AS SAW
             , SUM(DECODE(OPER_GRP_1, 'S/P', QTY, 0)) AS SP
             , SUM(CASE WHEN OPER IN ('A0250','A0310','A0333','A0340','A0401','A0501', 'A0400', 'A0500', 'A0530', 'A0531', 'A0370', 'A0380', 'A0395') THEN QTY 
                        WHEN OPER_GRP_1 = 'SMT' THEN QTY 
                        ELSE 0 END) AS DA1 
             , SUM(CASE WHEN OPER IN ('A0402','A0502', 'A0532') THEN QTY ELSE 0 END) AS DA2 
             , SUM(CASE WHEN OPER IN ('A0403','A0503', 'A0533') THEN QTY ELSE 0 END) AS DA3 
             , SUM(CASE WHEN OPER IN ('A0404','A0504', 'A0534') THEN QTY ELSE 0 END) AS DA4 
             , SUM(CASE WHEN OPER IN ('A0405','A0505', 'A0535') THEN QTY ELSE 0 END) AS DA5 
             , SUM(CASE WHEN OPER IN ('A0406','A0506', 'A0536') THEN QTY ELSE 0 END) AS DA6 
             , SUM(CASE WHEN OPER IN ('A0407','A0507', 'A0537') THEN QTY ELSE 0 END) AS DA7 
             , SUM(CASE WHEN OPER IN ('A0408','A0508', 'A0538') THEN QTY ELSE 0 END) AS DA8 
             , SUM(CASE WHEN OPER IN ('A0409','A0509', 'A0539') THEN QTY ELSE 0 END) AS DA9 
             , SUM(CASE WHEN OPER IN ('A0551', 'A0601', 'A0550', 'A0600') THEN QTY
                        WHEN OPER = 'A0801' AND MAT_GRP_1 = 'SE' AND MAT_GRP_5 <> 'Merge' THEN QTY 
                        WHEN OPER = 'A0801' AND MAT_GRP_1 <> 'SE' THEN QTY 
                        ELSE 0 END) AS WB1 
             , SUM(CASE WHEN OPER IN ('A0552', 'A0602') THEN QTY
                        WHEN OPER = 'A0802' AND MAT_GRP_1 = 'SE' AND MAT_GRP_5 <> 'Merge' THEN QTY 
                        WHEN OPER = 'A0802' AND MAT_GRP_1 <> 'SE' THEN DECODE(SUBSTR(MAT_GRP_4,-1), '2', 0, QTY) 
                        ELSE 0 END) AS WB2 
             , SUM(CASE WHEN OPER IN ('A0553', 'A0603') THEN QTY
                        WHEN OPER = 'A0803' AND MAT_GRP_1 = 'SE' AND MAT_GRP_5 <> 'Merge' THEN QTY  
                        WHEN OPER = 'A0803' AND MAT_GRP_1 <> 'SE' THEN DECODE(SUBSTR(MAT_GRP_4,-1), '2', 0, '3', 0, QTY) 
                        ELSE 0 END) AS WB3 
             , SUM(CASE WHEN OPER IN ('A0554', 'A0604') THEN QTY
                        WHEN OPER = 'A0804' AND MAT_GRP_1 = 'SE' AND MAT_GRP_5 <> 'Merge' THEN QTY 
                        WHEN OPER = 'A0804' AND MAT_GRP_1 <> 'SE' THEN DECODE(SUBSTR(MAT_GRP_4,-1), '2', 0, '3', 0, '4', 0, QTY) 
                        ELSE 0 END) AS WB4 
             , SUM(CASE WHEN OPER IN ('A0555', 'A0605') THEN QTY
                        WHEN OPER = 'A0805' AND MAT_GRP_1 = 'SE' AND MAT_GRP_5 <> 'Merge' THEN QTY 
                        WHEN OPER = 'A0805' AND MAT_GRP_1 <> 'SE' THEN DECODE(SUBSTR(MAT_GRP_4,-1), '2', 0, '3', 0, '4', 0, '5', 0, QTY) 
                        ELSE 0 END) AS WB5 
             , SUM(CASE WHEN OPER IN ('A0556', 'A0606') THEN QTY
                        WHEN OPER = 'A0806' AND MAT_GRP_1 = 'SE' AND MAT_GRP_5 <> 'Merge' THEN QTY 
                        WHEN OPER = 'A0806' AND MAT_GRP_1 <> 'SE' THEN DECODE(SUBSTR(MAT_GRP_4,-1), '2', 0, '3', 0, '4', 0, '5', 0, '6', 0, QTY) 
                        ELSE 0 END) AS WB6 
             , SUM(CASE WHEN OPER IN ('A0557', 'A0607') THEN QTY
                        WHEN OPER = 'A0807' AND MAT_GRP_1 = 'SE' AND MAT_GRP_5 <> 'Merge' THEN QTY 
                        WHEN OPER = 'A0807' AND MAT_GRP_1 <> 'SE' THEN DECODE(SUBSTR(MAT_GRP_4,-1), '2', 0, '3', 0, '4', 0, '5', 0, '6', 0, '7', 0, QTY) 
                        ELSE 0 END) AS WB7 
             , SUM(CASE WHEN OPER IN ('A0558', 'A0608') THEN QTY
                        WHEN OPER = 'A0808' AND MAT_GRP_1 = 'SE' AND MAT_GRP_5 <> 'Merge' THEN QTY 
                        WHEN OPER = 'A0808' AND MAT_GRP_1 <> 'SE' THEN DECODE(SUBSTR(MAT_GRP_4,-1), '2', 0, '3', 0, '4', 0, '5', 0, '6', 0, '7', 0, '8', 0, QTY) 
                        ELSE 0 END) AS WB8 
             , SUM(CASE WHEN OPER IN ('A0559', 'A0609') THEN QTY
                        WHEN OPER = 'A0809' AND MAT_GRP_1 = 'SE' AND MAT_GRP_5 <> 'Merge' THEN QTY 
                        WHEN OPER = 'A0809' AND MAT_GRP_1 <> 'SE' THEN DECODE(SUBSTR(MAT_GRP_4,-1), '2', 0, '3', 0, '4', 0, '5', 0, '6', 0, '7', 0, '8', 0, '9', 0, QTY) 
                        ELSE 0 END) AS WB9 
             , SUM(CASE WHEN OPER_GRP_1 = 'GATE' AND MAT_GRP_5 = '-' THEN QTY 
                        WHEN OPER_GRP_1 = 'GATE' AND MAT_GRP_1 = 'SE' AND MAT_GRP_5 = 'Merge' THEN QTY 
                        WHEN OPER_GRP_1 = 'GATE' AND MAT_GRP_1 <> 'SE' AND SUBSTR(MAT_GRP_4,-1) = SUBSTR(OPER, -1) THEN QTY 
                        ELSE 0 END) AS GATE 
             , SUM(CASE WHEN OPER IN ('A0950','A0900', 'A0910', 'A0920', 'A0930') THEN QTY ELSE 0 END) AS PLASMA 
             , SUM(CASE WHEN OPER IN ('A1000','A0980') THEN QTY ELSE 0 END) AS MOLD 
             , SUM(DECODE(OPER_GRP_1, 'CURE', QTY, 0)) AS CURE
             , SUM(DECODE(OPER_GRP_1, 'M/K', QTY, 0)) AS MK
             , SUM(DECODE(OPER_GRP_1, 'TRIM', QTY, 0)) AS TRIM
             , SUM(DECODE(OPER_GRP_1, 'TIN', QTY, 0)) AS TIN
             , SUM(DECODE(OPER_GRP_1, 'S/B/A', QTY, 0)) AS SBA
             , SUM(DECODE(OPER_GRP_1, 'SIG', QTY, 0)) AS SIG
             , SUM(DECODE(OPER, 'A1790', QTY, 0)) AS DC1
             , SUM(DECODE(OPER, 'A1795', QTY, 0)) AS DC2
             , SUM(CASE WHEN OPER_GRP_1 = 'AVI' AND OPER NOT IN ('A1790', 'A1795') THEN QTY ELSE 0 END) AS AVI
             , SUM(CASE WHEN OPER = 'A2030' THEN QTY ELSE 0 END) AS BAKE
             , SUM(CASE WHEN OPER IN ('A2050') THEN QTY ELSE 0 END) AS PVI
             , SUM(CASE WHEN OPER IN ('A2100','A2300') THEN QTY ELSE 0 END) AS QC_GATE 
             , SUM(DECODE(OPER_GRP_1, 'HMK3A', QTY, 0)) AS HMK3A
             , SUM(DECODE(OPER_GRP_1, 'HMK2A', 0, QTY)) AS W_ISSUE
             , SUM(CASE WHEN OPER_GRP_1 IN ('HMK2A', 'B/G') THEN 0 ELSE QTY END) AS W_BG
             , SUM(CASE WHEN OPER_GRP_1 IN ('HMK2A', 'B/G', 'SAW', 'SMT', 'S/P', 'D/A') THEN 0 
                        WHEN OPER_GRP_1 = 'W/B' AND MAT_GRP_4 NOT IN ('-','FD','FU') AND MAT_GRP_5 <> 'Merge' THEN 0 
                        ELSE QTY END) AS W_DA 
             , SUM(CASE WHEN OPER_GRP_1 IN ('HMK2A', 'B/G', 'SAW', 'SMT', 'S/P', 'D/A', 'W/B') THEN 0 ELSE QTY END) AS W_WB
             , SUM(CASE WHEN OPER_GRP_1 IN ('HMK2A', 'B/G', 'SAW', 'SMT', 'S/P', 'D/A', 'W/B', 'GATE', 'MOLD') THEN 0 ELSE QTY END) AS W_MOLD
          FROM (
                SELECT A.MAT_ID, A.OPER, B.OPER_GRP_1, C.MAT_GRP_1, C.MAT_GRP_4, C.MAT_GRP_5, QTY_1
                     , COMP_CNT, HX_COMP_MIN, HX_COMP_MAX 
                     , CASE WHEN MAT_GRP_1 = 'HX' AND HX_COMP_MIN IS NOT NULL
                                 THEN (CASE WHEN HX_COMP_MIN <> HX_COMP_MAX AND A.OPER > HX_COMP_MIN AND A.OPER <= HX_COMP_MAX THEN QTY_1 / NVL(COMP_CNT / 2,1)
                                            WHEN A.OPER <= HX_COMP_MAX THEN QTY_1 / NVL(COMP_CNT,1)
                                            ELSE QTY_1 END)
                            WHEN A.OPER <= 'A0395' THEN QTY_1 / NVL(COMP_CNT,1) 
                            ELSE QTY_1 
                       END QTY 
                  FROM RWIPLOTSTS A 
                     , MWIPOPRDEF B
                     , VWIPMATDEF C
                 WHERE 1=1 
                   AND A.FACTORY = B.FACTORY 
                   AND A.FACTORY = C.FACTORY 
                   AND A.OPER = B.OPER
                   AND A.MAT_ID = C.MAT_ID
                   AND A.FACTORY  = 'HMVA2' 
                   AND A.LOT_DEL_FLAG = ' '
                   AND A.LOT_TYPE = 'W'
                   AND A.LOT_CMF_5 LIKE 'P%' 
                   AND C.DELETE_FLAG = ' ' 
               )
         GROUP BY MAT_ID
       ) WIP  
     , ( 
        SELECT MAT.MAT_ID
             , SUM(CASE WHEN GUBUN ='DA' AND MAT.MAT_GRP_5 IN ('Merge', '-') THEN TRUNC(NVL(NVL(UPH.UPEH,0) * 24 * 0.68 * RES.RAS_CNT, 0)) ELSE 0 END) AS DA_CAPA
             , SUM(CASE WHEN GUBUN ='WB' AND MAT.MAT_GRP_5 IN ('Merge', '-') THEN TRUNC(NVL(NVL(UPH.UPEH,0) * 24 * 0.71 * RES.RAS_CNT, 0)) ELSE 0 END) AS WB_CAPA
             , SUM(CASE WHEN RES.OPER IN ('A0333','A0400', 'A0401') THEN TRUNC(NVL(NVL(UPH.UPEH,0) * 24 * 0.68 * RES.RAS_CNT, 0)) ELSE 0 END) AS DA1_CAPA
             , SUM(CASE WHEN RES.OPER = 'A0402' THEN TRUNC(NVL(NVL(UPH.UPEH,0) * 24 * 0.68 * RES.RAS_CNT, 0)) ELSE 0 END) AS DA2_CAPA
             , SUM(CASE WHEN RES.OPER = 'A0403' THEN TRUNC(NVL(NVL(UPH.UPEH,0) * 24 * 0.68 * RES.RAS_CNT, 0)) ELSE 0 END) AS DA3_CAPA
             , SUM(CASE WHEN RES.OPER = 'A0404' THEN TRUNC(NVL(NVL(UPH.UPEH,0) * 24 * 0.68 * RES.RAS_CNT, 0)) ELSE 0 END) AS DA4_CAPA
             , SUM(CASE WHEN RES.OPER = 'A0405' THEN TRUNC(NVL(NVL(UPH.UPEH,0) * 24 * 0.68 * RES.RAS_CNT, 0)) ELSE 0 END) AS DA5_CAPA
             , SUM(CASE WHEN RES.OPER = 'A0406' THEN TRUNC(NVL(NVL(UPH.UPEH,0) * 24 * 0.68 * RES.RAS_CNT, 0)) ELSE 0 END) AS DA6_CAPA
             , SUM(CASE WHEN RES.OPER = 'A0407' THEN TRUNC(NVL(NVL(UPH.UPEH,0) * 24 * 0.68 * RES.RAS_CNT, 0)) ELSE 0 END) AS DA7_CAPA
             , SUM(CASE WHEN RES.OPER = 'A0408' THEN TRUNC(NVL(NVL(UPH.UPEH,0) * 24 * 0.68 * RES.RAS_CNT, 0)) ELSE 0 END) AS DA8_CAPA
             , SUM(CASE WHEN RES.OPER = 'A0409' THEN TRUNC(NVL(NVL(UPH.UPEH,0) * 24 * 0.68 * RES.RAS_CNT, 0)) ELSE 0 END) AS DA9_CAPA
             , SUM(CASE WHEN RES.OPER IN ('A0600', 'A0601') THEN TRUNC(NVL(NVL(UPH.UPEH,0) * 24 * 0.71 * RES.RAS_CNT, 0)) ELSE 0 END) AS WB1_CAPA
             , SUM(CASE WHEN RES.OPER = 'A0602' THEN TRUNC(NVL(NVL(UPH.UPEH,0) * 24 * 0.71 * RES.RAS_CNT, 0)) ELSE 0 END) AS WB2_CAPA
             , SUM(CASE WHEN RES.OPER = 'A0603' THEN TRUNC(NVL(NVL(UPH.UPEH,0) * 24 * 0.71 * RES.RAS_CNT, 0)) ELSE 0 END) AS WB3_CAPA
             , SUM(CASE WHEN RES.OPER = 'A0604' THEN TRUNC(NVL(NVL(UPH.UPEH,0) * 24 * 0.71 * RES.RAS_CNT, 0)) ELSE 0 END) AS WB4_CAPA
             , SUM(CASE WHEN RES.OPER = 'A0605' THEN TRUNC(NVL(NVL(UPH.UPEH,0) * 24 * 0.71 * RES.RAS_CNT, 0)) ELSE 0 END) AS WB5_CAPA
             , SUM(CASE WHEN RES.OPER = 'A0606' THEN TRUNC(NVL(NVL(UPH.UPEH,0) * 24 * 0.71 * RES.RAS_CNT, 0)) ELSE 0 END) AS WB6_CAPA
             , SUM(CASE WHEN RES.OPER = 'A0607' THEN TRUNC(NVL(NVL(UPH.UPEH,0) * 24 * 0.71 * RES.RAS_CNT, 0)) ELSE 0 END) AS WB7_CAPA
             , SUM(CASE WHEN RES.OPER = 'A0608' THEN TRUNC(NVL(NVL(UPH.UPEH,0) * 24 * 0.71 * RES.RAS_CNT, 0)) ELSE 0 END) AS WB8_CAPA
             , SUM(CASE WHEN RES.OPER = 'A0609' THEN TRUNC(NVL(NVL(UPH.UPEH,0) * 24 * 0.71 * RES.RAS_CNT, 0)) ELSE 0 END) AS WB9_CAPA
          FROM ( 
                SELECT FACTORY, RES_STS_2, RES_STS_8 AS OPER 
                     , CASE WHEN RES_STS_8 LIKE 'A06%' THEN 'WB' ELSE 'DA' END AS GUBUN 
                     , RES_GRP_6 AS RES_MODEL, RES_GRP_7 AS UPEH_GRP, COUNT(RES_ID) AS RAS_CNT 
                  FROM MRASRESDEF 
                 WHERE FACTORY  = 'HMVA2' 
                   AND RES_CMF_9 = 'Y' 
                   AND RES_CMF_7 = 'Y' 
                   AND DELETE_FLAG = ' ' 
                   AND (RES_STS_8 LIKE 'A04%' OR RES_STS_8 LIKE 'A06%' OR RES_STS_8 = 'A0333')
                   AND (RES_STS_1 NOT IN ('C200', 'B199') OR RES_UP_DOWN_FLAG = 'U') 
                 GROUP BY FACTORY,RES_STS_2,RES_STS_8,RES_GRP_6,RES_GRP_7 
               ) RES 
             , CRASUPHDEF UPH 
             , MWIPMATDEF MAT 
         WHERE 1 = 1 
           AND RES.FACTORY = UPH.FACTORY(+) 
           AND RES.FACTORY = MAT.FACTORY 
           AND RES.OPER = UPH.OPER(+) 
           AND RES.RES_MODEL = UPH.RES_MODEL(+) 
           AND RES.UPEH_GRP = UPH.UPEH_GRP(+) 
           AND RES.RES_STS_2 = UPH.MAT_ID(+) 
           AND RES.RES_STS_2 = MAT.MAT_ID 
           AND MAT.DELETE_FLAG = ' ' 
         GROUP BY MAT.MAT_ID 
       ) CAP  
     , ( 
        SELECT MAT_ID 
             , DECODE(RESV_FIELD1, ' ', 0, RESV_FIELD1) AS ORI_PLAN 
             , DECODE(RESV_FIELD3, ' ', 0, RESV_FIELD3) AS REV_PLAN 
          FROM CWIPPLNMON 
         WHERE FACTORY  = 'HMVA2' 
           AND PLAN_MONTH = '202004' 
           AND PLAN_QTY_ASSY + DECODE(RESV_FIELD3, ' ', 0, RESV_FIELD3) > 0 
       ) MON  
 WHERE 1 = 1  
   AND MAT.MAT_ID = PLN.MAT_ID(+) 
   AND MAT.MAT_ID = SHP.MAT_ID(+) 
   AND MAT.MAT_ID = WIP.MAT_ID(+) 
   AND MAT.MAT_ID = CAP.MAT_ID(+) 
   AND MAT.MAT_ID = MON.MAT_ID(+) 
 GROUP BY MAT.MAT_GRP_1,  ' ', MAT.MAT_GRP_2, MAT.MAT_GRP_3, MAT.MAT_GRP_4,  ' ', MAT.MAT_GRP_6,  ' ',  ' ',  ' ', MAT.CONV_MAT_ID,  ' ',  ' ',  ' ' 
HAVING SUM(NVL(WEEK1_PLAN, 0) + NVL(SHP_WEEK, 0) + NVL(TOTAL, 0) + NVL(DA_CAPA, 0) + NVL(WB_CAPA, 0) + NVL(ORI_PLAN, 0) + NVL(REV_PLAN, 0) + NVL(SHP_MONTH, 0)) > 0
 ORDER BY MAT.MAT_GRP_1,  ' ', MAT.MAT_GRP_2, MAT.MAT_GRP_3, MAT.MAT_GRP_4,  ' ', MAT.MAT_GRP_6,  ' ',  ' ',  ' ', MAT.CONV_MAT_ID,  ' ',  ' ',  ' '
 )

-------------------------------------------------------------
