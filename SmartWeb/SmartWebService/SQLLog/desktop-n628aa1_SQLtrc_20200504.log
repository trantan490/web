SELECT * FROM RWEBUSRDEF WHERE FACTORY = :FACTORY AND USER_ID= :USER_ID
-------------------------------------------------------------
SELECT A.FUNC_GRP_SEQ,A.SEC_GRP_ID,A.FUNC_GRP_ID,NVL(A.FUNC_NAME, ' ') FUNC_NAME, NVL(B.FUNC_DESC, ' ') FUNC_DESC, LANGUAGE_1, LANGUAGE_2, LANGUAGE_3
  FROM RWEBGRPFUN A, RWEBFUNDEF B
 WHERE A.FACTORY = :p_FACTORY
   AND A.SEC_GRP_ID = :p_SEC_GRP_ID
   AND A.FUNC_NAME=B.FUNC_NAME(+)
 ORDER BY A.FUNC_GRP_SEQ, A.FUNC_SEQ
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
 SELECT PLAN_WEEK V1    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_DATE = TO_CHAR(SYSDATE,'yyyymmdd')      AND ROWNUM = 1  
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('2020', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('2020', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT LANGUAGE_2 FROM RWEBFUNDEF WHERE FUNC_NAME = 'PRD010604'
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
SELECT LANGUAGE_2 FROM RWEBFUNDEF WHERE FUNC_NAME = 'PQC031202'
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
 SELECT PLAN_WEEK V1    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_DATE = TO_CHAR(SYSDATE,'yyyymmdd')      AND ROWNUM = 1  
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('2020', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('2020', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT LANGUAGE_2 FROM RWEBFUNDEF WHERE FUNC_NAME = 'PQC030110'
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT DISTINCT CHAR_ID 
 FROM(  
       SELECT NVL((SELECT CHAR_ID 
                     FROM MEDCLOTDAT 
         WHERE  1=1 AND COL_SET_ID IN (SELECT COL_SET_ID FROM MEDCCOLDEF WHERE 1=1 AND COL_GRP_10='Visual'  AND DELETE_FLAG <> 'Y'   
            AND DELETE_FLAG <> 'Y' AND FACTORY=PQ.FACTORY)  
          AND LOT_ID = PQ.LOT_ID  AND VALUE_1 <> ' '  AND HIST_SEQ= PQ.HIST_SEQ and rownum=1),'-') AS CHAR_ID , TOTAL_DEFECT_QTY_1 
       FROM CPQCLOTHIS@RPTTOMES PQ  
               , MWIPMATDEF MAT   
      WHERE 1 = 1 
              AND PQ.FACTORY = 'HMVA2'  
              AND PQ.FACTORY = MAT.FACTORY  
              AND PQ.MAT_ID = MAT.MAT_ID  
        AND MAT.FACTORY (+) = 'HMVA2' 
              AND PQ.TRAN_TIME  BETWEEN '20200303220000' AND '20200504215959'  
    ) WHERE TOTAL_DEFECT_QTY_1 > 0  

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' 
       , QC_OPER, TRAN_TIME, QC_TYPE 
       , MAT_ID, LOT_ID, RES_ID, QTY_1, CUSTOMER, ASSE_SITE, LEAD_COUNT, H_PACKAGE, DENSITY, QC_OPERATOR ,SAMPLE_QTY 
       , SUM(TOTAL_DEFECT_QTY_1) AS TOTAL_QTY  , PPM, CMF_2 
       , DECODE(QC_FLAG, 'Y', 'PASS', 'FAIL') AS QC_FLAG  
       , SUM(DECODE(CHAR_ID , 'Etc' ,TOTAL_DEFECT_QTY_1,0))  AS "Etc"
       , SUM(DECODE(CHAR_ID , 'Ball Size' ,TOTAL_DEFECT_QTY_1,0))  AS "Ball Size"
       , SUM(DECODE(CHAR_ID , 'Pad Open (Ball Lift)' ,TOTAL_DEFECT_QTY_1,0))  AS "Pad Open (Ball Lift)"
       , SUM(DECODE(CHAR_ID , 'CCS Sheet Recording NG' ,TOTAL_DEFECT_QTY_1,0))  AS "CCS Sheet Recording NG"
       , SUM(DECODE(CHAR_ID , 'CCS basic information NG' ,TOTAL_DEFECT_QTY_1,0))  AS "CCS basic information NG"
       , SUM(DECODE(CHAR_ID , '-' ,TOTAL_DEFECT_QTY_1,0))  AS "-"
       , SUM(DECODE(CHAR_ID , 'T-Card Recording Defect' ,TOTAL_DEFECT_QTY_1,0))  AS "T-Card Recording Defect"
 FROM( 
       SELECT  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' 
              , PQ.QC_OPER 
              , PQ.TRAN_TIME 
              , PQ.QC_TYPE 
              , PQ.MAT_ID 
              , PQ.LOT_ID 
              , PQ.RES_ID, PQ.QC_FLAG, PQ.QC_OPERATOR 
              , WI.QTY_1  
              , NVL((SELECT DATA_1 FROM MGCMTBLDAT WHERE FACTORY='HMVA2' AND TABLE_NAME = 'H_CUSTOMER' AND KEY_1 = PQ.CUSTOMER AND ROWNUM=1), '-')  AS CUSTOMER 
              , TRIM(STS.LOT_CMF_7) AS ASSE_SITE, PQ.LEAD_COUNT, PQ.H_PACKAGE, PQ.DENSITY, PQ.SAMPLE_QTY, PQ.TOTAL_DEFECT_QTY_1, CMF_2 
              , DECODE(PQ.SAMPLE_QTY,0,0,ROUND((((PQ.TOTAL_DEFECT_QTY_1)/(PQ.SAMPLE_QTY))*1000000),0)) PPM   
              , NVL((SELECT CHAR_ID 
                       FROM MEDCLOTDAT 
                      WHERE  1=1  
                             AND COL_SET_ID IN ( 
                                                SELECT COL_SET_ID 
                                                  FROM MEDCCOLDEF 
                                                 WHERE 1=1 
                                                       AND COL_GRP_10='Visual' 
                                                       AND DELETE_FLAG <> 'Y' 
                                                      AND FACTORY=PQ.FACTORY 
                                                )  
                              AND LOT_ID = WI.LOT_ID 
                              AND VALUE_1 <> ' ' 
                              AND HIST_SEQ= PQ.HIST_SEQ 
                              AND ROWNUM = 1 ) 
                      ,'-') AS CHAR_ID  
         FROM CPQCLOTHIS@RPTTOMES PQ  
              , MWIPLOTHIS@RPTTOMES WI  
              , MWIPMATDEF MAT   
              , MWIPLOTSTS STS   
        WHERE 1 = 1 
              AND PQ.FACTORY = WI.FACTORY 
              AND PQ.FACTORY = MAT.FACTORY  
              AND PQ.MAT_ID = WI.MAT_ID  
              AND PQ.MAT_ID = MAT.MAT_ID  
              AND PQ.LOT_ID = WI.LOT_ID 
              AND PQ.LOT_ID = STS.LOT_ID 
              AND STS.LOT_CMF_7 LIKE '%'
              AND PQ.HIST_SEQ = WI.HIST_SEQ  
              AND MAT.FACTORY (+) = 'HMVA2' 
              AND WI.HIST_DEL_FLAG = ' ' 
              AND PQ.TRAN_TIME  BETWEEN '20200303220000' AND '20200504215959'  
              AND PQ.CMF_10 = ' ' 
     ) 
GROUP BY   ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' , QC_OPER, TRAN_TIME, QC_TYPE, MAT_ID, LOT_ID, RES_ID, QTY_1, CUSTOMER, ASSE_SITE, LEAD_COUNT, H_PACKAGE, DENSITY, QC_OPERATOR, SAMPLE_QTY, PPM, CMF_2, QC_FLAG 
ORDER BY   ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' , QC_OPER, TRAN_TIME, QC_TYPE, MAT_ID, LOT_ID, RES_ID, QTY_1, CUSTOMER, ASSE_SITE, LEAD_COUNT, H_PACKAGE, DENSITY, QC_OPERATOR, SAMPLE_QTY, PPM, CMF_2, QC_FLAG 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT DISTINCT CHAR_ID 
 FROM(  
       SELECT NVL((SELECT CHAR_ID 
                     FROM MEDCLOTDAT 
         WHERE  1=1 AND COL_SET_ID IN (SELECT COL_SET_ID FROM MEDCCOLDEF WHERE 1=1 AND COL_GRP_10='Visual'  AND DELETE_FLAG <> 'Y'   
            AND DELETE_FLAG <> 'Y' AND FACTORY=PQ.FACTORY)  
          AND LOT_ID = PQ.LOT_ID  AND VALUE_1 <> ' '  AND HIST_SEQ= PQ.HIST_SEQ and rownum=1),'-') AS CHAR_ID , TOTAL_DEFECT_QTY_1 
       FROM CPQCLOTHIS@RPTTOMES PQ  
               , MWIPMATDEF MAT   
      WHERE 1 = 1 
              AND PQ.FACTORY = 'HMVA2'  
              AND PQ.FACTORY = MAT.FACTORY  
              AND PQ.MAT_ID = MAT.MAT_ID  
        AND MAT.FACTORY (+) = 'HMVA2' 
              AND PQ.TRAN_TIME  BETWEEN '20200303220000' AND '20200504215959'  
    ) WHERE TOTAL_DEFECT_QTY_1 > 0  

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' 
       , QC_OPER, TRAN_TIME, QC_TYPE 
       , MAT_ID, LOT_ID, RES_ID, QTY_1, CUSTOMER, ASSE_SITE, LEAD_COUNT, H_PACKAGE, DENSITY, QC_OPERATOR ,SAMPLE_QTY 
       , SUM(TOTAL_DEFECT_QTY_1) AS TOTAL_QTY  , PPM, CMF_2 
       , DECODE(QC_FLAG, 'Y', 'PASS', 'FAIL') AS QC_FLAG  
       , SUM(DECODE(CHAR_ID , 'Etc' ,TOTAL_DEFECT_QTY_1,0))  AS "Etc"
       , SUM(DECODE(CHAR_ID , 'Ball Size' ,TOTAL_DEFECT_QTY_1,0))  AS "Ball Size"
       , SUM(DECODE(CHAR_ID , 'Pad Open (Ball Lift)' ,TOTAL_DEFECT_QTY_1,0))  AS "Pad Open (Ball Lift)"
       , SUM(DECODE(CHAR_ID , 'CCS Sheet Recording NG' ,TOTAL_DEFECT_QTY_1,0))  AS "CCS Sheet Recording NG"
       , SUM(DECODE(CHAR_ID , 'CCS basic information NG' ,TOTAL_DEFECT_QTY_1,0))  AS "CCS basic information NG"
       , SUM(DECODE(CHAR_ID , '-' ,TOTAL_DEFECT_QTY_1,0))  AS "-"
       , SUM(DECODE(CHAR_ID , 'T-Card Recording Defect' ,TOTAL_DEFECT_QTY_1,0))  AS "T-Card Recording Defect"
 FROM( 
       SELECT  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' 
              , PQ.QC_OPER 
              , PQ.TRAN_TIME 
              , PQ.QC_TYPE 
              , PQ.MAT_ID 
              , PQ.LOT_ID 
              , PQ.RES_ID, PQ.QC_FLAG, PQ.QC_OPERATOR 
              , WI.QTY_1  
              , NVL((SELECT DATA_1 FROM MGCMTBLDAT WHERE FACTORY='HMVA2' AND TABLE_NAME = 'H_CUSTOMER' AND KEY_1 = PQ.CUSTOMER AND ROWNUM=1), '-')  AS CUSTOMER 
              , TRIM(STS.LOT_CMF_7) AS ASSE_SITE, PQ.LEAD_COUNT, PQ.H_PACKAGE, PQ.DENSITY, PQ.SAMPLE_QTY, PQ.TOTAL_DEFECT_QTY_1, CMF_2 
              , DECODE(PQ.SAMPLE_QTY,0,0,ROUND((((PQ.TOTAL_DEFECT_QTY_1)/(PQ.SAMPLE_QTY))*1000000),0)) PPM   
              , NVL((SELECT CHAR_ID 
                       FROM MEDCLOTDAT 
                      WHERE  1=1  
                             AND COL_SET_ID IN ( 
                                                SELECT COL_SET_ID 
                                                  FROM MEDCCOLDEF 
                                                 WHERE 1=1 
                                                       AND COL_GRP_10='Visual' 
                                                       AND DELETE_FLAG <> 'Y' 
                                                      AND FACTORY=PQ.FACTORY 
                                                )  
                              AND LOT_ID = WI.LOT_ID 
                              AND VALUE_1 <> ' ' 
                              AND HIST_SEQ= PQ.HIST_SEQ 
                              AND ROWNUM = 1 ) 
                      ,'-') AS CHAR_ID  
         FROM CPQCLOTHIS@RPTTOMES PQ  
              , MWIPLOTHIS@RPTTOMES WI  
              , MWIPMATDEF MAT   
              , MWIPLOTSTS STS   
        WHERE 1 = 1 
              AND PQ.FACTORY = WI.FACTORY 
              AND PQ.FACTORY = MAT.FACTORY  
              AND PQ.MAT_ID = WI.MAT_ID  
              AND PQ.MAT_ID = MAT.MAT_ID  
              AND PQ.LOT_ID = WI.LOT_ID 
              AND PQ.LOT_ID = STS.LOT_ID 
              AND STS.LOT_CMF_7 LIKE '%'
              AND PQ.HIST_SEQ = WI.HIST_SEQ  
              AND MAT.FACTORY (+) = 'HMVA2' 
              AND WI.HIST_DEL_FLAG = ' ' 
              AND PQ.TRAN_TIME  BETWEEN '20200303220000' AND '20200504215959'  
              AND PQ.CMF_10 = ' ' 
     ) 
GROUP BY   ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' , QC_OPER, TRAN_TIME, QC_TYPE, MAT_ID, LOT_ID, RES_ID, QTY_1, CUSTOMER, ASSE_SITE, LEAD_COUNT, H_PACKAGE, DENSITY, QC_OPERATOR, SAMPLE_QTY, PPM, CMF_2, QC_FLAG 
ORDER BY   ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' , QC_OPER, TRAN_TIME, QC_TYPE, MAT_ID, LOT_ID, RES_ID, QTY_1, CUSTOMER, ASSE_SITE, LEAD_COUNT, H_PACKAGE, DENSITY, QC_OPERATOR, SAMPLE_QTY, PPM, CMF_2, QC_FLAG 

-------------------------------------------------------------
SELECT * FROM RWEBUSRDEF WHERE FACTORY = :FACTORY AND USER_ID= :USER_ID
-------------------------------------------------------------
SELECT A.FUNC_GRP_SEQ,A.SEC_GRP_ID,A.FUNC_GRP_ID,NVL(A.FUNC_NAME, ' ') FUNC_NAME, NVL(B.FUNC_DESC, ' ') FUNC_DESC, LANGUAGE_1, LANGUAGE_2, LANGUAGE_3
  FROM RWEBGRPFUN A, RWEBFUNDEF B
 WHERE A.FACTORY = :p_FACTORY
   AND A.SEC_GRP_ID = :p_SEC_GRP_ID
   AND A.FUNC_NAME=B.FUNC_NAME(+)
 ORDER BY A.FUNC_GRP_SEQ, A.FUNC_SEQ
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
SELECT LANGUAGE_2 FROM RWEBFUNDEF WHERE FUNC_NAME = 'STD1208'
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
 SELECT PLAN_WEEK V1    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_DATE = TO_CHAR(SYSDATE,'yyyymmdd')      AND ROWNUM = 1  
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('2020', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('2020', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT LANGUAGE_2 FROM RWEBFUNDEF WHERE FUNC_NAME = 'PQC030110'
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT DISTINCT CHAR_ID 
 FROM(  
       SELECT NVL((SELECT CHAR_ID 
                     FROM MEDCLOTDAT 
         WHERE  1=1 AND COL_SET_ID IN (SELECT COL_SET_ID FROM MEDCCOLDEF WHERE 1=1 AND COL_GRP_10='Visual'  AND DELETE_FLAG <> 'Y'   
            AND DELETE_FLAG <> 'Y' AND FACTORY=PQ.FACTORY)  
          AND LOT_ID = PQ.LOT_ID  AND VALUE_1 <> ' '  AND HIST_SEQ= PQ.HIST_SEQ and rownum=1),'-') AS CHAR_ID , TOTAL_DEFECT_QTY_1 
       FROM CPQCLOTHIS@RPTTOMES PQ  
               , MWIPMATDEF MAT   
      WHERE 1 = 1 
              AND PQ.FACTORY = 'HMVA2'  
              AND PQ.FACTORY = MAT.FACTORY  
              AND PQ.MAT_ID = MAT.MAT_ID  
        AND MAT.FACTORY (+) = 'HMVA2' 
              AND PQ.TRAN_TIME  BETWEEN '20200503220000' AND '20200504215959'  
    ) WHERE TOTAL_DEFECT_QTY_1 > 0  

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' 
       , QC_OPER, TRAN_TIME, QC_TYPE 
       , MAT_ID, LOT_ID, RES_ID, QTY_1, CUSTOMER, ASSE_SITE, LEAD_COUNT, H_PACKAGE, DENSITY, QC_OPERATOR ,SAMPLE_QTY 
       , SUM(TOTAL_DEFECT_QTY_1) AS TOTAL_QTY  , PPM, CMF_2 
       , DECODE(QC_FLAG, 'Y', 'PASS', 'FAIL') AS QC_FLAG  
 FROM( 
       SELECT  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' 
              , PQ.QC_OPER 
              , PQ.TRAN_TIME 
              , PQ.QC_TYPE 
              , PQ.MAT_ID 
              , PQ.LOT_ID 
              , PQ.RES_ID, PQ.QC_FLAG, PQ.QC_OPERATOR 
              , WI.QTY_1  
              , NVL((SELECT DATA_1 FROM MGCMTBLDAT WHERE FACTORY='HMVA2' AND TABLE_NAME = 'H_CUSTOMER' AND KEY_1 = PQ.CUSTOMER AND ROWNUM=1), '-')  AS CUSTOMER 
              , TRIM(STS.LOT_CMF_7) AS ASSE_SITE, PQ.LEAD_COUNT, PQ.H_PACKAGE, PQ.DENSITY, PQ.SAMPLE_QTY, PQ.TOTAL_DEFECT_QTY_1, CMF_2 
              , DECODE(PQ.SAMPLE_QTY,0,0,ROUND((((PQ.TOTAL_DEFECT_QTY_1)/(PQ.SAMPLE_QTY))*1000000),0)) PPM   
              , NVL((SELECT CHAR_ID 
                       FROM MEDCLOTDAT 
                      WHERE  1=1  
                             AND COL_SET_ID IN ( 
                                                SELECT COL_SET_ID 
                                                  FROM MEDCCOLDEF 
                                                 WHERE 1=1 
                                                       AND COL_GRP_10='Visual' 
                                                       AND DELETE_FLAG <> 'Y' 
                                                      AND FACTORY=PQ.FACTORY 
                                                )  
                              AND LOT_ID = WI.LOT_ID 
                              AND VALUE_1 <> ' ' 
                              AND HIST_SEQ= PQ.HIST_SEQ 
                              AND ROWNUM = 1 ) 
                      ,'-') AS CHAR_ID  
         FROM CPQCLOTHIS@RPTTOMES PQ  
              , MWIPLOTHIS@RPTTOMES WI  
              , MWIPMATDEF MAT   
              , MWIPLOTSTS STS   
        WHERE 1 = 1 
              AND PQ.FACTORY = WI.FACTORY 
              AND PQ.FACTORY = MAT.FACTORY  
              AND PQ.MAT_ID = WI.MAT_ID  
              AND PQ.MAT_ID = MAT.MAT_ID  
              AND PQ.LOT_ID = WI.LOT_ID 
              AND PQ.LOT_ID = STS.LOT_ID 
              AND STS.LOT_CMF_7 LIKE '%'
              AND PQ.HIST_SEQ = WI.HIST_SEQ  
              AND MAT.FACTORY (+) = 'HMVA2' 
              AND WI.HIST_DEL_FLAG = ' ' 
              AND PQ.TRAN_TIME  BETWEEN '20200503220000' AND '20200504215959'  
              AND PQ.CMF_10 = ' ' 
     ) 
GROUP BY   ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' , QC_OPER, TRAN_TIME, QC_TYPE, MAT_ID, LOT_ID, RES_ID, QTY_1, CUSTOMER, ASSE_SITE, LEAD_COUNT, H_PACKAGE, DENSITY, QC_OPERATOR, SAMPLE_QTY, PPM, CMF_2, QC_FLAG 
ORDER BY   ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' , QC_OPER, TRAN_TIME, QC_TYPE, MAT_ID, LOT_ID, RES_ID, QTY_1, CUSTOMER, ASSE_SITE, LEAD_COUNT, H_PACKAGE, DENSITY, QC_OPERATOR, SAMPLE_QTY, PPM, CMF_2, QC_FLAG 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT DISTINCT CHAR_ID 
 FROM(  
       SELECT NVL((SELECT CHAR_ID 
                     FROM MEDCLOTDAT 
         WHERE  1=1 AND COL_SET_ID IN (SELECT COL_SET_ID FROM MEDCCOLDEF WHERE 1=1 AND COL_GRP_10='Visual'  AND DELETE_FLAG <> 'Y'   
            AND DELETE_FLAG <> 'Y' AND FACTORY=PQ.FACTORY)  
          AND LOT_ID = PQ.LOT_ID  AND VALUE_1 <> ' '  AND HIST_SEQ= PQ.HIST_SEQ and rownum=1),'-') AS CHAR_ID , TOTAL_DEFECT_QTY_1 
       FROM CPQCLOTHIS@RPTTOMES PQ  
               , MWIPMATDEF MAT   
      WHERE 1 = 1 
              AND PQ.FACTORY = 'HMVA2'  
              AND PQ.FACTORY = MAT.FACTORY  
              AND PQ.MAT_ID = MAT.MAT_ID  
        AND MAT.FACTORY (+) = 'HMVA2' 
              AND PQ.TRAN_TIME  BETWEEN '20200128220000' AND '20200504215959'  
    ) WHERE TOTAL_DEFECT_QTY_1 > 0  

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' 
       , QC_OPER, TRAN_TIME, QC_TYPE 
       , MAT_ID, LOT_ID, RES_ID, QTY_1, CUSTOMER, ASSE_SITE, LEAD_COUNT, H_PACKAGE, DENSITY, QC_OPERATOR ,SAMPLE_QTY 
       , SUM(TOTAL_DEFECT_QTY_1) AS TOTAL_QTY  , PPM, CMF_2 
       , DECODE(QC_FLAG, 'Y', 'PASS', 'FAIL') AS QC_FLAG  
       , SUM(DECODE(CHAR_ID , 'Etc' ,TOTAL_DEFECT_QTY_1,0))  AS "Etc"
       , SUM(DECODE(CHAR_ID , 'Ball Size' ,TOTAL_DEFECT_QTY_1,0))  AS "Ball Size"
       , SUM(DECODE(CHAR_ID , 'Pad Open (Ball Lift)' ,TOTAL_DEFECT_QTY_1,0))  AS "Pad Open (Ball Lift)"
       , SUM(DECODE(CHAR_ID , 'CCS Sheet Recording NG' ,TOTAL_DEFECT_QTY_1,0))  AS "CCS Sheet Recording NG"
       , SUM(DECODE(CHAR_ID , 'CCS basic information NG' ,TOTAL_DEFECT_QTY_1,0))  AS "CCS basic information NG"
       , SUM(DECODE(CHAR_ID , '-' ,TOTAL_DEFECT_QTY_1,0))  AS "-"
       , SUM(DECODE(CHAR_ID , 'T-Card Recording Defect' ,TOTAL_DEFECT_QTY_1,0))  AS "T-Card Recording Defect"
 FROM( 
       SELECT  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' 
              , PQ.QC_OPER 
              , PQ.TRAN_TIME 
              , PQ.QC_TYPE 
              , PQ.MAT_ID 
              , PQ.LOT_ID 
              , PQ.RES_ID, PQ.QC_FLAG, PQ.QC_OPERATOR 
              , WI.QTY_1  
              , NVL((SELECT DATA_1 FROM MGCMTBLDAT WHERE FACTORY='HMVA2' AND TABLE_NAME = 'H_CUSTOMER' AND KEY_1 = PQ.CUSTOMER AND ROWNUM=1), '-')  AS CUSTOMER 
              , TRIM(STS.LOT_CMF_7) AS ASSE_SITE, PQ.LEAD_COUNT, PQ.H_PACKAGE, PQ.DENSITY, PQ.SAMPLE_QTY, PQ.TOTAL_DEFECT_QTY_1, CMF_2 
              , DECODE(PQ.SAMPLE_QTY,0,0,ROUND((((PQ.TOTAL_DEFECT_QTY_1)/(PQ.SAMPLE_QTY))*1000000),0)) PPM   
              , NVL((SELECT CHAR_ID 
                       FROM MEDCLOTDAT 
                      WHERE  1=1  
                             AND COL_SET_ID IN ( 
                                                SELECT COL_SET_ID 
                                                  FROM MEDCCOLDEF 
                                                 WHERE 1=1 
                                                       AND COL_GRP_10='Visual' 
                                                       AND DELETE_FLAG <> 'Y' 
                                                      AND FACTORY=PQ.FACTORY 
                                                )  
                              AND LOT_ID = WI.LOT_ID 
                              AND VALUE_1 <> ' ' 
                              AND HIST_SEQ= PQ.HIST_SEQ 
                              AND ROWNUM = 1 ) 
                      ,'-') AS CHAR_ID  
         FROM CPQCLOTHIS@RPTTOMES PQ  
              , MWIPLOTHIS@RPTTOMES WI  
              , MWIPMATDEF MAT   
              , MWIPLOTSTS STS   
        WHERE 1 = 1 
              AND PQ.FACTORY = WI.FACTORY 
              AND PQ.FACTORY = MAT.FACTORY  
              AND PQ.MAT_ID = WI.MAT_ID  
              AND PQ.MAT_ID = MAT.MAT_ID  
              AND PQ.LOT_ID = WI.LOT_ID 
              AND PQ.LOT_ID = STS.LOT_ID 
              AND STS.LOT_CMF_7 LIKE '%'
              AND PQ.HIST_SEQ = WI.HIST_SEQ  
              AND MAT.FACTORY (+) = 'HMVA2' 
              AND WI.HIST_DEL_FLAG = ' ' 
              AND PQ.TRAN_TIME  BETWEEN '20200128220000' AND '20200504215959'  
              AND PQ.CMF_10 = ' ' 
     ) 
GROUP BY   ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' , QC_OPER, TRAN_TIME, QC_TYPE, MAT_ID, LOT_ID, RES_ID, QTY_1, CUSTOMER, ASSE_SITE, LEAD_COUNT, H_PACKAGE, DENSITY, QC_OPERATOR, SAMPLE_QTY, PPM, CMF_2, QC_FLAG 
ORDER BY   ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' , QC_OPER, TRAN_TIME, QC_TYPE, MAT_ID, LOT_ID, RES_ID, QTY_1, CUSTOMER, ASSE_SITE, LEAD_COUNT, H_PACKAGE, DENSITY, QC_OPERATOR, SAMPLE_QTY, PPM, CMF_2, QC_FLAG 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT DISTINCT CHAR_ID 
 FROM(  
       SELECT NVL((SELECT CHAR_ID 
                     FROM MEDCLOTDAT 
         WHERE  1=1 AND COL_SET_ID IN (SELECT COL_SET_ID FROM MEDCCOLDEF WHERE 1=1 AND COL_GRP_10='Visual'  AND DELETE_FLAG <> 'Y'   
            AND DELETE_FLAG <> 'Y' AND FACTORY=PQ.FACTORY)  
          AND LOT_ID = PQ.LOT_ID  AND VALUE_1 <> ' '  AND HIST_SEQ= PQ.HIST_SEQ and rownum=1),'-') AS CHAR_ID , TOTAL_DEFECT_QTY_1 
       FROM CPQCLOTHIS@RPTTOMES PQ  
               , MWIPMATDEF MAT   
      WHERE 1 = 1 
              AND PQ.FACTORY = 'HMVA2'  
              AND PQ.FACTORY = MAT.FACTORY  
              AND PQ.MAT_ID = MAT.MAT_ID  
        AND MAT.FACTORY (+) = 'HMVA2' 
              AND PQ.TRAN_TIME  BETWEEN '20200128220000' AND '20200504215959'  
    ) WHERE TOTAL_DEFECT_QTY_1 > 0  

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' 
       , NVL((SELECT CHAR_ID 
                FROM MEDCLOTDAT 
               WHERE 1=1 AND COL_SET_ID IN (SELECT COL_SET_ID FROM MEDCCOLDEF WHERE 1=1 AND COL_GRP_10='Visual'  AND DELETE_FLAG <> 'Y' AND FACTORY=PQ.FACTORY)  
                         AND COL_SET_ID IN ( 
                                             SELECT COL_SET_ID 
                                               FROM MEDCCOLDEF 
                                              WHERE 1=1 
                                                    AND COL_GRP_10='Visual' 
                                                    AND DELETE_FLAG <> 'Y' 
                                                    AND FACTORY=PQ.FACTORY  
                                           )  
                         AND LOT_ID = WI.LOT_ID 
                         AND VALUE_1 <> ' ' 
                         AND HIST_SEQ= PQ.HIST_SEQ 
                         AND ROWNUM = 1 ) 
             ,'-') AS CHAR_ID  
       , PQ.QC_OPER, PQ.TRAN_TIME, PQ.QC_TYPE, PQ.MAT_ID, PQ.LOT_ID, PQ.RES_ID, WI.QTY_1  
       , NVL((SELECT DATA_1 FROM MGCMTBLDAT WHERE FACTORY='HMVA2' AND TABLE_NAME = 'H_CUSTOMER' AND KEY_1 = PQ.CUSTOMER AND ROWNUM=1), '-')  AS CUSTOMER 
       , TRIM(STS.LOT_CMF_7) AS ASSE_SITE, PQ.LEAD_COUNT, PQ.H_PACKAGE, PQ.DENSITY, PQ.QC_OPERATOR, PQ.SAMPLE_QTY, PQ.TOTAL_DEFECT_QTY_1 
       , DECODE(PQ.SAMPLE_QTY,0,0,ROUND((((PQ.TOTAL_DEFECT_QTY_1)/(PQ.SAMPLE_QTY))*1000000),0)) PPM   
  FROM CPQCLOTHIS@RPTTOMES PQ  
       , MWIPLOTHIS@RPTTOMES WI  
       , MWIPMATDEF MAT   
       , MWIPLOTSTS STS   
 WHERE 1 = 1 
       AND PQ.FACTORY = WI.FACTORY 
       AND PQ.FACTORY = MAT.FACTORY  
       AND PQ.LOT_ID = WI.LOT_ID 
       AND PQ.LOT_ID = STS.LOT_ID 
       AND STS.LOT_CMF_7 LIKE '%'
       AND PQ.MAT_ID = WI.MAT_ID  
       AND PQ.MAT_ID = MAT.MAT_ID  
       AND PQ.HIST_SEQ = WI.HIST_SEQ  
       AND MAT.FACTORY (+) = 'HMVA2' 
       AND WI.HIST_DEL_FLAG = ' ' 
       AND PQ.TRAN_TIME  BETWEEN '20200128220000' AND '20200504215959'  
       AND PQ.CMF_10 = ' ' 
ORDER BY  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' 
         , CHAR_ID DESC, MAT_ID, LOT_ID, TRAN_TIME, QC_OPER, QC_TYPE   

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT ' '  
       , SUM(DECODE(CHAR_ID , 'Etc' ,TOTAL_DEFECT_QTY_1,0))  AS "Etc"
       , SUM(DECODE(CHAR_ID , 'Ball Size' ,TOTAL_DEFECT_QTY_1,0))  AS "Ball Size"
       , SUM(DECODE(CHAR_ID , 'Pad Open (Ball Lift)' ,TOTAL_DEFECT_QTY_1,0))  AS "Pad Open (Ball Lift)"
       , SUM(DECODE(CHAR_ID , 'CCS Sheet Recording NG' ,TOTAL_DEFECT_QTY_1,0))  AS "CCS Sheet Recording NG"
       , SUM(DECODE(CHAR_ID , 'CCS basic information NG' ,TOTAL_DEFECT_QTY_1,0))  AS "CCS basic information NG"
       , SUM(DECODE(CHAR_ID , '-' ,TOTAL_DEFECT_QTY_1,0))  AS "-"
       , SUM(DECODE(CHAR_ID , 'T-Card Recording Defect' ,TOTAL_DEFECT_QTY_1,0))  AS "T-Card Recording Defect"
 FROM( 
      SELECT PQ.TOTAL_DEFECT_QTY_1 
             , NVL((SELECT CHAR_ID 
                      FROM MEDCLOTDAT 
                     WHERE 1=1 
                           AND COL_SET_ID IN 
                                           (SELECT COL_SET_ID 
                                              FROM MEDCCOLDEF 
                                             WHERE 1=1 
                                                   AND COL_GRP_10='Visual' 
                                                   AND DELETE_FLAG <> 'Y' 
                                                   AND FACTORY=PQ.FACTORY 
                                           )  
                           AND LOT_ID = PQ.LOT_ID 
                           AND VALUE_1 <> ' ' 
                           AND HIST_SEQ = PQ.HIST_SEQ 
                           AND ROWNUM = 1 ) 
                     ,' ') AS CHAR_ID 
        FROM CPQCLOTHIS@RPTTOMES PQ  
             ,MWIPLOTHIS@RPTTOMES WI  
             ,MWIPMATDEF MAT  
       WHERE 1=1 
             AND PQ.FACTORY = WI.FACTORY  
             AND PQ.FACTORY = MAT.FACTORY  
             AND PQ.LOT_ID = WI.LOT_ID  
             AND PQ.MAT_ID = WI.MAT_ID  
             AND PQ.MAT_ID = MAT.MAT_ID  
             AND PQ.HIST_SEQ = WI.HIST_SEQ  
             AND MAT.FACTORY (+) = 'HMVA2' 
             AND WI.HIST_DEL_FLAG = ' ' 
             AND PQ.TRAN_TIME  BETWEEN '20200128220000' AND '20200504215959'  
     ) 
ORDER BY CHAR_ID DESC 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT DISTINCT CHAR_ID 
 FROM(  
       SELECT NVL((SELECT CHAR_ID 
                     FROM MEDCLOTDAT 
         WHERE  1=1 AND COL_SET_ID IN (SELECT COL_SET_ID FROM MEDCCOLDEF WHERE 1=1 AND COL_GRP_10='Visual'  AND DELETE_FLAG <> 'Y'   
            AND DELETE_FLAG <> 'Y' AND FACTORY=PQ.FACTORY)  
          AND LOT_ID = PQ.LOT_ID  AND VALUE_1 <> ' '  AND HIST_SEQ= PQ.HIST_SEQ and rownum=1),'-') AS CHAR_ID , TOTAL_DEFECT_QTY_1 
       FROM CPQCLOTHIS@RPTTOMES PQ  
               , MWIPMATDEF MAT   
      WHERE 1 = 1 
              AND PQ.FACTORY = 'HMVA2'  
              AND PQ.FACTORY = MAT.FACTORY  
              AND PQ.MAT_ID = MAT.MAT_ID  
        AND MAT.FACTORY (+) = 'HMVA2' 
              AND PQ.TRAN_TIME  BETWEEN '20200128220000' AND '20200504215959'  
    ) WHERE TOTAL_DEFECT_QTY_1 > 0  

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' 
       , QC_OPER, TRAN_TIME, QC_TYPE 
       , MAT_ID, LOT_ID, RES_ID, QTY_1, CUSTOMER, ASSE_SITE, LEAD_COUNT, H_PACKAGE, DENSITY, QC_OPERATOR ,SAMPLE_QTY 
       , SUM(TOTAL_DEFECT_QTY_1) AS TOTAL_QTY  , PPM, CMF_2 
       , DECODE(QC_FLAG, 'Y', 'PASS', 'FAIL') AS QC_FLAG  
       , SUM(DECODE(CHAR_ID , 'Etc' ,TOTAL_DEFECT_QTY_1,0))  AS "Etc"
       , SUM(DECODE(CHAR_ID , 'Ball Size' ,TOTAL_DEFECT_QTY_1,0))  AS "Ball Size"
       , SUM(DECODE(CHAR_ID , 'Pad Open (Ball Lift)' ,TOTAL_DEFECT_QTY_1,0))  AS "Pad Open (Ball Lift)"
       , SUM(DECODE(CHAR_ID , 'CCS Sheet Recording NG' ,TOTAL_DEFECT_QTY_1,0))  AS "CCS Sheet Recording NG"
       , SUM(DECODE(CHAR_ID , 'CCS basic information NG' ,TOTAL_DEFECT_QTY_1,0))  AS "CCS basic information NG"
       , SUM(DECODE(CHAR_ID , '-' ,TOTAL_DEFECT_QTY_1,0))  AS "-"
       , SUM(DECODE(CHAR_ID , 'T-Card Recording Defect' ,TOTAL_DEFECT_QTY_1,0))  AS "T-Card Recording Defect"
 FROM( 
       SELECT  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' 
              , PQ.QC_OPER 
              , PQ.TRAN_TIME 
              , PQ.QC_TYPE 
              , PQ.MAT_ID 
              , PQ.LOT_ID 
              , PQ.RES_ID, PQ.QC_FLAG, PQ.QC_OPERATOR 
              , WI.QTY_1  
              , NVL((SELECT DATA_1 FROM MGCMTBLDAT WHERE FACTORY='HMVA2' AND TABLE_NAME = 'H_CUSTOMER' AND KEY_1 = PQ.CUSTOMER AND ROWNUM=1), '-')  AS CUSTOMER 
              , TRIM(STS.LOT_CMF_7) AS ASSE_SITE, PQ.LEAD_COUNT, PQ.H_PACKAGE, PQ.DENSITY, PQ.SAMPLE_QTY, PQ.TOTAL_DEFECT_QTY_1, CMF_2 
              , DECODE(PQ.SAMPLE_QTY,0,0,ROUND((((PQ.TOTAL_DEFECT_QTY_1)/(PQ.SAMPLE_QTY))*1000000),0)) PPM   
              , NVL((SELECT CHAR_ID 
                       FROM MEDCLOTDAT 
                      WHERE  1=1  
                             AND COL_SET_ID IN ( 
                                                SELECT COL_SET_ID 
                                                  FROM MEDCCOLDEF 
                                                 WHERE 1=1 
                                                       AND COL_GRP_10='Visual' 
                                                       AND DELETE_FLAG <> 'Y' 
                                                      AND FACTORY=PQ.FACTORY 
                                                )  
                              AND LOT_ID = WI.LOT_ID 
                              AND VALUE_1 <> ' ' 
                              AND HIST_SEQ= PQ.HIST_SEQ 
                              AND ROWNUM = 1 ) 
                      ,'-') AS CHAR_ID  
         FROM CPQCLOTHIS@RPTTOMES PQ  
              , MWIPLOTHIS@RPTTOMES WI  
              , MWIPMATDEF MAT   
              , MWIPLOTSTS STS   
        WHERE 1 = 1 
              AND PQ.FACTORY = WI.FACTORY 
              AND PQ.FACTORY = MAT.FACTORY  
              AND PQ.MAT_ID = WI.MAT_ID  
              AND PQ.MAT_ID = MAT.MAT_ID  
              AND PQ.LOT_ID = WI.LOT_ID 
              AND PQ.LOT_ID = STS.LOT_ID 
              AND STS.LOT_CMF_7 LIKE '%'
              AND PQ.HIST_SEQ = WI.HIST_SEQ  
              AND MAT.FACTORY (+) = 'HMVA2' 
              AND WI.HIST_DEL_FLAG = ' ' 
              AND PQ.TRAN_TIME  BETWEEN '20200128220000' AND '20200504215959'  
              AND PQ.CMF_10 = ' ' 
     ) 
GROUP BY   ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' , QC_OPER, TRAN_TIME, QC_TYPE, MAT_ID, LOT_ID, RES_ID, QTY_1, CUSTOMER, ASSE_SITE, LEAD_COUNT, H_PACKAGE, DENSITY, QC_OPERATOR, SAMPLE_QTY, PPM, CMF_2, QC_FLAG 
ORDER BY   ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' , QC_OPER, TRAN_TIME, QC_TYPE, MAT_ID, LOT_ID, RES_ID, QTY_1, CUSTOMER, ASSE_SITE, LEAD_COUNT, H_PACKAGE, DENSITY, QC_OPERATOR, SAMPLE_QTY, PPM, CMF_2, QC_FLAG 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT DISTINCT CHAR_ID 
 FROM(  
       SELECT NVL((SELECT CHAR_ID 
                     FROM MEDCLOTDAT 
         WHERE  1=1 AND COL_SET_ID IN (SELECT COL_SET_ID FROM MEDCCOLDEF WHERE 1=1 AND COL_GRP_10='Visual'  AND DELETE_FLAG <> 'Y'   
            AND DELETE_FLAG <> 'Y' AND FACTORY=PQ.FACTORY)  
          AND LOT_ID = PQ.LOT_ID  AND VALUE_1 <> ' '  AND HIST_SEQ= PQ.HIST_SEQ and rownum=1),'-') AS CHAR_ID , TOTAL_DEFECT_QTY_1 
       FROM CPQCLOTHIS@RPTTOMES PQ  
               , MWIPMATDEF MAT   
      WHERE 1 = 1 
              AND PQ.FACTORY = 'HMVA2'  
              AND PQ.FACTORY = MAT.FACTORY  
              AND PQ.MAT_ID = MAT.MAT_ID  
        AND MAT.FACTORY (+) = 'HMVA2' 
              AND PQ.TRAN_TIME  BETWEEN '20200128220000' AND '20200504215959'  
    ) WHERE TOTAL_DEFECT_QTY_1 > 0  

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' 
       , NVL((SELECT CHAR_ID 
                FROM MEDCLOTDAT 
               WHERE 1=1 AND COL_SET_ID IN (SELECT COL_SET_ID FROM MEDCCOLDEF WHERE 1=1 AND COL_GRP_10='Visual'  AND DELETE_FLAG <> 'Y' AND FACTORY=PQ.FACTORY)  
                         AND COL_SET_ID IN ( 
                                             SELECT COL_SET_ID 
                                               FROM MEDCCOLDEF 
                                              WHERE 1=1 
                                                    AND COL_GRP_10='Visual' 
                                                    AND DELETE_FLAG <> 'Y' 
                                                    AND FACTORY=PQ.FACTORY  
                                           )  
                         AND LOT_ID = WI.LOT_ID 
                         AND VALUE_1 <> ' ' 
                         AND HIST_SEQ= PQ.HIST_SEQ 
                         AND ROWNUM = 1 ) 
             ,'-') AS CHAR_ID  
       , PQ.QC_OPER, PQ.TRAN_TIME, PQ.QC_TYPE, PQ.MAT_ID, PQ.LOT_ID, PQ.RES_ID, WI.QTY_1  
       , NVL((SELECT DATA_1 FROM MGCMTBLDAT WHERE FACTORY='HMVA2' AND TABLE_NAME = 'H_CUSTOMER' AND KEY_1 = PQ.CUSTOMER AND ROWNUM=1), '-')  AS CUSTOMER 
       , TRIM(STS.LOT_CMF_7) AS ASSE_SITE, PQ.LEAD_COUNT, PQ.H_PACKAGE, PQ.DENSITY, PQ.QC_OPERATOR, PQ.SAMPLE_QTY, PQ.TOTAL_DEFECT_QTY_1 
       , DECODE(PQ.SAMPLE_QTY,0,0,ROUND((((PQ.TOTAL_DEFECT_QTY_1)/(PQ.SAMPLE_QTY))*1000000),0)) PPM   
  FROM CPQCLOTHIS@RPTTOMES PQ  
       , MWIPLOTHIS@RPTTOMES WI  
       , MWIPMATDEF MAT   
       , MWIPLOTSTS STS   
 WHERE 1 = 1 
       AND PQ.FACTORY = WI.FACTORY 
       AND PQ.FACTORY = MAT.FACTORY  
       AND PQ.LOT_ID = WI.LOT_ID 
       AND PQ.LOT_ID = STS.LOT_ID 
       AND STS.LOT_CMF_7 LIKE '%'
       AND PQ.MAT_ID = WI.MAT_ID  
       AND PQ.MAT_ID = MAT.MAT_ID  
       AND PQ.HIST_SEQ = WI.HIST_SEQ  
       AND MAT.FACTORY (+) = 'HMVA2' 
       AND WI.HIST_DEL_FLAG = ' ' 
       AND PQ.TRAN_TIME  BETWEEN '20200128220000' AND '20200504215959'  
       AND PQ.CMF_10 = ' ' 
ORDER BY  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' 
         , CHAR_ID DESC, MAT_ID, LOT_ID, TRAN_TIME, QC_OPER, QC_TYPE   

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT ' '  
       , SUM(DECODE(CHAR_ID , 'Etc' ,TOTAL_DEFECT_QTY_1,0))  AS "Etc"
       , SUM(DECODE(CHAR_ID , 'Ball Size' ,TOTAL_DEFECT_QTY_1,0))  AS "Ball Size"
       , SUM(DECODE(CHAR_ID , 'Pad Open (Ball Lift)' ,TOTAL_DEFECT_QTY_1,0))  AS "Pad Open (Ball Lift)"
       , SUM(DECODE(CHAR_ID , 'CCS Sheet Recording NG' ,TOTAL_DEFECT_QTY_1,0))  AS "CCS Sheet Recording NG"
       , SUM(DECODE(CHAR_ID , 'CCS basic information NG' ,TOTAL_DEFECT_QTY_1,0))  AS "CCS basic information NG"
       , SUM(DECODE(CHAR_ID , '-' ,TOTAL_DEFECT_QTY_1,0))  AS "-"
       , SUM(DECODE(CHAR_ID , 'T-Card Recording Defect' ,TOTAL_DEFECT_QTY_1,0))  AS "T-Card Recording Defect"
 FROM( 
      SELECT PQ.TOTAL_DEFECT_QTY_1 
             , NVL((SELECT CHAR_ID 
                      FROM MEDCLOTDAT 
                     WHERE 1=1 
                           AND COL_SET_ID IN 
                                           (SELECT COL_SET_ID 
                                              FROM MEDCCOLDEF 
                                             WHERE 1=1 
                                                   AND COL_GRP_10='Visual' 
                                                   AND DELETE_FLAG <> 'Y' 
                                                   AND FACTORY=PQ.FACTORY 
                                           )  
                           AND LOT_ID = PQ.LOT_ID 
                           AND VALUE_1 <> ' ' 
                           AND HIST_SEQ = PQ.HIST_SEQ 
                           AND ROWNUM = 1 ) 
                     ,' ') AS CHAR_ID 
        FROM CPQCLOTHIS@RPTTOMES PQ  
             ,MWIPLOTHIS@RPTTOMES WI  
             ,MWIPMATDEF MAT  
       WHERE 1=1 
             AND PQ.FACTORY = WI.FACTORY  
             AND PQ.FACTORY = MAT.FACTORY  
             AND PQ.LOT_ID = WI.LOT_ID  
             AND PQ.MAT_ID = WI.MAT_ID  
             AND PQ.MAT_ID = MAT.MAT_ID  
             AND PQ.HIST_SEQ = WI.HIST_SEQ  
             AND MAT.FACTORY (+) = 'HMVA2' 
             AND WI.HIST_DEL_FLAG = ' ' 
             AND PQ.TRAN_TIME  BETWEEN '20200128220000' AND '20200504215959'  
     ) 
ORDER BY CHAR_ID DESC 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
    SELECT   ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' 
          , A.QC_OPER, A.TRAN_TIME,A.QC_TYPE, A.MAT_ID, A.LOT_ID, A.RES_ID, A.QTY_1, A.CUSTOMER, A.ASSE_SITE,A.LEAD_COUNT, A.H_PACKAGE, A.DENSITY, QC_OPERATOR, A.SAMPLE_QTY  
          , A.TOTAL_DEFECT_QTY_1  ,B.CHAR_ID, B.LOWER_SPEC_LIMIT, B.UPPER_SPEC_LIMIT 
          , VALUE_1 , VALUE_2, VALUE_3, VALUE_4, VALUE_5, VALUE_6, VALUE_7, VALUE_8, VALUE_9, VALUE_10, VALUE_11, VALUE_12, VALUE_13, VALUE_14, VALUE_15 
          , VALUE_16, VALUE_17, VALUE_18, VALUE_19, VALUE_20, VALUE_21, VALUE_22, VALUE_23, VALUE_24, VALUE_25   
       FROM (   
          SELECT   ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' 
               , PQ.QC_OPER, PQ.TRAN_TIME, PQ.QC_TYPE, PQ.MAT_ID, PQ.LOT_ID, PQ.RES_ID, WI.QTY_1  
              , NVL((SELECT DATA_1 FROM MGCMTBLDAT WHERE FACTORY='HMVA2' AND TABLE_NAME = 'H_CUSTOMER' AND KEY_1 = PQ.CUSTOMER AND ROWNUM=1), '-')  AS CUSTOMER   
              , TRIM(STS.LOT_CMF_7) AS ASSE_SITE, PQ.LEAD_COUNT, PQ.H_PACKAGE, PQ.DENSITY, PQ.SAMPLE_QTY, PQ.TOTAL_DEFECT_QTY_1   
              , NVL((SELECT COL_SET_ID FROM MEDCLOTDAT   
                          WHERE  1=1 AND COL_SET_ID IN (SELECT COL_SET_ID FROM MEDCCOLDEF WHERE 1=1 AND FACTORY=PQ.FACTORY AND COL_GRP_10='Measure'  AND DELETE_FLAG <> 'Y' ) 
                                  AND LOT_ID = WI.LOT_ID  AND VALUE_1 <> ' '  AND HIST_SEQ= PQ.HIST_SEQ  AND ROWNUM = 1 ),'-') AS COL_SET_ID   
              , PQ.HIST_SEQ, PQ.FACTORY, PQ.QC_OPERATOR    
        FROM CPQCLOTHIS@RPTTOMES PQ  
               , MWIPLOTHIS@RPTTOMES WI  
               , MWIPMATDEF MAT   
               , MWIPLOTSTS STS   
       WHERE 1 = 1 
              AND PQ.FACTORY = WI.FACTORY 
              AND PQ.FACTORY = MAT.FACTORY  
              AND PQ.LOT_ID = WI.LOT_ID 
              AND PQ.LOT_ID = STS.LOT_ID 
              AND STS.LOT_CMF_7 LIKE '%'
              AND PQ.MAT_ID = MAT.MAT_ID  
              AND PQ.HIST_SEQ = WI.HIST_SEQ  
        AND MAT.FACTORY (+) = 'HMVA2' 
              AND WI.HIST_DEL_FLAG = ' ' 
              AND PQ.TRAN_TIME  BETWEEN '20200128220000' AND '20200504215959'  
              AND PQ.CMF_10 = 'Y' 
       )  A, 
    (SELECT DA.LOT_ID, DA.HIST_SEQ, DA.FACTORY, DA.MAT_ID, DA.COL_SET_ID, DA.COL_SET_VERSION, DA.CHAR_ID, DA.TRAN_TIME     
          , DA.VALUE_1 , DA.VALUE_2, DA.VALUE_3, DA.VALUE_4, DA.VALUE_5, DA.VALUE_6, DA.VALUE_7, DA.VALUE_8, DA.VALUE_9, DA.VALUE_10, DA.VALUE_11 ,DA.VALUE_12 
          , DA.VALUE_13, DA.VALUE_14, DA.VALUE_15, DA.VALUE_16, DA.VALUE_17, DA.VALUE_18, DA.VALUE_19, DA.VALUE_20, DA.VALUE_21, DA.VALUE_22, DA.VALUE_23, DA.VALUE_24, DA.VALUE_25     
          , DECODE(NVL(CH.UPPER_SPEC_LIMIT,0), ' ', 0, CH.UPPER_SPEC_LIMIT) UPPER_SPEC_LIMIT, DECODE(NVL(CH.LOWER_SPEC_LIMIT,0),' ',0,CH.LOWER_SPEC_LIMIT) LOWER_SPEC_LIMIT
      FROM MEDCCOLCHR@RPTTOMES CH  
          , (SELECT LOT_ID, HIST_SEQ,FACTORY, MAT_ID, COL_SET_ID, COL_SET_VERSION, CHAR_ID, TRAN_TIME  
                  , VALUE_1 , VALUE_2, VALUE_3, VALUE_4, VALUE_5, VALUE_6, VALUE_7, VALUE_8, VALUE_9, VALUE_10, VALUE_11, VALUE_12, VALUE_13, VALUE_14, VALUE_15 
                  , VALUE_16, VALUE_17, VALUE_18, VALUE_19, VALUE_20, VALUE_21, VALUE_22, VALUE_23, VALUE_24, VALUE_25 
               FROM MEDCLOTDAT@RPTTOMES   
             WHERE   1 = 1 
                  AND COL_SET_ID IN (SELECT COL_SET_ID FROM MEDCCOLDEF@RPTTOMES WHERE   1=1  AND FACTORY = 'HMVA2' AND COL_GRP_10='Measure' AND DELETE_FLAG <> 'Y' )
         AND FACTORY (+) = 'HMVA2' 
              AND TRAN_TIME  BETWEEN '20200128220000' AND '20200504215959'  
                  AND VALUE_1 <> ' ' 
           ) DA  
      WHERE   1 = 1 
       AND DA.FACTORY = CH.FACTORY 
         AND DA.FACTORY (+) = 'HMVA2' 
       AND DA.COL_SET_ID = CH.COL_SET_ID  
       AND DA.COL_SET_VERSION = CH.COL_SET_VERSION   ) B 
  WHERE   1 = 1 
       AND A.FACTORY = B.FACTORY 
       AND A.LOT_ID   = B.LOT_ID  
       AND A.MAT_ID = B.MAT_ID 
       AND A.HIST_SEQ = B.HIST_SEQ 
         AND A.FACTORY (+) = 'HMVA2' 
              AND A.COL_SET_ID = B.COL_SET_ID 
 ORDER BY   ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' ,A.QC_OPER, A.TRAN_TIME,A.QC_TYPE, A.MAT_ID, A.LOT_ID, A.RES_ID, A.CUSTOMER, A.H_PACKAGE, A.DENSITY ,B.CHAR_ID  

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
    SELECT   ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' 
          , A.QC_OPER, A.TRAN_TIME,A.QC_TYPE, A.MAT_ID, A.LOT_ID, A.RES_ID, A.QTY_1, A.CUSTOMER, A.ASSE_SITE,A.LEAD_COUNT, A.H_PACKAGE, A.DENSITY, QC_OPERATOR, A.SAMPLE_QTY  
          , A.TOTAL_DEFECT_QTY_1  ,B.CHAR_ID, B.LOWER_SPEC_LIMIT, B.UPPER_SPEC_LIMIT 
          , VALUE_1 , VALUE_2, VALUE_3, VALUE_4, VALUE_5, VALUE_6, VALUE_7, VALUE_8, VALUE_9, VALUE_10, VALUE_11, VALUE_12, VALUE_13, VALUE_14, VALUE_15 
          , VALUE_16, VALUE_17, VALUE_18, VALUE_19, VALUE_20, VALUE_21, VALUE_22, VALUE_23, VALUE_24, VALUE_25   
       FROM (   
          SELECT   ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' 
               , PQ.QC_OPER, PQ.TRAN_TIME, PQ.QC_TYPE, PQ.MAT_ID, PQ.LOT_ID, PQ.RES_ID, WI.QTY_1  
              , NVL((SELECT DATA_1 FROM MGCMTBLDAT WHERE FACTORY='HMVA2' AND TABLE_NAME = 'H_CUSTOMER' AND KEY_1 = PQ.CUSTOMER AND ROWNUM=1), '-')  AS CUSTOMER   
              , TRIM(STS.LOT_CMF_7) AS ASSE_SITE, PQ.LEAD_COUNT, PQ.H_PACKAGE, PQ.DENSITY, PQ.SAMPLE_QTY, PQ.TOTAL_DEFECT_QTY_1   
              , NVL((SELECT COL_SET_ID FROM MEDCLOTDAT   
                          WHERE  1=1 AND COL_SET_ID IN (SELECT COL_SET_ID FROM MEDCCOLDEF WHERE 1=1 AND FACTORY=PQ.FACTORY AND COL_GRP_10='Measure'  AND DELETE_FLAG <> 'Y' ) 
                                  AND LOT_ID = WI.LOT_ID  AND VALUE_1 <> ' '  AND HIST_SEQ= PQ.HIST_SEQ  AND ROWNUM = 1 ),'-') AS COL_SET_ID   
              , PQ.HIST_SEQ, PQ.FACTORY, PQ.QC_OPERATOR    
        FROM CPQCLOTHIS@RPTTOMES PQ  
               , MWIPLOTHIS@RPTTOMES WI  
               , MWIPMATDEF MAT   
               , MWIPLOTSTS STS   
       WHERE 1 = 1 
              AND PQ.FACTORY = WI.FACTORY 
              AND PQ.FACTORY = MAT.FACTORY  
              AND PQ.LOT_ID = WI.LOT_ID 
              AND PQ.LOT_ID = STS.LOT_ID 
              AND STS.LOT_CMF_7 LIKE '%'
              AND PQ.MAT_ID = MAT.MAT_ID  
              AND PQ.HIST_SEQ = WI.HIST_SEQ  
        AND MAT.FACTORY (+) = 'HMVA2' 
              AND WI.HIST_DEL_FLAG = ' ' 
              AND PQ.TRAN_TIME  BETWEEN '20200128220000' AND '20200504215959'  
              AND PQ.CMF_10 = 'Y' 
       )  A, 
    (SELECT DA.LOT_ID, DA.HIST_SEQ, DA.FACTORY, DA.MAT_ID, DA.COL_SET_ID, DA.COL_SET_VERSION, DA.CHAR_ID, DA.TRAN_TIME     
          , DA.VALUE_1 , DA.VALUE_2, DA.VALUE_3, DA.VALUE_4, DA.VALUE_5, DA.VALUE_6, DA.VALUE_7, DA.VALUE_8, DA.VALUE_9, DA.VALUE_10, DA.VALUE_11 ,DA.VALUE_12 
          , DA.VALUE_13, DA.VALUE_14, DA.VALUE_15, DA.VALUE_16, DA.VALUE_17, DA.VALUE_18, DA.VALUE_19, DA.VALUE_20, DA.VALUE_21, DA.VALUE_22, DA.VALUE_23, DA.VALUE_24, DA.VALUE_25     
          , DECODE(NVL(CH.UPPER_SPEC_LIMIT,0), ' ', 0, CH.UPPER_SPEC_LIMIT) UPPER_SPEC_LIMIT, DECODE(NVL(CH.LOWER_SPEC_LIMIT,0),' ',0,CH.LOWER_SPEC_LIMIT) LOWER_SPEC_LIMIT
      FROM MEDCCOLCHR@RPTTOMES CH  
          , (SELECT LOT_ID, HIST_SEQ,FACTORY, MAT_ID, COL_SET_ID, COL_SET_VERSION, CHAR_ID, TRAN_TIME  
                  , VALUE_1 , VALUE_2, VALUE_3, VALUE_4, VALUE_5, VALUE_6, VALUE_7, VALUE_8, VALUE_9, VALUE_10, VALUE_11, VALUE_12, VALUE_13, VALUE_14, VALUE_15 
                  , VALUE_16, VALUE_17, VALUE_18, VALUE_19, VALUE_20, VALUE_21, VALUE_22, VALUE_23, VALUE_24, VALUE_25 
               FROM MEDCLOTDAT@RPTTOMES   
             WHERE   1 = 1 
                  AND COL_SET_ID IN (SELECT COL_SET_ID FROM MEDCCOLDEF@RPTTOMES WHERE   1=1  AND FACTORY = 'HMVA2' AND COL_GRP_10='Measure' AND DELETE_FLAG <> 'Y' )
         AND FACTORY (+) = 'HMVA2' 
              AND TRAN_TIME  BETWEEN '20200128220000' AND '20200504215959'  
                  AND VALUE_1 <> ' ' 
           ) DA  
      WHERE   1 = 1 
       AND DA.FACTORY = CH.FACTORY 
         AND DA.FACTORY (+) = 'HMVA2' 
       AND DA.COL_SET_ID = CH.COL_SET_ID  
       AND DA.COL_SET_VERSION = CH.COL_SET_VERSION   ) B 
  WHERE   1 = 1 
       AND A.FACTORY = B.FACTORY 
       AND A.LOT_ID   = B.LOT_ID  
       AND A.MAT_ID = B.MAT_ID 
       AND A.HIST_SEQ = B.HIST_SEQ 
         AND A.FACTORY (+) = 'HMVA2' 
              AND A.COL_SET_ID = B.COL_SET_ID 
 ORDER BY   ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' ,A.QC_OPER, A.TRAN_TIME,A.QC_TYPE, A.MAT_ID, A.LOT_ID, A.RES_ID, A.CUSTOMER, A.H_PACKAGE, A.DENSITY ,B.CHAR_ID  

-------------------------------------------------------------
SELECT * FROM RWEBUSRDEF WHERE FACTORY = :FACTORY AND USER_ID= :USER_ID
-------------------------------------------------------------
SELECT A.FUNC_GRP_SEQ,A.SEC_GRP_ID,A.FUNC_GRP_ID,NVL(A.FUNC_NAME, ' ') FUNC_NAME, NVL(B.FUNC_DESC, ' ') FUNC_DESC, LANGUAGE_1, LANGUAGE_2, LANGUAGE_3
  FROM RWEBGRPFUN A, RWEBFUNDEF B
 WHERE A.FACTORY = :p_FACTORY
   AND A.SEC_GRP_ID = :p_SEC_GRP_ID
   AND A.FUNC_NAME=B.FUNC_NAME(+)
 ORDER BY A.FUNC_GRP_SEQ, A.FUNC_SEQ
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
 SELECT PLAN_WEEK V1    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_DATE = TO_CHAR(SYSDATE,'yyyymmdd')      AND ROWNUM = 1  
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('2020', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('2020', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT LANGUAGE_2 FROM RWEBFUNDEF WHERE FUNC_NAME = 'PQC030110'
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT DISTINCT CHAR_ID 
 FROM(  
       SELECT NVL((SELECT CHAR_ID 
                     FROM MEDCLOTDAT 
         WHERE  1=1 AND COL_SET_ID IN (SELECT COL_SET_ID FROM MEDCCOLDEF WHERE 1=1 AND COL_GRP_10='Visual'  AND DELETE_FLAG <> 'Y'   
            AND DELETE_FLAG <> 'Y' AND FACTORY=PQ.FACTORY)  
          AND LOT_ID = PQ.LOT_ID  AND VALUE_1 <> ' '  AND HIST_SEQ= PQ.HIST_SEQ and rownum=1),'-') AS CHAR_ID , TOTAL_DEFECT_QTY_1 
       FROM CPQCLOTHIS@RPTTOMES PQ  
               , MWIPMATDEF MAT   
      WHERE 1 = 1 
              AND PQ.FACTORY = 'HMVA2'  
              AND PQ.FACTORY = MAT.FACTORY  
              AND PQ.MAT_ID = MAT.MAT_ID  
        AND MAT.FACTORY (+) = 'HMVA2' 
              AND PQ.TRAN_TIME  BETWEEN '20200503220000' AND '20200504215959'  
    ) WHERE TOTAL_DEFECT_QTY_1 > 0  

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' 
       , QC_OPER, TRAN_TIME, QC_TYPE 
       , MAT_ID, LOT_ID, RES_ID, QTY_1, CUSTOMER, ASSE_SITE, LEAD_COUNT, H_PACKAGE, DENSITY, QC_OPERATOR ,SAMPLE_QTY 
       , SUM(TOTAL_DEFECT_QTY_1) AS TOTAL_QTY  , PPM, CMF_2 
       , DECODE(QC_FLAG, 'Y', 'PASS', 'FAIL') AS QC_FLAG  
 FROM( 
       SELECT  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' 
              , PQ.QC_OPER 
              , PQ.TRAN_TIME 
              , PQ.QC_TYPE 
              , PQ.MAT_ID 
              , PQ.LOT_ID 
              , PQ.RES_ID, PQ.QC_FLAG, PQ.QC_OPERATOR 
              , WI.QTY_1  
              , NVL((SELECT DATA_1 FROM MGCMTBLDAT WHERE FACTORY='HMVA2' AND TABLE_NAME = 'H_CUSTOMER' AND KEY_1 = PQ.CUSTOMER AND ROWNUM=1), '-')  AS CUSTOMER 
              , TRIM(STS.LOT_CMF_7) AS ASSE_SITE, PQ.LEAD_COUNT, PQ.H_PACKAGE, PQ.DENSITY, PQ.SAMPLE_QTY, PQ.TOTAL_DEFECT_QTY_1, CMF_2 
              , DECODE(PQ.SAMPLE_QTY,0,0,ROUND((((PQ.TOTAL_DEFECT_QTY_1)/(PQ.SAMPLE_QTY))*1000000),0)) PPM   
              , NVL((SELECT CHAR_ID 
                       FROM MEDCLOTDAT 
                      WHERE  1=1  
                             AND COL_SET_ID IN ( 
                                                SELECT COL_SET_ID 
                                                  FROM MEDCCOLDEF 
                                                 WHERE 1=1 
                                                       AND COL_GRP_10='Visual' 
                                                       AND DELETE_FLAG <> 'Y' 
                                                      AND FACTORY=PQ.FACTORY 
                                                )  
                              AND LOT_ID = WI.LOT_ID 
                              AND VALUE_1 <> ' ' 
                              AND HIST_SEQ= PQ.HIST_SEQ 
                              AND ROWNUM = 1 ) 
                      ,'-') AS CHAR_ID  
         FROM CPQCLOTHIS@RPTTOMES PQ  
              , MWIPLOTHIS@RPTTOMES WI  
              , MWIPMATDEF MAT   
              , MWIPLOTSTS STS   
        WHERE 1 = 1 
              AND PQ.FACTORY = WI.FACTORY 
              AND PQ.FACTORY = MAT.FACTORY  
              AND PQ.MAT_ID = WI.MAT_ID  
              AND PQ.MAT_ID = MAT.MAT_ID  
              AND PQ.LOT_ID = WI.LOT_ID 
              AND PQ.LOT_ID = STS.LOT_ID 
              AND STS.LOT_CMF_7 LIKE '%'
              AND PQ.HIST_SEQ = WI.HIST_SEQ  
              AND MAT.FACTORY (+) = 'HMVA2' 
              AND WI.HIST_DEL_FLAG = ' ' 
              AND PQ.TRAN_TIME  BETWEEN '20200503220000' AND '20200504215959'  
              AND PQ.CMF_10 = ' ' 
     ) 
GROUP BY   ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' , QC_OPER, TRAN_TIME, QC_TYPE, MAT_ID, LOT_ID, RES_ID, QTY_1, CUSTOMER, ASSE_SITE, LEAD_COUNT, H_PACKAGE, DENSITY, QC_OPERATOR, SAMPLE_QTY, PPM, CMF_2, QC_FLAG 
ORDER BY   ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' , QC_OPER, TRAN_TIME, QC_TYPE, MAT_ID, LOT_ID, RES_ID, QTY_1, CUSTOMER, ASSE_SITE, LEAD_COUNT, H_PACKAGE, DENSITY, QC_OPERATOR, SAMPLE_QTY, PPM, CMF_2, QC_FLAG 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT DISTINCT CHAR_ID 
 FROM(  
       SELECT NVL((SELECT CHAR_ID 
                     FROM MEDCLOTDAT 
         WHERE  1=1 AND COL_SET_ID IN (SELECT COL_SET_ID FROM MEDCCOLDEF WHERE 1=1 AND COL_GRP_10='Visual'  AND DELETE_FLAG <> 'Y'   
            AND DELETE_FLAG <> 'Y' AND FACTORY=PQ.FACTORY)  
          AND LOT_ID = PQ.LOT_ID  AND VALUE_1 <> ' '  AND HIST_SEQ= PQ.HIST_SEQ and rownum=1),'-') AS CHAR_ID , TOTAL_DEFECT_QTY_1 
       FROM CPQCLOTHIS@RPTTOMES PQ  
               , MWIPMATDEF MAT   
      WHERE 1 = 1 
              AND PQ.FACTORY = 'HMVA2'  
              AND PQ.FACTORY = MAT.FACTORY  
              AND PQ.MAT_ID = MAT.MAT_ID  
        AND MAT.FACTORY (+) = 'HMVA2' 
              AND PQ.TRAN_TIME  BETWEEN '20200503220000' AND '20200504215959'  
    ) WHERE TOTAL_DEFECT_QTY_1 > 0  

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' 
       , QC_OPER, TRAN_TIME, QC_TYPE 
       , MAT_ID, LOT_ID, RES_ID, QTY_1, CUSTOMER, ASSE_SITE, LEAD_COUNT, H_PACKAGE, DENSITY, QC_OPERATOR ,SAMPLE_QTY 
       , SUM(TOTAL_DEFECT_QTY_1) AS TOTAL_QTY  , PPM, CMF_2 
       , DECODE(QC_FLAG, 'Y', 'PASS', 'FAIL') AS QC_FLAG  
 FROM( 
       SELECT  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' 
              , PQ.QC_OPER 
              , PQ.TRAN_TIME 
              , PQ.QC_TYPE 
              , PQ.MAT_ID 
              , PQ.LOT_ID 
              , PQ.RES_ID, PQ.QC_FLAG, PQ.QC_OPERATOR 
              , WI.QTY_1  
              , NVL((SELECT DATA_1 FROM MGCMTBLDAT WHERE FACTORY='HMVA2' AND TABLE_NAME = 'H_CUSTOMER' AND KEY_1 = PQ.CUSTOMER AND ROWNUM=1), '-')  AS CUSTOMER 
              , TRIM(STS.LOT_CMF_7) AS ASSE_SITE, PQ.LEAD_COUNT, PQ.H_PACKAGE, PQ.DENSITY, PQ.SAMPLE_QTY, PQ.TOTAL_DEFECT_QTY_1, CMF_2 
              , DECODE(PQ.SAMPLE_QTY,0,0,ROUND((((PQ.TOTAL_DEFECT_QTY_1)/(PQ.SAMPLE_QTY))*1000000),0)) PPM   
              , NVL((SELECT CHAR_ID 
                       FROM MEDCLOTDAT 
                      WHERE  1=1  
                             AND COL_SET_ID IN ( 
                                                SELECT COL_SET_ID 
                                                  FROM MEDCCOLDEF 
                                                 WHERE 1=1 
                                                       AND COL_GRP_10='Visual' 
                                                       AND DELETE_FLAG <> 'Y' 
                                                      AND FACTORY=PQ.FACTORY 
                                                )  
                              AND LOT_ID = WI.LOT_ID 
                              AND VALUE_1 <> ' ' 
                              AND HIST_SEQ= PQ.HIST_SEQ 
                              AND ROWNUM = 1 ) 
                      ,'-') AS CHAR_ID  
         FROM CPQCLOTHIS@RPTTOMES PQ  
              , MWIPLOTHIS@RPTTOMES WI  
              , MWIPMATDEF MAT   
              , MWIPLOTSTS STS   
        WHERE 1 = 1 
              AND PQ.FACTORY = WI.FACTORY 
              AND PQ.FACTORY = MAT.FACTORY  
              AND PQ.MAT_ID = WI.MAT_ID  
              AND PQ.MAT_ID = MAT.MAT_ID  
              AND PQ.LOT_ID = WI.LOT_ID 
              AND PQ.LOT_ID = STS.LOT_ID 
              AND STS.LOT_CMF_7 LIKE '%'
              AND PQ.HIST_SEQ = WI.HIST_SEQ  
              AND MAT.FACTORY (+) = 'HMVA2' 
              AND WI.HIST_DEL_FLAG = ' ' 
              AND PQ.TRAN_TIME  BETWEEN '20200503220000' AND '20200504215959'  
              AND PQ.CMF_10 = ' ' 
     ) 
GROUP BY   ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' , QC_OPER, TRAN_TIME, QC_TYPE, MAT_ID, LOT_ID, RES_ID, QTY_1, CUSTOMER, ASSE_SITE, LEAD_COUNT, H_PACKAGE, DENSITY, QC_OPERATOR, SAMPLE_QTY, PPM, CMF_2, QC_FLAG 
ORDER BY   ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' , QC_OPER, TRAN_TIME, QC_TYPE, MAT_ID, LOT_ID, RES_ID, QTY_1, CUSTOMER, ASSE_SITE, LEAD_COUNT, H_PACKAGE, DENSITY, QC_OPERATOR, SAMPLE_QTY, PPM, CMF_2, QC_FLAG 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT DISTINCT CHAR_ID 
 FROM(  
       SELECT NVL((SELECT CHAR_ID 
                     FROM MEDCLOTDAT 
         WHERE  1=1 AND COL_SET_ID IN (SELECT COL_SET_ID FROM MEDCCOLDEF WHERE 1=1 AND COL_GRP_10='Visual'  AND DELETE_FLAG <> 'Y'   
            AND DELETE_FLAG <> 'Y' AND FACTORY=PQ.FACTORY)  
          AND LOT_ID = PQ.LOT_ID  AND VALUE_1 <> ' '  AND HIST_SEQ= PQ.HIST_SEQ and rownum=1),'-') AS CHAR_ID , TOTAL_DEFECT_QTY_1 
       FROM CPQCLOTHIS@RPTTOMES PQ  
               , MWIPMATDEF MAT   
      WHERE 1 = 1 
              AND PQ.FACTORY = 'HMVA2'  
              AND PQ.FACTORY = MAT.FACTORY  
              AND PQ.MAT_ID = MAT.MAT_ID  
        AND MAT.FACTORY (+) = 'HMVA2' 
              AND PQ.TRAN_TIME  BETWEEN '20200503220000' AND '20200504215959'  
    ) WHERE TOTAL_DEFECT_QTY_1 > 0  

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' 
       , QC_OPER, TRAN_TIME, QC_TYPE 
       , MAT_ID, LOT_ID, RES_ID, QTY_1, CUSTOMER, ASSE_SITE, LEAD_COUNT, H_PACKAGE, DENSITY, QC_OPERATOR ,SAMPLE_QTY 
       , SUM(TOTAL_DEFECT_QTY_1) AS TOTAL_QTY  , PPM, CMF_2 
       , DECODE(QC_FLAG, 'Y', 'PASS', 'FAIL') AS QC_FLAG  
 FROM( 
       SELECT  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' 
              , PQ.QC_OPER 
              , PQ.TRAN_TIME 
              , PQ.QC_TYPE 
              , PQ.MAT_ID 
              , PQ.LOT_ID 
              , PQ.RES_ID, PQ.QC_FLAG, PQ.QC_OPERATOR 
              , WI.QTY_1  
              , NVL((SELECT DATA_1 FROM MGCMTBLDAT WHERE FACTORY='HMVA2' AND TABLE_NAME = 'H_CUSTOMER' AND KEY_1 = PQ.CUSTOMER AND ROWNUM=1), '-')  AS CUSTOMER 
              , TRIM(STS.LOT_CMF_7) AS ASSE_SITE, PQ.LEAD_COUNT, PQ.H_PACKAGE, PQ.DENSITY, PQ.SAMPLE_QTY, PQ.TOTAL_DEFECT_QTY_1, CMF_2 
              , DECODE(PQ.SAMPLE_QTY,0,0,ROUND((((PQ.TOTAL_DEFECT_QTY_1)/(PQ.SAMPLE_QTY))*1000000),0)) PPM   
              , NVL((SELECT CHAR_ID 
                       FROM MEDCLOTDAT 
                      WHERE  1=1  
                             AND COL_SET_ID IN ( 
                                                SELECT COL_SET_ID 
                                                  FROM MEDCCOLDEF 
                                                 WHERE 1=1 
                                                       AND COL_GRP_10='Visual' 
                                                       AND DELETE_FLAG <> 'Y' 
                                                      AND FACTORY=PQ.FACTORY 
                                                )  
                              AND LOT_ID = WI.LOT_ID 
                              AND VALUE_1 <> ' ' 
                              AND HIST_SEQ= PQ.HIST_SEQ 
                              AND ROWNUM = 1 ) 
                      ,'-') AS CHAR_ID  
         FROM CPQCLOTHIS@RPTTOMES PQ  
              , MWIPLOTHIS@RPTTOMES WI  
              , MWIPMATDEF MAT   
              , MWIPLOTSTS STS   
        WHERE 1 = 1 
              AND PQ.FACTORY = WI.FACTORY 
              AND PQ.FACTORY = MAT.FACTORY  
              AND PQ.MAT_ID = WI.MAT_ID  
              AND PQ.MAT_ID = MAT.MAT_ID  
              AND PQ.LOT_ID = WI.LOT_ID 
              AND PQ.LOT_ID = STS.LOT_ID 
              AND STS.LOT_CMF_7 LIKE '%'
              AND PQ.HIST_SEQ = WI.HIST_SEQ  
              AND MAT.FACTORY (+) = 'HMVA2' 
              AND WI.HIST_DEL_FLAG = ' ' 
              AND PQ.TRAN_TIME  BETWEEN '20200503220000' AND '20200504215959'  
              AND PQ.CMF_10 = ' ' 
     ) 
GROUP BY   ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' , QC_OPER, TRAN_TIME, QC_TYPE, MAT_ID, LOT_ID, RES_ID, QTY_1, CUSTOMER, ASSE_SITE, LEAD_COUNT, H_PACKAGE, DENSITY, QC_OPERATOR, SAMPLE_QTY, PPM, CMF_2, QC_FLAG 
ORDER BY   ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' , QC_OPER, TRAN_TIME, QC_TYPE, MAT_ID, LOT_ID, RES_ID, QTY_1, CUSTOMER, ASSE_SITE, LEAD_COUNT, H_PACKAGE, DENSITY, QC_OPERATOR, SAMPLE_QTY, PPM, CMF_2, QC_FLAG 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT DISTINCT CHAR_ID 
 FROM(  
       SELECT NVL((SELECT CHAR_ID 
                     FROM MEDCLOTDAT 
         WHERE  1=1 AND COL_SET_ID IN (SELECT COL_SET_ID FROM MEDCCOLDEF WHERE 1=1 AND COL_GRP_10='Visual'  AND DELETE_FLAG <> 'Y'   
            AND DELETE_FLAG <> 'Y' AND FACTORY=PQ.FACTORY)  
          AND LOT_ID = PQ.LOT_ID  AND VALUE_1 <> ' '  AND HIST_SEQ= PQ.HIST_SEQ and rownum=1),'-') AS CHAR_ID , TOTAL_DEFECT_QTY_1 
       FROM CPQCLOTHIS@RPTTOMES PQ  
               , MWIPMATDEF MAT   
      WHERE 1 = 1 
              AND PQ.FACTORY = 'HMVA2'  
              AND PQ.FACTORY = MAT.FACTORY  
              AND PQ.MAT_ID = MAT.MAT_ID  
        AND MAT.FACTORY (+) = 'HMVA2' 
              AND PQ.TRAN_TIME  BETWEEN '20200429220000' AND '20200504215959'  
    ) WHERE TOTAL_DEFECT_QTY_1 > 0  

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' 
       , QC_OPER, TRAN_TIME, QC_TYPE 
       , MAT_ID, LOT_ID, RES_ID, QTY_1, CUSTOMER, ASSE_SITE, LEAD_COUNT, H_PACKAGE, DENSITY, QC_OPERATOR ,SAMPLE_QTY 
       , SUM(TOTAL_DEFECT_QTY_1) AS TOTAL_QTY  , PPM, CMF_2 
       , DECODE(QC_FLAG, 'Y', 'PASS', 'FAIL') AS QC_FLAG  
 FROM( 
       SELECT  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' 
              , PQ.QC_OPER 
              , PQ.TRAN_TIME 
              , PQ.QC_TYPE 
              , PQ.MAT_ID 
              , PQ.LOT_ID 
              , PQ.RES_ID, PQ.QC_FLAG, PQ.QC_OPERATOR 
              , WI.QTY_1  
              , NVL((SELECT DATA_1 FROM MGCMTBLDAT WHERE FACTORY='HMVA2' AND TABLE_NAME = 'H_CUSTOMER' AND KEY_1 = PQ.CUSTOMER AND ROWNUM=1), '-')  AS CUSTOMER 
              , TRIM(STS.LOT_CMF_7) AS ASSE_SITE, PQ.LEAD_COUNT, PQ.H_PACKAGE, PQ.DENSITY, PQ.SAMPLE_QTY, PQ.TOTAL_DEFECT_QTY_1, CMF_2 
              , DECODE(PQ.SAMPLE_QTY,0,0,ROUND((((PQ.TOTAL_DEFECT_QTY_1)/(PQ.SAMPLE_QTY))*1000000),0)) PPM   
              , NVL((SELECT CHAR_ID 
                       FROM MEDCLOTDAT 
                      WHERE  1=1  
                             AND COL_SET_ID IN ( 
                                                SELECT COL_SET_ID 
                                                  FROM MEDCCOLDEF 
                                                 WHERE 1=1 
                                                       AND COL_GRP_10='Visual' 
                                                       AND DELETE_FLAG <> 'Y' 
                                                      AND FACTORY=PQ.FACTORY 
                                                )  
                              AND LOT_ID = WI.LOT_ID 
                              AND VALUE_1 <> ' ' 
                              AND HIST_SEQ= PQ.HIST_SEQ 
                              AND ROWNUM = 1 ) 
                      ,'-') AS CHAR_ID  
         FROM CPQCLOTHIS@RPTTOMES PQ  
              , MWIPLOTHIS@RPTTOMES WI  
              , MWIPMATDEF MAT   
              , MWIPLOTSTS STS   
        WHERE 1 = 1 
              AND PQ.FACTORY = WI.FACTORY 
              AND PQ.FACTORY = MAT.FACTORY  
              AND PQ.MAT_ID = WI.MAT_ID  
              AND PQ.MAT_ID = MAT.MAT_ID  
              AND PQ.LOT_ID = WI.LOT_ID 
              AND PQ.LOT_ID = STS.LOT_ID 
              AND STS.LOT_CMF_7 LIKE '%'
              AND PQ.HIST_SEQ = WI.HIST_SEQ  
              AND MAT.FACTORY (+) = 'HMVA2' 
              AND WI.HIST_DEL_FLAG = ' ' 
              AND PQ.TRAN_TIME  BETWEEN '20200429220000' AND '20200504215959'  
              AND PQ.CMF_10 = ' ' 
     ) 
GROUP BY   ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' , QC_OPER, TRAN_TIME, QC_TYPE, MAT_ID, LOT_ID, RES_ID, QTY_1, CUSTOMER, ASSE_SITE, LEAD_COUNT, H_PACKAGE, DENSITY, QC_OPERATOR, SAMPLE_QTY, PPM, CMF_2, QC_FLAG 
ORDER BY   ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' , QC_OPER, TRAN_TIME, QC_TYPE, MAT_ID, LOT_ID, RES_ID, QTY_1, CUSTOMER, ASSE_SITE, LEAD_COUNT, H_PACKAGE, DENSITY, QC_OPERATOR, SAMPLE_QTY, PPM, CMF_2, QC_FLAG 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
SELECT DISTINCT CHAR_ID 
 FROM(  
       SELECT NVL((SELECT CHAR_ID 
                     FROM MEDCLOTDAT 
         WHERE  1=1 AND COL_SET_ID IN (SELECT COL_SET_ID FROM MEDCCOLDEF WHERE 1=1 AND COL_GRP_10='Visual'  AND DELETE_FLAG <> 'Y'   
            AND DELETE_FLAG <> 'Y' AND FACTORY=PQ.FACTORY)  
          AND LOT_ID = PQ.LOT_ID  AND VALUE_1 <> ' '  AND HIST_SEQ= PQ.HIST_SEQ and rownum=1),'-') AS CHAR_ID , TOTAL_DEFECT_QTY_1 
       FROM CPQCLOTHIS@RPTTOMES PQ  
               , MWIPMATDEF MAT   
      WHERE 1 = 1 
              AND PQ.FACTORY = 'HMVA2'  
              AND PQ.FACTORY = MAT.FACTORY  
              AND PQ.MAT_ID = MAT.MAT_ID  
        AND MAT.FACTORY (+) = 'HMVA2' 
              AND PQ.TRAN_TIME  BETWEEN '20200429220000' AND '20200504215959'  
    ) WHERE TOTAL_DEFECT_QTY_1 > 0  

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' 
       , QC_OPER, TRAN_TIME, QC_TYPE 
       , MAT_ID, LOT_ID, RES_ID, QTY_1, CUSTOMER, ASSE_SITE, LEAD_COUNT, H_PACKAGE, DENSITY, QC_OPERATOR ,SAMPLE_QTY 
       , SUM(TOTAL_DEFECT_QTY_1) AS TOTAL_QTY  , PPM, CMF_2 
       , DECODE(QC_FLAG, 'Y', 'PASS', 'FAIL') AS QC_FLAG  
 FROM( 
       SELECT  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' 
              , PQ.QC_OPER 
              , PQ.TRAN_TIME 
              , PQ.QC_TYPE 
              , PQ.MAT_ID 
              , PQ.LOT_ID 
              , PQ.RES_ID, PQ.QC_FLAG, PQ.QC_OPERATOR 
              , WI.QTY_1  
              , NVL((SELECT DATA_1 FROM MGCMTBLDAT WHERE FACTORY='HMVA2' AND TABLE_NAME = 'H_CUSTOMER' AND KEY_1 = PQ.CUSTOMER AND ROWNUM=1), '-')  AS CUSTOMER 
              , TRIM(STS.LOT_CMF_7) AS ASSE_SITE, PQ.LEAD_COUNT, PQ.H_PACKAGE, PQ.DENSITY, PQ.SAMPLE_QTY, PQ.TOTAL_DEFECT_QTY_1, CMF_2 
              , DECODE(PQ.SAMPLE_QTY,0,0,ROUND((((PQ.TOTAL_DEFECT_QTY_1)/(PQ.SAMPLE_QTY))*1000000),0)) PPM   
              , NVL((SELECT CHAR_ID 
                       FROM MEDCLOTDAT 
                      WHERE  1=1  
                             AND COL_SET_ID IN ( 
                                                SELECT COL_SET_ID 
                                                  FROM MEDCCOLDEF 
                                                 WHERE 1=1 
                                                       AND COL_GRP_10='Visual' 
                                                       AND DELETE_FLAG <> 'Y' 
                                                      AND FACTORY=PQ.FACTORY 
                                                )  
                              AND LOT_ID = WI.LOT_ID 
                              AND VALUE_1 <> ' ' 
                              AND HIST_SEQ= PQ.HIST_SEQ 
                              AND ROWNUM = 1 ) 
                      ,'-') AS CHAR_ID  
         FROM CPQCLOTHIS@RPTTOMES PQ  
              , MWIPLOTHIS@RPTTOMES WI  
              , MWIPMATDEF MAT   
              , MWIPLOTSTS STS   
        WHERE 1 = 1 
              AND PQ.FACTORY = WI.FACTORY 
              AND PQ.FACTORY = MAT.FACTORY  
              AND PQ.MAT_ID = WI.MAT_ID  
              AND PQ.MAT_ID = MAT.MAT_ID  
              AND PQ.LOT_ID = WI.LOT_ID 
              AND PQ.LOT_ID = STS.LOT_ID 
              AND STS.LOT_CMF_7 LIKE '%'
              AND PQ.HIST_SEQ = WI.HIST_SEQ  
              AND MAT.FACTORY (+) = 'HMVA2' 
              AND WI.HIST_DEL_FLAG = ' ' 
              AND PQ.TRAN_TIME  BETWEEN '20200429220000' AND '20200504215959'  
              AND PQ.CMF_10 = ' ' 
     ) 
GROUP BY   ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' , QC_OPER, TRAN_TIME, QC_TYPE, MAT_ID, LOT_ID, RES_ID, QTY_1, CUSTOMER, ASSE_SITE, LEAD_COUNT, H_PACKAGE, DENSITY, QC_OPERATOR, SAMPLE_QTY, PPM, CMF_2, QC_FLAG 
ORDER BY   ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' , QC_OPER, TRAN_TIME, QC_TYPE, MAT_ID, LOT_ID, RES_ID, QTY_1, CUSTOMER, ASSE_SITE, LEAD_COUNT, H_PACKAGE, DENSITY, QC_OPERATOR, SAMPLE_QTY, PPM, CMF_2, QC_FLAG 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT DISTINCT CHAR_ID 
 FROM(  
       SELECT NVL((SELECT CHAR_ID 
                     FROM MEDCLOTDAT 
         WHERE  1=1 AND COL_SET_ID IN (SELECT COL_SET_ID FROM MEDCCOLDEF WHERE 1=1 AND COL_GRP_10='Visual'  AND DELETE_FLAG <> 'Y'   
            AND DELETE_FLAG <> 'Y' AND FACTORY=PQ.FACTORY)  
          AND LOT_ID = PQ.LOT_ID  AND VALUE_1 <> ' '  AND HIST_SEQ= PQ.HIST_SEQ and rownum=1),'-') AS CHAR_ID , TOTAL_DEFECT_QTY_1 
       FROM CPQCLOTHIS@RPTTOMES PQ  
               , MWIPMATDEF MAT   
      WHERE 1 = 1 
              AND PQ.FACTORY = 'HMVA2'  
              AND PQ.FACTORY = MAT.FACTORY  
              AND PQ.MAT_ID = MAT.MAT_ID  
        AND MAT.FACTORY (+) = 'HMVA2' 
              AND PQ.TRAN_TIME  BETWEEN '20200303220000' AND '20200504215959'  
    ) WHERE TOTAL_DEFECT_QTY_1 > 0  

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' 
       , QC_OPER, TRAN_TIME, QC_TYPE 
       , MAT_ID, LOT_ID, RES_ID, QTY_1, CUSTOMER, ASSE_SITE, LEAD_COUNT, H_PACKAGE, DENSITY, QC_OPERATOR ,SAMPLE_QTY 
       , SUM(TOTAL_DEFECT_QTY_1) AS TOTAL_QTY  , PPM, CMF_2 
       , DECODE(QC_FLAG, 'Y', 'PASS', 'FAIL') AS QC_FLAG  
       , SUM(DECODE(CHAR_ID , 'Etc' ,TOTAL_DEFECT_QTY_1,0))  AS "Etc"
       , SUM(DECODE(CHAR_ID , 'Ball Size' ,TOTAL_DEFECT_QTY_1,0))  AS "Ball Size"
       , SUM(DECODE(CHAR_ID , 'Pad Open (Ball Lift)' ,TOTAL_DEFECT_QTY_1,0))  AS "Pad Open (Ball Lift)"
       , SUM(DECODE(CHAR_ID , 'CCS Sheet Recording NG' ,TOTAL_DEFECT_QTY_1,0))  AS "CCS Sheet Recording NG"
       , SUM(DECODE(CHAR_ID , 'CCS basic information NG' ,TOTAL_DEFECT_QTY_1,0))  AS "CCS basic information NG"
       , SUM(DECODE(CHAR_ID , '-' ,TOTAL_DEFECT_QTY_1,0))  AS "-"
       , SUM(DECODE(CHAR_ID , 'T-Card Recording Defect' ,TOTAL_DEFECT_QTY_1,0))  AS "T-Card Recording Defect"
 FROM( 
       SELECT  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' 
              , PQ.QC_OPER 
              , PQ.TRAN_TIME 
              , PQ.QC_TYPE 
              , PQ.MAT_ID 
              , PQ.LOT_ID 
              , PQ.RES_ID, PQ.QC_FLAG, PQ.QC_OPERATOR 
              , WI.QTY_1  
              , NVL((SELECT DATA_1 FROM MGCMTBLDAT WHERE FACTORY='HMVA2' AND TABLE_NAME = 'H_CUSTOMER' AND KEY_1 = PQ.CUSTOMER AND ROWNUM=1), '-')  AS CUSTOMER 
              , TRIM(STS.LOT_CMF_7) AS ASSE_SITE, PQ.LEAD_COUNT, PQ.H_PACKAGE, PQ.DENSITY, PQ.SAMPLE_QTY, PQ.TOTAL_DEFECT_QTY_1, CMF_2 
              , DECODE(PQ.SAMPLE_QTY,0,0,ROUND((((PQ.TOTAL_DEFECT_QTY_1)/(PQ.SAMPLE_QTY))*1000000),0)) PPM   
              , NVL((SELECT CHAR_ID 
                       FROM MEDCLOTDAT 
                      WHERE  1=1  
                             AND COL_SET_ID IN ( 
                                                SELECT COL_SET_ID 
                                                  FROM MEDCCOLDEF 
                                                 WHERE 1=1 
                                                       AND COL_GRP_10='Visual' 
                                                       AND DELETE_FLAG <> 'Y' 
                                                      AND FACTORY=PQ.FACTORY 
                                                )  
                              AND LOT_ID = WI.LOT_ID 
                              AND VALUE_1 <> ' ' 
                              AND HIST_SEQ= PQ.HIST_SEQ 
                              AND ROWNUM = 1 ) 
                      ,'-') AS CHAR_ID  
         FROM CPQCLOTHIS@RPTTOMES PQ  
              , MWIPLOTHIS@RPTTOMES WI  
              , MWIPMATDEF MAT   
              , MWIPLOTSTS STS   
        WHERE 1 = 1 
              AND PQ.FACTORY = WI.FACTORY 
              AND PQ.FACTORY = MAT.FACTORY  
              AND PQ.MAT_ID = WI.MAT_ID  
              AND PQ.MAT_ID = MAT.MAT_ID  
              AND PQ.LOT_ID = WI.LOT_ID 
              AND PQ.LOT_ID = STS.LOT_ID 
              AND STS.LOT_CMF_7 LIKE '%'
              AND PQ.HIST_SEQ = WI.HIST_SEQ  
              AND MAT.FACTORY (+) = 'HMVA2' 
              AND WI.HIST_DEL_FLAG = ' ' 
              AND PQ.TRAN_TIME  BETWEEN '20200303220000' AND '20200504215959'  
              AND PQ.CMF_10 = ' ' 
     ) 
GROUP BY   ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' , QC_OPER, TRAN_TIME, QC_TYPE, MAT_ID, LOT_ID, RES_ID, QTY_1, CUSTOMER, ASSE_SITE, LEAD_COUNT, H_PACKAGE, DENSITY, QC_OPERATOR, SAMPLE_QTY, PPM, CMF_2, QC_FLAG 
ORDER BY   ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' , QC_OPER, TRAN_TIME, QC_TYPE, MAT_ID, LOT_ID, RES_ID, QTY_1, CUSTOMER, ASSE_SITE, LEAD_COUNT, H_PACKAGE, DENSITY, QC_OPERATOR, SAMPLE_QTY, PPM, CMF_2, QC_FLAG 

-------------------------------------------------------------
SELECT * FROM RWEBUSRDEF WHERE FACTORY = :FACTORY AND USER_ID= :USER_ID
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT A.FUNC_GRP_SEQ,A.SEC_GRP_ID,A.FUNC_GRP_ID,NVL(A.FUNC_NAME, ' ') FUNC_NAME, NVL(B.FUNC_DESC, ' ') FUNC_DESC, LANGUAGE_1, LANGUAGE_2, LANGUAGE_3
  FROM RWEBGRPFUN A, RWEBFUNDEF B
 WHERE A.FACTORY = :p_FACTORY
   AND A.SEC_GRP_ID = :p_SEC_GRP_ID
   AND A.FUNC_NAME=B.FUNC_NAME(+)
 ORDER BY A.FUNC_GRP_SEQ, A.FUNC_SEQ
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
 SELECT PLAN_WEEK V1    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_DATE = TO_CHAR(SYSDATE,'yyyymmdd')      AND ROWNUM = 1  
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('2020', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('2020', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT LANGUAGE_2 FROM RWEBFUNDEF WHERE FUNC_NAME = 'PQC030110'
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT DISTINCT CHAR_ID 
 FROM(  
       SELECT NVL((SELECT CHAR_ID 
                     FROM MEDCLOTDAT 
         WHERE  1=1 AND COL_SET_ID IN (SELECT COL_SET_ID FROM MEDCCOLDEF WHERE 1=1 AND COL_GRP_10='Visual'  AND DELETE_FLAG <> 'Y'   
            AND DELETE_FLAG <> 'Y' AND FACTORY=PQ.FACTORY)  
          AND LOT_ID = PQ.LOT_ID  AND VALUE_1 <> ' '  AND HIST_SEQ= PQ.HIST_SEQ and rownum=1),'-') AS CHAR_ID , TOTAL_DEFECT_QTY_1 
       FROM CPQCLOTHIS@RPTTOMES PQ  
               , MWIPMATDEF MAT   
      WHERE 1 = 1 
              AND PQ.FACTORY = 'HMVA2'  
              AND PQ.FACTORY = MAT.FACTORY  
              AND PQ.MAT_ID = MAT.MAT_ID  
        AND MAT.FACTORY (+) = 'HMVA2' 
              AND PQ.TRAN_TIME  BETWEEN '20200303220000' AND '20200504215959'  
    ) WHERE TOTAL_DEFECT_QTY_1 > 0  

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' 
       , QC_OPER, TRAN_TIME, QC_TYPE 
       , MAT_ID, LOT_ID, RES_ID, QTY_1, CUSTOMER, ASSE_SITE, LEAD_COUNT, H_PACKAGE, DENSITY, QC_OPERATOR ,SAMPLE_QTY 
       , SUM(TOTAL_DEFECT_QTY_1) AS TOTAL_QTY  , PPM, CMF_2 
       , DECODE(QC_FLAG, 'Y', 'PASS', 'FAIL') AS QC_FLAG  
       , SUM(DECODE(CHAR_ID , 'Etc' ,TOTAL_DEFECT_QTY_1,0))  AS "Etc"
       , SUM(DECODE(CHAR_ID , 'Ball Size' ,TOTAL_DEFECT_QTY_1,0))  AS "Ball Size"
       , SUM(DECODE(CHAR_ID , 'Pad Open (Ball Lift)' ,TOTAL_DEFECT_QTY_1,0))  AS "Pad Open (Ball Lift)"
       , SUM(DECODE(CHAR_ID , 'CCS Sheet Recording NG' ,TOTAL_DEFECT_QTY_1,0))  AS "CCS Sheet Recording NG"
       , SUM(DECODE(CHAR_ID , 'CCS basic information NG' ,TOTAL_DEFECT_QTY_1,0))  AS "CCS basic information NG"
       , SUM(DECODE(CHAR_ID , '-' ,TOTAL_DEFECT_QTY_1,0))  AS "-"
       , SUM(DECODE(CHAR_ID , 'T-Card Recording Defect' ,TOTAL_DEFECT_QTY_1,0))  AS "T-Card Recording Defect"
 FROM( 
       SELECT  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' 
              , PQ.QC_OPER 
              , PQ.TRAN_TIME 
              , PQ.QC_TYPE 
              , PQ.MAT_ID 
              , PQ.LOT_ID 
              , PQ.RES_ID, PQ.QC_FLAG, PQ.QC_OPERATOR 
              , WI.QTY_1  
              , NVL((SELECT DATA_1 FROM MGCMTBLDAT WHERE FACTORY='HMVA2' AND TABLE_NAME = 'H_CUSTOMER' AND KEY_1 = PQ.CUSTOMER AND ROWNUM=1), '-')  AS CUSTOMER 
              , TRIM(STS.LOT_CMF_7) AS ASSE_SITE, PQ.LEAD_COUNT, PQ.H_PACKAGE, PQ.DENSITY, PQ.SAMPLE_QTY, PQ.TOTAL_DEFECT_QTY_1, CMF_2 
              , DECODE(PQ.SAMPLE_QTY,0,0,ROUND((((PQ.TOTAL_DEFECT_QTY_1)/(PQ.SAMPLE_QTY))*1000000),0)) PPM   
              , NVL((SELECT CHAR_ID 
                       FROM MEDCLOTDAT 
                      WHERE  1=1  
                             AND COL_SET_ID IN ( 
                                                SELECT COL_SET_ID 
                                                  FROM MEDCCOLDEF 
                                                 WHERE 1=1 
                                                       AND COL_GRP_10='Visual' 
                                                       AND DELETE_FLAG <> 'Y' 
                                                      AND FACTORY=PQ.FACTORY 
                                                )  
                              AND LOT_ID = WI.LOT_ID 
                              AND VALUE_1 <> ' ' 
                              AND HIST_SEQ= PQ.HIST_SEQ 
                              AND ROWNUM = 1 ) 
                      ,'-') AS CHAR_ID  
         FROM CPQCLOTHIS@RPTTOMES PQ  
              , MWIPLOTHIS@RPTTOMES WI  
              , MWIPMATDEF MAT   
              , MWIPLOTSTS STS   
        WHERE 1 = 1 
              AND PQ.FACTORY = WI.FACTORY 
              AND PQ.FACTORY = MAT.FACTORY  
              AND PQ.MAT_ID = WI.MAT_ID  
              AND PQ.MAT_ID = MAT.MAT_ID  
              AND PQ.LOT_ID = WI.LOT_ID 
              AND PQ.LOT_ID = STS.LOT_ID 
              AND STS.LOT_CMF_7 LIKE '%'
              AND PQ.HIST_SEQ = WI.HIST_SEQ  
              AND MAT.FACTORY (+) = 'HMVA2' 
              AND WI.HIST_DEL_FLAG = ' ' 
              AND PQ.TRAN_TIME  BETWEEN '20200303220000' AND '20200504215959'  
              AND PQ.CMF_10 = ' ' 
     ) 
GROUP BY   ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' , QC_OPER, TRAN_TIME, QC_TYPE, MAT_ID, LOT_ID, RES_ID, QTY_1, CUSTOMER, ASSE_SITE, LEAD_COUNT, H_PACKAGE, DENSITY, QC_OPERATOR, SAMPLE_QTY, PPM, CMF_2, QC_FLAG 
ORDER BY   ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' , QC_OPER, TRAN_TIME, QC_TYPE, MAT_ID, LOT_ID, RES_ID, QTY_1, CUSTOMER, ASSE_SITE, LEAD_COUNT, H_PACKAGE, DENSITY, QC_OPERATOR, SAMPLE_QTY, PPM, CMF_2, QC_FLAG 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT DISTINCT TRIM(STS.LOT_CMF_7) AS CODE, ' ' AS NAME
  FROM CPQCLOTHIS@RPTTOMES PQ
     , MWIPLOTHIS@RPTTOMES WI
     , MWIPMATDEF MAT
     , MWIPLOTSTS STS
 WHERE MAT.FACTORY (+) = 'HMVA2' 
   AND PQ.FACTORY = WI.FACTORY 
   AND PQ.FACTORY = MAT.FACTORY 
   AND PQ.MAT_ID = WI.MAT_ID 
   AND PQ.MAT_ID = MAT.MAT_ID 
   AND PQ.LOT_ID = WI.LOT_ID 
   AND PQ.LOT_ID = STS.LOT_ID 
   AND PQ.HIST_SEQ = WI.HIST_SEQ 
   AND WI.HIST_DEL_FLAG = ' ' 
   AND PQ.TRAN_TIME  BETWEEN '20200303220000' AND '20200504215959'  
   AND PQ.CMF_10 = ' ' 
 ORDER BY CODE 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT DISTINCT QC_TYPE ,  ' ' AS NONE FROM CPQCLOTHIS@RPTTOMES ORDER BY QC_TYPE
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT DISTINCT CHAR_ID 
 FROM(  
       SELECT NVL((SELECT CHAR_ID 
                     FROM MEDCLOTDAT 
         WHERE  1=1 AND COL_SET_ID IN (SELECT COL_SET_ID FROM MEDCCOLDEF WHERE 1=1 AND COL_GRP_10='Visual'  AND DELETE_FLAG <> 'Y'   
            AND DELETE_FLAG <> 'Y' AND FACTORY=PQ.FACTORY)  
          AND LOT_ID = PQ.LOT_ID  AND VALUE_1 <> ' '  AND HIST_SEQ= PQ.HIST_SEQ and rownum=1),'-') AS CHAR_ID , TOTAL_DEFECT_QTY_1 
       FROM CPQCLOTHIS@RPTTOMES PQ  
               , MWIPMATDEF MAT   
      WHERE 1 = 1 
              AND PQ.FACTORY = 'HMVA2'  
              AND PQ.FACTORY = MAT.FACTORY  
              AND PQ.MAT_ID = MAT.MAT_ID  
        AND MAT.FACTORY (+) = 'HMVA2' 
              AND PQ.TRAN_TIME  BETWEEN '20200303220000' AND '20200504215959'  
    ) WHERE TOTAL_DEFECT_QTY_1 > 0  

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' 
       , QC_OPER, TRAN_TIME, QC_TYPE 
       , MAT_ID, LOT_ID, RES_ID, QTY_1, CUSTOMER, ASSE_SITE, LEAD_COUNT, H_PACKAGE, DENSITY, QC_OPERATOR ,SAMPLE_QTY 
       , SUM(TOTAL_DEFECT_QTY_1) AS TOTAL_QTY  , PPM, CMF_2 
       , DECODE(QC_FLAG, 'Y', 'PASS', 'FAIL') AS QC_FLAG  
       , SUM(DECODE(CHAR_ID , 'Etc' ,TOTAL_DEFECT_QTY_1,0))  AS "Etc"
       , SUM(DECODE(CHAR_ID , 'Ball Size' ,TOTAL_DEFECT_QTY_1,0))  AS "Ball Size"
       , SUM(DECODE(CHAR_ID , 'Pad Open (Ball Lift)' ,TOTAL_DEFECT_QTY_1,0))  AS "Pad Open (Ball Lift)"
       , SUM(DECODE(CHAR_ID , 'CCS Sheet Recording NG' ,TOTAL_DEFECT_QTY_1,0))  AS "CCS Sheet Recording NG"
       , SUM(DECODE(CHAR_ID , 'CCS basic information NG' ,TOTAL_DEFECT_QTY_1,0))  AS "CCS basic information NG"
       , SUM(DECODE(CHAR_ID , '-' ,TOTAL_DEFECT_QTY_1,0))  AS "-"
       , SUM(DECODE(CHAR_ID , 'T-Card Recording Defect' ,TOTAL_DEFECT_QTY_1,0))  AS "T-Card Recording Defect"
 FROM( 
       SELECT  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' 
              , PQ.QC_OPER 
              , PQ.TRAN_TIME 
              , PQ.QC_TYPE 
              , PQ.MAT_ID 
              , PQ.LOT_ID 
              , PQ.RES_ID, PQ.QC_FLAG, PQ.QC_OPERATOR 
              , WI.QTY_1  
              , NVL((SELECT DATA_1 FROM MGCMTBLDAT WHERE FACTORY='HMVA2' AND TABLE_NAME = 'H_CUSTOMER' AND KEY_1 = PQ.CUSTOMER AND ROWNUM=1), '-')  AS CUSTOMER 
              , TRIM(STS.LOT_CMF_7) AS ASSE_SITE, PQ.LEAD_COUNT, PQ.H_PACKAGE, PQ.DENSITY, PQ.SAMPLE_QTY, PQ.TOTAL_DEFECT_QTY_1, CMF_2 
              , DECODE(PQ.SAMPLE_QTY,0,0,ROUND((((PQ.TOTAL_DEFECT_QTY_1)/(PQ.SAMPLE_QTY))*1000000),0)) PPM   
              , NVL((SELECT CHAR_ID 
                       FROM MEDCLOTDAT 
                      WHERE  1=1  
                             AND COL_SET_ID IN ( 
                                                SELECT COL_SET_ID 
                                                  FROM MEDCCOLDEF 
                                                 WHERE 1=1 
                                                       AND COL_GRP_10='Visual' 
                                                       AND DELETE_FLAG <> 'Y' 
                                                      AND FACTORY=PQ.FACTORY 
                                                )  
                              AND LOT_ID = WI.LOT_ID 
                              AND VALUE_1 <> ' ' 
                              AND HIST_SEQ= PQ.HIST_SEQ 
                              AND ROWNUM = 1 ) 
                      ,'-') AS CHAR_ID  
         FROM CPQCLOTHIS@RPTTOMES PQ  
              , MWIPLOTHIS@RPTTOMES WI  
              , MWIPMATDEF MAT   
              , MWIPLOTSTS STS   
        WHERE 1 = 1 
              AND PQ.FACTORY = WI.FACTORY 
              AND PQ.FACTORY = MAT.FACTORY  
              AND PQ.MAT_ID = WI.MAT_ID  
              AND PQ.MAT_ID = MAT.MAT_ID  
              AND PQ.LOT_ID = WI.LOT_ID 
              AND PQ.LOT_ID = STS.LOT_ID 
              AND STS.LOT_CMF_7 LIKE '%'
              AND PQ.HIST_SEQ = WI.HIST_SEQ  
              AND MAT.FACTORY (+) = 'HMVA2' 
              AND WI.HIST_DEL_FLAG = ' ' 
              AND PQ.TRAN_TIME  BETWEEN '20200303220000' AND '20200504215959'  
              AND PQ.CMF_10 = ' ' 
     ) 
GROUP BY   ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' , QC_OPER, TRAN_TIME, QC_TYPE, MAT_ID, LOT_ID, RES_ID, QTY_1, CUSTOMER, ASSE_SITE, LEAD_COUNT, H_PACKAGE, DENSITY, QC_OPERATOR, SAMPLE_QTY, PPM, CMF_2, QC_FLAG 
ORDER BY   ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' , QC_OPER, TRAN_TIME, QC_TYPE, MAT_ID, LOT_ID, RES_ID, QTY_1, CUSTOMER, ASSE_SITE, LEAD_COUNT, H_PACKAGE, DENSITY, QC_OPERATOR, SAMPLE_QTY, PPM, CMF_2, QC_FLAG 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT DISTINCT CHAR_ID 
 FROM(  
       SELECT NVL((SELECT CHAR_ID 
                     FROM MEDCLOTDAT 
         WHERE  1=1 AND COL_SET_ID IN (SELECT COL_SET_ID FROM MEDCCOLDEF WHERE 1=1 AND COL_GRP_10='Visual'  AND DELETE_FLAG <> 'Y'   
            AND DELETE_FLAG <> 'Y' AND FACTORY=PQ.FACTORY)  
          AND LOT_ID = PQ.LOT_ID  AND VALUE_1 <> ' '  AND HIST_SEQ= PQ.HIST_SEQ and rownum=1),'-') AS CHAR_ID , TOTAL_DEFECT_QTY_1 
       FROM CPQCLOTHIS@RPTTOMES PQ  
               , MWIPMATDEF MAT   
      WHERE 1 = 1 
              AND PQ.FACTORY = 'HMVA2'  
              AND PQ.FACTORY = MAT.FACTORY  
              AND PQ.MAT_ID = MAT.MAT_ID  
        AND MAT.FACTORY (+) = 'HMVA2' 
              AND PQ.TRAN_TIME  BETWEEN '20200303220000' AND '20200504215959'  
    ) WHERE TOTAL_DEFECT_QTY_1 > 0  

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
    SELECT   ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' 
          , PQ.QC_OPER   
          , NVL((SELECT CHAR_ID FROM MEDCLOTDAT   
                      WHERE  1=1 AND COL_SET_ID IN (SELECT COL_SET_ID FROM MEDCCOLDEF WHERE 1=1 AND COL_GRP_10='Visual'  AND DELETE_FLAG <> 'Y' AND FACTORY=PQ.FACTORY)  
                              AND LOT_ID = WI.LOT_ID  AND VALUE_1 <> ' '  AND HIST_SEQ= PQ.HIST_SEQ AND ROWNUM = 1 ),'-') AS CHAR_ID  
          , PQ.TRAN_TIME, PQ.QC_TYPE, PQ.MAT_ID, PQ.LOT_ID, PQ.RES_ID, WI.QTY_1  
          , NVL((SELECT DATA_1 FROM MGCMTBLDAT WHERE FACTORY='HMVA2' AND TABLE_NAME = 'H_CUSTOMER' AND KEY_1 = PQ.CUSTOMER AND ROWNUM=1), '-')  AS CUSTOMER 
          , TRIM(STS.LOT_CMF_7) AS ASSE_SITE, PQ.LEAD_COUNT, PQ.H_PACKAGE, PQ.DENSITY, PQ.QC_OPERATOR, PQ.SAMPLE_QTY, PQ.TOTAL_DEFECT_QTY_1 
          , DECODE(PQ.SAMPLE_QTY,0,0,ROUND((((PQ.TOTAL_DEFECT_QTY_1)/(PQ.SAMPLE_QTY))*1000000),0)) PPM   
       FROM CPQCLOTHIS@RPTTOMES PQ  
               , MWIPLOTHIS@RPTTOMES WI  
               , MWIPMATDEF MAT   
               , MWIPLOTSTS STS   
      WHERE 1 = 1 
              AND PQ.FACTORY = WI.FACTORY 
              AND PQ.FACTORY = MAT.FACTORY  
              AND PQ.MAT_ID = MAT.MAT_ID  
              AND PQ.LOT_ID = WI.LOT_ID 
              AND PQ.LOT_ID = STS.LOT_ID 
              AND STS.LOT_CMF_7 LIKE '%'
              AND PQ.HIST_SEQ = WI.HIST_SEQ  
              AND MAT.FACTORY (+) = 'HMVA2' 
              AND WI.HIST_DEL_FLAG = ' ' 
              AND PQ.TRAN_TIME  BETWEEN '20200303220000' AND '20200504215959'  
              AND PQ.CMF_10 = ' ' 
       ORDER BY   ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ' 
              , PQ.QC_OPER , CHAR_ID DESC, PQ.MAT_ID, PQ.LOT_ID, PQ.TRAN_TIME   

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
 SELECT QC_OPER  
        , SUM(DECODE(CHAR_ID , 'Etc' ,TOTAL_DEFECT_QTY_1,0))  AS "Etc"
        , SUM(DECODE(CHAR_ID , 'Ball Size' ,TOTAL_DEFECT_QTY_1,0))  AS "Ball Size"
        , SUM(DECODE(CHAR_ID , 'Pad Open (Ball Lift)' ,TOTAL_DEFECT_QTY_1,0))  AS "Pad Open (Ball Lift)"
        , SUM(DECODE(CHAR_ID , 'CCS Sheet Recording NG' ,TOTAL_DEFECT_QTY_1,0))  AS "CCS Sheet Recording NG"
        , SUM(DECODE(CHAR_ID , 'CCS basic information NG' ,TOTAL_DEFECT_QTY_1,0))  AS "CCS basic information NG"
        , SUM(DECODE(CHAR_ID , '-' ,TOTAL_DEFECT_QTY_1,0))  AS "-"
        , SUM(DECODE(CHAR_ID , 'T-Card Recording Defect' ,TOTAL_DEFECT_QTY_1,0))  AS "T-Card Recording Defect"
  FROM ( 
      SELECT   PQ.TOTAL_DEFECT_QTY_1,PQ.QC_OPER  
           , NVL((SELECT CHAR_ID FROM MEDCLOTDAT WHERE  1=1 AND COL_SET_ID IN   
                          (SELECT COL_SET_ID FROM MEDCCOLDEF WHERE 1=1 AND COL_GRP_10='Visual'  AND DELETE_FLAG <> 'Y' AND FACTORY=PQ.FACTORY) 
                  AND LOT_ID = PQ.LOT_ID  AND VALUE_1 <> ' '  AND HIST_SEQ= PQ.HIST_SEQ  AND ROWNUM = 1 ),' ') AS CHAR_ID 
        FROM CPQCLOTHIS@RPTTOMES PQ  
               ,  MWIPMATDEF MAT  
 WHERE 1=1 
              AND PQ.FACTORY = MAT.FACTORY  
              AND PQ.MAT_ID = MAT.MAT_ID  
         AND MAT.FACTORY (+) = 'HMVA2' 
              AND PQ.TRAN_TIME  BETWEEN '20200303220000' AND '20200504215959'  
               AND PQ.TOTAL_DEFECT_QTY_1 > 0  
 ) GROUP BY QC_OPER   ORDER BY QC_OPER 

-------------------------------------------------------------
SELECT * FROM RWEBUSRDEF WHERE FACTORY = :FACTORY AND USER_ID= :USER_ID
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND TO_DATE(VIEW_TIME,'YYYYMMDDHH24MISS') BETWEEN SYSDATE -  10/1440 AND SYSDATE + 10/1440
-------------------------------------------------------------
SELECT A.FUNC_GRP_SEQ,A.SEC_GRP_ID,A.FUNC_GRP_ID,NVL(A.FUNC_NAME, ' ') FUNC_NAME, NVL(B.FUNC_DESC, ' ') FUNC_DESC, LANGUAGE_1, LANGUAGE_2, LANGUAGE_3
  FROM RWEBGRPFUN A, RWEBFUNDEF B
 WHERE A.FACTORY = :p_FACTORY
   AND A.SEC_GRP_ID = :p_SEC_GRP_ID
   AND A.FUNC_NAME=B.FUNC_NAME(+)
 ORDER BY A.FUNC_GRP_SEQ, A.FUNC_SEQ
-------------------------------------------------------------
