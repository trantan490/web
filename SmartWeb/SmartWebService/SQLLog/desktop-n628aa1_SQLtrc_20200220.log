SELECT * FROM RWEBUSRDEF WHERE FACTORY = :FACTORY AND USER_ID= :USER_ID
-------------------------------------------------------------
SELECT A.FUNC_GRP_SEQ,A.SEC_GRP_ID,A.FUNC_GRP_ID,NVL(A.FUNC_NAME, ' ') FUNC_NAME, NVL(B.FUNC_DESC, ' ') FUNC_DESC, LANGUAGE_1, LANGUAGE_2, LANGUAGE_3
  FROM RWEBGRPFUN A, RWEBFUNDEF B
 WHERE A.FACTORY = :p_FACTORY
   AND A.SEC_GRP_ID = :p_SEC_GRP_ID
   AND A.FUNC_NAME=B.FUNC_NAME(+)
 ORDER BY A.FUNC_GRP_SEQ, A.FUNC_SEQ
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('2020', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('2020', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT '2019' || '1231220000' AS PREV_DATE 
     , ( 
        SELECT MAX(SYS_DATE) || '220000' 
          FROM MWIPCALDEF 
         WHERE 1=1 
           AND CALENDAR_ID = 'HM' 
           AND PLAN_YEAR = '2020' 
           AND PLAN_WEEK = '1' 
       ) AS POST_DATE 
  FROM DUAL 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT '2019' || '1231220000' AS PREV_DATE 
     , ( 
        SELECT MAX(SYS_DATE) || '220000' 
          FROM MWIPCALDEF 
         WHERE 1=1 
           AND CALENDAR_ID = 'HM' 
           AND PLAN_YEAR = '2020' 
           AND PLAN_WEEK = '1' 
       ) AS POST_DATE 
  FROM DUAL 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('2020', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT '2019' || '1231220000' AS PREV_DATE 
     , ( 
        SELECT MAX(SYS_DATE) || '220000' 
          FROM MWIPCALDEF 
         WHERE 1=1 
           AND CALENDAR_ID = 'HM' 
           AND PLAN_YEAR = '2020' 
           AND PLAN_WEEK = '1' 
       ) AS POST_DATE 
  FROM DUAL 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT '2019' || '1231220000' AS PREV_DATE 
     , ( 
        SELECT MAX(SYS_DATE) || '220000' 
          FROM MWIPCALDEF 
         WHERE 1=1 
           AND CALENDAR_ID = 'HM' 
           AND PLAN_YEAR = '2020' 
           AND PLAN_WEEK = '1' 
       ) AS POST_DATE 
  FROM DUAL 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT PLAN_WEEK V1    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_DATE = TO_CHAR(SYSDATE,'yyyymmdd')      AND ROWNUM = 1  
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('2020', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT '2019' || '1231220000' AS PREV_DATE 
     , ( 
        SELECT MAX(SYS_DATE) || '220000' 
          FROM MWIPCALDEF 
         WHERE 1=1 
           AND CALENDAR_ID = 'HM' 
           AND PLAN_YEAR = '2020' 
           AND PLAN_WEEK = '1' 
       ) AS POST_DATE 
  FROM DUAL 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT '2019' || '1231220000' AS PREV_DATE 
     , ( 
        SELECT MAX(SYS_DATE) || '220000' 
          FROM MWIPCALDEF 
         WHERE 1=1 
           AND CALENDAR_ID = 'HM' 
           AND PLAN_YEAR = '2020' 
           AND PLAN_WEEK = '8' 
       ) AS POST_DATE 
  FROM DUAL 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('2020', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT '2019' || '1231220000' AS PREV_DATE 
     , ( 
        SELECT MAX(SYS_DATE) || '220000' 
          FROM MWIPCALDEF 
         WHERE 1=1 
           AND CALENDAR_ID = 'HM' 
           AND PLAN_YEAR = '2020' 
           AND PLAN_WEEK = '8' 
       ) AS POST_DATE 
  FROM DUAL 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT ( 
        SELECT MAX(SYS_DATE) || '220000'  
          FROM MWIPCALDEF 
         WHERE 1=1 
           AND CALENDAR_ID = 'HM' 
           AND PLAN_YEAR = '2020' 
           AND PLAN_WEEK = '7' 
       ) AS PREV_DATE 
     , ( 
        SELECT MAX(SYS_DATE) || '220000' 
          FROM MWIPCALDEF 
         WHERE 1=1 
           AND CALENDAR_ID = 'HM' 
           AND PLAN_YEAR = '2020' 
           AND PLAN_WEEK = '8' 
       ) AS POST_DATE 
  FROM DUAL 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT ( 
        SELECT MAX(SYS_DATE) || '220000'  
          FROM MWIPCALDEF 
         WHERE 1=1 
           AND CALENDAR_ID = 'HM' 
           AND PLAN_YEAR = '2020' 
           AND PLAN_WEEK = '7' 
       ) AS PREV_DATE 
     , ( 
        SELECT MAX(SYS_DATE) || '220000' 
          FROM MWIPCALDEF 
         WHERE 1=1 
           AND CALENDAR_ID = 'HM' 
           AND PLAN_YEAR = '2020' 
           AND PLAN_WEEK = '8' 
       ) AS POST_DATE 
  FROM DUAL 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT ( 
        SELECT MAX(SYS_DATE) || '220000'  
          FROM MWIPCALDEF 
         WHERE 1=1 
           AND CALENDAR_ID = 'HM' 
           AND PLAN_YEAR = '2020' 
           AND PLAN_WEEK = '7' 
       ) AS PREV_DATE 
     , ( 
        SELECT MAX(SYS_DATE) || '220000' 
          FROM MWIPCALDEF 
         WHERE 1=1 
           AND CALENDAR_ID = 'HM' 
           AND PLAN_YEAR = '2020' 
           AND PLAN_WEEK = '8' 
       ) AS POST_DATE 
  FROM DUAL 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT ( 
        SELECT MAX(SYS_DATE) || '220000'  
          FROM MWIPCALDEF 
         WHERE 1=1 
           AND CALENDAR_ID = 'HM' 
           AND PLAN_YEAR = '2020' 
           AND PLAN_WEEK = '7' 
       ) AS PREV_DATE 
     , ( 
        SELECT MAX(SYS_DATE) || '220000' 
          FROM MWIPCALDEF 
         WHERE 1=1 
           AND CALENDAR_ID = 'HM' 
           AND PLAN_YEAR = '2020' 
           AND PLAN_WEEK = '8' 
       ) AS POST_DATE 
  FROM DUAL 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT LANGUAGE_3 FROM RWEBFUNDEF WHERE FUNC_NAME = 'PRD011016'
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
SELECT LANGUAGE_3 FROM RWEBFUNDEF WHERE FUNC_NAME = 'PRD011014'
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT PLAN_WEEK V1    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_DATE = TO_CHAR(SYSDATE,'yyyymmdd')      AND ROWNUM = 1  
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('2020', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('2020', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT LANGUAGE_3 FROM RWEBFUNDEF WHERE FUNC_NAME = 'PRD010805'
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT A.KEY_1, A.KEY_2, A.OPER, A.OPER_DESC
     , ROUND(AVG(A.UPEH), 0) AS UPEH
     , A.USER_CAPA
     , ROUND(AVG(A.UPOH), 0) AS UPOH
     , A.OP_EFFICE, A.YIELD
     , ROUND(SUM(CASE WHEN B.PLAN_DATE = '202002' THEN A.K_TIME * B.PLAN_QTY ELSE 0 END), 2) AS HUMAN_TIME_0
     , ROUND(SUM(CASE WHEN B.PLAN_DATE = '202002' THEN (A.K_TIME * B.PLAN_QTY) / B.WORK_DAY / 24 * 3 ELSE 0 END), 2) AS HUMAN_NEED_0
  FROM (
        SELECT KEY_1, KEY_2, KEY_3 AS OPER, DATA_1 AS OPER_DESC, DATA_3 AS USER_CAPA
             , DATA_4 AS OP_EFFICE, DATA_5 AS YIELD
             , B.MAT_GRP_1, B.MAT_GRP_5, B.PKG_CODE
             , AVG(B.UPEH) AS UPEH, AVG(B.UPEH * DATA_3) AS UPOH
             , AVG(CASE WHEN DATA_3 = ' ' OR DATA_4 = ' ' OR DATA_5 = ' ' THEN 0
                        WHEN B.UPEH IS NULL OR B.UPEH = 0 THEN 1000 / (B.OPER_AVG_UPEH * DATA_3 * (DATA_4/100) * (DATA_5/100)) * 1.15
                        ELSE 1000 / (B.UPEH * DATA_3 * (DATA_4/100) * (DATA_5/100)) * 1.15
                   END) AS K_TIME
             , AVG(B.OPER_AVG_UPEH) AS OPER_AVG_UPEH
          FROM MGCMTBLDAT A
             , (
                SELECT A.FACTORY, A.MAT_ID, A.OPER, A.UPEH, B.MAT_GRP_1, B.MAT_GRP_5, B.MAT_CMF_11
                     , CASE WHEN B.MAT_GRP_1 = 'HX' THEN B.MAT_ID ELSE B.MAT_CMF_11 END AS PKG_CODE
                     , AVG(A.UPEH) OVER(PARTITION BY A.OPER) AS OPER_AVG_UPEH
                  FROM CRASUPHDEF A
                     , MWIPMATDEF B
                 WHERE 1=1
                   AND A.FACTORY = B.FACTORY
                   AND A.MAT_ID = B.MAT_ID
                   AND A.FACTORY = 'HMKA1'
                   AND B.DELETE_FLAG = ' '
                   AND B.MAT_TYPE = 'FG'
               ) B
         WHERE 1=1
           AND A.FACTORY = B.FACTORY(+)
           AND A.KEY_3 = B.OPER(+)
           AND A.FACTORY = 'HMKA1'
           AND A.TABLE_NAME = 'H_RPT_HUMAN'
           AND A.DATA_2 = 'Y'
         GROUP BY KEY_1, KEY_2, KEY_3, DATA_1, DATA_3, DATA_4, DATA_5, B.MAT_GRP_1, B.MAT_GRP_5, PKG_CODE
       ) A
     , (
        SELECT PLAN_DATE, PKG_CODE, OPER, MAT_GRP_1, MAT_GRP_5, WORK_DAY
             , SUM(PLAN_QTY) AS PLAN_QTY
          FROM (
                SELECT B.PLAN_DATE, B.MAT_KEY, B.MAT_ID, C.OPER, TO_NUMBER(PLAN_QTY) AS PLAN_QTY
                     , CASE WHEN A.MAT_GRP_1 = 'HX' THEN A.MAT_ID ELSE A.MAT_CMF_11 END AS PKG_CODE
                     , MAT_GRP_1, MAT_GRP_2, MAT_GRP_4, MAT_GRP_5, MAT_GRP_6, MAT_CMF_11, FIRST_FLOW
                     , NET_DIE, COMP_CNT, HX_COMP_MIN, HX_COMP_MAX
                     , CASE WHEN MAT_GRP_4 IN ('-', 'FD', 'FU') THEN '1'
                            ELSE SUBSTR(MAT_GRP_4, 3) 
                       END AS STACK
                     , TO_CHAR(LAST_DAY(TO_DATE(B.PLAN_DATE, 'YYYYMM')), 'DD') AS WORK_DAY
                  FROM VWIPMATDEF A
                     , (
                        SELECT DISTINCT A.PLAN_MONTH AS PLAN_DATE
                             , CASE WHEN B.MAT_ID IS NULL THEN A.MAT_ID ELSE B.MCP_TO_PART END AS MAT_KEY
                             , CASE WHEN B.MAT_ID IS NULL THEN A.MAT_ID ELSE B.MAT_ID END AS MAT_ID
                             , A.RESV_FIELD1 / 1000 AS PLAN_QTY
                          FROM CWIPPLNMON A
                             , RWIPMCPBOM B
                         WHERE 1=1   
                           AND A.FACTORY = B.FACTORY(+)
                           AND A.MAT_ID = B.MCP_TO_PART(+)
                           AND A.FACTORY = 'HMKA1' 
                           AND A.PLAN_MONTH BETWEEN '202002' AND '202002'
                           AND DECODE(A.RESV_FIELD1, ' ', 0, A.RESV_FIELD1) > 0  
                       ) B 
                     , (
                        SELECT DISTINCT SUBSTR(PLNNR, 1, 4) AS FLOW, KTSCH AS OPER
                          FROM ZHPPT120@SAPREAL
                         WHERE 1=1
                           AND ARBPL != 'DUMMY'
                       ) C   
                 WHERE 1=1
                   AND A.MAT_ID = B.MAT_ID
                   AND A.FIRST_FLOW = C.FLOW(+)
                   AND A.FACTORY = 'HMKA1'
                   AND A.DELETE_FLAG = ' ' 
               )
         GROUP BY PLAN_DATE, PKG_CODE, OPER, MAT_GRP_1, MAT_GRP_5, WORK_DAY
       ) B
 WHERE 1=1
   AND A.PKG_CODE = B.PKG_CODE
   AND A.OPER = B.OPER
   AND A.MAT_GRP_1 = B.MAT_GRP_1
   AND A.MAT_GRP_5 = B.MAT_GRP_5
GROUP BY A.KEY_1, A.KEY_2, A.OPER, A.OPER_DESC, A.USER_CAPA, A.OP_EFFICE, A.YIELD
ORDER BY A.KEY_1, A.KEY_2, A.OPER, A.OPER_DESC, A.USER_CAPA, A.OP_EFFICE, A.YIELD

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
WITH DT AS
(
SELECT B.MAT_GRP_2, B.MAT_GRP_3, B.MAT_GRP_6, B.BASE_MAT_ID, B.MAT_CMF_11, B.MAT_ID
     , SUM(DECODE(PLAN_WEEK, '202008', WW_QTY, 0)) AS PLAN_0
  FROM RWIPPLNWEK A
     , (
        SELECT DISTINCT MAT_GRP_2, MAT_GRP_3, MAT_GRP_6, BASE_MAT_ID, MAT_CMF_11, MAT_ID
          FROM MWIPMATDEF
         WHERE FACTORY IN ('HMKT1', 'HMKE1')
           AND DELETE_FLAG = ' '
           AND MAT_TYPE = 'FG' 
       ) B
 WHERE 1=1
   AND A.MAT_ID = B.MAT_ID
   AND A.FACTORY = 'HMKT1'
   AND A.PLAN_WEEK BETWEEN '202008' AND '202008'
   AND A.GUBUN = '3' 
   AND A.MAT_ID LIKE '%'
 GROUP BY B.MAT_GRP_2, B.MAT_GRP_3, B.MAT_GRP_6, B.BASE_MAT_ID, B.MAT_CMF_11, B.MAT_ID
)
SELECT KEY_1 AS OPER_GRP, KEY_2 AS GP, KEY_4 AS TYPE, KEY_3 AS SYS, OPER,  ' ',  ' ',  ' ',  ' ',  ' ',  ' ', RES_Y_CNT, RES_N_CNT 
     , ROUND(SUM(NEED_0), 1) AS NEED_0
     , ROUND(RES_Y_CNT - SUM(NEED_0), 1) AS DEF_0
     , SUM(PLAN_0) AS PLAN_0
  FROM (
        SELECT A.KEY_1
             , A.KEY_2
             , A.KEY_3
             , A.KEY_4
             , SUM(DECODE(A.KEY_2, 'HANDLER', HDR_Y_CNT, RES_Y_CNT)) AS RES_Y_CNT
             , SUM(DECODE(A.KEY_2, 'HANDLER', HDR_N_CNT, RES_N_CNT)) AS RES_N_CNT
          FROM MGCMTBLDAT A
             , (
                SELECT 'RES_GRP_6' AS GUBUN, RES_GRP_6 AS DATA
                     , SUM(DECODE(RES_CMF_9, 'Y', 1, 0)) AS RES_Y_CNT
                     , SUM(DECODE(RES_CMF_9, 'N', 1, 0)) AS RES_N_CNT
                  FROM MRASRESDEF
                 WHERE 1=1
                   AND FACTORY = 'HMKT1'
                   AND DELETE_FLAG = ' '
                 GROUP BY RES_GRP_6 
                 UNION ALL
                SELECT 'RES_GRP_3' AS GUBUN, RES_GRP_3
                     , SUM(DECODE(RES_CMF_9, 'Y', 1, 0)) AS RES_Y_CNT
                     , SUM(DECODE(RES_CMF_9, 'N', 1, 0)) AS RES_N_CNT
                  FROM MRASRESDEF
                 WHERE 1=1
                   AND FACTORY = 'HMKT1'
                   AND DELETE_FLAG = ' '
                 GROUP BY RES_GRP_3 
                 UNION ALL
                SELECT 'SUB_AREA_ID' AS GUBUN, SUB_AREA_ID
                     , SUM(DECODE(RES_CMF_9, 'Y', 1, 0)) AS RES_Y_CNT
                     , SUM(DECODE(RES_CMF_9, 'N', 1, 0)) AS RES_N_CNT
                  FROM MRASRESDEF
                 WHERE 1=1
                   AND FACTORY = 'HMKT1'
                   AND DELETE_FLAG = ' '
                 GROUP BY SUB_AREA_ID 
               ) B
             , (
                SELECT SUBSTR(MODEL, 1, 6) AS HDR_ID
                     , SUM(DECODE(PROGRAM, 'Y', 1, 0)) AS HDR_Y_CNT
                     , SUM(DECODE(PROGRAM, 'N', 1, 0)) AS HDR_N_CNT
                  FROM CRASHDRDEF@RPTTOMES
                 WHERE FACTORY = 'HMKT1'
                 GROUP BY SUBSTR(MODEL, 1, 6)
               ) C
         WHERE 1=1
           AND A.DATA_1 = B.GUBUN(+)
           AND A.KEY_3 = C.HDR_ID(+)
           AND B.DATA(+) LIKE A.DATA_2
           AND A.FACTORY = 'HMKT1'
           AND A.TABLE_NAME = 'H_CAPA_MACHINE_INFO'
         GROUP BY A.KEY_1, A.KEY_2, A.KEY_3, A.KEY_4
       ) A
     , ( 
        SELECT KEY_3 AS GUBUN, KEY_2 AS OPER
             , B.MAT_GRP_2, B.MAT_GRP_3, B.MAT_GRP_6, B.BASE_MAT_ID, B.MAT_CMF_11, B.MAT_ID
             , SUM((B.PLAN_0 * DATA_7) / ((86400 / (NVL(DATA_4,0) + NVL(DATA_5,0)) * (DATA_1/100) * (DATA_2/100) * (DATA_3/100) * KEY_4) * 7)) AS NEED_0
             , SUM((B.PLAN_0 * DATA_7)) AS PLAN_0
          FROM MGCMTBLDAT A
             , DT B
         WHERE 1=1
           AND A.KEY_1 = B.MAT_ID
           AND A.FACTORY = 'HMKT1'
           AND A.TABLE_NAME = 'H_CAPA_SIM_INFO'
         GROUP BY KEY_3, KEY_2, B.MAT_GRP_2, B.MAT_GRP_3, B.MAT_GRP_6, B.BASE_MAT_ID, B.MAT_CMF_11, B.MAT_ID
         UNION ALL
        SELECT DATA_8 AS GUBUN, KEY_2 AS OPER
             , B.MAT_GRP_2, B.MAT_GRP_3, B.MAT_GRP_6, B.BASE_MAT_ID, B.MAT_CMF_11, B.MAT_ID
             , SUM((B.PLAN_0 * DATA_7) / ((86400 / (NVL(DATA_4,0) + NVL(DATA_5,0)) * (DATA_1/100) * (DATA_2/100) * (DATA_3/100) * KEY_4) * 7)) AS NEED_0
             , SUM((B.PLAN_0 * DATA_7)) AS PLAN_0
          FROM MGCMTBLDAT A
             , DT B
         WHERE 1=1
           AND A.KEY_1 = B.MAT_ID
           AND A.FACTORY = 'HMKT1'
           AND A.TABLE_NAME = 'H_CAPA_SIM_INFO'
         GROUP BY DATA_8, KEY_2, B.MAT_GRP_2, B.MAT_GRP_3, B.MAT_GRP_6, B.BASE_MAT_ID, B.MAT_CMF_11, B.MAT_ID
         UNION ALL
        SELECT 'AUTO VISUAL' AS GUBUN, '' AS OPER 
             , B.MAT_GRP_2, B.MAT_GRP_3, B.MAT_GRP_6, B.BASE_MAT_ID, B.MAT_CMF_11, B.MAT_ID
             , SUM(CASE WHEN C.FLOW IS NULL THEN 0 ELSE PLAN_0 / (80000 * 7) END) NEED_0
             , SUM(PLAN_0) AS PLAN_0
          FROM DT A
             , MWIPMATDEF B
             , (SELECT DISTINCT FLOW FROM MWIPFLWOPR@RPTTOMES WHERE FACTORY = 'HMKT1' AND OPER ='T1100') C 
         WHERE 1=1
           AND A.MAT_ID = B.MAT_ID
           AND B.FIRST_FLOW = C.FLOW 
           AND B.FACTORY = 'HMKT1'
           AND B.MAT_TYPE = 'FG'
           AND B.DELETE_FLAG = ' ' 
         GROUP BY B.MAT_GRP_2, B.MAT_GRP_3, B.MAT_GRP_6, B.BASE_MAT_ID, B.MAT_CMF_11, B.MAT_ID
         UNION ALL
        SELECT 'TAPE & REEL' AS GUBUN, '' AS OPER 
             , B.MAT_GRP_2, B.MAT_GRP_3, B.MAT_GRP_6, B.BASE_MAT_ID, B.MAT_CMF_11, B.MAT_ID
             , SUM(CASE WHEN C.FLOW IS NULL THEN 0 ELSE PLAN_0 / (100000 * 7) END) NEED_0
             , SUM(PLAN_0) AS PLAN_0
          FROM DT A
             , MWIPMATDEF B
             , (SELECT DISTINCT FLOW FROM MWIPFLWOPR@RPTTOMES WHERE FACTORY = 'HMKT1' AND OPER ='T1200') C 
         WHERE 1=1
           AND A.MAT_ID = B.MAT_ID
           AND B.FIRST_FLOW = C.FLOW   
           AND B.FACTORY = 'HMKT1'
           AND B.MAT_TYPE = 'FG'
           AND B.DELETE_FLAG = ' '
         GROUP BY B.MAT_GRP_2, B.MAT_GRP_3, B.MAT_GRP_6, B.BASE_MAT_ID, B.MAT_CMF_11, B.MAT_ID
       ) B
 WHERE 1=1
   AND A.KEY_3 = B.GUBUN(+)
 GROUP BY KEY_1, KEY_2, KEY_4, KEY_3, OPER,  ' ',  ' ',  ' ',  ' ',  ' ',  ' ', RES_Y_CNT, RES_N_CNT 
 ORDER BY DECODE(KEY_1, 'TEST', 1, 'AUTO VISUAL', 2, 3), KEY_2 DESC, KEY_4, KEY_3, OPER,  ' ',  ' ',  ' ',  ' ',  ' ',  ' ', RES_Y_CNT, RES_N_CNT 

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
SELECT LANGUAGE_3 FROM RWEBFUNDEF WHERE FUNC_NAME = 'BUM010101'
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT               
      LOT_ID          
     ,MOTHER_LOT_ID          
     ,TESTAREA          
     ,PRODUCT          
     ,START_TIME          
     ,END_TIME          
     ,YIELD          
     ,WAFER_CAT          
     ,LOSS_DIE          
     ,TESTED_DIE          
     ,NETDIE          
     ,GEC          
 FROM VYMSWFRYLD@RPTTOMES YLD, MWIPMATDEF MAT      
 WHERE 1=1          
 AND YLD.PRODUCT = MAT.MAT_ID 
 AND END_TIME BETWEEN TO_DATE('20200213000000','YYYYMMDDHH24MISS') AND TO_DATE('20200220235900','YYYYMMDDHH24MISS')          
 AND MAT.FACTORY = 'HMKB1'   
 AND MAT.MAT_VER = 1 
 ORDER BY  LOT_ID         

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
SELECT LANGUAGE_3 FROM RWEBFUNDEF WHERE FUNC_NAME = 'SEC1101'
-------------------------------------------------------------
SELECT * FROM RWEBUSRDEF WHERE FACTORY= :FACTORY ORDER BY USER_ID
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
SELECT LANGUAGE_3 FROM RWEBFUNDEF WHERE FUNC_NAME = 'PRD010217'
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT TO_CHAR(SYSDATE -1 + 2/24, 'YYYYMMDD') AS Y_DAY, SYS_DATE, PLAN_YEAR||LPAD(PLAN_WEEK,2,'0') AS PLAN_WEEK  
  FROM MWIPCALDEF
 WHERE CALENDAR_ID = 'OTD'
   AND SYS_DATE IN (TO_CHAR(SYSDATE + 2/24, 'YYYYMMDD'), TO_CHAR(SYSDATE + 7 + 2/24, 'YYYYMMDD'))

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
SELECT LANGUAGE_3 FROM RWEBFUNDEF WHERE FUNC_NAME = 'TAT050403'
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
SELECT LANGUAGE_3 FROM RWEBFUNDEF WHERE FUNC_NAME = 'TAT050702'
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
(SELECT TO_CHAR(LAST_DAY(TO_DATE('202002', 'YYYYMM')),'YYYYMMDD') FROM DUAL)
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT MIN(SYS_DATE-1) 
  FROM MWIPCALDEF 
 WHERE 1=1
   AND CALENDAR_ID='SE'
   AND SYS_YEAR='2020'
   AND PLAN_WEEK=(
                  SELECT PLAN_WEEK 
                    FROM MWIPCALDEF 
                   WHERE 1=1 
                     AND CALENDAR_ID='SE' 
                     AND SYS_DATE=TO_CHAR(TO_DATE('20200220','YYYYMMDD'),'YYYYMMDD')
                 )

-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ', MAT.MAT_CMF_10, MAT.MAT_ID
     , SUM(NVL(SHP.END_QTY_1,0)) + SUM(NVL(PLN.D0,0))
     , SUM(NVL(SHP.END_QTY_1,0)) AS END_QTY
     , (SUM(NVL(SHP.END_QTY_1,0)) + SUM(NVL(PLN.D0,0))) - SUM(NVL(SHP.END_QTY_1,0)) AS DEF_QTY
     , SUM(NVL(SHP.END_QTY_1,0)) + SUM(NVL(PLN.D0,0)) AS D0
     , SUM(PLN.D1)
     , SUM(PLN.D2)
     , SUM(WIP.STOCK)
     , SUM(WIP.SAW)
     , SUM(WIP.DA)
     , SUM(WIP.WB)
     , SUM(WIP.GATE)
     , SUM(WIP.MOLD)
     , SUM(WIP.FINISH)
     , SUM(WIP.TTL)
  FROM (
        SELECT MAT_GRP_1
             , MAT_GRP_3
             , MAT_ID
             , SUM(CASE WHEN DATA_2 <= T0 THEN QTY_1
                        ELSE 0
                   END) D0
             , SUM(CASE WHEN T0 < DATA_2 AND DATA_2 <= T1 THEN QTY_1
                        ELSE 0
                   END) D1
             , SUM(CASE WHEN T1 < DATA_2 AND DATA_2 <= T2 THEN QTY_1
                        ELSE 0
                   END) D2
          FROM (
                SELECT A.MAT_GRP_1
                     , A.MAT_GRP_3
                     , A.MAT_ID
                     , A.LOT_ID
                     , A.OPER
                     , A.QTY_1
                     , A.DATA_2
                     , B.OPER_GRP_1
                     , (SYSDATE - TO_DATE(A.LOT_CMF_14, 'YYYYMMDDHH24MISS') + 1) - (SYSDATE - TO_DATE('20200219220000', 'YYYYMMDDHH24MISS')) AS T0
                     , (SYSDATE - TO_DATE(A.LOT_CMF_14, 'YYYYMMDDHH24MISS') + 2) - (SYSDATE - TO_DATE('20200219220000', 'YYYYMMDDHH24MISS')) AS T1
                     , (SYSDATE - TO_DATE(A.LOT_CMF_14, 'YYYYMMDDHH24MISS') + 3) - (SYSDATE - TO_DATE('20200219220000', 'YYYYMMDDHH24MISS')) AS T2
                  FROM ( 
                        SELECT A.LOT_ID 
                             , A.FACTORY 
                             , A.MAT_ID 
                             , A.OPER 
                             , A.QTY_1 
                             , A.LOT_CMF_5 
                             , A.LOT_CMF_14 
                             , A.RESV_FIELD_1 
                             , A.MAT_GRP_1 
                             , A.MAT_GRP_3 
                             , CASE WHEN NVL(B.DATA_2, 0) <> 0 THEN B.DATA_2  
                                    ELSE C.DATA_2 
                               END AS DATA_2 
                          FROM ( 
                                SELECT STS.LOT_ID 
                                     , STS.FACTORY 
                                     , STS.MAT_ID 
                                     , STS.OPER 
                                     , STS.QTY_1 
                                     , STS.LOT_CMF_5 
                                     , STS.LOT_CMF_14 
                                     , STS.RESV_FIELD_1 
                                     , MAT.MAT_GRP_1 
                                     , MAT.MAT_GRP_3 
                                  FROM RWIPLOTSTS STS
                                     , (
                                        SELECT FACTORY 
                                             , MAT_ID 
                                             , MAT_GRP_1 
                                             , MAT_GRP_3 
                                          FROM MWIPMATDEF 
                                         WHERE FACTORY = 'HMKA1' 
                                       ) MAT 
                                 WHERE STS.FACTORY = MAT.FACTORY
                                   AND STS.MAT_ID = MAT.MAT_ID
                                   AND STS.FACTORY = 'HMKA1'
                                   AND STS.LOT_TYPE = 'W'
                                   AND STS.LOT_DEL_FLAG = ' '
                               ) A 
                             , (
                                SELECT FACTORY, KEY_2, KEY_3, SUM(TO_NUMBER(DATA_2)) AS DATA_2
                                  FROM MGCMTBLDAT
                                 WHERE FACTORY = 'HMKA1' 
                                   AND TABLE_NAME = 'H_RPT_TAT_MAINOBJECT'
                                   AND KEY_1 <= '20200220'
                                   AND DATA_1 >= '20200220'
                                   AND KEY_2 <> '-' 
                                   AND KEY_4 IN ('HMK2A','SAW')
                                 GROUP BY FACTORY, KEY_2, KEY_3
                               ) B 
                             , (
                                SELECT FACTORY, KEY_2, KEY_3, SUM(TO_NUMBER(DATA_2)) AS DATA_2
                                  FROM MGCMTBLDAT
                                 WHERE FACTORY = 'HMKA1' 
                                   AND TABLE_NAME = 'H_RPT_TAT_MAINOBJECT'
                                   AND KEY_1 <= '20200220'
                                   AND DATA_1 >= '20200220'
                                   AND KEY_2 = '-' 
                                   AND KEY_4 IN ('HMK2A','SAW')
                                 GROUP BY FACTORY, KEY_2, KEY_3
                               ) C 
                         WHERE A.FACTORY = B.FACTORY(+) 
                           AND A.MAT_GRP_1 = B.KEY_2(+) 
                           AND A.MAT_GRP_3 = B.KEY_3(+) 
                           AND A.FACTORY = C.FACTORY(+)
                           AND A.MAT_GRP_3 = C.KEY_3(+)
                       ) A 
                     , MWIPOPRDEF B
                 WHERE A.FACTORY = B.FACTORY
                   AND A.OPER = B.OPER
                   AND A.DATA_2 > 0
                   AND B.OPER_GRP_1 IN ('HMK2A', 'B/G', 'SAW', 'S/P')
               )
         GROUP BY MAT_GRP_1, MAT_GRP_3, MAT_ID
       ) PLN
     , (
        SELECT A.MAT_ID 
             , SUM(NVL(A.V0,0)) AS STOCK 
             , SUM(NVL(A.V1+A.V2+A.V3,0)) AS SAW 
             , SUM(NVL(A.V4,0)) AS DA 
             , SUM(NVL(A.V5,0)) AS WB 
             , SUM(NVL(A.V16,0)) AS GATE 
             , SUM(NVL(A.V6+A.V7,0)) AS MOLD 
             , SUM(NVL(A.V8+A.V9+A.V10+A.V11+A.V12+A.V13+A.V14+A.V15,0)) AS FINISH 
             , SUM(NVL(A.V0+A.V1+A.V2+A.V3+A.V4+A.V5+A.V6+A.V7+A.V8+A.V9+A.V10+A.V11+A.V12+A.V13+A.V14+A.V15+A.V16,0)) AS TTL 
          FROM ( 
                SELECT MAT_ID
                     , SUM(DECODE(OPER_GRP_1, 'HMK2A', QTY, 0)) V0 
                     , SUM(DECODE(OPER_GRP_1, 'B/G', QTY, 0)) V1 
                     , SUM(DECODE(OPER_GRP_1, 'SAW', QTY, 0)) V2 
                     , SUM(DECODE(OPER_GRP_1, 'S/P', QTY, 0)) V3 
                     , SUM(DECODE(OPER_GRP_1, 'D/A', QTY, 0)) V4 
                     , SUM(DECODE(OPER_GRP_1, 'W/B', QTY, 0)) V5 
                     , SUM(DECODE(OPER_GRP_1, 'MOLD', QTY, 0)) V6 
                     , SUM(DECODE(OPER_GRP_1, 'CURE', QTY, 0)) V7 
                     , SUM(DECODE(OPER_GRP_1, 'M/K', QTY, 0)) V8 
                     , SUM(DECODE(OPER_GRP_1, 'TRIM', QTY, 0)) V9 
                     , SUM(DECODE(OPER_GRP_1, 'TIN', QTY, 0)) V10
                     , SUM(DECODE(OPER_GRP_1, 'S/B/A', QTY, 0)) V11 
                     , SUM(DECODE(OPER_GRP_1, 'SIG', QTY, 0)) V12 
                     , SUM(DECODE(OPER_GRP_1, 'AVI', QTY, 0)) V13 
                     , SUM(DECODE(OPER_GRP_1, 'V/I', QTY, 0)) V14 
                     , SUM(DECODE(OPER_GRP_1, 'HMK3A', QTY, 0)) V15  
                     , SUM(DECODE(OPER_GRP_1, 'GATE', QTY, 0)) V16
                  FROM (  
                        SELECT A.FACTORY, A.MAT_ID, B.OPER_GRP_1 
                             , SUM(A.QTY_1) QTY  
                          FROM RWIPLOTSTS A  
                             , MWIPOPRDEF B  
                         WHERE 1 = 1                      
                           AND A.FACTORY = 'HMKA1' 
                           AND A.LOT_TYPE = 'W'  
                           AND A.LOT_DEL_FLAG = ' ' 
                           AND B.OPER_GRP_1 <> '-'
                           AND A.OPER NOT IN ('A000N')
                           AND A.FACTORY = B.FACTORY(+)  
                           AND A.OPER = B.OPER(+)  
                         GROUP BY A.FACTORY, A.MAT_ID, B.OPER_GRP_1 
                       ) 
                 GROUP BY MAT_ID
               ) A
         WHERE 1 = 1 
         GROUP BY A.MAT_ID
       ) WIP
     , (
        SELECT MAT_ID
             , SUM(DECODE(WORK_DATE, '20200220', (CASE WHEN OPER IN ('AZ010','SHIP','TZ010','F0000','EZ010', 'F0000') THEN SHIP_QTY_1 ELSE END_QTY_1 END),0)) END_QTY_1
          FROM (
                SELECT FACTORY, MAT_ID, OPER, LOT_TYPE, MAT_VER, WORK_DATE, CM_KEY_3
                     , SUM(END_QTY_1) AS END_QTY_1
                     , SUM(SHIP_QTY_1) AS SHIP_QTY_1
                  FROM (
                        SELECT FACTORY, MAT_ID, OPER, LOT_TYPE, MAT_VER, WORK_DATE, CM_KEY_3
                             , DECODE(SUBSTR(OPER,2,4),'0000',SUM(S1_OPER_IN_QTY_1+S2_OPER_IN_QTY_1+S3_OPER_IN_QTY_1),SUM(S1_END_QTY_1+S2_END_QTY_1+S3_END_QTY_1+S1_END_RWK_QTY_1 + S2_END_RWK_QTY_1 + S3_END_RWK_QTY_1)) END_QTY_1
                             , 0 SHIP_QTY_1
                          FROM RSUMWIPMOV 
                         WHERE WORK_DATE = '20200220'
                           AND OPER NOT IN ('AZ010','TZ010','F0000','EZ010', 'F0000')
                         GROUP BY FACTORY, MAT_ID, OPER, LOT_TYPE, MAT_VER, WORK_DATE, CM_KEY_3
                         UNION ALL
                        SELECT CM_KEY_1 AS FACTORY, MAT_ID
                             , DECODE(CM_KEY_1,'HMKA1','AZ010','HMKT1','TZ010','FGS','F0000','HMKE1','EZ010') OPER
                             , LOT_TYPE, MAT_VER,  WORK_DATE,CM_KEY_3
                             , 0 END_QTY_1
                             , SUM(S1_FAC_OUT_QTY_1+S2_FAC_OUT_QTY_1+S3_FAC_OUT_QTY_1) SHIP_QTY_1
                          FROM RSUMFACMOV 
                         WHERE FACTORY NOT IN ('RETURN')
                           AND WORK_DATE = '20200220'
                         GROUP BY CM_KEY_1, MAT_ID, OPER, LOT_TYPE, MAT_VER, WORK_DATE, CM_KEY_3
                       )
                 GROUP BY FACTORY, MAT_ID, OPER, LOT_TYPE, MAT_VER, WORK_DATE, CM_KEY_3
               ) 
        WHERE 1=1 
          AND FACTORY  = 'HMKA1'              
          AND MAT_VER = 1 
          AND OPER = 'A0300' 
          AND OPER NOT IN ('00001','00002') 
        GROUP BY MAT_ID
       ) SHP
       , MWIPMATDEF MAT
 WHERE 1=1
   AND MAT.MAT_ID = PLN.MAT_ID(+)
   AND MAT.MAT_ID = WIP.MAT_ID(+)
   AND MAT.MAT_ID = SHP.MAT_ID(+)
   AND MAT.FACTORY = 'HMKA1' 
 GROUP BY  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ', MAT.MAT_CMF_10, MAT.MAT_ID
 HAVING ( 
         NVL(SUM(SHP.END_QTY_1),0) + NVL(SUM(PLN.D0),0) + NVL(SUM(PLN.D1),0) + NVL(SUM(PLN.D2),0) + NVL(SUM(WIP.STOCK),0) +  
         NVL(SUM(WIP.SAW),0) + NVL(SUM(WIP.DA),0) + NVL(SUM(WIP.WB),0) + NVL(SUM(WIP.GATE),0) + NVL(SUM(WIP.MOLD),0) + NVL(SUM(WIP.FINISH),0) + NVL(SUM(WIP.TTL),0) 
        ) <> 0 
 ORDER BY  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ',  ' ', MAT.MAT_CMF_10, MAT.MAT_ID

-------------------------------------------------------------
SELECT * FROM RWEBUSRDEF WHERE FACTORY = :FACTORY AND USER_ID= :USER_ID
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT A.FUNC_GRP_SEQ,A.SEC_GRP_ID,A.FUNC_GRP_ID,NVL(A.FUNC_NAME, ' ') FUNC_NAME, NVL(B.FUNC_DESC, ' ') FUNC_DESC, LANGUAGE_1, LANGUAGE_2, LANGUAGE_3
  FROM RWEBGRPFUN A, RWEBFUNDEF B
 WHERE A.FACTORY = :p_FACTORY
   AND A.SEC_GRP_ID = :p_SEC_GRP_ID
   AND A.FUNC_NAME=B.FUNC_NAME(+)
 ORDER BY A.FUNC_GRP_SEQ, A.FUNC_SEQ
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
SELECT LANGUAGE_3 FROM RWEBFUNDEF WHERE FUNC_NAME = 'SEC1103'
-------------------------------------------------------------
SELECT * FROM RWEBFUNDEF ORDER BY FUNC_NAME
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
SELECT LANGUAGE_3 FROM RWEBFUNDEF WHERE FUNC_NAME = 'PRD011999'
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
SELECT LANGUAGE_3 FROM RWEBFUNDEF WHERE FUNC_NAME = 'SEC1102'
-------------------------------------------------------------
SELECT * FROM RWEBGRPDEF WHERE FACTORY = :FACTORY ORDER BY SEC_GRP_ID
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT LANGUAGE_3 FROM RWEBFUNDEF WHERE FUNC_NAME = 'SEC1101'
-------------------------------------------------------------
SELECT * FROM RWEBUSRDEF WHERE FACTORY= :FACTORY ORDER BY USER_ID
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
SELECT LANGUAGE_3 FROM RWEBFUNDEF WHERE FUNC_NAME = 'TST1107'
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT LANGUAGE_3 FROM RWEBFUNDEF WHERE FUNC_NAME = 'BUM010101'
-------------------------------------------------------------
SELECT * FROM RWEBUSRDEF WHERE FACTORY = :FACTORY AND USER_ID= :USER_ID
-------------------------------------------------------------
SELECT A.FUNC_GRP_SEQ,A.SEC_GRP_ID,A.FUNC_GRP_ID,NVL(A.FUNC_NAME, ' ') FUNC_NAME, NVL(B.FUNC_DESC, ' ') FUNC_DESC, LANGUAGE_1, LANGUAGE_2, LANGUAGE_3
  FROM RWEBGRPFUN A, RWEBFUNDEF B
 WHERE A.FACTORY = :p_FACTORY
   AND A.SEC_GRP_ID = :p_SEC_GRP_ID
   AND A.FUNC_NAME=B.FUNC_NAME(+)
 ORDER BY A.FUNC_GRP_SEQ, A.FUNC_SEQ
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT LANGUAGE_3 FROM RWEBFUNDEF WHERE FUNC_NAME = 'PRD010217'
-------------------------------------------------------------
SELECT * FROM RWEBUSRDEF WHERE FACTORY = :FACTORY AND USER_ID= :USER_ID
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT A.FUNC_GRP_SEQ,A.SEC_GRP_ID,A.FUNC_GRP_ID,NVL(A.FUNC_NAME, ' ') FUNC_NAME, NVL(B.FUNC_DESC, ' ') FUNC_DESC, LANGUAGE_1, LANGUAGE_2, LANGUAGE_3
  FROM RWEBGRPFUN A, RWEBFUNDEF B
 WHERE A.FACTORY = :p_FACTORY
   AND A.SEC_GRP_ID = :p_SEC_GRP_ID
   AND A.FUNC_NAME=B.FUNC_NAME(+)
 ORDER BY A.FUNC_GRP_SEQ, A.FUNC_SEQ
-------------------------------------------------------------
SELECT * FROM RWEBUSRDEF WHERE FACTORY = :FACTORY AND USER_ID= :USER_ID
-------------------------------------------------------------
SELECT A.FUNC_GRP_SEQ,A.SEC_GRP_ID,A.FUNC_GRP_ID,NVL(A.FUNC_NAME, ' ') FUNC_NAME, NVL(B.FUNC_DESC, ' ') FUNC_DESC, LANGUAGE_1, LANGUAGE_2, LANGUAGE_3
  FROM RWEBGRPFUN A, RWEBFUNDEF B
 WHERE A.FACTORY = :p_FACTORY
   AND A.SEC_GRP_ID = :p_SEC_GRP_ID
   AND A.FUNC_NAME=B.FUNC_NAME(+)
 ORDER BY A.FUNC_GRP_SEQ, A.FUNC_SEQ
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT PLAN_WEEK V1    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_DATE = TO_CHAR(SYSDATE,'yyyymmdd')      AND ROWNUM = 1  
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('2020', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
 SELECT UNIQUE PLAN_WEEK V1, (PLAN_YEAR || LPAD(PLAN_WEEK, 2,'0')) V2    FROM MWIPCALDEF   WHERE CALENDAR_ID IN ('SYSTEM', 'HM', 'SYSTEM')     AND SYS_YEAR = NVL('2020', TO_CHAR(SYSDATE,'yyyy'))    ORDER BY 1 
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT LANGUAGE_3 FROM RWEBFUNDEF WHERE FUNC_NAME = 'PQC030901'
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
INSERT INTO RWEBFUNLOG(FACTORY,USER_ID,FUNC_NAME,FUNC_GROUP,VIEW_TIME, UPDATE_TIME)
VALUES (:p_FACTORY, :p_USER_ID, :p_FUNC_NAME, :p_FUNC_GROUP,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'))

-------------------------------------------------------------
SELECT LANGUAGE_3 FROM RWEBFUNDEF WHERE FUNC_NAME = 'PRD011007'
-------------------------------------------------------------
SELECT COUNT(*)
FROM RWEBFUNLOG
WHERE FACTORY = :FACTORY  
AND USER_ID = :USER_ID 
AND FUNC_NAME = :FUNC_NAME 
AND FUNC_GROUP = :FUNC_GROUP
AND VIEW_TIME BETWEEN TO_CHAR(SYSDATE - 10/1440, 'YYYYMMDDHH24MISS') AND TO_CHAR(SYSDATE + 10/1440, 'YYYYMMDDHH24MISS')
-------------------------------------------------------------
SELECT CUST_TYPE, NVL((SELECT DATA_1 FROM MGCMTBLDAT WHERE TABLE_NAME = 'H_CUSTOMER' AND KEY_1 = MAT_GRP_1 AND ROWNUM=1), '-') AS CUSTOMER, MAT_GRP_9, MAT_GRP_10,  ' ',  ' ',  ' ' 
     , ROUND(SUM(ORI_PLAN * PRICE) / 1000, 0) AS ORI_PLAN
     , ROUND(SUM(REV_PLAN * PRICE) / 1000, 0) AS REV_PLAN
     , ROUND(SUM(BOH_QTY * PRICE) / 1000, 0) AS BOH_QTY
     , ROUND(SUM(RCV_QTY * PRICE) / 1000, 0) AS RCV_QTY
     , ROUND(SUM((NVL(BOH_QTY,0) + NVL(RCV_QTY,0)) * PRICE) / 1000, 0) AS WSH_QTY
     , ROUND(DECODE(SUM(ORI_PLAN), 0, 0, ROUND(SUM(NVL(BOH_QTY,0) + NVL(RCV_QTY,0)) / SUM(ORI_PLAN) * 100,1)), 0) AS ORI_PER
     , ROUND(DECODE(SUM(REV_PLAN), 0, 0, ROUND(SUM(NVL(BOH_QTY,0) + NVL(RCV_QTY,0)) / SUM(REV_PLAN) * 100,1)), 0) AS REV_PER
     , ROUND(SUM(RCV_0 * PRICE) / 1000, 0)  AS RCV_0
     , ROUND(SUM(RCV_1 * PRICE) / 1000, 0)  AS RCV_1
     , ROUND(SUM(RCV_2 * PRICE) / 1000, 0)  AS RCV_2
     , ROUND(SUM(RCV_3 * PRICE) / 1000, 0)  AS RCV_3
     , ROUND(SUM(RCV_4 * PRICE) / 1000, 0)  AS RCV_4
     , ROUND(SUM(RCV_5 * PRICE) / 1000, 0)  AS RCV_5
     , ROUND(SUM(RCV_6 * PRICE) / 1000, 0)  AS RCV_6
     , ROUND(SUM(RCV_7 * PRICE) / 1000, 0)  AS RCV_7
     , ROUND(SUM(RCV_8 * PRICE) / 1000, 0)  AS RCV_8
     , ROUND(SUM(RCV_9 * PRICE) / 1000, 0)  AS RCV_9
     , ROUND(SUM(RCV_10 * PRICE) / 1000, 0)  AS RCV_10
     , ROUND(SUM(RCV_11 * PRICE) / 1000, 0)  AS RCV_11
     , ROUND(SUM(RCV_12 * PRICE) / 1000, 0)  AS RCV_12
     , ROUND(SUM(RCV_13 * PRICE) / 1000, 0)  AS RCV_13
     , ROUND(SUM(RCV_14 * PRICE) / 1000, 0)  AS RCV_14
     , ROUND(SUM(RCV_15 * PRICE) / 1000, 0)  AS RCV_15
     , ROUND(SUM(RCV_16 * PRICE) / 1000, 0)  AS RCV_16
     , ROUND(SUM(RCV_17 * PRICE) / 1000, 0)  AS RCV_17
     , ROUND(SUM(RCV_18 * PRICE) / 1000, 0)  AS RCV_18
     , ROUND(SUM(RCV_19 * PRICE) / 1000, 0)  AS RCV_19
  FROM (
        SELECT MAT.*
             , NVL((SELECT DATA_10 FROM MGCMTBLDAT WHERE TABLE_NAME = 'H_CUSTOMER' AND FACTORY = 'HMKA1' AND  KEY_1 = MAT_GRP_1), '-') AS CUST_TYPE
             , CASE WHEN MAT_GRP_3 IN ('COB', 'BGN') THEN ROUND(PLN.ORI_PLAN/DECODE(MAT_CMF_13,' ', 1, '-', 1, MAT_CMF_13),0) ELSE PLN.ORI_PLAN END AS ORI_PLAN
             , CASE WHEN MAT_GRP_3 IN ('COB', 'BGN') THEN ROUND(PLN.REV_PLAN/DECODE(MAT_CMF_13,' ', 1, '-', 1, MAT_CMF_13),0) ELSE PLN.REV_PLAN END AS REV_PLAN
             , CASE WHEN MAT_GRP_3 IN ('COB', 'BGN') THEN ROUND(BOH.BOH_QTY/DECODE(MAT_CMF_13,' ', 1, '-', 1, MAT_CMF_13),0)
                    WHEN MAT_CMF_11 IN ('DHL', 'DQZ', 'DQA', 'DRA', 'DND', 'DWG', 'DUT', 'HAU', 'HF8', 'HDM', 'HDR', 'HEN', 'HQA', 'HQC') THEN (CASE WHEN MAT_GRP_5 IN ('3rd','Merge') THEN BOH.BOH_QTY
                                                                                             WHEN MAT_GRP_5 LIKE 'Middle%' AND MAT_GRP_5 <> 'Middle' THEN BOH.BOH_QTY
                                                                                             ELSE 0 END)
                    WHEN MAT_CMF_11 IN (SELECT DISTINCT(MAT_CMF_11) FROM MWIPMATDEF WHERE FACTORY = 'HMKA1' AND MAT_GRP_5 = '1st' AND (MAT_ID LIKE 'SEKS%' OR MAT_ID LIKE 'SEKY%'))
                         THEN (CASE WHEN MAT_GRP_5 IN ('2nd','Merge') OR MAT_GRP_5 LIKE 'Middle%' THEN BOH.BOH_QTY ELSE 0 END)
                    WHEN MAT_GRP_1 = 'HX' AND MESMGR.F_GET_ATTR_VALUE@RPTTOMES(MAT.MAT_ID, 'MAT_ETC', 'HX_VERSION') = 'A-376'
                         THEN (CASE WHEN MAT_GRP_5 IN ('5th','Merge') THEN BOH.BOH_QTY ELSE 0 END)
                    WHEN MAT_GRP_1 = 'HX' AND MESMGR.F_GET_ATTR_VALUE@RPTTOMES(MAT.MAT_ID, 'MAT_ETC', 'HX_VERSION') IN ('A-445', 'A-525')
                         THEN (CASE WHEN MAT_GRP_5 IN ('6th','Merge') THEN BOH.BOH_QTY ELSE 0 END)
                    WHEN MAT_GRP_1 = 'HX' AND MESMGR.F_GET_ATTR_VALUE@RPTTOMES(MAT.MAT_ID, 'MAT_ETC', 'HX_VERSION') = 'A-524'
                         THEN (CASE WHEN MAT_GRP_5 IN ('7th','Merge') THEN BOH.BOH_QTY ELSE 0 END)
                    WHEN MAT_GRP_4 NOT IN ('-','FD','FU') AND MAT_GRP_5 <> '-' 
                         THEN (CASE WHEN MAT_GRP_5 IN ('1st','Merge') OR MAT_GRP_5 LIKE 'Middle%' THEN BOH.BOH_QTY ELSE 0 END)
                    ELSE BOH.BOH_QTY
               END BOH_QTY
             , RCV.*
             , 1 AS PRICE
          FROM MWIPMATDEF MAT
             , (
                SELECT MAT_ID
                     , SUM(PLAN_QTY_ASSY) AS ORI_PLAN 
                     , SUM(DECODE(RESV_FIELD1, ' ', 0, RESV_FIELD1)) AS REV_PLAN
                  FROM CWIPPLNMON
                 WHERE 1=1
                   AND FACTORY = 'HMKA1'
                   AND PLAN_MONTH = '202002' 
                   AND PLAN_QTY_ASSY + DECODE(RESV_FIELD1, ' ', 0, RESV_FIELD1) > 0 
                 GROUP BY MAT_ID
               ) PLN
             , (
                SELECT MAT_ID
                     , SUM(CASE WHEN MESMGR.F_GET_ATTR_VALUE@RPTTOMES(MAT_ID, 'MAT_ETC', 'HX_VERSION') IN ('A-376', 'A-445')
                                     THEN (CASE WHEN OPER <= 'A0015' THEN QTY_1 / NVL(COMP_CNT,1) ELSE QTY_1 END)
                                ELSE (CASE WHEN OPER <= 'A0395' THEN QTY_1 / NVL(COMP_CNT,1) ELSE QTY_1 END)
                           END) AS BOH_QTY
                  FROM (
                        SELECT MAT_ID
                             , OPER
                             , EOH_QTY_1 AS QTY_1
                             , (SELECT DATA_1 FROM MGCMTBLDAT WHERE FACTORY = 'HMKA1' AND TABLE_NAME IN ('H_SEC_AUTO_LOSS','H_HX_AUTO_LOSS') AND KEY_1 = A.MAT_ID) AS COMP_CNT 
                          FROM RSUMWIPEOH A
                         WHERE 1=1
                           AND FACTORY = 'HMKA1'
                           AND WORK_DATE = TO_CHAR(TO_DATE('202002' || '01')-1, 'YYYYMMDD')
                           AND SHIFT = '3'
                           AND LOT_TYPE = 'W'
                           AND MAT_ID NOT LIKE 'HX%' 
                           AND CM_KEY_3 LIKE 'P%' 
                         UNION ALL 
                        SELECT MAT_ID
                             , OPER
                             , EOH_QTY_1 AS QTY_1
                             , (SELECT DATA_1 FROM MGCMTBLDAT WHERE FACTORY = 'HMKA1' AND TABLE_NAME IN ('H_SEC_AUTO_LOSS','H_HX_AUTO_LOSS') AND KEY_1 = A.MAT_ID) AS COMP_CNT 
                          FROM RSUMWIPEOH A
                         WHERE 1=1
                           AND FACTORY = 'HMKA1'
                           AND WORK_DATE = '20200201'
                           AND SHIFT = '1'
                           AND LOT_TYPE = 'W'
                           AND MAT_ID LIKE 'HX%' 
                           AND CM_KEY_3 LIKE 'P%' 
                       )
                 GROUP BY MAT_ID
               ) BOH
             , (
                SELECT MAT_ID AS PRODUCT 
                     , SUM(QTY / NVL(COMP_CNT,1)) AS RCV_QTY
                     , SUM(DECODE(WORK_DATE, '20200201', QTY / NVL(COMP_CNT,1), 0)) AS RCV_0
                     , SUM(DECODE(WORK_DATE, '20200202', QTY / NVL(COMP_CNT,1), 0)) AS RCV_1
                     , SUM(DECODE(WORK_DATE, '20200203', QTY / NVL(COMP_CNT,1), 0)) AS RCV_2
                     , SUM(DECODE(WORK_DATE, '20200204', QTY / NVL(COMP_CNT,1), 0)) AS RCV_3
                     , SUM(DECODE(WORK_DATE, '20200205', QTY / NVL(COMP_CNT,1), 0)) AS RCV_4
                     , SUM(DECODE(WORK_DATE, '20200206', QTY / NVL(COMP_CNT,1), 0)) AS RCV_5
                     , SUM(DECODE(WORK_DATE, '20200207', QTY / NVL(COMP_CNT,1), 0)) AS RCV_6
                     , SUM(DECODE(WORK_DATE, '20200208', QTY / NVL(COMP_CNT,1), 0)) AS RCV_7
                     , SUM(DECODE(WORK_DATE, '20200209', QTY / NVL(COMP_CNT,1), 0)) AS RCV_8
                     , SUM(DECODE(WORK_DATE, '20200210', QTY / NVL(COMP_CNT,1), 0)) AS RCV_9
                     , SUM(DECODE(WORK_DATE, '20200211', QTY / NVL(COMP_CNT,1), 0)) AS RCV_10
                     , SUM(DECODE(WORK_DATE, '20200212', QTY / NVL(COMP_CNT,1), 0)) AS RCV_11
                     , SUM(DECODE(WORK_DATE, '20200213', QTY / NVL(COMP_CNT,1), 0)) AS RCV_12
                     , SUM(DECODE(WORK_DATE, '20200214', QTY / NVL(COMP_CNT,1), 0)) AS RCV_13
                     , SUM(DECODE(WORK_DATE, '20200215', QTY / NVL(COMP_CNT,1), 0)) AS RCV_14
                     , SUM(DECODE(WORK_DATE, '20200216', QTY / NVL(COMP_CNT,1), 0)) AS RCV_15
                     , SUM(DECODE(WORK_DATE, '20200217', QTY / NVL(COMP_CNT,1), 0)) AS RCV_16
                     , SUM(DECODE(WORK_DATE, '20200218', QTY / NVL(COMP_CNT,1), 0)) AS RCV_17
                     , SUM(DECODE(WORK_DATE, '20200219', QTY / NVL(COMP_CNT,1), 0)) AS RCV_18
                     , SUM(DECODE(WORK_DATE, '20200220', QTY / NVL(COMP_CNT,1), 0)) AS RCV_19
                  FROM (
                        SELECT A.WORK_DATE, A.MAT_ID
                             , CASE WHEN MAT_GRP_3 IN ('COB', 'BGN') THEN ROUND(RCV_QTY_1/DECODE(MAT_CMF_13,' ', 1, '-', 1, MAT_CMF_13),0)
                                    WHEN MAT_CMF_11 = 'JZH' THEN ROUND(RCV_QTY_1 / 2,0)
                                    WHEN MAT_CMF_11 IN ('DHL', 'DQZ', 'DQA', 'DRA', 'DND', 'DWG', 'DUT', 'HAU', 'HF8', 'HDM', 'HDR', 'HEN', 'HQA', 'HQC') THEN DECODE(MAT_GRP_5, '3rd', RCV_QTY_1, 0)
                                    WHEN MAT_CMF_11 IN (SELECT DISTINCT(MAT_CMF_11) FROM MWIPMATDEF WHERE FACTORY = 'HMKA1' AND MAT_GRP_5 = '1st' AND (MAT_ID LIKE 'SEKS%' OR MAT_ID LIKE 'SEKY%'))
                                         THEN DECODE(MAT_GRP_5, '2nd', RCV_QTY_1, 0)
                                    WHEN MAT_GRP_1 = 'HX' AND MESMGR.F_GET_ATTR_VALUE@RPTTOMES(A.MAT_ID, 'MAT_ETC', 'HX_VERSION') = 'A-376'
                                         THEN DECODE(MAT_GRP_5, '5th', RCV_QTY_1, 0)
                                    WHEN MAT_GRP_1 = 'HX' AND MESMGR.F_GET_ATTR_VALUE@RPTTOMES(A.MAT_ID, 'MAT_ETC', 'HX_VERSION') IN ('A-445', 'A-525')
                                         THEN DECODE(MAT_GRP_5, '6th', RCV_QTY_1, 0)
                                    WHEN MAT_GRP_1 = 'HX' AND MESMGR.F_GET_ATTR_VALUE@RPTTOMES(A.MAT_ID, 'MAT_ETC', 'HX_VERSION') = 'A-524'
                                         THEN DECODE(MAT_GRP_5, '7th', RCV_QTY_1, 0)
                                    WHEN MAT_GRP_4 NOT IN ('-','FD','FU') AND MAT_GRP_5 <> '-' THEN CASE WHEN MAT_GRP_5 IN ('1st','Merge') THEN RCV_QTY_1 ELSE 0 END
                                    ELSE RCV_QTY_1
                                END QTY
                             , (SELECT DATA_1 FROM MGCMTBLDAT WHERE FACTORY = 'HMKA1' AND TABLE_NAME IN ('H_SEC_AUTO_LOSS','H_HX_AUTO_LOSS') AND KEY_1 = A.MAT_ID) AS COMP_CNT 
                          FROM (
                                SELECT A.*
                                     , B.WORK_DATE, B.RCV_QTY_1, B.RCV_QTY_2
                                  FROM MWIPMATDEF A
                                     , (
                                        SELECT *
                                          FROM VSUMWIPRCV 
                                         WHERE 1=1
                                           AND WORK_DATE BETWEEN '20200201' AND '20200220'
                                           AND LOT_TYPE = 'W'
                                           AND FACTORY = 'HMKA1'
                                           AND CM_KEY_2 = 'PROD'   
                                           AND CM_KEY_3 LIKE 'P%'
                                           AND MAT_ID NOT LIKE 'HX%'
                                         UNION ALL
                                        SELECT *
                                          FROM VSUMWIPRCV_HX 
                                         WHERE 1=1
                                           AND WORK_DATE BETWEEN '20200201' AND '20200220'
                                           AND LOT_TYPE = 'W'
                                           AND FACTORY = 'HMKA1'
                                           AND CM_KEY_2 = 'PROD'   
                                           AND CM_KEY_3 LIKE 'P%'
                                           AND MAT_ID LIKE 'HX%'
                                       ) B
                                 WHERE 1=1
                                   AND A.FACTORY = B.FACTORY
                                   AND A.MAT_ID = B.MAT_ID
                               ) A
                       )
                 GROUP BY MAT_ID
               ) RCV
         WHERE 1=1
           AND MAT.MAT_ID = PLN.MAT_ID(+)
           AND MAT.MAT_ID = BOH.MAT_ID(+)
           AND MAT.MAT_ID = RCV.PRODUCT(+)
           AND MAT.FACTORY = 'HMKA1'
           AND MAT.DELETE_FLAG = ' '
           AND MAT.MAT_TYPE = 'FG'
           AND MAT.MAT_GRP_2 NOT IN ('-', 'PW')
           AND MAT.MAT_ID LIKE '%'
       ) 
 GROUP BY CUST_TYPE, MAT_GRP_1, MAT_GRP_9, MAT_GRP_10,  ' ',  ' ',  ' ' 
 HAVING SUM(NVL(ORI_PLAN,0)) + SUM(NVL(REV_PLAN,0)) + SUM(NVL(BOH_QTY,0)) + SUM(NVL(RCV_QTY,0)) > 0
 ORDER BY DECODE(CUST_TYPE, 'SEC', 1, 'Hynix', 2, 'Fabless', 3, 4), MAT_GRP_1, MAT_GRP_9, MAT_GRP_10,  ' ',  ' ',  ' ' 

-------------------------------------------------------------
