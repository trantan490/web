using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Drawing;
using System.Data;
using System.Text;
using System.Windows.Forms;

using Miracom.UI;
using Miracom.SmartWeb;
using Miracom.SmartWeb.UI;
using Miracom.SmartWeb.FWX;
using Miracom.SmartWeb.UI.Controls;

namespace Hana.PQC
{
    public partial class PQC031206 : Miracom.SmartWeb.UI.Controls.udcCUSReportMain001
    {

        #region " PQC031206 : Program Initial "

        public PQC031206()
        {
            InitializeComponent();

            cdvDate.Value = System.DateTime.Now;
            cboGraph.SelectedIndex = 0;
        }

        #endregion


        #region " Common Function "

        private void fnSSInitial()
        {
            /****************************************************
             * Comment : SS의 Header를 설정한다.
             * 
             * Created By : 김선호(2012-06-16-목)
             * 
             * Modified By : 
             ****************************************************/
            //월
            string squery = "";
            DataTable dt = null;
            //주차
            string squery2 = "";
            DataTable dtWeek = null;
            // 목요일 가져오기
            string squery3 = "";
            DataTable dtThu = null;
            //일가져오기
            string squery4 = "";
            DataTable dtDay = null;
            // 분기
            string squery5 = "";
            DataTable dtQuarter = null;

            try
            {
                Cursor.Current = Cursors.WaitCursor;
                LoadingPopUp.LoadIngPopUpShow(this);

                string todate = "";

                switch (cboGraph.SelectedIndex)
                {
                    #region - 공정 품질 기상도

                    case 0:

                        todate = cdvDate.Value.ToString("yyyyMMddHHmmss");

                        squery5 = "SELECT CASE WHEN TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD HH24MISS'), 'Q') - 3 > 0 \n"
                                + "            THEN SUBSTR(TO_CHAR(TO_DATE(TO_DATE('" + todate + "', 'YYYYMMDD HH24MISS')),'YYYY'),3,2) || 'Y ' || TO_CHAR(TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD HH24MISS'), 'Q') - 3) || 'Q' \n"
                                + "            WHEN TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD HH24MISS'), 'Q') - 3 = 0 \n"
                                + "            THEN SUBSTR(TO_CHAR(TO_DATE(TO_DATE('" + todate + "', 'YYYYMMDD HH24MISS')),'YYYY'),3,2) - 1 || 'Y ' || '4' || 'Q' \n"
                                + "            WHEN TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD HH24MISS'), 'Q') - 3 = -1 \n"
                                + "            THEN SUBSTR(TO_CHAR(TO_DATE(TO_DATE('" + todate + "', 'YYYYMMDD HH24MISS')),'YYYY'),3,2) - 1 || 'Y ' || '3' || 'Q' \n"
                                + "            WHEN TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD HH24MISS'), 'Q') - 3 = -2 \n"
                                + "            THEN SUBSTR(TO_CHAR(TO_DATE(TO_DATE('" + todate + "', 'YYYYMMDD HH24MISS')),'YYYY'),3,2) - 1 || 'Y ' || '2' || 'Q' \n"
                                + "       END AS Q4, \n"
                                + "       CASE WHEN TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD HH24MISS'), 'Q') - 2 > 0 \n"
                                + "            THEN SUBSTR(TO_CHAR(TO_DATE(TO_DATE('" + todate + "', 'YYYYMMDD HH24MISS')),'YYYY'),3,2) || 'Y ' || TO_CHAR(TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD HH24MISS'), 'Q') - 2)|| 'Q' \n"
                                + "            WHEN TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD HH24MISS'), 'Q') - 2 = 0 \n"
                                + "            THEN SUBSTR(TO_CHAR(TO_DATE(TO_DATE('" + todate + "', 'YYYYMMDD HH24MISS')),'YYYY'),3,2) - 1 || 'Y ' || '4' || 'Q' \n"
                                + "            WHEN TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD HH24MISS'), 'Q') - 2 = -1 \n"
                                + "            THEN SUBSTR(TO_CHAR(TO_DATE(TO_DATE('" + todate + "', 'YYYYMMDD HH24MISS')),'YYYY'),3,2) - 1 || 'Y ' || '3' || 'Q' \n"
                                + "       END AS Q3, \n"
                                + "       CASE WHEN TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD HH24MISS'), 'Q') - 1 > 0 \n"
                                + "            THEN SUBSTR(TO_CHAR(TO_DATE(TO_DATE('" + todate + "', 'YYYYMMDD HH24MISS')),'YYYY'),3,2) || 'Y ' || TO_CHAR(TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD HH24MISS'), 'Q') - 1)|| 'Q' \n"
                                + "            WHEN TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD HH24MISS'), 'Q') - 1 = 0 \n"
                                + "            THEN SUBSTR(TO_CHAR(TO_DATE(TO_DATE('" + todate + "', 'YYYYMMDD HH24MISS')),'YYYY'),3,2) - 1 || 'Y ' || '4' || 'Q' \n"
                                + "            END AS Q2, \n"
                                + "            SUBSTR(TO_CHAR(TO_DATE(TO_DATE('" + todate + "', 'YYYYMMDD HH24MISS')),'YYYY'),3,2) || 'Y ' || TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD HH24MISS'), 'Q') || 'Q' AS Q1 \n"
                                + "  FROM DUAL";

                        dtQuarter = CmnFunction.oComm.GetFuncDataTable("DYNAMIC", squery5.Replace((char)Keys.Tab, ' '));

                        squery = "SELECT SUBSTR(TO_CHAR(TO_DATE('" + todate + "'),'YYYYMM'),5,2)||'월' AS MM4 \n"
                               + "	   , SUBSTR(TO_CHAR(ADD_MONTHS(TO_DATE('" + todate + "'),-1),'YYYYMM'),5,2)||'월' AS MM3 \n"
                               + "	   , SUBSTR(TO_CHAR(ADD_MONTHS(TO_DATE('" + todate + "'),-2),'YYYYMM'),5,2)||'월' AS MM2 \n"
                               + "	   , SUBSTR(TO_CHAR(ADD_MONTHS(TO_DATE('" + todate + "'),-3),'YYYYMM'),5,2)||'월' AS MM1 \n"
                               + "  FROM DUAL";

                        dt = CmnFunction.oComm.GetFuncDataTable("DYNAMIC", squery.Replace((char)Keys.Tab, ' '));

                        todate = cdvDate.Value.ToString("yyyyMMdd");

                        squery2 = "SELECT DECODE(PLAN_WEEK - 3,-2,51,-1,52, 0,53, PLAN_WEEK - 3)||'주' AS WW1 \n"
                               + "      , DECODE(PLAN_WEEK - 2,-1,52, 0,53, PLAN_WEEK - 2)||'주' AS WW2 \n"
                               + "	    , DECODE(PLAN_WEEK - 1, 0,53, PLAN_WEEK - 1)||'주' AS WW3 \n"
                               + "	    , PLAN_WEEK||'주' AS WW4 \n"
                               + "	 FROM MWIPCALDEF \n"
                               + "	WHERE CALENDAR_ID = 'QC' \n"
                               + "	  AND SYS_DATE = TO_CHAR(TO_DATE('" + todate + "','YYYYMMDD'),'YYYYMMDD')";

                        dtWeek = CmnFunction.oComm.GetFuncDataTable("DYNAMIC", squery2.Replace((char)Keys.Tab, ' '));


                        squery3 = "SELECT CASE TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD') + 6, 'YYYYMMDD') \n"
                               + "        WHEN '토' THEN TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD') + 5, 'YYYYMMDD') \n"
                               + "        WHEN '일' THEN TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD') + 4, 'YYYYMMDD') \n"
                               + "        WHEN '월' THEN TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD') + 3, 'YYYYMMDD') \n"
                               + "        WHEN '화' THEN TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD') + 2, 'YYYYMMDD') \n"
                               + "        WHEN '수' THEN TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD') + 1, 'YYYYMMDD') \n"
                               + "        WHEN '목' THEN TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD') + 0, 'YYYYMMDD') \n"
                               + "        END AS DAY \n"
                               + "	 FROM DUAL";

                        dtThu = CmnFunction.oComm.GetFuncDataTable("DYNAMIC", squery3.Replace((char)Keys.Tab, ' '));

                        squery4 = "SELECT SUBSTR(TO_CHAR(TO_DATE('" + dtThu.Rows[0][0] + "'),'YYYYMMDD'),7,2)||'일(목)' AS DD \n"
                               + "      , SUBSTR(TO_CHAR(TO_DATE('" + dtThu.Rows[0][0] + "')-1,'YYYYMMDD'),7,2)||'일(수)' AS DD1 \n"
                               + "      , SUBSTR(TO_CHAR(TO_DATE('" + dtThu.Rows[0][0] + "')-2,'YYYYMMDD'),7,2)||'일(화)' AS DD2 \n"
                               + "      , SUBSTR(TO_CHAR(TO_DATE('" + dtThu.Rows[0][0] + "')-3,'YYYYMMDD'),7,2)||'일(월)' AS DD3 \n"
                               + "      , SUBSTR(TO_CHAR(TO_DATE('" + dtThu.Rows[0][0] + "')-4,'YYYYMMDD'),7,2)||'일(일)' AS DD4 \n"
                               + "      , SUBSTR(TO_CHAR(TO_DATE('" + dtThu.Rows[0][0] + "')-5,'YYYYMMDD'),7,2)||'일(토)' AS DD5 \n"
                               + "      , SUBSTR(TO_CHAR(TO_DATE('" + dtThu.Rows[0][0] + "')-6,'YYYYMMDD'),7,2)||'일(금)' AS DD6 \n"
                               + "	 FROM DUAL";
                        dtDay = CmnFunction.oComm.GetFuncDataTable("DYNAMIC", squery4.Replace((char)Keys.Tab, ' '));

                        if (dtQuarter.Rows.Count <= 0)
                        {
                            dtQuarter.Dispose();
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 3).Value = "QQ_1";
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 4).Value = "QQ_2";
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 5).Value = "QQ_3";
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 6).Value = "QQ_4";
                        }
                        else
                        {
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 3).Value = dtQuarter.Rows[0][0].ToString();
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 4).Value = dtQuarter.Rows[0][1].ToString();
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 5).Value = dtQuarter.Rows[0][2].ToString();
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 6).Value = dtQuarter.Rows[0][3].ToString();
                        }

                        if (dt.Rows.Count <= 0)
                        {
                            dt.Dispose();
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 7).Value = "MM_1";
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 8).Value = "MM_2";
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 9).Value = "MM_3";
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 10).Value = "MM_4";
                        }
                        else
                        {
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 7).Value = dt.Rows[0][3].ToString();
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 8).Value = dt.Rows[0][2].ToString();
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 9).Value = dt.Rows[0][1].ToString();
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 10).Value = dt.Rows[0][0].ToString();
                        }

                        if (dtWeek.Rows.Count <= 0)
                        {
                            dtWeek.Dispose();
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 11).Value = "WW_1";
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 12).Value = "WW_2";
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 13).Value = "WW_3";
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 14).Value = "WW_4";
                        }
                        else
                        {
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 11).Value = dtWeek.Rows[0][0].ToString();
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 12).Value = dtWeek.Rows[0][1].ToString();
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 13).Value = dtWeek.Rows[0][2].ToString();
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 14).Value = dtWeek.Rows[0][3].ToString();
                        }

                        if (dtDay.Rows.Count <= 0)
                        {
                            dtDay.Dispose();
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 15).Value = "금";
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 16).Value = "토";
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 17).Value = "일";
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 18).Value = "월";
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 19).Value = "화";
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 20).Value = "수";
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 21).Value = "목";
                        }
                        else
                        {
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 15).Value = dtDay.Rows[0][6].ToString();
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 16).Value = dtDay.Rows[0][5].ToString();
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 17).Value = dtDay.Rows[0][4].ToString();
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 18).Value = dtDay.Rows[0][3].ToString();
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 19).Value = dtDay.Rows[0][2].ToString();
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 20).Value = dtDay.Rows[0][1].ToString();
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 21).Value = dtDay.Rows[0][0].ToString();
                        }

                        break;

                    #endregion

                    #region - 일일 공정 품질 기상도

                    case 1:

                        todate = cdvDate.Value.ToString("yyyyMMddHHmmss");

                        squery5 = "SELECT CASE WHEN TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD HH24MISS'), 'Q') - 2 > 0 \n"
                                + "            THEN SUBSTR(TO_CHAR(TO_DATE(TO_DATE('" + todate + "', 'YYYYMMDD HH24MISS')),'YYYY'),3,2) || 'Y ' || TO_CHAR(TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD HH24MISS'), 'Q') - 2)|| 'Q' \n"
                                + "            WHEN TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD HH24MISS'), 'Q') - 2 = 0 \n"
                                + "            THEN SUBSTR(TO_CHAR(TO_DATE(TO_DATE('" + todate + "', 'YYYYMMDD HH24MISS')),'YYYY'),3,2) - 1 || 'Y ' || '4' || 'Q' \n"
                                + "            WHEN TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD HH24MISS'), 'Q') - 2 = -1 \n"
                                + "            THEN SUBSTR(TO_CHAR(TO_DATE(TO_DATE('" + todate + "', 'YYYYMMDD HH24MISS')),'YYYY'),3,2) - 1 || 'Y ' || '3' || 'Q' \n"
                                + "       END AS Q3, \n"
                                + "       CASE WHEN TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD HH24MISS'), 'Q') - 1 > 0 \n"
                                + "            THEN SUBSTR(TO_CHAR(TO_DATE(TO_DATE('" + todate + "', 'YYYYMMDD HH24MISS')),'YYYY'),3,2) || 'Y ' || TO_CHAR(TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD HH24MISS'), 'Q') - 1)|| 'Q' \n"
                                + "            WHEN TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD HH24MISS'), 'Q') - 1 = 0 \n"
                                + "            THEN SUBSTR(TO_CHAR(TO_DATE(TO_DATE('" + todate + "', 'YYYYMMDD HH24MISS')),'YYYY'),3,2) - 1 || 'Y ' || '4' || 'Q' \n"
                                + "            END AS Q2, \n"
                                + "            SUBSTR(TO_CHAR(TO_DATE(TO_DATE('" + todate + "', 'YYYYMMDD HH24MISS')),'YYYY'),3,2) || 'Y ' || TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD HH24MISS'), 'Q') || 'Q' AS Q1 \n"
                                + "  FROM DUAL";

                        dtQuarter = CmnFunction.oComm.GetFuncDataTable("DYNAMIC", squery5.Replace((char)Keys.Tab, ' '));

                        squery = "SELECT SUBSTR(TO_CHAR(TO_DATE('" + todate + "'),'YYYYMM'),5,2)||'월' AS MM1 \n"
                               + "  FROM DUAL";

                        dt = CmnFunction.oComm.GetFuncDataTable("DYNAMIC", squery.Replace((char)Keys.Tab, ' '));

                        if (dtQuarter.Rows.Count <= 0)
                        {
                            dtQuarter.Dispose();
                            this.spdData_Sheet1.Cells.Get(2, 2).Value = "QQ_1";
                            this.spdData_Sheet1.Cells.Get(2, 4).Value = "QQ_2";
                            this.spdData_Sheet1.Cells.Get(2, 6).Value = "QQ_3";
                            this.spdData_Sheet1.Cells.Get(2, 11).Value = "QQ_1";
                            this.spdData_Sheet1.Cells.Get(2, 13).Value = "QQ_2";
                            this.spdData_Sheet1.Cells.Get(2, 15).Value = "QQ_3";
                        }
                        else
                        {
                            this.spdData_Sheet1.Cells.Get(2, 2).Value = dtQuarter.Rows[0][0].ToString();
                            this.spdData_Sheet1.Cells.Get(2, 4).Value = dtQuarter.Rows[0][1].ToString();
                            this.spdData_Sheet1.Cells.Get(2, 6).Value = dtQuarter.Rows[0][2].ToString();
                            this.spdData_Sheet1.Cells.Get(2, 11).Value = dtQuarter.Rows[0][0].ToString();
                            this.spdData_Sheet1.Cells.Get(2, 13).Value = dtQuarter.Rows[0][1].ToString();
                            this.spdData_Sheet1.Cells.Get(2, 15).Value = dtQuarter.Rows[0][2].ToString();
                        }

                        if (dt.Rows.Count <= 0)
                        {
                            dt.Dispose();
                            this.spdData_Sheet1.Cells.Get(2, 8).Value = "MM_1";
                            this.spdData_Sheet1.Cells.Get(2, 17).Value = "MM_1";
                        }
                        else
                        {
                            this.spdData_Sheet1.Cells.Get(2, 8).Value = dt.Rows[0][0].ToString();
                            this.spdData_Sheet1.Cells.Get(2, 17).Value = dt.Rows[0][0].ToString();
                        }

                        break;

                    #endregion
                } 
            }
            catch (Exception ex)
            {
                LoadingPopUp.LoadingPopUpHidden();
                CmnFunction.ShowMsgBox(ex.Message);
                return;
            }
            finally
            {
                LoadingPopUp.LoadingPopUpHidden();
                Cursor.Current = Cursors.Default;
            }
        }

        private void InitSpreadSheet()
        {
            /****************************************************
             * Comment : SS의 Header 및 기본 데이터를 설정한다.
             * 
             * Created By : 김선호(2012-08-16-목요일)
             * 
             * Modified By :
             ****************************************************/
            try
            {
                Cursor.Current = Cursors.WaitCursor;

                this.spdData_Sheet1.Reset();
                this.spdData_Sheet1.ColumnCount = 0;
                this.spdData_Sheet1.RowCount = 0;

                switch (cboGraph.SelectedIndex)
                {
                    case 0:

                        #region - 공정 품질 기상도

                        FarPoint.Win.Spread.CellType.ImageCellType imageCellType = new FarPoint.Win.Spread.CellType.ImageCellType();

                        this.spdData_Sheet1.ReferenceStyle = FarPoint.Win.Spread.Model.ReferenceStyle.R1C1;
                        this.spdData_Sheet1.ColumnCount = 22;
                        this.spdData_Sheet1.ColumnHeader.RowCount = 2;

                        // 컬럼 헤더
                        this.spdData_Sheet1.ColumnHeader.Rows[0].Height = 30F;
                        this.spdData_Sheet1.ColumnHeader.Rows[1].Height = 30F;

                        this.spdData_Sheet1.ColumnHeader.Cells.Get(0, 0).ColumnSpan = 2;
                        this.spdData_Sheet1.ColumnHeader.Cells.Get(0, 0).RowSpan = 2;
                        this.spdData_Sheet1.ColumnHeader.Cells.Get(0, 0).Value = "구분";

                        this.spdData_Sheet1.ColumnHeader.Cells.Get(0, 2).RowSpan = 2;
                        this.spdData_Sheet1.ColumnHeader.Cells.Get(0, 2).Value = "goal";

                        this.spdData_Sheet1.ColumnHeader.Cells.Get(0, 3).ColumnSpan = 4;
                        this.spdData_Sheet1.ColumnHeader.Cells.Get(0, 3).Value = "분기";

                        this.spdData_Sheet1.ColumnHeader.Cells.Get(0, 7).ColumnSpan = 4;
                        this.spdData_Sheet1.ColumnHeader.Cells.Get(0, 7).Value = "월";

                        this.spdData_Sheet1.ColumnHeader.Cells.Get(0, 11).ColumnSpan = 4;
                        this.spdData_Sheet1.ColumnHeader.Cells.Get(0, 11).Value = "주";

                        this.spdData_Sheet1.ColumnHeader.Cells.Get(0, 15).ColumnSpan = 7;
                        this.spdData_Sheet1.ColumnHeader.Cells.Get(0, 15).Value = "일";

                        // 날짜 컬럼 헤더 설정
                        fnSSInitial();

                        this.spdData_Sheet1.RowCount = 9;

                        // 셀 설정
                        this.spdData_Sheet1.Cells.Get(0, 0).ColumnSpan = 2;
                        this.spdData_Sheet1.Cells.Get(0, 0).Value = "Process Quality Weather Map";
                        this.spdData_Sheet1.Cells.Get(0, 2).Value = "만족";
                        this.spdData_Sheet1.Cells.Get(0, 2).ForeColor = System.Drawing.Color.Blue;

                        this.spdData_Sheet1.Cells.Get(1, 0).RowSpan = 6;
                        this.spdData_Sheet1.Cells.Get(1, 0).Value = "QCN";
                        this.spdData_Sheet1.Cells.Get(1, 1).RowSpan = 2;
                        this.spdData_Sheet1.Cells.Get(1, 1).Value = "Total";
                        this.spdData_Sheet1.Cells.Get(1, 2).RowSpan = 2;
                        this.spdData_Sheet1.Cells.Get(1, 2).Value = "1.00 (%)";

                        this.spdData_Sheet1.Cells.Get(2, 0).Value = "QCN";
                        this.spdData_Sheet1.Cells.Get(2, 1).Value = "Total";
                        this.spdData_Sheet1.Cells.Get(2, 2).RowSpan = 2;
                        this.spdData_Sheet1.Cells.Get(2, 2).Value = "1.00 (%)";

                        this.spdData_Sheet1.Cells.Get(3, 0).Value = "QCN";
                        this.spdData_Sheet1.Cells.Get(3, 1).RowSpan = 2;
                        this.spdData_Sheet1.Cells.Get(3, 1).Value = "SEC";
                        this.spdData_Sheet1.Cells.Get(3, 2).RowSpan = 2;
                        this.spdData_Sheet1.Cells.Get(3, 2).Value = "1.00 (%)";

                        this.spdData_Sheet1.Cells.Get(4, 0).Value = "QCN";
                        this.spdData_Sheet1.Cells.Get(4, 1).Value = "SEC";
                        this.spdData_Sheet1.Cells.Get(4, 2).RowSpan = 2;
                        this.spdData_Sheet1.Cells.Get(4, 2).Value = "1.00 (%)";

                        this.spdData_Sheet1.Cells.Get(5, 0).Value = "QCN";
                        this.spdData_Sheet1.Cells.Get(5, 1).RowSpan = 2;
                        this.spdData_Sheet1.Cells.Get(5, 1).Value = "SK Hynix";
                        this.spdData_Sheet1.Cells.Get(5, 2).RowSpan = 2;
                        this.spdData_Sheet1.Cells.Get(5, 2).Value = "1.00 (%)";

                        this.spdData_Sheet1.Cells.Get(6, 0).Value = "QCN";
                        this.spdData_Sheet1.Cells.Get(6, 1).Value = "SK Hynix";
                        this.spdData_Sheet1.Cells.Get(6, 2).RowSpan = 2;
                        this.spdData_Sheet1.Cells.Get(6, 2).Value = "1.00 (%)";

                        this.spdData_Sheet1.Cells.Get(7, 0).RowSpan = 2;
                        this.spdData_Sheet1.Cells.Get(7, 0).Value = "CCN";

                        this.spdData_Sheet1.Cells.Get(7, 1).RowSpan = 2;
                        this.spdData_Sheet1.Cells.Get(7, 1).Value = "Total";
                        this.spdData_Sheet1.Cells.Get(7, 2).RowSpan = 2;
                        this.spdData_Sheet1.Cells.Get(7, 2).Value = "1.00 (%)";

                        this.spdData_Sheet1.Cells.Get(8, 0).Value = "CCN";
                        this.spdData_Sheet1.Cells.Get(8, 1).Value = "Total";
                        this.spdData_Sheet1.Cells.Get(8, 2).RowSpan = 2;
                        this.spdData_Sheet1.Cells.Get(8, 2).Value = "1.00 (%)";

                        // Alignment, Color설정
                        for (int irow = 0; irow < spdData_Sheet1.RowCount; irow++)
                        {
                            for (int icol = 0; icol < spdData_Sheet1.ColumnCount; icol++)
                            {
                                this.spdData_Sheet1.Cells[irow, icol].HorizontalAlignment = FarPoint.Win.Spread.CellHorizontalAlignment.Center;
                                this.spdData_Sheet1.Cells[irow, icol].VerticalAlignment = FarPoint.Win.Spread.CellVerticalAlignment.Center;

                                if (irow == 2 || irow == 4 || irow == 6 || irow == 8)
                                {
                                    if (icol >= 3)
                                    {
                                        this.spdData_Sheet1.Cells[irow, icol].CellType = imageCellType;
                                    }
                                }
                            }

                            switch (irow)
                            {
                                case 0:
                                    spdData_Sheet1.Rows[irow].BackColor = System.Drawing.Color.Yellow;
                                    break;

                                case 1:
                                case 2:
                                    spdData_Sheet1.Rows[irow].BackColor = System.Drawing.Color.DarkSeaGreen;
                                    break;

                                case 3:
                                case 4:
                                    spdData_Sheet1.Rows[irow].BackColor = System.Drawing.Color.SkyBlue;
                                    break;

                                case 5:
                                case 6:
                                    spdData_Sheet1.Rows[irow].BackColor = System.Drawing.Color.SandyBrown;
                                    break;

                                case 7:
                                case 8:
                                    spdData_Sheet1.Rows[irow].BackColor = System.Drawing.Color.Thistle;
                                    break;
                            }
                        }

                        this.spdData_Sheet1.Columns.Get(0).Font = new System.Drawing.Font("굴림", 9F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(129)));
                        this.spdData_Sheet1.Columns.Get(1).Font = new System.Drawing.Font("굴림", 9F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(129)));
                        this.spdData_Sheet1.Columns.Get(2).Font = new System.Drawing.Font("굴림", 9F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(129)));

                        // Cell 높이 설정
                        this.spdData_Sheet1.ColumnHeader.Rows.Get(0).Height = 19F;
                        this.spdData_Sheet1.ColumnHeader.Rows.Get(1).Height = 19F;
                        this.spdData_Sheet1.RowHeader.Columns.Default.Resizable = true;
                        this.spdData_Sheet1.Rows.Get(0).Height = 25F;
                        this.spdData_Sheet1.Rows.Get(1).Height = 25F;
                        this.spdData_Sheet1.Rows.Get(2).Height = 50F;
                        this.spdData_Sheet1.Rows.Get(3).Height = 25F;
                        this.spdData_Sheet1.Rows.Get(4).Height = 50F;
                        this.spdData_Sheet1.Rows.Get(5).Height = 25F;
                        this.spdData_Sheet1.Rows.Get(6).Height = 50F;
                        this.spdData_Sheet1.Rows.Get(7).Height = 25F;
                        this.spdData_Sheet1.Rows.Get(8).Height = 50F;

                        this.spdData_Sheet1.ReferenceStyle = FarPoint.Win.Spread.Model.ReferenceStyle.A1;

                        #endregion

                        break;

                    case 1:

                        #region - 일일 공정 품질 기상도

                        FarPoint.Win.Spread.CellType.TextCellType textCellType = new FarPoint.Win.Spread.CellType.TextCellType();
                        textCellType.Multiline = true;

                        this.spdData_Sheet1.ReferenceStyle = FarPoint.Win.Spread.Model.ReferenceStyle.R1C1;
                        this.spdData_Sheet1.ColumnCount = 19;
                        this.spdData_Sheet1.ColumnHeader.RowCount = 2;
                        this.spdData_Sheet1.RowCount = 16;

                        // Cell설정 - Align, Font, Color
                        for (int icol = 0; icol < spdData_Sheet1.ColumnCount; icol++)
                        {
                            for (int irow = 0; irow < spdData_Sheet1.RowCount; irow++)
                            {
                                this.spdData_Sheet1.Cells.Get(irow, icol).VerticalAlignment = FarPoint.Win.Spread.CellVerticalAlignment.Center;
                                this.spdData_Sheet1.Cells.Get(irow, icol).HorizontalAlignment = FarPoint.Win.Spread.CellHorizontalAlignment.Center;

                                if (icol == 8 || icol == 9 || icol == 17 || icol == 18)
                                {
                                    this.spdData_Sheet1.Cells.Get(irow, icol).BackColor = System.Drawing.Color.Honeydew;
                                }

                                if (icol == 0)
                                {
                                    this.spdData_Sheet1.Cells.Get(irow, icol).Font = new System.Drawing.Font("굴림", 9F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(129)));
                                }

                                if (irow == 2 || irow == 3)
                                {
                                    this.spdData_Sheet1.Cells.Get(irow, icol).BackColor = System.Drawing.Color.YellowGreen;
                                    this.spdData_Sheet1.Cells.Get(irow, icol).Font = new System.Drawing.Font("굴림", 9F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(129)));
                                }

                                if (irow == 14 || irow == 15)
                                {
                                    this.spdData_Sheet1.Cells.Get(irow, icol).BackColor = System.Drawing.Color.LightGoldenrodYellow;

                                    if (icol == 1 || icol == 10)
                                    {
                                        this.spdData_Sheet1.Cells.Get(irow, icol).Font = new System.Drawing.Font("굴림", 9F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(129)));
                                    }
                                }
                            }
                        }

                        // 품질 기상도 Cell 설정
                        this.spdData_Sheet1.Cells.Get(0, 0).BackColor = System.Drawing.Color.LightBlue;
                        this.spdData_Sheet1.Cells.Get(0, 0).Value = "Quality Index";
                        this.spdData_Sheet1.Cells.Get(0, 1).ColumnSpan = 3;
                        this.spdData_Sheet1.Cells.Get(0, 4).ColumnSpan = 4;
                        this.spdData_Sheet1.Cells.Get(0, 8).ColumnSpan = 2;
                        //this.spdData_Sheet1.Cells.Get(0, 8).BackColor = System.Drawing.Color.Honeydew;
                        this.spdData_Sheet1.Cells.Get(0, 10).ColumnSpan = 3;
                        this.spdData_Sheet1.Cells.Get(0, 13).ColumnSpan = 4;
                        this.spdData_Sheet1.Cells.Get(0, 17).ColumnSpan = 2;
                        //this.spdData_Sheet1.Cells.Get(0, 17).BackColor = System.Drawing.Color.Honeydew;

                        this.spdData_Sheet1.Cells.Get(1, 0).BackColor = System.Drawing.Color.LightBlue;
                        this.spdData_Sheet1.Cells.Get(1, 0).Value = "LRR / number";
                        this.spdData_Sheet1.Cells.Get(1, 1).ColumnSpan = 3;
                        this.spdData_Sheet1.Cells.Get(1, 4).ColumnSpan = 4;
                        this.spdData_Sheet1.Cells.Get(1, 8).ColumnSpan = 2;
                        //this.spdData_Sheet1.Cells.Get(1, 8).BackColor = System.Drawing.Color.Honeydew;
                        this.spdData_Sheet1.Cells.Get(1, 10).ColumnSpan = 3;
                        this.spdData_Sheet1.Cells.Get(1, 13).ColumnSpan = 4;
                        this.spdData_Sheet1.Cells.Get(1, 17).ColumnSpan = 2;
                        //this.spdData_Sheet1.Cells.Get(1, 17).BackColor = System.Drawing.Color.Honeydew;

                        this.spdData_Sheet1.Cells.Get(2, 0).RowSpan = 2;
                        this.spdData_Sheet1.Cells.Get(2, 0).Value = "Defect MODE / Process";

                        this.spdData_Sheet1.Cells.Get(2, 1).RowSpan = 2;
                        this.spdData_Sheet1.Cells.Get(2, 1).Value = "QCN";

                        this.spdData_Sheet1.Cells.Get(2, 2).ColumnSpan = 2;
                        this.spdData_Sheet1.Cells.Get(2, 2).Value = "QQ_1";
                    
                        this.spdData_Sheet1.Cells.Get(2, 4).ColumnSpan = 2;
                        this.spdData_Sheet1.Cells.Get(2, 4).Value = "QQ_2";

                        this.spdData_Sheet1.Cells.Get(2, 6).ColumnSpan = 2;
                        this.spdData_Sheet1.Cells.Get(2, 6).Value = "QQ_3";

                        this.spdData_Sheet1.Cells.Get(2, 8).ColumnSpan = 2;
                        this.spdData_Sheet1.Cells.Get(2, 8).Value = "MM_1";

                        this.spdData_Sheet1.Cells.Get(2, 10).RowSpan = 2;
                        this.spdData_Sheet1.Cells.Get(2, 10).Value = "CCN";
                        
                        this.spdData_Sheet1.Cells.Get(2, 11).ColumnSpan = 2;
                        this.spdData_Sheet1.Cells.Get(2, 11).Value = "QQ_1";

                        this.spdData_Sheet1.Cells.Get(2, 13).ColumnSpan = 2;
                        this.spdData_Sheet1.Cells.Get(2, 13).Value = "QQ_2";

                        this.spdData_Sheet1.Cells.Get(2, 15).ColumnSpan = 2;
                        this.spdData_Sheet1.Cells.Get(2, 15).Value = "QQ_3";

                        this.spdData_Sheet1.Cells.Get(2, 17).ColumnSpan = 2;
                        this.spdData_Sheet1.Cells.Get(2, 17).Value = "MM_1";

                        this.spdData_Sheet1.Cells.Get(3, 2).Value = "Number";
                        this.spdData_Sheet1.Cells.Get(3, 3).Value = "percentage";
                        this.spdData_Sheet1.Cells.Get(3, 4).Value = "Number";
                        this.spdData_Sheet1.Cells.Get(3, 5).Value = "percentage";
                        this.spdData_Sheet1.Cells.Get(3, 6).Value = "Number";
                        this.spdData_Sheet1.Cells.Get(3, 7).Value = "percentage";
                        this.spdData_Sheet1.Cells.Get(3, 8).Value = "Number";
                        this.spdData_Sheet1.Cells.Get(3, 9).Value = "percentage";
                        this.spdData_Sheet1.Cells.Get(3, 11).Value = "Number";
                        this.spdData_Sheet1.Cells.Get(3, 12).Value = "percentage";
                        this.spdData_Sheet1.Cells.Get(3, 13).Value = "Number";
                        this.spdData_Sheet1.Cells.Get(3, 14).Value = "percentage";
                        this.spdData_Sheet1.Cells.Get(3, 15).Value = "Number";
                        this.spdData_Sheet1.Cells.Get(3, 16).Value = "percentage";
                        this.spdData_Sheet1.Cells.Get(3, 17).Value = "Number";
                        this.spdData_Sheet1.Cells.Get(3, 18).Value = "percentage";

                        // 로우 헤더 설정.
                        this.spdData_Sheet1.Cells.Get(4, 0).RowSpan = 4;
                        this.spdData_Sheet1.Cells.Get(4, 0).CellType = textCellType;
                        this.spdData_Sheet1.Cells.Get(4, 0).ForeColor = System.Drawing.Color.Red;
                        this.spdData_Sheet1.Cells.Get(4, 0).Value = "Intensive Management Mode (TOP 4)";

                        this.spdData_Sheet1.Cells.Get(4, 0).BackColor = System.Drawing.Color.LightBlue;
                        this.spdData_Sheet1.Cells.Get(5, 0).BackColor = System.Drawing.Color.LightBlue;                        
                        this.spdData_Sheet1.Cells.Get(6, 0).BackColor = System.Drawing.Color.LightBlue;                        
                        this.spdData_Sheet1.Cells.Get(7, 0).BackColor = System.Drawing.Color.LightBlue;
                        this.spdData_Sheet1.Cells.Get(8, 0).BackColor = System.Drawing.Color.LightBlue;
                        this.spdData_Sheet1.Cells.Get(9, 0).BackColor = System.Drawing.Color.LightBlue;
                        this.spdData_Sheet1.Cells.Get(11, 0).BackColor = System.Drawing.Color.LightBlue;
                        this.spdData_Sheet1.Cells.Get(10, 0).BackColor = System.Drawing.Color.LightBlue;

                        this.spdData_Sheet1.Cells.Get(8, 0).RowSpan = 3;
                        this.spdData_Sheet1.Cells.Get(8, 0).CellType = textCellType;
                        this.spdData_Sheet1.Cells.Get(8, 0).ForeColor = System.Drawing.Color.DarkGoldenrod;
                        this.spdData_Sheet1.Cells.Get(8, 0).Value = "Object of interest MODE (TOP 3)";

                        this.spdData_Sheet1.Cells.Get(11, 0).RowSpan = 3;
                        this.spdData_Sheet1.Cells.Get(11, 0).CellType = textCellType;
                        this.spdData_Sheet1.Cells.Get(11, 0).ForeColor = System.Drawing.Color.Blue;
                        this.spdData_Sheet1.Cells.Get(11, 0).Value = "Process Generation Rate(TOP 3)";

                        this.spdData_Sheet1.Cells.Get(14, 0).RowSpan = 2;
                        this.spdData_Sheet1.Cells.Get(14, 0).CellType = textCellType;
                        this.spdData_Sheet1.Cells.Get(14, 0).ForeColor = System.Drawing.Color.BlueViolet;
                        this.spdData_Sheet1.Cells.Get(14, 0).Value = "TOTAL";
                        
                        //this.spdData_Sheet1.Cells.Get(14, 1).Value = "TOTAL";

                        //this.spdData_Sheet1.Cells.Get(15, 1).Value = "Monthly average";


                        // 컬럼 헤더 설정
                        for (int icol = 0; icol < spdData_Sheet1.ColumnCount; icol++)
                        {
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(0, icol).Font = new System.Drawing.Font("굴림", 9F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(129)));
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, icol).Font = new System.Drawing.Font("굴림", 9F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(129)));

                            this.spdData_Sheet1.ColumnHeader.Cells.Get(0, icol).VerticalAlignment = FarPoint.Win.Spread.CellVerticalAlignment.Center;
                            this.spdData_Sheet1.ColumnHeader.Cells.Get(1, icol).HorizontalAlignment = FarPoint.Win.Spread.CellHorizontalAlignment.Center;
                        }

                        this.spdData_Sheet1.ColumnHeader.Cells.Get(0, 0).RowSpan = 2;
                        this.spdData_Sheet1.ColumnHeader.Cells.Get(0, 0).Column.Width = 110F;

                        this.spdData_Sheet1.ColumnHeader.Cells.Get(0, 0).Value = "Quality weather map";
                        
                        this.spdData_Sheet1.ColumnHeader.Cells.Get(0, 1).ColumnSpan = 9;                       
                        this.spdData_Sheet1.ColumnHeader.Cells.Get(0, 1).Value = "QCN Indices";

                        this.spdData_Sheet1.ColumnHeader.Cells.Get(0, 10).ColumnSpan = 9;
                        this.spdData_Sheet1.ColumnHeader.Cells.Get(0, 10).Value = "CCN Index";

                        this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 0).Value = "구분";
                        this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 1).ColumnSpan = 3;
                        this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 1).Value = "Yesterday LRR";

                        this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 4).ColumnSpan = 4;
                        this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 4).Value = "Today's LRR";

                        this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 8).ColumnSpan = 2;
                        this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 8).Value = "결과";

                        this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 10).ColumnSpan = 3;
                        this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 10).Value = "Yesterday LRR";

                        this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 13).ColumnSpan = 4;
                        this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 13).Value = "Today's LRR";

                        this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 17).ColumnSpan = 2;
                        this.spdData_Sheet1.ColumnHeader.Cells.Get(1, 17).Value = "결과";                        

                        // 높이 설정

                        this.spdData_Sheet1.ColumnHeader.Rows[0].Height = 30F;
                        this.spdData_Sheet1.ColumnHeader.Rows[1].Height = 30F;

                        for (int irow = 0; irow < 14; irow++)
                        {
                            this.spdData_Sheet1.Rows.Get(irow).Height = 30F;
                        }

                        fnSSInitial();

                        this.spdData_Sheet1.VerticalGridLine = new FarPoint.Win.Spread.GridLine(FarPoint.Win.Spread.GridLineType.Flat, System.Drawing.Color.Black);
                        this.spdData_Sheet1.HorizontalGridLine = new FarPoint.Win.Spread.GridLine(FarPoint.Win.Spread.GridLineType.Flat, System.Drawing.Color.Black);
                        this.spdData_Sheet1.RowHeader.Columns.Default.Resizable = true;
                        this.spdData_Sheet1.ReferenceStyle = FarPoint.Win.Spread.Model.ReferenceStyle.A1;

                        #endregion

                        break;
                }
            }
            catch (Exception ex)
            {
                MessageBox.Show(ex.Message);
                return;
            }
            finally
            {
                Cursor.Current = Cursors.Default;
            }
        }

        private bool fnDataFind()
        {
            /****************************************************
             * Comment : DataBase에 저장된 데이터를 조회한다.
             * 
             * Created By : 김선호(2012-08-14-화요일)
             * 
             * Modified By :
             ****************************************************/
            DataTable dt = null;
            DataTable dt1 = null;
            DataTable dt2 = null;
            string QRY = "";

            try
            {
                Cursor.Current = Cursors.WaitCursor;
                LoadingPopUp.LoadIngPopUpShow(this);

                // Sheet / Listview를 초기화 한다.
                //CmnInitFunction.ClearList(spdData, true);

                switch (cboGraph.SelectedIndex)
                {
                    case 0:
                        QRY = MakeSqlString();

                        dt = CmnFunction.oComm.GetFuncDataTable("DYNAMIC", QRY);

                        if (dt.Rows.Count == 0)
                        {
                            dt.Dispose();
                            LoadingPopUp.LoadingPopUpHidden();
                            CmnFunction.ShowMsgBox(RptMessages.GetMessage("STD010", GlobalVariable.gcLanguage));
                            return false;
                        }

                        MakeSheetData(dt);
                        break;

                    case 1:

                        QRY = MakeSqlString1();

                        dt = CmnFunction.oComm.GetFuncDataTable("DYNAMIC", QRY);

                        if (dt.Rows.Count == 0)
                        {
                            dt.Dispose();
                            LoadingPopUp.LoadingPopUpHidden();
                            CmnFunction.ShowMsgBox(RptMessages.GetMessage("STD010", GlobalVariable.gcLanguage));
                            return false;
                        }

                        MakeSheetData1(dt);

                        QRY = MakeSqlString2();

                        dt1 = CmnFunction.oComm.GetFuncDataTable("DYNAMIC", QRY);

                        if (dt1.Rows.Count == 0)
                        {
                            dt1.Dispose();
                            LoadingPopUp.LoadingPopUpHidden();
                            CmnFunction.ShowMsgBox(RptMessages.GetMessage("STD010", GlobalVariable.gcLanguage));
                            return false;
                        }

                        MakeSheetData2(dt1, 1);

                        QRY = MakeSqlString3();

                        dt2 = CmnFunction.oComm.GetFuncDataTable("DYNAMIC", QRY);

                        if (dt2.Rows.Count == 0)
                        {
                            dt2.Dispose();
                            LoadingPopUp.LoadingPopUpHidden();
                            CmnFunction.ShowMsgBox(RptMessages.GetMessage("STD010", GlobalVariable.gcLanguage));
                            return false;
                        }

                        MakeSheetData2(dt2, 10);
                        break;
                }
                return true;
            }
            catch (Exception ex)
            {
                LoadingPopUp.LoadingPopUpHidden();
                MessageBox.Show(ex.Message);
                return false;
            }
            finally
            {
                LoadingPopUp.LoadingPopUpHidden();
                Cursor.Current = Cursors.Default;
            }
        }

        private string MakeSqlString()
        {
            /****************************************************
             * Comment : DataBase에 저장된 데이터를 조회한다.(공정 품질 기상도)
             * 
             * Created By : 김선호(2012-08-14-화요일)
             * 
             * Modified By :
             ****************************************************/

            string QRY = "";

            string date = cdvDate.Value.ToString("yyyyMMddHHmmss");

            QRY = "	SELECT *	\n "
                + "	FROM(	\n "
                + "	    SELECT 'QCN' AS GUBUN	\n "
                + "	        , CUSTOMER	\n "
                + "	        , '1.00 (%)' AS GOAL	\n "
                + "	        , SUM(QTY_QQ_1) AS QTY_QQ_1	\n "
                + "	        , SUM(QTY_QQ_2) AS QTY_QQ_2	\n "
                + "	        , SUM(QTY_QQ_3) AS QTY_QQ_3	\n "
                + "	        , SUM(QTY_QQ_4) AS QTY_QQ_4	\n "
                + "	        , SUM(QTY_MM_1) AS QTY_MM_1	\n "
                + "	        , SUM(QTY_MM_2) AS QTY_MM_2	\n "
                + "	        , SUM(QTY_MM_3) AS QTY_MM_3	\n "
                + "	        , SUM(QTY_MM_4) AS QTY_MM_4	\n "
                + "	        , SUM(QTY_WW_1) AS QTY_WW_1	\n "
                + "	        , SUM(QTY_WW_2) AS QTY_WW_2	\n "
                + "	        , SUM(QTY_WW_3) AS QTY_WW_3	\n "
                + "	        , SUM(QTY_WW_4) AS QTY_WW_4	\n "
                + "	        , SUM(QTY_DD_1) AS QTY_DD_1	\n "
                + "	        , SUM(QTY_DD_2) AS QTY_DD_2	\n "
                + "	        , SUM(QTY_DD_3) AS QTY_DD_3	\n "
                + "	        , SUM(QTY_DD_4) AS QTY_DD_4	\n "
                + "	        , SUM(QTY_DD_5) AS QTY_DD_5	\n "
                + "	        , SUM(QTY_DD_6) AS QTY_DD_6	\n "
                + "	        , SUM(QTY_DD_7) AS QTY_DD_7	\n "
                + "	    FROM	\n "
                + "	    (	\n "
                + "	        SELECT A.CUSTOMER AS CUSTOMER	\n "
                + "	            , CASE WHEN A.QTY_QQ_1 > 0 AND B.LOT_QTY_QQ_1 > 0 THEN ROUND(A.QTY_QQ_1 / B.LOT_QTY_QQ_1 * 100, 2) ELSE 0 END AS QTY_QQ_1	\n "
                + "	            , CASE WHEN A.QTY_QQ_2 > 0 AND B.LOT_QTY_QQ_2 > 0 THEN ROUND(A.QTY_QQ_2 / B.LOT_QTY_QQ_2 * 100, 2) ELSE 0 END AS QTY_QQ_2	\n "
                + "	            , CASE WHEN A.QTY_QQ_3 > 0 AND B.LOT_QTY_QQ_3 > 0 THEN ROUND(A.QTY_QQ_3 / B.LOT_QTY_QQ_3 * 100, 2) ELSE 0 END AS QTY_QQ_3	\n "
                + "	            , CASE WHEN A.QTY_QQ_4 > 0 AND B.LOT_QTY_QQ_4 > 0 THEN ROUND(A.QTY_QQ_4 / B.LOT_QTY_QQ_4 * 100, 2) ELSE 0 END AS QTY_QQ_4	\n "
                + "	            , 0 AS QTY_MM_1	\n "
                + "	            , 0 AS QTY_MM_2	\n "
                + "	            , 0 AS QTY_MM_3	\n "
                + "	            , 0 AS QTY_MM_4	\n "
                + "	            , 0 AS QTY_WW_1	\n "
                + "	            , 0 AS QTY_WW_2	\n "
                + "	            , 0 AS QTY_WW_3	\n "
                + "	            , 0 AS QTY_WW_4	\n "
                + "	            , 0 AS QTY_DD_1	\n "
                + "	            , 0 AS QTY_DD_2	\n "
                + "	            , 0 AS QTY_DD_3	\n "
                + "	            , 0 AS QTY_DD_4	\n "
                + "	            , 0 AS QTY_DD_5	\n "
                + "	            , 0 AS QTY_DD_6	\n "
                + "	            , 0 AS QTY_DD_7	\n "
                + "	        FROM(	\n "
                + "	            SELECT 'TOTAL' AS CUSTOMER	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                        WHEN '4' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                        WHEN '3' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                        WHEN '2' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                        WHEN '1' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                      END) AS QTY_QQ_1	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                        WHEN '4' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                        WHEN '3' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                        WHEN '2' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                        WHEN '1' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                      END) AS QTY_QQ_2	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                        WHEN '4' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                        WHEN '3' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                        WHEN '2' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                        WHEN '1' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                      END) AS QTY_QQ_3	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                        WHEN '4' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                        WHEN '3' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                        WHEN '2' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                        WHEN '1' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                      END) AS QTY_QQ_4	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n "
                + "	            WHERE 1=1 	\n "
                + "	            AND SUBSTR(STS.ABR_NO,1,3) = 'QCN'	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.FACTORY = MAT.FACTORY 	\n "
                + "	            AND STS.MAT_ID = MAT.MAT_ID 	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -13)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n "
                + "	            AND STS.DEFECT_CODE LIKE '%'	\n "
                + "	            AND STS.CUR_STEP LIKE '%'	\n "
                + "	            AND STS.OPER_1 >= 'A0000'	\n "
                + "	            AND STS.OPER_1 <= 'AZ010'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT CASE STS.CUS_ID WHEN 'SE' THEN 'SEC'	\n "
                + "	                                   WHEN 'HX' THEN 'SK Hynix'	\n "
                + "	                   END AS CUSTOMER	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                        WHEN '4' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                        WHEN '3' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                        WHEN '2' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                        WHEN '1' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                      END) AS QTY_QQ_1	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                        WHEN '4' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                        WHEN '3' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                        WHEN '2' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                        WHEN '1' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                      END) AS QTY_QQ_2	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                        WHEN '4' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                        WHEN '3' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                        WHEN '2' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                        WHEN '1' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                      END) AS QTY_QQ_3	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                        WHEN '4' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                        WHEN '3' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                        WHEN '2' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                        WHEN '1' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                      END) AS QTY_QQ_4	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n "
                + "	            WHERE 1=1 	\n "
                + "	            AND SUBSTR(STS.ABR_NO,1,3) = 'QCN'	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.FACTORY = MAT.FACTORY 	\n "
                + "	            AND STS.MAT_ID = MAT.MAT_ID 	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -13)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n "
                + "	            AND STS.DEFECT_CODE LIKE '%'	\n "
                + "	            AND STS.CUR_STEP LIKE '%'	\n "
                + "	            AND STS.OPER_1 >= 'A0000'	\n "
                + "	            AND STS.OPER_1 <= 'AZ010'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            GROUP BY CASE STS.CUS_ID WHEN 'SE' THEN 'SEC'	\n "
                + "	                                   WHEN 'HX' THEN 'SK Hynix'	\n "
                + "	                     END	\n "
                + "	        ) A,	\n "
                + "	        (	\n "
                + "	            SELECT 'TOTAL' AS CUSTOMER 	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'04'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'04', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS LOT_QTY_QQ_1	\n "
                + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS LOT_QTY_QQ_2	\n "
                + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS LOT_QTY_QQ_3	\n "
                + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'10'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'10', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS LOT_QTY_QQ_4	\n "
                + "	            FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n "
                + "	            WHERE A.FACTORY = B.FACTORY  	\n "
                + "	            AND A.MAT_ID = B.MAT_ID  	\n "
                + "	            AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n "
                + "	            AND A.WORK_MONTH >= TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -11), 'YYYYMM') 	\n "
                + "	            AND A.WORK_MONTH <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMM')	\n "
                + "	            AND A.QC_OPER IN ('PVI','QC GATE')    	\n "
                + "	            AND A.QC_TYPE LIKE 'GATE' || '%'  	\n "
                + "	            AND B.MAT_GRP_1 LIKE '%'	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC'	\n "
                + "	                                    WHEN 'HX' THEN 'SK Hynix'	\n "
                + "	                   END AS CUSTOMER 	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'04'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'04', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS LOT_QTY_QQ_1	\n "
                + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS LOT_QTY_QQ_2	\n "
                + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS LOT_QTY_QQ_3	\n "
                + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'10'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'10', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS LOT_QTY_QQ_4	\n "
                + "	            FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n "
                + "	            WHERE A.FACTORY = B.FACTORY  	\n "
                + "	            AND A.MAT_ID = B.MAT_ID  	\n "
                + "	            AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n "
                + "	            AND A.WORK_MONTH >= TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -11), 'YYYYMM') 	\n "
                + "	            AND A.WORK_MONTH <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMM')	\n "
                + "	            AND A.QC_OPER IN ('PVI','QC GATE')    	\n "
                + "	            AND A.QC_TYPE LIKE 'GATE' || '%'  	\n "
                + "	            AND B.MAT_GRP_1 LIKE '%'	\n "
                + "	            GROUP BY CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC'	\n "
                + "	                                      WHEN 'HX' THEN 'SK Hynix'	\n "
                + "	                     END	\n "
                + "	        ) B	\n "
                + "	        WHERE A.CUSTOMER = B.CUSTOMER	\n "
                + "	        UNION ALL	\n "
                + "	        SELECT A.CUSTOMER AS CUSTOMER	\n "
                + "	            , 0 AS QTY_QQ_1	\n "
                + "	            , 0 AS QTY_QQ_2	\n "
                + "	            , 0 AS QTY_QQ_3	\n "
                + "	            , 0 AS QTY_QQ_4	\n "
                + "	            , CASE WHEN A.QTY_MM_1 > 0 AND B.LOT_QTY_MM_1 > 0 THEN ROUND(A.QTY_MM_1 / B.LOT_QTY_MM_1 * 100, 2) ELSE 0 END AS QTY_MM_1	\n "
                + "	            , CASE WHEN A.QTY_MM_2 > 0 AND B.LOT_QTY_MM_2 > 0 THEN ROUND(A.QTY_MM_2 / B.LOT_QTY_MM_2 * 100, 2) ELSE 0 END AS QTY_MM_2	\n "
                + "	            , CASE WHEN A.QTY_MM_3 > 0 AND B.LOT_QTY_MM_3 > 0 THEN ROUND(A.QTY_MM_3 / B.LOT_QTY_MM_3 * 100, 2) ELSE 0 END AS QTY_MM_3	\n "
                + "	            , CASE WHEN A.QTY_MM_4 > 0 AND B.LOT_QTY_MM_4 > 0 THEN ROUND(A.QTY_MM_4 / B.LOT_QTY_MM_4 * 100, 2) ELSE 0 END AS QTY_MM_4	\n "
                + "	            , 0 AS QTY_WW_1	\n "
                + "	            , 0 AS QTY_WW_2	\n "
                + "	            , 0 AS QTY_WW_3	\n "
                + "	            , 0 AS QTY_WW_4	\n "
                + "	            , 0 AS QTY_DD_1	\n "
                + "	            , 0 AS QTY_DD_2	\n "
                + "	            , 0 AS QTY_DD_3	\n "
                + "	            , 0 AS QTY_DD_4	\n "
                + "	            , 0 AS QTY_DD_5	\n "
                + "	            , 0 AS QTY_DD_6	\n "
                + "	            , 0 AS QTY_DD_7	\n "
                + "	        FROM(	\n "
                + "	            SELECT 'TOTAL' AS CUSTOMER	\n "
                + "	                ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n "
                + "	                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n "
                + "	                            THEN 1	\n "
                + "	                            ELSE 0	\n "
                + "	                     END) AS QTY_MM_1	\n "
                + "	                ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n "
                + "	                            THEN 1	\n "
                + "	                            ELSE 0	\n "
                + "	                     END) AS QTY_MM_2	\n "
                + "	                ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n "
                + "	                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n "
                + "	                            THEN 1	\n "
                + "	                            ELSE 0	\n "
                + "	                     END) AS QTY_MM_3	\n "
                + "	                ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n "
                + "	                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 0)), 'YYYYMMDD')||'220000'	\n "
                + "	                            THEN 1	\n "
                + "	                            ELSE 0	\n "
                + "	                     END) AS QTY_MM_4	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n "
                + "	            WHERE 1=1 	\n "
                + "	            AND SUBSTR(STS.ABR_NO,1,3) = 'QCN'	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.FACTORY = MAT.FACTORY 	\n "
                + "	            AND STS.MAT_ID = MAT.MAT_ID 	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n "
                + "	            AND STS.DEFECT_CODE LIKE '%'	\n "
                + "	            AND STS.CUR_STEP LIKE '%'	\n "
                + "	            AND STS.OPER_1 >= 'A0000'	\n "
                + "	            AND STS.OPER_1 <= 'AZ010'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT CASE STS.CUS_ID WHEN 'SE' THEN 'SEC'	\n "
                + "	                                   WHEN 'HX' THEN 'SK Hynix'	\n "
                + "	                   END AS CUSTOMER	\n "
                + "	                ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n "
                + "	                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n "
                + "	                            THEN 1	\n "
                + "	                            ELSE 0	\n "
                + "	                     END) AS QTY_MM_1	\n "
                + "	                ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n "
                + "	                            THEN 1	\n "
                + "	                            ELSE 0	\n "
                + "	                     END) AS QTY_MM_2	\n "
                + "	                ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n "
                + "	                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n "
                + "	                            THEN 1	\n "
                + "	                            ELSE 0	\n "
                + "	                     END) AS QTY_MM_3	\n "
                + "	                ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n "
                + "	                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 0)), 'YYYYMMDD')||'220000'	\n "
                + "	                            THEN 1	\n "
                + "	                            ELSE 0	\n "
                + "	                     END) AS QTY_MM_4	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n "
                + "	            WHERE 1=1 	\n "
                + "	            AND SUBSTR(STS.ABR_NO,1,3) = 'QCN'	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.FACTORY = MAT.FACTORY 	\n "
                + "	            AND STS.MAT_ID = MAT.MAT_ID 	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n "
                + "	            AND STS.DEFECT_CODE LIKE '%'	\n "
                + "	            AND STS.CUR_STEP LIKE '%'	\n "
                + "	            AND STS.OPER_1 >= 'A0000'	\n "
                + "	            AND STS.OPER_1 <= 'AZ010'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            GROUP BY CASE STS.CUS_ID WHEN 'SE' THEN 'SEC'	\n "
                + "	                                   WHEN 'HX' THEN 'SK Hynix'	\n "
                + "	                     END	\n "
                + "	        ) A,	\n "
                + "	        (	\n "
                + "	            SELECT 'TOTAL' AS CUSTOMER 	\n "
                + "	                , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_1	\n "
                + "	                , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_2	\n "
                + "	                , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_3	\n "
                + "	                , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_4	\n "
                + "	            FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n "
                + "	            WHERE A.FACTORY = B.FACTORY  	\n "
                + "	            AND A.MAT_ID = B.MAT_ID  	\n "
                + "	            AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n "
                + "	            AND A.WORK_MONTH >= TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4), 'YYYYMM') 	\n "
                + "	            AND A.WORK_MONTH <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMM')	\n "
                + "	            AND A.QC_OPER IN ('PVI','QC GATE')    	\n "
                + "	            AND A.QC_TYPE LIKE 'GATE' || '%'  	\n "
                + "	            AND B.MAT_GRP_1 LIKE '%'	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC'	\n "
                + "	                                    WHEN 'HX' THEN 'SK Hynix'	\n "
                + "	                   END AS CUSTOMER 	\n "
                + "	                , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_1	\n "
                + "	                , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_2	\n "
                + "	                , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_3	\n "
                + "	                , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_4	\n "
                + "	            FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n "
                + "	            WHERE A.FACTORY = B.FACTORY  	\n "
                + "	            AND A.MAT_ID = B.MAT_ID  	\n "
                + "	            AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n "
                + "	            AND A.WORK_MONTH >= TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4), 'YYYYMM') 	\n "
                + "	            AND A.WORK_MONTH <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMM')	\n "
                + "	            AND A.QC_OPER IN ('PVI','QC GATE')    	\n "
                + "	            AND A.QC_TYPE LIKE 'GATE' || '%'  	\n "
                + "	            AND B.MAT_GRP_1 LIKE '%'	\n "
                + "	            GROUP BY CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC'	\n "
                + "	                                      WHEN 'HX' THEN 'SK Hynix'	\n "
                + "	                     END	\n "
                + "	        ) B	\n "
                + "	        WHERE A.CUSTOMER = B.CUSTOMER	\n "
                + "	        UNION ALL	\n "
                + "	        SELECT A.CUSTOMER AS CUSTOMER	\n "
                + "	            , 0 AS QTY_QQ_1	\n "
                + "	            , 0 AS QTY_QQ_2	\n "
                + "	            , 0 AS QTY_QQ_3	\n "
                + "	            , 0 AS QTY_QQ_4	\n "
                + "	            , 0 AS QTY_MM_1	\n "
                + "	            , 0 AS QTY_MM_2	\n "
                + "	            , 0 AS QTY_MM_3	\n "
                + "	            , 0 AS QTY_MM_4	\n "
                + "	            , CASE WHEN A.QTY_WW_1 > 0 AND B.LOT_QTY_WW_1 > 0 THEN ROUND(A.QTY_WW_1 / B.LOT_QTY_WW_1 * 100, 2) ELSE 0 END AS QTY_WW_1	\n "
                + "	            , CASE WHEN A.QTY_WW_2 > 0 AND B.LOT_QTY_WW_2 > 0 THEN ROUND(A.QTY_WW_2 / B.LOT_QTY_WW_2 * 100, 2) ELSE 0 END AS QTY_WW_2	\n "
                + "	            , CASE WHEN A.QTY_WW_3 > 0 AND B.LOT_QTY_WW_3 > 0 THEN ROUND(A.QTY_WW_3 / B.LOT_QTY_WW_3 * 100, 2) ELSE 0 END AS QTY_WW_3	\n "
                + "	            , CASE WHEN A.QTY_WW_4 > 0 AND B.LOT_QTY_WW_4 > 0 THEN ROUND(A.QTY_WW_4 / B.LOT_QTY_WW_4 * 100, 2) ELSE 0 END AS QTY_WW_4	\n "
                + "	            , 0 AS QTY_DD_1	\n "
                + "	            , 0 AS QTY_DD_2	\n "
                + "	            , 0 AS QTY_DD_3	\n "
                + "	            , 0 AS QTY_DD_4	\n "
                + "	            , 0 AS QTY_DD_5	\n "
                + "	            , 0 AS QTY_DD_6	\n "
                + "	            , 0 AS QTY_DD_7	\n "
                + "	        FROM(	\n "
                + "	            SELECT 'TOTAL' AS CUSTOMER	\n "
                + "	                , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 28, 'YYYYMMDD')||'220000' 	\n "
                + "	                                               END	\n "
                + "	                            AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')||'220000'	\n "
                + "	                                                                          WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')||'220000'	\n "
                + "	                                                                          WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                          WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                          WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                          WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                          WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')||'220000' 	\n "
                + "	                                               END THEN 1 ELSE 0 END) AS QTY_WW_1	\n "
                + "	                , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')||'220000' 	\n "
                + "	                                               END	\n "
                + "	                            AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')||'220000'   	\n "
                + "	                                                                          WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')||'220000'   	\n "
                + "	                                                                          WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')||'220000'  	\n "
                + "	                                                                          WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')||'220000'  	\n "
                + "	                                                                          WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')||'220000'  	\n "
                + "	                                                                          WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')||'220000'  	\n "
                + "	                                                                          WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')||'220000'  	\n "
                + "	                                               END THEN 1 ELSE 0 END) AS QTY_WW_2	\n "
                + "	                , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')||'220000'  	\n "
                + "	                                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')||'220000'  	\n "
                + "	                                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')||'220000'  	\n "
                + "	                                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')||'220000'  	\n "
                + "	                                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')||'220000'  	\n "
                + "	                                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')||'220000'  	\n "
                + "	                                               END	\n "
                + "	                            AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                          WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                          WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                          WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                          WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                          WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                          WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000' 	\n "
                + "	                                               END THEN 1 ELSE 0 END) AS QTY_WW_3	\n "
                + "	                , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000' 	\n "
                + "	                                               END	\n "
                + "	                            AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 6, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                          WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 5, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                          WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 4, 'YYYYMMDD')||'220000'	\n "
                + "	                                                                          WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 3, 'YYYYMMDD')||'220000'	\n "
                + "	                                                                          WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 2, 'YYYYMMDD')||'220000'	\n "
                + "	                                                                          WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 1, 'YYYYMMDD')||'220000'	\n "
                + "	                                                                          WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 0, 'YYYYMMDD')||'220000'	\n "
                + "	                                               END THEN 1 ELSE 0 END) AS QTY_WW_4 	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n "
                + "	            WHERE 1=1 	\n "
                + "	            AND SUBSTR(STS.ABR_NO,1,3) = 'QCN'	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.FACTORY = MAT.FACTORY 	\n "
                + "	            AND STS.MAT_ID = MAT.MAT_ID	\n "
                + "	            AND STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')||'220000'	\n "
                + "	                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')||'220000'	\n "
                + "	                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 28, 'YYYYMMDD')||'220000'	\n "
                + "	                                                   END 	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n "
                + "	            AND STS.DEFECT_CODE LIKE '%'	\n "
                + "	            AND STS.CUR_STEP LIKE '%'	\n "
                + "	            AND STS.OPER_1 >= 'A0000'	\n "
                + "	            AND STS.OPER_1 <= 'AZ010'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT CASE STS.CUS_ID WHEN 'SE' THEN 'SEC'	\n "
                + "	                                   WHEN 'HX' THEN 'SK Hynix'	\n "
                + "	                   END AS CUSTOMER	\n "
                + "	                , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 28, 'YYYYMMDD')||'220000' 	\n "
                + "	                                               END	\n "
                + "	                            AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')||'220000'	\n "
                + "	                                                                          WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')||'220000'	\n "
                + "	                                                                          WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                          WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                          WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                          WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                          WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')||'220000' 	\n "
                + "	                                               END THEN 1 ELSE 0 END) AS QTY_WW_1	\n "
                + "	                , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')||'220000' 	\n "
                + "	                                               END	\n "
                + "	                            AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')||'220000'   	\n "
                + "	                                                                          WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')||'220000'   	\n "
                + "	                                                                          WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')||'220000'  	\n "
                + "	                                                                          WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')||'220000'  	\n "
                + "	                                                                          WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')||'220000'  	\n "
                + "	                                                                          WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')||'220000'  	\n "
                + "	                                                                          WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')||'220000'  	\n "
                + "	                                               END THEN 1 ELSE 0 END) AS QTY_WW_2	\n "
                + "	                , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')||'220000'  	\n "
                + "	                                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')||'220000'  	\n "
                + "	                                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')||'220000'  	\n "
                + "	                                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')||'220000'  	\n "
                + "	                                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')||'220000'  	\n "
                + "	                                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')||'220000'  	\n "
                + "	                                               END	\n "
                + "	                            AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                          WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                          WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                          WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                          WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                          WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                          WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000' 	\n "
                + "	                                               END THEN 1 ELSE 0 END) AS QTY_WW_3	\n "
                + "	                , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000' 	\n "
                + "	                                               END	\n "
                + "	                            AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 6, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                          WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 5, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                          WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 4, 'YYYYMMDD')||'220000'	\n "
                + "	                                                                          WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 3, 'YYYYMMDD')||'220000'	\n "
                + "	                                                                          WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 2, 'YYYYMMDD')||'220000'	\n "
                + "	                                                                          WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 1, 'YYYYMMDD')||'220000'	\n "
                + "	                                                                          WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 0, 'YYYYMMDD')||'220000'	\n "
                + "	                                               END THEN 1 ELSE 0 END) AS QTY_WW_4	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n "
                + "	            WHERE 1=1 	\n "
                + "	            AND SUBSTR(STS.ABR_NO,1,3) = 'QCN'	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.FACTORY = MAT.FACTORY 	\n "
                + "	            AND STS.MAT_ID = MAT.MAT_ID	\n "
                + "	            AND STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')||'220000'	\n "
                + "	                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')||'220000'	\n "
                + "	                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 28, 'YYYYMMDD')||'220000'	\n "
                + "	                                                   END 	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n "
                + "	            AND STS.DEFECT_CODE LIKE '%'	\n "
                + "	            AND STS.CUR_STEP LIKE '%'	\n "
                + "	            AND STS.OPER_1 >= 'A0000'	\n "
                + "	            AND STS.OPER_1 <= 'AZ010'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            GROUP BY CASE STS.CUS_ID WHEN 'SE' THEN 'SEC'	\n "
                + "	                                   WHEN 'HX' THEN 'SK Hynix'	\n "
                + "	                     END	\n "
                + "	        ) A,	\n "
                + "	        (	\n "
                + "	            SELECT 'TOTAL' AS CUSTOMER 	\n "
                + "	                , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')	\n "
                + "	                                               END	\n "
                + "	                            AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')	\n "
                + "	                                               END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_1	\n "
                + "	                , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')	\n "
                + "	                                               END	\n "
                + "	                            AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')	\n "
                + "	                                               END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_2	\n "
                + "	                , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')	\n "
                + "	                                               END	\n "
                + "	                            AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')	\n "
                + "	                                               END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_3	\n "
                + "	                , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 0, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')	\n "
                + "	                                               END	\n "
                + "	                            AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 6, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 5, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 4, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 3, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 2, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 1, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 0, 'YYYYMMDD')	\n "
                + "	                                               END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_4	\n "
                + "	            FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n "
                + "	            WHERE A.FACTORY = B.FACTORY  	\n "
                + "	            AND A.MAT_ID = B.MAT_ID  	\n "
                + "	            AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n "
                + "	            AND A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')	\n "
                + "	                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')	\n "
                + "	                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')	\n "
                + "	                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')	\n "
                + "	                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')	\n "
                + "	                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')	\n "
                + "	                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')	\n "
                + "	                               END 	\n "
                + "	            AND A.WORK_DATE <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD') 	\n "
                + "	            AND A.QC_OPER IN ('PVI','QC GATE')    	\n "
                + "	            AND A.QC_TYPE LIKE 'GATE' || '%'  	\n "
                + "	            AND B.MAT_GRP_1 LIKE '%'	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC'	\n "
                + "	                                    WHEN 'HX' THEN 'SK Hynix'	\n "
                + "	                   END AS CUSTOMER 	\n "
                + "	                , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')	\n "
                + "	                                               END	\n "
                + "	                            AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')	\n "
                + "	                                               END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_1	\n "
                + "	                , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')	\n "
                + "	                                               END	\n "
                + "	                            AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')	\n "
                + "	                                               END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_2	\n "
                + "	                , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')	\n "
                + "	                                               END	\n "
                + "	                            AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')	\n "
                + "	                                               END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_3	\n "
                + "	                , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 0, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')	\n "
                + "	                                               END	\n "
                + "	                            AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 6, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 5, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 4, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 3, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 2, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 1, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 0, 'YYYYMMDD')	\n "
                + "	                                               END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_4	\n "
                + "	            FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n "
                + "	            WHERE A.FACTORY = B.FACTORY  	\n "
                + "	            AND A.MAT_ID = B.MAT_ID  	\n "
                + "	            AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n "
                + "	            AND A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')	\n "
                + "	                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')	\n "
                + "	                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')	\n "
                + "	                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')	\n "
                + "	                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')	\n "
                + "	                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')	\n "
                + "	                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')	\n "
                + "	                               END 	\n "
                + "	            AND A.WORK_DATE <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD') 	\n "
                + "	            AND A.QC_OPER IN ('PVI','QC GATE')    	\n "
                + "	            AND A.QC_TYPE LIKE 'GATE' || '%'  	\n "
                + "	            AND B.MAT_GRP_1 LIKE '%'	\n "
                + "	            GROUP BY CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC'	\n "
                + "	                                      WHEN 'HX' THEN 'SK Hynix'	\n "
                + "	                     END	\n "
                + "	        ) B	\n "
                + "	        WHERE A.CUSTOMER = B.CUSTOMER	\n "
                + "	        UNION ALL	\n "
                + "	        SELECT A.CUSTOMER AS CUSTOMER	\n "
                + "	            , 0 AS QTY_QQ_1	\n "
                + "	            , 0 AS QTY_QQ_2	\n "
                + "	            , 0 AS QTY_QQ_3	\n "
                + "	            , 0 AS QTY_QQ_4	\n "
                + "	            , 0 AS QTY_MM_1	\n "
                + "	            , 0 AS QTY_MM_2	\n "
                + "	            , 0 AS QTY_MM_3	\n "
                + "	            , 0 AS QTY_MM_4	\n "
                + "	            , 0 AS QTY_WW_1	\n "
                + "	            , 0 AS QTY_WW_2	\n "
                + "	            , 0 AS QTY_WW_3	\n "
                + "	            , 0 AS QTY_WW_4	\n "
                + "	            , CASE WHEN A.QTY_DD_1 > 0 AND B.LOT_QTY_DD_1 > 0 THEN ROUND(A.QTY_DD_1 / B.LOT_QTY_DD_1 * 100, 2) ELSE 0 END AS QTY_DD_1	\n "
                + "	            , CASE WHEN A.QTY_DD_2 > 0 AND B.LOT_QTY_DD_2 > 0 THEN ROUND(A.QTY_DD_2 / B.LOT_QTY_DD_2 * 100, 2) ELSE 0 END AS QTY_DD_2	\n "
                + "	            , CASE WHEN A.QTY_DD_3 > 0 AND B.LOT_QTY_DD_3 > 0 THEN ROUND(A.QTY_DD_3 / B.LOT_QTY_DD_3 * 100, 2) ELSE 0 END AS QTY_DD_3	\n "
                + "	            , CASE WHEN A.QTY_DD_4 > 0 AND B.LOT_QTY_DD_4 > 0 THEN ROUND(A.QTY_DD_4 / B.LOT_QTY_DD_4 * 100, 2) ELSE 0 END AS QTY_DD_4	\n "
                + "	            , CASE WHEN A.QTY_DD_5 > 0 AND B.LOT_QTY_DD_5 > 0 THEN ROUND(A.QTY_DD_5 / B.LOT_QTY_DD_5 * 100, 2) ELSE 0 END AS QTY_DD_5	\n "
                + "	            , CASE WHEN A.QTY_DD_6 > 0 AND B.LOT_QTY_DD_6 > 0 THEN ROUND(A.QTY_DD_6 / B.LOT_QTY_DD_6 * 100, 2) ELSE 0 END AS QTY_DD_6	\n "
                + "	            , CASE WHEN A.QTY_DD_7 > 0 AND B.LOT_QTY_DD_7 > 0 THEN ROUND(A.QTY_DD_7 / B.LOT_QTY_DD_7 * 100, 2) ELSE 0 END AS QTY_DD_7	\n "
                + "	        FROM(	\n "
                + "	            SELECT 'TOTAL' AS CUSTOMER	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n "
                + "	                            WHEN '금' 	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                            WHEN '목'	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                      END) AS QTY_DD_1	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n "
                + "	                            WHEN '토'	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                            WHEN '금'	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                      END) AS QTY_DD_2 	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n "
                + "	                            WHEN '일' 	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                            WHEN '토'	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                      END) AS QTY_DD_3 	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n "
                + "	                            WHEN '월' 	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                            WHEN '일'	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                      END) AS QTY_DD_4 	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n "
                + "	                            WHEN '화'	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                            WHEN '월'	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                      END) AS QTY_DD_5 	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n "
                + "	                            WHEN '수'	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                            WHEN '화'	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                      END) AS QTY_DD_6 	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n "
                + "	                            WHEN '목' 	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                            WHEN '수'	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                      END) AS QTY_DD_7	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n "
                + "	            WHERE 1=1 	\n "
                + "	            AND SUBSTR(STS.ABR_NO,1,3) = 'QCN'	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.FACTORY = MAT.FACTORY 	\n "
                + "	            AND STS.MAT_ID = MAT.MAT_ID	\n "
                + "	            AND STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000'	\n "
                + "	                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000'	\n "
                + "	                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000'	\n "
                + "	                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000'	\n "
                + "	                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000'	\n "
                + "	                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000'	\n "
                + "	                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000'	\n "
                + "	                                                   END 	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n "
                + "	            AND STS.DEFECT_CODE LIKE '%'	\n "
                + "	            AND STS.CUR_STEP LIKE '%'	\n "
                + "	            AND STS.OPER_1 >= 'A0000'	\n "
                + "	            AND STS.OPER_1 <= 'AZ010'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT CASE STS.CUS_ID WHEN 'SE' THEN 'SEC'	\n "
                + "	                                   WHEN 'HX' THEN 'SK Hynix'	\n "
                + "	                   END AS CUSTOMER	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n "
                + "	                            WHEN '금' 	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                            WHEN '목'	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                      END) AS QTY_DD_1	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n "
                + "	                            WHEN '토'	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                            WHEN '금'	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                      END) AS QTY_DD_2 	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n "
                + "	                            WHEN '일' 	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                            WHEN '토'	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                      END) AS QTY_DD_3 	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n "
                + "	                            WHEN '월' 	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                            WHEN '일'	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                      END) AS QTY_DD_4 	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n "
                + "	                            WHEN '화'	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                            WHEN '월'	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                      END) AS QTY_DD_5 	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n "
                + "	                            WHEN '수'	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                            WHEN '화'	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                      END) AS QTY_DD_6 	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n "
                + "	                            WHEN '목' 	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                            WHEN '수'	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                      END) AS QTY_DD_7	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n "
                + "	            WHERE 1=1 	\n "
                + "	            AND SUBSTR(STS.ABR_NO,1,3) = 'QCN'	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.FACTORY = MAT.FACTORY 	\n "
                + "	            AND STS.MAT_ID = MAT.MAT_ID	\n "
                + "	            AND STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000'	\n "
                + "	                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000'	\n "
                + "	                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000'	\n "
                + "	                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000'	\n "
                + "	                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000'	\n "
                + "	                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000'	\n "
                + "	                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000'	\n "
                + "	                                                   END 	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n "
                + "	            AND STS.DEFECT_CODE LIKE '%'	\n "
                + "	            AND STS.CUR_STEP LIKE '%'	\n "
                + "	            AND STS.OPER_1 >= 'A0000'	\n "
                + "	            AND STS.OPER_1 <= 'AZ010'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            GROUP BY CASE STS.CUS_ID WHEN 'SE' THEN 'SEC'	\n "
                + "	                                   WHEN 'HX' THEN 'SK Hynix'	\n "
                + "	                     END	\n "
                + "	        ) A,	\n "
                + "	        (	\n "
                + "	            SELECT 'TOTAL' AS CUSTOMER 	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '금' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_1 	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '토' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_2	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '일' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_3	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '월' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_4	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '화' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_5	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '수' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_6	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '목' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_7	\n "
                + "	            FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n "
                + "	            WHERE A.FACTORY = B.FACTORY  	\n "
                + "	            AND A.MAT_ID = B.MAT_ID  	\n "
                + "	            AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n "
                + "	            AND A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 0, 'YYYYMMDD') 	\n "
                + "	                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD') 	\n "
                + "	                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD') 	\n "
                + "	                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD') 	\n "
                + "	                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD') 	\n "
                + "	                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD') 	\n "
                + "	                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD') 	\n "
                + "	                               END  	\n "
                + "	            AND A.WORK_DATE <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD') 	\n "
                + "	            AND A.QC_OPER IN ('PVI','QC GATE')    	\n "
                + "	            AND A.QC_TYPE LIKE 'GATE' || '%'  	\n "
                + "	            AND B.MAT_GRP_1 LIKE '%'	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC'	\n "
                + "	                                    WHEN 'HX' THEN 'SK Hynix'	\n "
                + "	                   END AS CUSTOMER 	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '금' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_1 	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '토' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_2	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '일' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_3	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '월' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_4	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '화' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_5	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '수' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_6	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '목' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_7	\n "
                + "	            FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n "
                + "	            WHERE A.FACTORY = B.FACTORY  	\n "
                + "	            AND A.MAT_ID = B.MAT_ID  	\n "
                + "	            AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n "
                + "	            AND A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 0, 'YYYYMMDD') 	\n "
                + "	                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD') 	\n "
                + "	                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD') 	\n "
                + "	                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD') 	\n "
                + "	                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD') 	\n "
                + "	                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD') 	\n "
                + "	                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD') 	\n "
                + "	                               END	\n "
                + "	            AND A.WORK_DATE <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')	\n "
                + "	            AND A.QC_OPER IN ('PVI','QC GATE') 	\n "
                + "	            AND A.QC_TYPE LIKE 'GATE' || '%'	\n "
                + "	            AND B.MAT_GRP_1 LIKE '%'	\n "
                + "	            GROUP BY CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC'	\n "
                + "	                                      WHEN 'HX' THEN 'SK Hynix'	\n "
                + "	                     END	\n "
                + "	        ) B	\n "
                + "	        WHERE A.CUSTOMER = B.CUSTOMER	\n "
                + "	    )GROUP BY CUSTOMER	\n "
                + "	    	\n "
                + "	    UNION ALL	\n "
                + "	    	\n "
                + "	    SELECT 'CCN' AS GUBUN	\n "
                + "	        , CUSTOMER	\n "
                + "	        , '1.00 (%)' AS GOAL	\n "
                + "	        , SUM(QTY_QQ_1) AS QTY_QQ_1	\n "
                + "	        , SUM(QTY_QQ_2) AS QTY_QQ_2	\n "
                + "	        , SUM(QTY_QQ_3) AS QTY_QQ_3	\n "
                + "	        , SUM(QTY_QQ_4) AS QTY_QQ_4	\n "
                + "	        , SUM(QTY_MM_1) AS QTY_MM_1	\n "
                + "	        , SUM(QTY_MM_2) AS QTY_MM_2	\n "
                + "	        , SUM(QTY_MM_3) AS QTY_MM_3	\n "
                + "	        , SUM(QTY_MM_4) AS QTY_MM_4	\n "
                + "	        , SUM(QTY_WW_1) AS QTY_WW_1	\n "
                + "	        , SUM(QTY_WW_2) AS QTY_WW_2	\n "
                + "	        , SUM(QTY_WW_3) AS QTY_WW_3	\n "
                + "	        , SUM(QTY_WW_4) AS QTY_WW_4	\n "
                + "	        , SUM(QTY_DD_1) AS QTY_DD_1	\n "
                + "	        , SUM(QTY_DD_2) AS QTY_DD_2	\n "
                + "	        , SUM(QTY_DD_3) AS QTY_DD_3	\n "
                + "	        , SUM(QTY_DD_4) AS QTY_DD_4	\n "
                + "	        , SUM(QTY_DD_5) AS QTY_DD_5	\n "
                + "	        , SUM(QTY_DD_6) AS QTY_DD_6	\n "
                + "	        , SUM(QTY_DD_7) AS QTY_DD_7	\n "
                + "	    FROM(	\n "
                + "	        SELECT A.CUSTOMER AS CUSTOMER	\n "
                + "	            , CASE WHEN A.QTY_QQ_1 > 0 AND B.LOT_QTY_QQ_1 > 0 THEN ROUND(A.QTY_QQ_1 / B.LOT_QTY_QQ_1 * 100, 2) ELSE 0 END AS QTY_QQ_1	\n "
                + "	            , CASE WHEN A.QTY_QQ_2 > 0 AND B.LOT_QTY_QQ_2 > 0 THEN ROUND(A.QTY_QQ_2 / B.LOT_QTY_QQ_2 * 100, 2) ELSE 0 END AS QTY_QQ_2	\n "
                + "	            , CASE WHEN A.QTY_QQ_3 > 0 AND B.LOT_QTY_QQ_3 > 0 THEN ROUND(A.QTY_QQ_3 / B.LOT_QTY_QQ_3 * 100, 2) ELSE 0 END AS QTY_QQ_3	\n "
                + "	            , CASE WHEN A.QTY_QQ_4 > 0 AND B.LOT_QTY_QQ_4 > 0 THEN ROUND(A.QTY_QQ_4 / B.LOT_QTY_QQ_4 * 100, 2) ELSE 0 END AS QTY_QQ_4	\n "
                + "	            , 0 AS QTY_MM_1	\n "
                + "	            , 0 AS QTY_MM_2	\n "
                + "	            , 0 AS QTY_MM_3	\n "
                + "	            , 0 AS QTY_MM_4	\n "
                + "	            , 0 AS QTY_WW_1	\n "
                + "	            , 0 AS QTY_WW_2	\n "
                + "	            , 0 AS QTY_WW_3	\n "
                + "	            , 0 AS QTY_WW_4	\n "
                + "	            , 0 AS QTY_DD_1	\n "
                + "	            , 0 AS QTY_DD_2	\n "
                + "	            , 0 AS QTY_DD_3	\n "
                + "	            , 0 AS QTY_DD_4	\n "
                + "	            , 0 AS QTY_DD_5	\n "
                + "	            , 0 AS QTY_DD_6	\n "
                + "	            , 0 AS QTY_DD_7	\n "
                + "	        FROM(	\n "
                + "	            SELECT 'TOTAL' AS CUSTOMER	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                        WHEN '4' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                        WHEN '3' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                        WHEN '2' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                        WHEN '1' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                      END) AS QTY_QQ_1	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                        WHEN '4' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                        WHEN '3' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                        WHEN '2' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                        WHEN '1' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                      END) AS QTY_QQ_2	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                        WHEN '4' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                        WHEN '3' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                        WHEN '2' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                        WHEN '1' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                      END) AS QTY_QQ_3	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                        WHEN '4' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                        WHEN '3' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                        WHEN '2' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                        WHEN '1' THEN 	\n "
                + "	                                    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                        THEN 1	\n "
                + "	                                        ELSE 0 	\n "
                + "	                                    END	\n "
                + "	                      END) AS QTY_QQ_4	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n "
                + "	            WHERE 1=1 	\n "
                + "	            AND SUBSTR(STS.ABR_NO,1,3) = 'CCN'	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.FACTORY = MAT.FACTORY 	\n "
                + "	            AND STS.MAT_ID = MAT.MAT_ID 	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -13)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n "
                + "	            AND STS.DEFECT_CODE LIKE '%'	\n "
                + "	            AND STS.CUR_STEP LIKE '%'	\n "
                + "	            AND STS.OPER_1 >= 'A0000'	\n "
                + "	            AND STS.OPER_1 <= 'AZ010'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	        ) A,	\n "
                + "	        (	\n "
                + "	            SELECT 'TOTAL' AS CUSTOMER 	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'04'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'04', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS LOT_QTY_QQ_1	\n "
                + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS LOT_QTY_QQ_2	\n "
                + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS LOT_QTY_QQ_3	\n "
                + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'10'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'10', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n "
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n "
                + "	                                    THEN A.QC_LOT_QTY_1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS LOT_QTY_QQ_4	\n "
                + "	            FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n "
                + "	            WHERE A.FACTORY = B.FACTORY  	\n "
                + "	            AND A.MAT_ID = B.MAT_ID  	\n "
                + "	            AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n "
                + "	            AND A.WORK_MONTH >= TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -11), 'YYYYMM') 	\n "
                + "	            AND A.WORK_MONTH <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMM')	\n "
                + "	            AND A.QC_TYPE LIKE 'CCS(변경점)' || '%'	\n "
                + "	            AND B.MAT_GRP_1 LIKE '%'	\n "
                + "	        ) B	\n "
                + "	        WHERE A.CUSTOMER = B.CUSTOMER	\n "
                + "	        UNION ALL	\n "
                + "	        SELECT A.CUSTOMER AS CUSTOMER	\n "
                + "	            , 0 AS QTY_QQ_1	\n "
                + "	            , 0 AS QTY_QQ_2	\n "
                + "	            , 0 AS QTY_QQ_3	\n "
                + "	            , 0 AS QTY_QQ_4	\n "
                + "	            , CASE WHEN A.QTY_MM_1 > 0 AND B.LOT_QTY_MM_1 > 0 THEN ROUND(A.QTY_MM_1 / B.LOT_QTY_MM_1 * 100, 2) ELSE 0 END AS QTY_MM_1	\n "
                + "	            , CASE WHEN A.QTY_MM_2 > 0 AND B.LOT_QTY_MM_2 > 0 THEN ROUND(A.QTY_MM_2 / B.LOT_QTY_MM_2 * 100, 2) ELSE 0 END AS QTY_MM_2	\n "
                + "	            , CASE WHEN A.QTY_MM_3 > 0 AND B.LOT_QTY_MM_3 > 0 THEN ROUND(A.QTY_MM_3 / B.LOT_QTY_MM_3 * 100, 2) ELSE 0 END AS QTY_MM_3	\n "
                + "	            , CASE WHEN A.QTY_MM_4 > 0 AND B.LOT_QTY_MM_4 > 0 THEN ROUND(A.QTY_MM_4 / B.LOT_QTY_MM_4 * 100, 2) ELSE 0 END AS QTY_MM_4	\n "
                + "	            , 0 AS QTY_WW_1	\n "
                + "	            , 0 AS QTY_WW_2	\n "
                + "	            , 0 AS QTY_WW_3	\n "
                + "	            , 0 AS QTY_WW_4	\n "
                + "	            , 0 AS QTY_DD_1	\n "
                + "	            , 0 AS QTY_DD_2	\n "
                + "	            , 0 AS QTY_DD_3	\n "
                + "	            , 0 AS QTY_DD_4	\n "
                + "	            , 0 AS QTY_DD_5	\n "
                + "	            , 0 AS QTY_DD_6	\n "
                + "	            , 0 AS QTY_DD_7	\n "
                + "	        FROM(	\n "
                + "	            SELECT 'TOTAL' AS CUSTOMER	\n "
                + "	                ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n "
                + "	                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n "
                + "	                            THEN 1	\n "
                + "	                            ELSE 0	\n "
                + "	                     END) AS QTY_MM_1	\n "
                + "	                ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n "
                + "	                            THEN 1	\n "
                + "	                            ELSE 0	\n "
                + "	                     END) AS QTY_MM_2	\n "
                + "	                ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n "
                + "	                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n "
                + "	                            THEN 1	\n "
                + "	                            ELSE 0	\n "
                + "	                     END) AS QTY_MM_3	\n "
                + "	                ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n "
                + "	                                AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 0)), 'YYYYMMDD')||'220000'	\n "
                + "	                            THEN 1	\n "
                + "	                            ELSE 0	\n "
                + "	                     END) AS QTY_MM_4	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n "
                + "	            WHERE 1=1 	\n "
                + "	            AND SUBSTR(STS.ABR_NO,1,3) = 'CCN'	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.FACTORY = MAT.FACTORY 	\n "
                + "	            AND STS.MAT_ID = MAT.MAT_ID 	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n "
                + "	            AND STS.DEFECT_CODE LIKE '%'	\n "
                + "	            AND STS.CUR_STEP LIKE '%'	\n "
                + "	            AND STS.OPER_1 >= 'A0000'	\n "
                + "	            AND STS.OPER_1 <= 'AZ010'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	        ) A,	\n "
                + "	        (	\n "
                + "	            SELECT 'TOTAL' AS CUSTOMER 	\n "
                + "	                , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_1	\n "
                + "	                , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_2	\n "
                + "	                , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_3	\n "
                + "	                , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_4	\n "
                + "	            FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n "
                + "	            WHERE A.FACTORY = B.FACTORY  	\n "
                + "	            AND A.MAT_ID = B.MAT_ID  	\n "
                + "	            AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n "
                + "	            AND A.WORK_MONTH >= TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4), 'YYYYMM') 	\n "
                + "	            AND A.WORK_MONTH <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMM')	\n "
                + "	            AND A.QC_TYPE LIKE 'CCS(변경점)' || '%'  	\n "
                + "	            AND B.MAT_GRP_1 LIKE '%'	\n "
                + "	        ) B	\n "
                + "	        WHERE A.CUSTOMER = B.CUSTOMER	\n "
                + "	        UNION ALL	\n "
                + "	        SELECT A.CUSTOMER AS CUSTOMER	\n "
                + "	            , 0 AS QTY_QQ_1	\n "
                + "	            , 0 AS QTY_QQ_2	\n "
                + "	            , 0 AS QTY_QQ_3	\n "
                + "	            , 0 AS QTY_QQ_4	\n "
                + "	            , 0 AS QTY_MM_1	\n "
                + "	            , 0 AS QTY_MM_2	\n "
                + "	            , 0 AS QTY_MM_3	\n "
                + "	            , 0 AS QTY_MM_4	\n "
                + "	            , CASE WHEN A.QTY_WW_1 > 0 AND B.LOT_QTY_WW_1 > 0 THEN ROUND(A.QTY_WW_1 / B.LOT_QTY_WW_1 * 100, 2) ELSE 0 END AS QTY_WW_1	\n "
                + "	            , CASE WHEN A.QTY_WW_2 > 0 AND B.LOT_QTY_WW_2 > 0 THEN ROUND(A.QTY_WW_2 / B.LOT_QTY_WW_2 * 100, 2) ELSE 0 END AS QTY_WW_2	\n "
                + "	            , CASE WHEN A.QTY_WW_3 > 0 AND B.LOT_QTY_WW_3 > 0 THEN ROUND(A.QTY_WW_3 / B.LOT_QTY_WW_3 * 100, 2) ELSE 0 END AS QTY_WW_3	\n "
                + "	            , CASE WHEN A.QTY_WW_4 > 0 AND B.LOT_QTY_WW_4 > 0 THEN ROUND(A.QTY_WW_4 / B.LOT_QTY_WW_4 * 100, 2) ELSE 0 END AS QTY_WW_4	\n "
                + "	            , 0 AS QTY_DD_1	\n "
                + "	            , 0 AS QTY_DD_2	\n "
                + "	            , 0 AS QTY_DD_3	\n "
                + "	            , 0 AS QTY_DD_4	\n "
                + "	            , 0 AS QTY_DD_5	\n "
                + "	            , 0 AS QTY_DD_6	\n "
                + "	            , 0 AS QTY_DD_7	\n "
                + "	        FROM(	\n "
                + "	            SELECT 'TOTAL' AS CUSTOMER	\n "
                + "	                , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 28, 'YYYYMMDD')||'220000' 	\n "
                + "	                                               END	\n "
                + "	                            AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')||'220000'	\n "
                + "	                                                                          WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')||'220000'	\n "
                + "	                                                                          WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                          WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                          WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                          WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                          WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')||'220000' 	\n "
                + "	                                               END THEN 1 ELSE 0 END) AS QTY_WW_1	\n "
                + "	                , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')||'220000' 	\n "
                + "	                                               END	\n "
                + "	                            AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')||'220000'   	\n "
                + "	                                                                          WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')||'220000'   	\n "
                + "	                                                                          WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')||'220000'  	\n "
                + "	                                                                          WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')||'220000'  	\n "
                + "	                                                                          WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')||'220000'  	\n "
                + "	                                                                          WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')||'220000'  	\n "
                + "	                                                                          WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')||'220000'  	\n "
                + "	                                               END THEN 1 ELSE 0 END) AS QTY_WW_2	\n "
                + "	                , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')||'220000'  	\n "
                + "	                                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')||'220000'  	\n "
                + "	                                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')||'220000'  	\n "
                + "	                                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')||'220000'  	\n "
                + "	                                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')||'220000'  	\n "
                + "	                                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')||'220000'  	\n "
                + "	                                               END	\n "
                + "	                            AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                          WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                          WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                          WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                          WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                          WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                          WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000' 	\n "
                + "	                                               END THEN 1 ELSE 0 END) AS QTY_WW_3	\n "
                + "	                , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000' 	\n "
                + "	                                               END	\n "
                + "	                            AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 6, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                          WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 5, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                                          WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 4, 'YYYYMMDD')||'220000'	\n "
                + "	                                                                          WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 3, 'YYYYMMDD')||'220000'	\n "
                + "	                                                                          WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 2, 'YYYYMMDD')||'220000'	\n "
                + "	                                                                          WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 1, 'YYYYMMDD')||'220000'	\n "
                + "	                                                                          WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 0, 'YYYYMMDD')||'220000'	\n "
                + "	                                               END THEN 1 ELSE 0 END) AS QTY_WW_4 	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n "
                + "	            WHERE 1=1 	\n "
                + "	            AND SUBSTR(STS.ABR_NO,1,3) = 'CCN'	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.FACTORY = MAT.FACTORY 	\n "
                + "	            AND STS.MAT_ID = MAT.MAT_ID	\n "
                + "	            AND STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')||'220000'	\n "
                + "	                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')||'220000' 	\n "
                + "	                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')||'220000'	\n "
                + "	                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 28, 'YYYYMMDD')||'220000'	\n "
                + "	                                                   END 	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n "
                + "	            AND STS.DEFECT_CODE LIKE '%'	\n "
                + "	            AND STS.CUR_STEP LIKE '%'	\n "
                + "	            AND STS.OPER_1 >= 'A0000'	\n "
                + "	            AND STS.OPER_1 <= 'AZ010'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	        ) A,	\n "
                + "	        (	\n "
                + "	            SELECT 'TOTAL' AS CUSTOMER 	\n "
                + "	                , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')	\n "
                + "	                                               END	\n "
                + "	                            AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')	\n "
                + "	                                               END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_1	\n "
                + "	                , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')	\n "
                + "	                                               END	\n "
                + "	                            AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')	\n "
                + "	                                               END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_2	\n "
                + "	                , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')	\n "
                + "	                                               END	\n "
                + "	                            AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')	\n "
                + "	                                               END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_3	\n "
                + "	                , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 0, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')	\n "
                + "	                                               END	\n "
                + "	                            AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 6, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 5, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 4, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 3, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 2, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 1, 'YYYYMMDD')	\n "
                + "	                                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 0, 'YYYYMMDD')	\n "
                + "	                                               END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_4	\n "
                + "	            FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n "
                + "	            WHERE A.FACTORY = B.FACTORY  	\n "
                + "	            AND A.MAT_ID = B.MAT_ID  	\n "
                + "	            AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n "
                + "	            AND A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')	\n "
                + "	                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')	\n "
                + "	                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')	\n "
                + "	                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')	\n "
                + "	                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')	\n "
                + "	                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')	\n "
                + "	                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')	\n "
                + "	                               END 	\n "
                + "	            AND A.WORK_DATE <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD') 	\n "
                + "	            AND A.QC_TYPE LIKE 'CCS(변경점)' || '%'	\n "
                + "	            AND B.MAT_GRP_1 LIKE '%'	\n "
                + "	        ) B	\n "
                + "	        WHERE A.CUSTOMER = B.CUSTOMER	\n "
                + "	        UNION ALL	\n "
                + "	        SELECT A.CUSTOMER AS CUSTOMER	\n "
                + "	            , 0 AS QTY_QQ_1	\n "
                + "	            , 0 AS QTY_QQ_2	\n "
                + "	            , 0 AS QTY_QQ_3	\n "
                + "	            , 0 AS QTY_QQ_4	\n "
                + "	            , 0 AS QTY_MM_1	\n "
                + "	            , 0 AS QTY_MM_2	\n "
                + "	            , 0 AS QTY_MM_3	\n "
                + "	            , 0 AS QTY_MM_4	\n "
                + "	            , 0 AS QTY_WW_1	\n "
                + "	            , 0 AS QTY_WW_2	\n "
                + "	            , 0 AS QTY_WW_3	\n "
                + "	            , 0 AS QTY_WW_4	\n "
                + "	            , CASE WHEN A.QTY_DD_1 > 0 AND B.LOT_QTY_DD_1 > 0 THEN ROUND(A.QTY_DD_1 / B.LOT_QTY_DD_1 * 100, 2) ELSE 0 END AS QTY_DD_1	\n "
                + "	            , CASE WHEN A.QTY_DD_2 > 0 AND B.LOT_QTY_DD_2 > 0 THEN ROUND(A.QTY_DD_2 / B.LOT_QTY_DD_2 * 100, 2) ELSE 0 END AS QTY_DD_2	\n "
                + "	            , CASE WHEN A.QTY_DD_3 > 0 AND B.LOT_QTY_DD_3 > 0 THEN ROUND(A.QTY_DD_3 / B.LOT_QTY_DD_3 * 100, 2) ELSE 0 END AS QTY_DD_3	\n "
                + "	            , CASE WHEN A.QTY_DD_4 > 0 AND B.LOT_QTY_DD_4 > 0 THEN ROUND(A.QTY_DD_4 / B.LOT_QTY_DD_4 * 100, 2) ELSE 0 END AS QTY_DD_4	\n "
                + "	            , CASE WHEN A.QTY_DD_5 > 0 AND B.LOT_QTY_DD_5 > 0 THEN ROUND(A.QTY_DD_5 / B.LOT_QTY_DD_5 * 100, 2) ELSE 0 END AS QTY_DD_5	\n "
                + "	            , CASE WHEN A.QTY_DD_6 > 0 AND B.LOT_QTY_DD_6 > 0 THEN ROUND(A.QTY_DD_6 / B.LOT_QTY_DD_6 * 100, 2) ELSE 0 END AS QTY_DD_6	\n "
                + "	            , CASE WHEN A.QTY_DD_7 > 0 AND B.LOT_QTY_DD_7 > 0 THEN ROUND(A.QTY_DD_7 / B.LOT_QTY_DD_7 * 100, 2) ELSE 0 END AS QTY_DD_7	\n "
                + "	        FROM(	\n "
                + "	            SELECT 'TOTAL' AS CUSTOMER	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n "
                + "	                            WHEN '금' 	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                            WHEN '목'	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                      END) AS QTY_DD_1	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n "
                + "	                            WHEN '토'	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                            WHEN '금'	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                      END) AS QTY_DD_2 	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n "
                + "	                            WHEN '일' 	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                            WHEN '토'	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                      END) AS QTY_DD_3 	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n "
                + "	                            WHEN '월' 	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                            WHEN '일'	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                      END) AS QTY_DD_4 	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n "
                + "	                            WHEN '화'	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                            WHEN '월'	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                      END) AS QTY_DD_5 	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n "
                + "	                            WHEN '수'	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                            WHEN '화'	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                      END) AS QTY_DD_6 	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n "
                + "	                            WHEN '목' 	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                            WHEN '수'	\n "
                + "	                            THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n "
                + "	                                      THEN 1	\n "
                + "	                                      ELSE 0	\n "
                + "	                                 END	\n "
                + "	                      END) AS QTY_DD_7	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n "
                + "	            WHERE 1=1 	\n "
                + "	            AND SUBSTR(STS.ABR_NO,1,3) = 'CCN'	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.FACTORY = MAT.FACTORY 	\n "
                + "	            AND STS.MAT_ID = MAT.MAT_ID	\n "
                + "	            AND STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000'	\n "
                + "	                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000'	\n "
                + "	                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000'	\n "
                + "	                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000'	\n "
                + "	                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000'	\n "
                + "	                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000'	\n "
                + "	                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000'	\n "
                + "	                                                   END 	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n "
                + "	            AND STS.DEFECT_CODE LIKE '%'	\n "
                + "	            AND STS.CUR_STEP LIKE '%'	\n "
                + "	            AND STS.OPER_1 >= 'A0000'	\n "
                + "	            AND STS.OPER_1 <= 'AZ010'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	        ) A,	\n "
                + "	        (	\n "
                + "	            SELECT 'TOTAL' AS CUSTOMER 	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '금' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_1 	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '토' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_2	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '일' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_3	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '월' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_4	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '화' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_5	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '수' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_6	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '목' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_7	\n "
                + "	            FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n "
                + "	            WHERE A.FACTORY = B.FACTORY  	\n "
                + "	            AND A.MAT_ID = B.MAT_ID  	\n "
                + "	            AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n "
                + "	            AND A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 0, 'YYYYMMDD') 	\n "
                + "	                                                           WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD') 	\n "
                + "	                                                           WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD') 	\n "
                + "	                                                           WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD') 	\n "
                + "	                                                           WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD') 	\n "
                + "	                                                           WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD') 	\n "
                + "	                                                           WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD') 	\n "
                + "	                               END  	\n "
                + "	            AND A.WORK_DATE <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD') 	\n "
                + "	            AND A.QC_TYPE LIKE 'CCS(변경점)' || '%'	\n "
                + "	            AND B.MAT_GRP_1 LIKE '%'	\n "
                + "	        ) B	\n "
                + "	        WHERE A.CUSTOMER = B.CUSTOMER	\n "
                + "	    )GROUP BY CUSTOMER	\n "
                + "	)	\n "
                + "	ORDER BY DECODE(GUBUN, 'QCN', 0, 'CCN', 1)	\n "
                + "	        , DECODE(CUSTOMER, 'TOTAL', 0, 'SEC', 1, 'SK Hynix', 2)	\n ";

            if (GlobalVariable.gsUserGroup == "ADMIN_GROUP" || GlobalVariable.gsUserGroup == "HANA_ADMIN_GROUP")
            {
                System.Windows.Forms.Clipboard.SetText(QRY.Replace((char)Keys.Tab, ' '));
            }

            return QRY.Replace((char)Keys.Tab, ' ');
        }

        private string MakeSqlString1()
        {
            /****************************************************
             * Comment : DataBase에 저장된 데이터를 조회한다.(일일공정품질 기상도 - 품질기상도)
             * 
             * Created By : 김선호(2012-08-17-금요일)
             * 
             * Modified By :
             ****************************************************/

            string QRY = "";

            string date = cdvDate.Value.ToString("yyyyMMddHHmmss");

            QRY = "	SELECT GUBUN	\n "
                + "	    ,SUM(QCN_DD_1) AS QCN_DD_1	\n "
                + "	    ,SUM(QCN_DD_2) AS QCN_DD_2	\n "
                + "	    ,ABS(SUM(QCN_DD_1) - SUM(QCN_DD_2)) AS QCN_RESULT	\n "
                + "	    ,SUM(CCN_DD_1) AS CCN_DD_1	\n "
                + "	    ,SUM(CCN_DD_2) AS CCN_DD_2	\n "
                + "	    ,ABS(SUM(CCN_DD_1) - SUM(CCN_DD_2)) AS CCN_RESULT	\n "
                + "	FROM	\n "
                + "	(	\n "
                + "	    SELECT A.GUBUN AS GUBUN	\n "
                + "	        , CASE WHEN A.QCN_DD_1 > 0 AND B.LOT_QCN_DD_1 > 0 THEN ROUND(A.QCN_DD_1 / B.LOT_QCN_DD_1 * 100, 2) ELSE 0 END AS QCN_DD_1	\n "
                + "	        , CASE WHEN A.QCN_DD_2 > 0 AND B.LOT_QCN_DD_2 > 0 THEN ROUND(A.QCN_DD_2 / B.LOT_QCN_DD_2 * 100, 2) ELSE 0 END AS QCN_DD_2	\n "
                + "	        , 0 AS CCN_DD_1	\n "
                + "	        , 0 AS CCN_DD_2	\n "
                + "	    FROM(    	\n "
                + "	        SELECT 'LRR' AS GUBUN	\n "
                + "	            ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS')-2, 'YYYYMMDD')||'220000'	\n "
                + "	                            AND STS.STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS')-1, 'YYYYMMDD')||'220000'	\n "
                + "	                        THEN 1	\n "
                + "	                        ELSE 0	\n "
                + "	                 END) AS QCN_DD_1	\n "
                + "	            ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS')-1, 'YYYYMMDD')||'220000'	\n "
                + "	                            AND STS.STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	                        THEN 1	\n "
                + "	                        ELSE 0	\n "
                + "	                 END) AS QCN_DD_2	\n "
                + "	        FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n "
                + "	        WHERE 1=1 	\n "
                + "	        AND SUBSTR(STS.ABR_NO,1,3) = 'QCN'	\n "
                + "	        AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	        AND STS.FACTORY = MAT.FACTORY 	\n "
                + "	        AND STS.MAT_ID = MAT.MAT_ID 	\n "
                + "	        AND STEP10_TIME >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') -2, 'YYYYMMDD')||'220000'	\n "
                + "	        AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	        AND STS.OPER_1 >= 'A0000'	\n "
                + "	        AND STS.OPER_1 <= 'AZ010'	\n "
                + "	        AND STS.DEL_FLAG = ' '	\n "
                + "	        ) A,	\n "
                + "	        (SELECT 'LRR' AS GUBUN 	\n "
                + "	            , SUM(CASE A.WORK_DATE WHEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS')-1, 'YYYYMMDD') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QCN_DD_1	\n "
                + "	            , SUM(CASE A.WORK_DATE WHEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QCN_DD_2	\n "
                + "	        FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B	\n "
                + "	        WHERE A.FACTORY = B.FACTORY	\n "
                + "	        AND A.MAT_ID = B.MAT_ID	\n "
                + "	        AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	        AND A.WORK_DATE >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS')-1, 'YYYYMMDD')	\n "
                + "	        AND A.WORK_DATE <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')	\n "
                + "	        AND A.QC_OPER IN ('PVI','QC GATE') 	\n "
                + "	        AND A.QC_TYPE LIKE 'GATE' || '%' 	\n "
                + "	        AND B.MAT_GRP_1 LIKE '%'	\n "
                + "	    ) B	\n "
                + "	    WHERE A.GUBUN = B.GUBUN	\n "
                + "	    UNION ALL	\n "
                + "	    SELECT A.GUBUN AS GUBUN	\n "
                + "	        , 0 AS QCN_DD_1	\n "
                + "	        , 0 AS QCN_DD_2	\n "
                + "	        , CASE WHEN A.CCN_DD_1 > 0 AND B.LOT_CCN_DD_1 > 0 THEN ROUND(A.CCN_DD_1 / B.LOT_CCN_DD_1 * 100, 2) ELSE 0 END AS CCN_DD_1	\n "
                + "	        , CASE WHEN A.CCN_DD_2 > 0 AND B.LOT_CCN_DD_2 > 0 THEN ROUND(A.CCN_DD_2 / B.LOT_CCN_DD_2 * 100, 2) ELSE 0 END AS CCN_DD_2	\n "
                + "	    FROM(    	\n "
                + "	        SELECT 'LRR' AS GUBUN	\n "
                + "	            ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS')-2, 'YYYYMMDD')||'220000'	\n "
                + "	                            AND STS.STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS')-1, 'YYYYMMDD')||'220000'	\n "
                + "	                        THEN 1	\n "
                + "	                        ELSE 0	\n "
                + "	                 END) AS CCN_DD_1	\n "
                + "	            ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS')-1, 'YYYYMMDD')||'220000'	\n "
                + "	                            AND STS.STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	                        THEN 1	\n "
                + "	                        ELSE 0	\n "
                + "	                 END) AS CCN_DD_2	\n "
                + "	        FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n "
                + "	        WHERE 1=1 	\n "
                + "	        AND SUBSTR(STS.ABR_NO,1,3) = 'CCN'	\n "
                + "	        AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	        AND STS.FACTORY = MAT.FACTORY 	\n "
                + "	        AND STS.MAT_ID = MAT.MAT_ID 	\n "
                + "	        AND STEP10_TIME >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') -2, 'YYYYMMDD')||'220000'	\n "
                + "	        AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	        AND STS.OPER_1 >= 'A0000'	\n "
                + "	        AND STS.OPER_1 <= 'AZ010'	\n "
                + "	        AND STS.DEL_FLAG = ' '	\n "
                + "	        ) A,	\n "
                + "	        (SELECT 'LRR' AS GUBUN 	\n "
                + "	            , SUM(CASE A.WORK_DATE WHEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS')-1, 'YYYYMMDD') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_CCN_DD_1	\n "
                + "	            , SUM(CASE A.WORK_DATE WHEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_CCN_DD_2	\n "
                + "	        FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B	\n "
                + "	        WHERE A.FACTORY = B.FACTORY	\n "
                + "	        AND A.MAT_ID = B.MAT_ID	\n "
                + "	        AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	        AND A.WORK_DATE >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS')-1, 'YYYYMMDD')	\n "
                + "	        AND A.WORK_DATE <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')	\n "
                + "	        AND A.QC_TYPE LIKE 'CCS(변경점)' || '%'  	\n "
                + "	        AND B.MAT_GRP_1 LIKE '%'	\n "
                + "	    ) B	\n "
                + "	    WHERE A.GUBUN = B.GUBUN	\n "
                + "	)GROUP BY GUBUN	\n ";

            if (GlobalVariable.gsUserGroup == "ADMIN_GROUP" || GlobalVariable.gsUserGroup == "HANA_ADMIN_GROUP")
            {
                System.Windows.Forms.Clipboard.SetText(QRY.Replace((char)Keys.Tab, ' '));
            }

            return QRY.Replace((char)Keys.Tab, ' ');
        }

        private string MakeSqlString2()
        {
            /****************************************************
             * Comment : DataBase에 저장된 데이터를 조회한다.(일일공정품질 기상도 - 불량 Mode/공정(QCN))
             * 
             * Created By : 김선호(2012-08-17-금요일)
             * 
             * Modified By :
             ****************************************************/

            string QRY = "";

            string date = cdvDate.Value.ToString("yyyyMMddHHmmss");

            QRY = "	SELECT *	\n "
                + "	FROM (	\n "
                + "	    SELECT A.GUBUN	\n "
                + "	        , A.QTY_QQ_1	\n "
                + "	        , CASE WHEN A.QTY_QQ_1 > 0 AND B.TOT_QQ_1 > 0 THEN ROUND(A.QTY_QQ_1 / B.TOT_QQ_1 * 100, 2) ELSE 0 END AS PERCENT_QQ_1	\n "
                + "	        , A.QTY_QQ_2	\n "
                + "	        , CASE WHEN A.QTY_QQ_1 > 0 AND B.TOT_QQ_2 > 0 THEN ROUND(A.QTY_QQ_2 / B.TOT_QQ_2 * 100, 2) ELSE 0 END AS PERCENT_QQ_2	\n "
                + "	        , A.QTY_QQ_3	\n "
                + "	        , CASE WHEN A.QTY_QQ_1 > 0 AND B.TOT_QQ_3 > 0 THEN ROUND(A.QTY_QQ_3 / B.TOT_QQ_3 * 100, 2) ELSE 0 END AS PERCENT_QQ_3	\n "
                + "	        , A.QTY_MM_1	\n "
                + "	        , CASE WHEN A.QTY_MM_1 > 0 AND B.TOT_MM_1 > 0 THEN ROUND(A.QTY_MM_1 / B.TOT_MM_1 * 100, 2) ELSE 0 END AS PERCENT_MM_1	\n "
                + "	    FROM(	\n "
                + "	        SELECT GUBUN	\n "
                + "	            , SUM(QTY_QQ_1) AS QTY_QQ_1	\n "
                + "	            , SUM(QTY_QQ_2) AS QTY_QQ_2	\n "
                + "	            , SUM(QTY_QQ_3) AS QTY_QQ_3	\n "
                + "	            , SUM(QTY_MM_1) AS QTY_MM_1	\n "
                + "	            , SUM(QTY_QQ_2 + QTY_QQ_3) AS TOTAL	\n "
                + "	        FROM (	\n "
                + "	            SELECT DEF.DESC_1 AS GUBUN	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_1	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_2	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_3	\n "
                + "	                , 0 AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -10)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 >= 'A0000'	\n "
                + "	            AND STS.OPER_1 <= 'AZ010'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'QCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            GROUP BY DEF.DESC_1	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT DEF.DESC_1 AS GUBUN	\n "
                + "	                , 0 AS QTY_QQ_1	\n "
                + "	                , 0 AS QTY_QQ_2	\n "
                + "	                , 0 AS QTY_QQ_3	\n "
                + "	                , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n "
                + "	                                AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0)), 'YYYYMMDD')||'220000'	\n "
                + "	                           THEN 1	\n "
                + "	                           ELSE 0	\n "
                + "	                      END) AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 >= 'A0000'	\n "
                + "	            AND STS.OPER_1 <= 'AZ010'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'QCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            GROUP BY DEF.DESC_1	\n "
                + "	        )GROUP BY GUBUN	\n "
                + "	    )A,	\n "
                + "	    (	\n "
                + "	        SELECT GUBUN	\n "
                + "	            , SUM(QTY_QQ_1) AS TOT_QQ_1	\n "
                + "	            , SUM(QTY_QQ_2) AS TOT_QQ_2	\n "
                + "	            , SUM(QTY_QQ_3) AS TOT_QQ_3	\n "
                + "	            , SUM(QTY_MM_1) AS TOT_MM_1	\n "
                + "	        FROM (	\n "
                + "	            SELECT 'TOTAL' AS GUBUN	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_1	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_2	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_3	\n "
                + "	                , 0 AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -10)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 >= 'A0000'	\n "
                + "	            AND STS.OPER_1 <= 'AZ010'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'QCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            GROUP BY DEF.DESC_1	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT 'TOTAL' AS GUBUN	\n "
                + "	                , 0 AS QTY_QQ_1	\n "
                + "	                , 0 AS QTY_QQ_2	\n "
                + "	                , 0 AS QTY_QQ_3	\n "
                + "	                , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n "
                + "	                                AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0)), 'YYYYMMDD')||'220000'	\n "
                + "	                           THEN 1	\n "
                + "	                           ELSE 0	\n "
                + "	                      END) AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 >= 'A0000'	\n "
                + "	            AND STS.OPER_1 <= 'AZ010'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'QCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	        )GROUP BY GUBUN	\n "
                + "	    )B	\n "
                + "	    ORDER BY TOTAL DESC	\n "
                + "	)WHERE ROWNUM <= 7	\n "
                + "	UNION ALL	\n "
                + "	SELECT *	\n "
                + "	FROM (	\n "
                + "	    SELECT A.GUBUN AS GUBUN	\n "
                + "	        , QTY_QQ_1	\n "
                + "	        , CASE WHEN A.QTY_QQ_1 > 0 AND B.TOT_QTY_QQ_1 > 0 THEN ROUND(A.QTY_QQ_1 / B.TOT_QTY_QQ_1 * 100, 2) ELSE 0 END AS PERCENT_QQ_1	\n "
                + "	        , QTY_QQ_2	\n "
                + "	        , CASE WHEN A.QTY_QQ_1 > 0 AND B.TOT_QTY_QQ_2 > 0 THEN ROUND(A.QTY_QQ_2 / B.TOT_QTY_QQ_2 * 100, 2) ELSE 0 END AS PERCENT_QQ_2	\n "
                + "	        , QTY_QQ_3	\n "
                + "	        , CASE WHEN A.QTY_QQ_1 > 0 AND B.TOT_QTY_QQ_3 > 0 THEN ROUND(A.QTY_QQ_3 / B.TOT_QTY_QQ_3 * 100, 2) ELSE 0 END AS PERCENT_QQ_3	\n "
                + "	        , QTY_MM_1	\n "
                + "	        , CASE WHEN A.QTY_MM_1 > 0 AND B.TOT_QTY_MM_1 > 0 THEN ROUND(A.QTY_MM_1 / B.TOT_QTY_MM_1 * 100, 2) ELSE 0 END AS PERCENT_MM_1	\n "
                + "	    FROM(	\n "
                + "	        SELECT GUBUN	\n "
                + "	            , SUM(QTY_QQ_1) AS QTY_QQ_1	\n "
                + "	            , SUM(QTY_QQ_2) AS QTY_QQ_2	\n "
                + "	            , SUM(QTY_QQ_3) AS QTY_QQ_3	\n "
                + "	            , SUM(QTY_MM_1) AS QTY_MM_1	\n "
                + "	            , SUM(QTY_QQ_2 + QTY_QQ_3) AS TOTAL	\n "
                + "	        FROM (	\n "
                + "	            SELECT 'PVI GATE' AS GUBUN	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_1	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_2	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_3	\n "
                + "	                , 0 AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -10)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 = 'A2100'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'QCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT 'PVI GATE' AS GUBUN	\n "
                + "	                , 0 AS QTY_QQ_1	\n "
                + "	                , 0 AS QTY_QQ_2	\n "
                + "	                , 0 AS QTY_QQ_3	\n "
                + "	                , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n "
                + "	                                AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0)), 'YYYYMMDD')||'220000'	\n "
                + "	                           THEN 1	\n "
                + "	                           ELSE 0	\n "
                + "	                      END) AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 = 'A2100'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'QCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT 'IVI GATE' AS GUBUN	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_1	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_2	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_3	\n "
                + "	                , 0 AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -10)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND OPER_1 >= 'A0800'	\n "
                + "	            AND OPER_1 <= 'A0809'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'QCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT 'IVI GATE' AS GUBUN	\n "
                + "	                , 0 AS QTY_QQ_1	\n "
                + "	                , 0 AS QTY_QQ_2	\n "
                + "	                , 0 AS QTY_QQ_3	\n "
                + "	                , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n "
                + "	                                AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0)), 'YYYYMMDD')||'220000'	\n "
                + "	                           THEN 1	\n "
                + "	                           ELSE 0	\n "
                + "	                      END) AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND OPER_1 >= 'A0800'	\n "
                + "	            AND OPER_1 <= 'A0809'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'QCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT 'W/B' AS GUBUN	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_1	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_2	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_3	\n "
                + "	                , 0 AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -10)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 >= 'A0600'	\n "
                + "	            AND STS.OPER_1 <= 'A0609'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'QCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT 'W/B' AS GUBUN	\n "
                + "	                , 0 AS QTY_QQ_1	\n "
                + "	                , 0 AS QTY_QQ_2	\n "
                + "	                , 0 AS QTY_QQ_3	\n "
                + "	                , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n "
                + "	                                AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0)), 'YYYYMMDD')||'220000'	\n "
                + "	                           THEN 1	\n "
                + "	                           ELSE 0	\n "
                + "	                      END) AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 >= 'A0600'	\n "
                + "	            AND STS.OPER_1 <= 'A0609'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'QCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT 'M/D' AS GUBUN	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_1	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_2	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_3	\n "
                + "	                , 0 AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -10)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 = 'A1000'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'QCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT 'M/D' AS GUBUN	\n "
                + "	                , 0 AS QTY_QQ_1	\n "
                + "	                , 0 AS QTY_QQ_2	\n "
                + "	                , 0 AS QTY_QQ_3	\n "
                + "	                , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n "
                + "	                                AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0)), 'YYYYMMDD')||'220000'	\n "
                + "	                           THEN 1	\n "
                + "	                           ELSE 0	\n "
                + "	                      END) AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 = 'A1000'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'QCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT 'FINISH' AS GUBUN	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_1	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_2	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_3	\n "
                + "	                , 0 AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -10)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 > 'A1000'	\n "
                + "	            AND STS.OPER_1 <= 'A2050'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'QCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT 'FINISH' AS GUBUN	\n "
                + "	                , 0 AS QTY_QQ_1	\n "
                + "	                , 0 AS QTY_QQ_2	\n "
                + "	                , 0 AS QTY_QQ_3	\n "
                + "	                , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n "
                + "	                                AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0)), 'YYYYMMDD')||'220000'	\n "
                + "	                           THEN 1	\n "
                + "	                           ELSE 0	\n "
                + "	                      END) AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 > 'A1000'	\n "
                + "	            AND STS.OPER_1 <= 'A2050'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'QCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT 'D/A' AS GUBUN	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_1	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_2	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_3	\n "
                + "	                , 0 AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -10)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 >= 'A0400'	\n "
                + "	            AND STS.OPER_1 <= 'A0409'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'QCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT 'D/A' AS GUBUN	\n "
                + "	                , 0 AS QTY_QQ_1	\n "
                + "	                , 0 AS QTY_QQ_2	\n "
                + "	                , 0 AS QTY_QQ_3	\n "
                + "	                , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n "
                + "	                                AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0)), 'YYYYMMDD')||'220000'	\n "
                + "	                           THEN 1	\n "
                + "	                           ELSE 0	\n "
                + "	                      END) AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 >= 'A0400'	\n "
                + "	            AND STS.OPER_1 <= 'A0409'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'QCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT '2ND GATE' AS GUBUN	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_1	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_2	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_3	\n "
                + "	                , 0 AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -10)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 = 'A0300'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'QCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT '2ND GATE' AS GUBUN	\n "
                + "	                , 0 AS QTY_QQ_1	\n "
                + "	                , 0 AS QTY_QQ_2	\n "
                + "	                , 0 AS QTY_QQ_3	\n "
                + "	                , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n "
                + "	                                AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0)), 'YYYYMMDD')||'220000'	\n "
                + "	                           THEN 1	\n "
                + "	                           ELSE 0	\n "
                + "	                      END) AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 = 'A0300'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'QCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT 'SAW' AS GUBUN	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_1	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_2	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_3	\n "
                + "	                , 0 AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -10)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 = 'A0200'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'QCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT 'SAW' AS GUBUN	\n "
                + "	                , 0 AS QTY_QQ_1	\n "
                + "	                , 0 AS QTY_QQ_2	\n "
                + "	                , 0 AS QTY_QQ_3	\n "
                + "	                , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n "
                + "	                                AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0)), 'YYYYMMDD')||'220000'	\n "
                + "	                           THEN 1	\n "
                + "	                           ELSE 0	\n "
                + "	                      END) AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 = 'A0200'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'QCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	        )GROUP BY GUBUN	\n "
                + "	    )A,	\n "
                + "	    (	\n "
                + "	    SELECT GUBUN	\n "
                + "	        , SUM(TOT_QTY_QQ_1) AS TOT_QTY_QQ_1	\n "
                + "	        , SUM(TOT_QTY_QQ_2) AS TOT_QTY_QQ_2	\n "
                + "	        , SUM(TOT_QTY_QQ_3) AS TOT_QTY_QQ_3	\n "
                + "	        , SUM(TOT_QTY_MM_1) AS TOT_QTY_MM_1	\n "
                + "	    FROM (	\n "
                + "	        SELECT 'TOTAL' AS GUBUN	\n "
                + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                WHEN '4' THEN 	\n "
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                THEN 1	\n "
                + "	                                ELSE 0 	\n "
                + "	                            END	\n "
                + "	                WHEN '3' THEN 	\n "
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                THEN 1	\n "
                + "	                                ELSE 0 	\n "
                + "	                            END	\n "
                + "	                WHEN '2' THEN 	\n "
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                THEN 1	\n "
                + "	                                ELSE 0 	\n "
                + "	                            END	\n "
                + "	                WHEN '1' THEN 	\n "
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                THEN 1	\n "
                + "	                                ELSE 0 	\n "
                + "	                            END	\n "
                + "	              END) AS TOT_QTY_QQ_1	\n "
                + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                WHEN '4' THEN 	\n "
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                THEN 1	\n "
                + "	                                ELSE 0 	\n "
                + "	                            END	\n "
                + "	                WHEN '3' THEN 	\n "
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                THEN 1	\n "
                + "	                                ELSE 0 	\n "
                + "	                            END	\n "
                + "	                WHEN '2' THEN 	\n "
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                THEN 1	\n "
                + "	                                ELSE 0 	\n "
                + "	                            END	\n "
                + "	                WHEN '1' THEN 	\n "
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                THEN 1	\n "
                + "	                                ELSE 0 	\n "
                + "	                            END	\n "
                + "	              END) AS TOT_QTY_QQ_2	\n "
                + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                WHEN '4' THEN 	\n "
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                THEN 1	\n "
                + "	                                ELSE 0 	\n "
                + "	                            END	\n "
                + "	                WHEN '3' THEN 	\n "
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                THEN 1	\n "
                + "	                                ELSE 0 	\n "
                + "	                            END	\n "
                + "	                WHEN '2' THEN 	\n "
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                THEN 1	\n "
                + "	                                ELSE 0 	\n "
                + "	                            END	\n "
                + "	                WHEN '1' THEN 	\n "
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                THEN 1	\n "
                + "	                                ELSE 0 	\n "
                + "	                            END	\n "
                + "	              END) AS TOT_QTY_QQ_3	\n "
                + "	            , 0 AS TOT_QTY_MM_1	\n "
                + "	        FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	        WHERE 1=1	\n "
                + "	        AND STS.FACTORY = DEF.FACTORY	\n "
                + "	        AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	        AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	        AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -10)), 'YYYYMMDD')||'220000'	\n "
                + "	        AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	        AND STS.OPER_1 >= 'A0000'	\n "
                + "	        AND STS.OPER_1 <= 'AZ010'	\n "
                + "	        AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	        AND ABR_NO LIKE 'QCN%'	\n "
                + "	        AND STS.DEL_FLAG = ' '	\n "
                + "	        UNION ALL	\n "
                + "	        SELECT 'TOTAL' AS GUBUN	\n "
                + "	            ,0 AS TOT_QTY_QQ_1	\n "
                + "	            ,0 AS TOT_QTY_QQ_2	\n "
                + "	            ,0 AS TOT_QTY_QQ_3	\n "
                + "	            , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n "
                + "	                            AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0)), 'YYYYMMDD')||'220000'	\n "
                + "	                       THEN 1	\n "
                + "	                       ELSE 0	\n "
                + "	                  END) AS TOT_QTY_MM_1	\n "
                + "	        FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	        WHERE 1=1	\n "
                + "	        AND STS.FACTORY = DEF.FACTORY	\n "
                + "	        AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	        AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	        AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n "
                + "	        AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	        AND STS.OPER_1 >= 'A0000'	\n "
                + "	        AND STS.OPER_1 <= 'AZ010'	\n "
                + "	        AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	        AND ABR_NO LIKE 'QCN%'	\n "
                + "	        AND STS.DEL_FLAG = ' '	\n "
                + "	        )GROUP BY GUBUN	\n "
                + "	    )B	\n "
                + "	    ORDER BY TOTAL DESC	\n "
                + "	)WHERE ROWNUM <= 3	\n "
                + "	UNION ALL	\n "
                + "	SELECT GUBUN 	\n "
                + "	    , SUM(QTY_QQ_1) AS QTY_QQ_1	\n "
                + "	    , 100 AS PERCENT_QQ_1	\n "
                + "	    , SUM(QTY_QQ_2) AS QTY_QQ_2	\n "
                + "	    , 100 AS PERCENT_QQ_2	\n "
                + "	    , SUM(QTY_QQ_3) AS QTY_QQ_3	\n "
                + "	    , 100 AS PERCENT_QQ_3	\n "
                + "	    , SUM(QTY_MM_1) AS QTY_MM_1	\n "
                + "	    , 100 AS PERCENT_MM_1	\n "
                + "	FROM (	\n "
                + "	    SELECT 'TOTAL' AS GUBUN	\n "
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	            WHEN '4' THEN 	\n "
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                            THEN 1	\n "
                + "	                            ELSE 0 	\n "
                + "	                        END	\n "
                + "	            WHEN '3' THEN 	\n "
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                            THEN 1	\n "
                + "	                            ELSE 0 	\n "
                + "	                        END	\n "
                + "	            WHEN '2' THEN 	\n "
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                            THEN 1	\n "
                + "	                            ELSE 0 	\n "
                + "	                        END	\n "
                + "	            WHEN '1' THEN 	\n "
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                            THEN 1	\n "
                + "	                            ELSE 0 	\n "
                + "	                        END	\n "
                + "	          END) AS QTY_QQ_1	\n "
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	            WHEN '4' THEN 	\n "
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                            THEN 1	\n "
                + "	                            ELSE 0 	\n "
                + "	                        END	\n "
                + "	            WHEN '3' THEN 	\n "
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                            THEN 1	\n "
                + "	                            ELSE 0 	\n "
                + "	                        END	\n "
                + "	            WHEN '2' THEN 	\n "
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                            THEN 1	\n "
                + "	                            ELSE 0 	\n "
                + "	                        END	\n "
                + "	            WHEN '1' THEN 	\n "
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                            THEN 1	\n "
                + "	                            ELSE 0 	\n "
                + "	                        END	\n "
                + "	          END) AS QTY_QQ_2	\n "
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	            WHEN '4' THEN 	\n "
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                            THEN 1	\n "
                + "	                            ELSE 0 	\n "
                + "	                        END	\n "
                + "	            WHEN '3' THEN 	\n "
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                            THEN 1	\n "
                + "	                            ELSE 0 	\n "
                + "	                        END	\n "
                + "	            WHEN '2' THEN 	\n "
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                            THEN 1	\n "
                + "	                            ELSE 0 	\n "
                + "	                        END	\n "
                + "	            WHEN '1' THEN 	\n "
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                            THEN 1	\n "
                + "	                            ELSE 0 	\n "
                + "	                        END	\n "
                + "	          END) AS QTY_QQ_3	\n "
                + "	        , 0 AS QTY_MM_1	\n "
                + "	    FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	    WHERE 1=1	\n "
                + "	    AND STS.FACTORY = DEF.FACTORY	\n "
                + "	    AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	    AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	    AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -10)), 'YYYYMMDD')||'220000'	\n "
                + "	    AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	    AND STS.OPER_1 >= 'A0000'	\n "
                + "	    AND STS.OPER_1 <= 'AZ010'	\n "
                + "	    AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	    AND ABR_NO LIKE 'QCN%'	\n "
                + "	    AND STS.DEL_FLAG = ' '	\n "
                + "	    UNION ALL	\n "
                + "	    SELECT 'TOTAL' AS GUBUN	\n "
                + "	        , 0 AS QTY_QQ_1	\n "
                + "	        , 0 AS QTY_QQ_2	\n "
                + "	        , 0 AS QTY_QQ_3	\n "
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n "
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0)), 'YYYYMMDD')||'220000'	\n "
                + "	                   THEN 1	\n "
                + "	                   ELSE 0	\n "
                + "	              END) AS QTY_MM_1	\n "
                + "	    FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	    WHERE 1=1	\n "
                + "	    AND STS.FACTORY = DEF.FACTORY	\n "
                + "	    AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	    AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	    AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n "
                + "	    AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	    AND STS.OPER_1 >= 'A0000'	\n "
                + "	    AND STS.OPER_1 <= 'AZ010'	\n "
                + "	    AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	    AND ABR_NO LIKE 'QCN%'	\n "
                + "	    AND STS.DEL_FLAG = ' '	\n "
                + "	    UNION ALL	\n "
                + "	    SELECT '월 평균' AS GUBUN	\n "
                + "	        , ROUND(SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	            WHEN '4' THEN 	\n "
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                            THEN 1	\n "
                + "	                            ELSE 0 	\n "
                + "	                        END	\n "
                + "	            WHEN '3' THEN 	\n "
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                            THEN 1	\n "
                + "	                            ELSE 0 	\n "
                + "	                        END	\n "
                + "	            WHEN '2' THEN 	\n "
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                            THEN 1	\n "
                + "	                            ELSE 0 	\n "
                + "	                        END	\n "
                + "	            WHEN '1' THEN 	\n "
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                            THEN 1	\n "
                + "	                            ELSE 0 	\n "
                + "	                        END	\n "
                + "	          END) / 3) AS QTY_QQ_1	\n "
                + "	        , ROUND(SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	            WHEN '4' THEN 	\n "
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                            THEN 1	\n "
                + "	                            ELSE 0 	\n "
                + "	                        END	\n "
                + "	            WHEN '3' THEN 	\n "
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                            THEN 1	\n "
                + "	                            ELSE 0 	\n "
                + "	                        END	\n "
                + "	            WHEN '2' THEN 	\n "
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                            THEN 1	\n "
                + "	                            ELSE 0 	\n "
                + "	                        END	\n "
                + "	            WHEN '1' THEN 	\n "
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                            THEN 1	\n "
                + "	                            ELSE 0 	\n "
                + "	                        END	\n "
                + "	          END) / 3) AS QTY_QQ_2	\n "
                + "	        , ROUND(SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	            WHEN '4' THEN 	\n "
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                            THEN 1	\n "
                + "	                            ELSE 0 	\n "
                + "	                        END	\n "
                + "	            WHEN '3' THEN 	\n "
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                            THEN 1	\n "
                + "	                            ELSE 0 	\n "
                + "	                        END	\n "
                + "	            WHEN '2' THEN 	\n "
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                            THEN 1	\n "
                + "	                            ELSE 0 	\n "
                + "	                        END	\n "
                + "	            WHEN '1' THEN 	\n "
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                            THEN 1	\n "
                + "	                            ELSE 0 	\n "
                + "	                        END	\n "
                + "	          END) / 3) AS QTY_QQ_3	\n "
                + "	        , 0 AS QTY_MM_1	\n "
                + "	    FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	    WHERE 1=1	\n "
                + "	    AND STS.FACTORY = DEF.FACTORY	\n "
                + "	    AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	    AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	    AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -10)), 'YYYYMMDD')||'220000'	\n "
                + "	    AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	    AND STS.OPER_1 >= 'A0000'	\n "
                + "	    AND STS.OPER_1 <= 'AZ010'	\n "
                + "	    AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	    AND ABR_NO LIKE 'QCN%'	\n "
                + "	    AND STS.DEL_FLAG = ' '	\n "
                + "	)GROUP BY GUBUN 	\n ";

            if (GlobalVariable.gsUserGroup == "ADMIN_GROUP" || GlobalVariable.gsUserGroup == "HANA_ADMIN_GROUP")
            {
                System.Windows.Forms.Clipboard.SetText(QRY.Replace((char)Keys.Tab, ' '));
            }

            return QRY.Replace((char)Keys.Tab, ' ');
        }

        private string MakeSqlString3()
        {
            /****************************************************
             * Comment : DataBase에 저장된 데이터를 조회한다.(일일공정품질 기상도 - 불량 Mode/공정(CCN))
             * 
             * Created By : 김선호(2012-08-17-금요일)
             * 
             * Modified By :
             ****************************************************/

            string QRY = "";

            string date = cdvDate.Value.ToString("yyyyMMddHHmmss");

            QRY = "	SELECT *	\n "
                + "	FROM (	\n "
                + "	    SELECT A.GUBUN	\n "
                + "	        , A.QTY_QQ_1	\n "
                + "	        , CASE WHEN A.QTY_QQ_1 > 0 AND B.TOT_QQ_1 > 0 THEN ROUND(A.QTY_QQ_1 / B.TOT_QQ_1 * 100, 2) ELSE 0 END AS PERCENT_QQ_1	\n "
                + "	        , A.QTY_QQ_2	\n "
                + "	        , CASE WHEN A.QTY_QQ_1 > 0 AND B.TOT_QQ_2 > 0 THEN ROUND(A.QTY_QQ_2 / B.TOT_QQ_2 * 100, 2) ELSE 0 END AS PERCENT_QQ_2	\n "
                + "	        , A.QTY_QQ_3	\n "
                + "	        , CASE WHEN A.QTY_QQ_1 > 0 AND B.TOT_QQ_3 > 0 THEN ROUND(A.QTY_QQ_3 / B.TOT_QQ_3 * 100, 2) ELSE 0 END AS PERCENT_QQ_3	\n "
                + "	        , A.QTY_MM_1	\n "
                + "	        , CASE WHEN A.QTY_MM_1 > 0 AND B.TOT_MM_1 > 0 THEN ROUND(A.QTY_MM_1 / B.TOT_MM_1 * 100, 2) ELSE 0 END AS PERCENT_MM_1	\n "
                + "	    FROM(	\n "
                + "	        SELECT GUBUN	\n "
                + "	            , SUM(QTY_QQ_1) AS QTY_QQ_1	\n "
                + "	            , SUM(QTY_QQ_2) AS QTY_QQ_2	\n "
                + "	            , SUM(QTY_QQ_3) AS QTY_QQ_3	\n "
                + "	            , SUM(QTY_MM_1) AS QTY_MM_1	\n "
                + "	            , SUM(QTY_QQ_2 + QTY_QQ_3) AS TOTAL	\n "
                + "	        FROM (	\n "
                + "	            SELECT DEF.DESC_1 AS GUBUN	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_1	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_2	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_3	\n "
                + "	                , 0 AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -10)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 >= 'A0000'	\n "
                + "	            AND STS.OPER_1 <= 'AZ010'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'CCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            GROUP BY DEF.DESC_1	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT DEF.DESC_1 AS GUBUN	\n "
                + "	                , 0 AS QTY_QQ_1	\n "
                + "	                , 0 AS QTY_QQ_2	\n "
                + "	                , 0 AS QTY_QQ_3	\n "
                + "	                , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n "
                + "	                                AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0)), 'YYYYMMDD')||'220000'	\n "
                + "	                           THEN 1	\n "
                + "	                           ELSE 0	\n "
                + "	                      END) AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 >= 'A0000'	\n "
                + "	            AND STS.OPER_1 <= 'AZ010'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'CCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            GROUP BY DEF.DESC_1	\n "
                + "	        )GROUP BY GUBUN	\n "
                + "	    )A,	\n "
                + "	    (	\n "
                + "	        SELECT GUBUN	\n "
                + "	            , SUM(QTY_QQ_1) AS TOT_QQ_1	\n "
                + "	            , SUM(QTY_QQ_2) AS TOT_QQ_2	\n "
                + "	            , SUM(QTY_QQ_3) AS TOT_QQ_3	\n "
                + "	            , SUM(QTY_MM_1) AS TOT_MM_1	\n "
                + "	        FROM (	\n "
                + "	            SELECT 'TOTAL' AS GUBUN	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_1	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_2	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_3	\n "
                + "	                , 0 AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -10)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 >= 'A0000'	\n "
                + "	            AND STS.OPER_1 <= 'AZ010'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'CCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT 'TOTAL' AS GUBUN	\n "
                + "	                , 0 AS QTY_QQ_1	\n "
                + "	                , 0 AS QTY_QQ_2	\n "
                + "	                , 0 AS QTY_QQ_3	\n "
                + "	                , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n "
                + "	                                AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0)), 'YYYYMMDD')||'220000'	\n "
                + "	                           THEN 1	\n "
                + "	                           ELSE 0	\n "
                + "	                      END) AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 >= 'A0000'	\n "
                + "	            AND STS.OPER_1 <= 'AZ010'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'CCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	        )GROUP BY GUBUN	\n "
                + "	    )B	\n "
                + "	    ORDER BY TOTAL DESC	\n "
                + "	)WHERE ROWNUM <= 7	\n "
                + "	UNION ALL	\n "
                + "	SELECT *	\n "
                + "	FROM (    	\n "
                + "	    SELECT A.GUBUN AS GUBUN	\n "
                + "	        , QTY_QQ_1	\n "
                + "	        , CASE WHEN A.QTY_QQ_1 > 0 AND B.TOT_QTY_QQ_1 > 0 THEN ROUND(A.QTY_QQ_1 / B.TOT_QTY_QQ_1 * 100, 2) ELSE 0 END AS PERCENT_QQ_1	\n "
                + "	        , QTY_QQ_2	\n "
                + "	        , CASE WHEN A.QTY_QQ_1 > 0 AND B.TOT_QTY_QQ_2 > 0 THEN ROUND(A.QTY_QQ_2 / B.TOT_QTY_QQ_2 * 100, 2) ELSE 0 END AS PERCENT_QQ_2	\n "
                + "	        , QTY_QQ_3	\n "
                + "	        , CASE WHEN A.QTY_QQ_1 > 0 AND B.TOT_QTY_QQ_3 > 0 THEN ROUND(A.QTY_QQ_3 / B.TOT_QTY_QQ_3 * 100, 2) ELSE 0 END AS PERCENT_QQ_3	\n "
                + "	        , QTY_MM_1	\n "
                + "	        , CASE WHEN A.QTY_MM_1 > 0 AND B.TOT_QTY_MM_1 > 0 THEN ROUND(A.QTY_MM_1 / B.TOT_QTY_MM_1 * 100, 2) ELSE 0 END AS PERCENT_MM_1	\n "
                + "	    FROM(	\n "
                + "	        SELECT GUBUN	\n "
                + "	            , SUM(QTY_QQ_1) AS QTY_QQ_1	\n "
                + "	            , SUM(QTY_QQ_2) AS QTY_QQ_2	\n "
                + "	            , SUM(QTY_QQ_3) AS QTY_QQ_3	\n "
                + "	            , SUM(QTY_MM_1) AS QTY_MM_1	\n "
                + "	            , SUM(QTY_QQ_2 + QTY_QQ_3) AS TOTAL	\n "
                + "	        FROM (	\n "
                + "	            SELECT 'B/G' AS GUBUN	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_1	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_2	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_3	\n "
                + "	                , 0 AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -10)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 = 'A0040'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'CCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT 'B/G' AS GUBUN	\n "
                + "	                , 0 AS QTY_QQ_1	\n "
                + "	                , 0 AS QTY_QQ_2	\n "
                + "	                , 0 AS QTY_QQ_3	\n "
                + "	                , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n "
                + "	                                AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0)), 'YYYYMMDD')||'220000'	\n "
                + "	                           THEN 1	\n "
                + "	                           ELSE 0	\n "
                + "	                      END) AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 = 'A0040'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'CCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT 'SAW' AS GUBUN	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_1	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_2	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_3	\n "
                + "	                , 0 AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -10)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 = 'A0200'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'CCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT 'SAW' AS GUBUN	\n "
                + "	                , 0 AS QTY_QQ_1	\n "
                + "	                , 0 AS QTY_QQ_2	\n "
                + "	                , 0 AS QTY_QQ_3	\n "
                + "	                , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n "
                + "	                                AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0)), 'YYYYMMDD')||'220000'	\n "
                + "	                           THEN 1	\n "
                + "	                           ELSE 0	\n "
                + "	                      END) AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 = 'A0200'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'CCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT 'D/A' AS GUBUN	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_1	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_2	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_3	\n "
                + "	                , 0 AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -10)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 >= 'A0400'	\n "
                + "	            AND STS.OPER_1 <= 'A0409'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'CCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT 'D/A' AS GUBUN	\n "
                + "	                , 0 AS QTY_QQ_1	\n "
                + "	                , 0 AS QTY_QQ_2	\n "
                + "	                , 0 AS QTY_QQ_3	\n "
                + "	                , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n "
                + "	                                AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0)), 'YYYYMMDD')||'220000'	\n "
                + "	                           THEN 1	\n "
                + "	                           ELSE 0	\n "
                + "	                      END) AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 >= 'A0400'	\n "
                + "	            AND STS.OPER_1 <= 'A0409'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'CCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT 'W/B' AS GUBUN	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_1	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_2	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_3	\n "
                + "	                , 0 AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -10)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 >= 'A0600'	\n "
                + "	            AND STS.OPER_1 <= 'A0609'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'CCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT 'W/B' AS GUBUN	\n "
                + "	                , 0 AS QTY_QQ_1	\n "
                + "	                , 0 AS QTY_QQ_2	\n "
                + "	                , 0 AS QTY_QQ_3	\n "
                + "	                , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n "
                + "	                                AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0)), 'YYYYMMDD')||'220000'	\n "
                + "	                           THEN 1	\n "
                + "	                           ELSE 0	\n "
                + "	                      END) AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 >= 'A0600'	\n "
                + "	            AND STS.OPER_1 <= 'A0609'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'CCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT 'M/D' AS GUBUN	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_1	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_2	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_3	\n "
                + "	                , 0 AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -10)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 = 'A1000'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'CCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT 'M/D' AS GUBUN	\n "
                + "	                , 0 AS QTY_QQ_1	\n "
                + "	                , 0 AS QTY_QQ_2	\n "
                + "	                , 0 AS QTY_QQ_3	\n "
                + "	                , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n "
                + "	                                AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0)), 'YYYYMMDD')||'220000'	\n "
                + "	                           THEN 1	\n "
                + "	                           ELSE 0	\n "
                + "	                      END) AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 = 'A1000'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'CCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT 'M/K' AS GUBUN	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_1	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_2	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_3	\n "
                + "	                , 0 AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -10)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 >= 'A1110'	\n "
                + "	            AND STS.OPER_1 <= 'A1150'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'CCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT 'M/K' AS GUBUN	\n "
                + "	                , 0 AS QTY_QQ_1	\n "
                + "	                , 0 AS QTY_QQ_2	\n "
                + "	                , 0 AS QTY_QQ_3	\n "
                + "	                , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n "
                + "	                                AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0)), 'YYYYMMDD')||'220000'	\n "
                + "	                           THEN 1	\n "
                + "	                           ELSE 0	\n "
                + "	                      END) AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 >= 'A1110'	\n "
                + "	            AND STS.OPER_1 <= 'A1150'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'CCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT 'SBA' AS GUBUN	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_1	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_2	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_3	\n "
                + "	                , 0 AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -10)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 = 'A1300'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'CCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT 'SBA' AS GUBUN	\n "
                + "	                , 0 AS QTY_QQ_1	\n "
                + "	                , 0 AS QTY_QQ_2	\n "
                + "	                , 0 AS QTY_QQ_3	\n "
                + "	                , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n "
                + "	                                AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0)), 'YYYYMMDD')||'220000'	\n "
                + "	                           THEN 1	\n "
                + "	                           ELSE 0	\n "
                + "	                      END) AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 = 'A1300'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'CCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT 'SST' AS GUBUN	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_1	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_2	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_3	\n "
                + "	                , 0 AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -10)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 >= 'A1720'	\n "
                + "	            AND STS.OPER_1 <= 'A1750'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'CCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT 'SST' AS GUBUN	\n "
                + "	                , 0 AS QTY_QQ_1	\n "
                + "	                , 0 AS QTY_QQ_2	\n "
                + "	                , 0 AS QTY_QQ_3	\n "
                + "	                , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n "
                + "	                                AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0)), 'YYYYMMDD')||'220000'	\n "
                + "	                           THEN 1	\n "
                + "	                           ELSE 0	\n "
                + "	                      END) AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 >= 'A1720'	\n "
                + "	            AND STS.OPER_1 <= 'A1750'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'CCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT 'T/F' AS GUBUN	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_1	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_2	\n "
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                    WHEN '4' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '3' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '2' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                    WHEN '1' THEN 	\n "
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                    THEN 1	\n "
                + "	                                    ELSE 0 	\n "
                + "	                                END	\n "
                + "	                  END) AS QTY_QQ_3	\n "
                + "	                , 0 AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -10)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 >= 'A1800'	\n "
                + "	            AND STS.OPER_1 <= 'A1900'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'CCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	            UNION ALL	\n "
                + "	            SELECT 'T/F' AS GUBUN	\n "
                + "	                , 0 AS QTY_QQ_1	\n "
                + "	                , 0 AS QTY_QQ_2	\n "
                + "	                , 0 AS QTY_QQ_3	\n "
                + "	                , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n "
                + "	                                AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0)), 'YYYYMMDD')||'220000'	\n "
                + "	                           THEN 1	\n "
                + "	                           ELSE 0	\n "
                + "	                      END) AS QTY_MM_1	\n "
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	            WHERE 1=1	\n "
                + "	            AND STS.FACTORY = DEF.FACTORY	\n "
                + "	            AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	            AND STS.OPER_1 >= 'A1800'	\n "
                + "	            AND STS.OPER_1 <= 'A1900'	\n "
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	            AND ABR_NO LIKE 'CCN%'	\n "
                + "	            AND STS.DEL_FLAG = ' '	\n "
                + "	        )GROUP BY GUBUN	\n "
                + "	    )A,	\n "
                + "	    (	\n "
                + "	    SELECT GUBUN	\n "
                + "	        , SUM(TOT_QTY_QQ_1) AS TOT_QTY_QQ_1	\n "
                + "	        , SUM(TOT_QTY_QQ_2) AS TOT_QTY_QQ_2	\n "
                + "	        , SUM(TOT_QTY_QQ_3) AS TOT_QTY_QQ_3	\n "
                + "	        , SUM(TOT_QTY_MM_1) AS TOT_QTY_MM_1	\n "
                + "	    FROM (	\n "
                + "	        SELECT 'TOTAL' AS GUBUN	\n "
                + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                WHEN '4' THEN 	\n "
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                THEN 1	\n "
                + "	                                ELSE 0 	\n "
                + "	                            END	\n "
                + "	                WHEN '3' THEN 	\n "
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                THEN 1	\n "
                + "	                                ELSE 0 	\n "
                + "	                            END	\n "
                + "	                WHEN '2' THEN 	\n "
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                THEN 1	\n "
                + "	                                ELSE 0 	\n "
                + "	                            END	\n "
                + "	                WHEN '1' THEN 	\n "
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                THEN 1	\n "
                + "	                                ELSE 0 	\n "
                + "	                            END	\n "
                + "	              END) AS TOT_QTY_QQ_1	\n "
                + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                WHEN '4' THEN 	\n "
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                THEN 1	\n "
                + "	                                ELSE 0 	\n "
                + "	                            END	\n "
                + "	                WHEN '3' THEN 	\n "
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                THEN 1	\n "
                + "	                                ELSE 0 	\n "
                + "	                            END	\n "
                + "	                WHEN '2' THEN 	\n "
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                THEN 1	\n "
                + "	                                ELSE 0 	\n "
                + "	                            END	\n "
                + "	                WHEN '1' THEN 	\n "
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                THEN 1	\n "
                + "	                                ELSE 0 	\n "
                + "	                            END	\n "
                + "	              END) AS TOT_QTY_QQ_2	\n "
                + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + "	                WHEN '4' THEN 	\n "
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                THEN 1	\n "
                + "	                                ELSE 0 	\n "
                + "	                            END	\n "
                + "	                WHEN '3' THEN 	\n "
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                THEN 1	\n "
                + "	                                ELSE 0 	\n "
                + "	                            END	\n "
                + "	                WHEN '2' THEN 	\n "
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                THEN 1	\n "
                + "	                                ELSE 0 	\n "
                + "	                            END	\n "
                + "	                WHEN '1' THEN 	\n "
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + "	                                THEN 1	\n "
                + "	                                ELSE 0 	\n "
                + "	                            END	\n "
                + "	              END) AS TOT_QTY_QQ_3	\n "
                + "	            , 0 AS TOT_QTY_MM_1	\n "
                + "	        FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	        WHERE 1=1	\n "
                + "	        AND STS.FACTORY = DEF.FACTORY	\n "
                + "	        AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	        AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	        AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -10)), 'YYYYMMDD')||'220000'	\n "
                + "	        AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	        AND STS.OPER_1 >= 'A0000'	\n "
                + "	        AND STS.OPER_1 <= 'AZ010'	\n "
                + "	        AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	        AND ABR_NO LIKE 'CCN%'	\n "
                + "	        AND STS.DEL_FLAG = ' '	\n "
                + "	        UNION ALL	\n "
                + "	        SELECT 'TOTAL' AS GUBUN	\n "
                + "	            ,0 AS TOT_QTY_QQ_1	\n "
                + "	            ,0 AS TOT_QTY_QQ_2	\n "
                + "	            ,0 AS TOT_QTY_QQ_3	\n "
                + "	            , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n "
                + "	                            AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0)), 'YYYYMMDD')||'220000'	\n "
                + "	                       THEN 1	\n "
                + "	                       ELSE 0	\n "
                + "	                  END) AS TOT_QTY_MM_1	\n "
                + "	        FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + "	        WHERE 1=1	\n "
                + "	        AND STS.FACTORY = DEF.FACTORY	\n "
                + "	        AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + "	        AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + "	        AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n "
                + "	        AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + "	        AND STS.OPER_1 >= 'A0000'	\n "
                + "	        AND STS.OPER_1 <= 'AZ010'	\n "
                + "	        AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + "	        AND ABR_NO LIKE 'CCN%'	\n "
                + "	        AND STS.DEL_FLAG = ' '	\n "
                + "	        )GROUP BY GUBUN	\n "
                + "	    )B	\n "
                + "	    ORDER BY TOTAL DESC	\n "
                + "	)WHERE ROWNUM <= 3	\n "
                + "	UNION ALL	\n "
                + " SELECT GUBUN	\n "
                + "     , SUM(QTY_QQ_1) AS QTY_QQ_1	\n "
                + "     , 100 AS PERCENT_QQ_1	\n "
                + "     , SUM(QTY_QQ_2) AS QTY_QQ_2	\n "
                + "     , 100 AS PERCENT_QQ_2	\n "
                + "     , SUM(QTY_QQ_3) AS QTY_QQ_3	\n "
                + "     , 100 AS PERCENT_QQ_3	\n "
                + "     , SUM(QTY_MM_1) AS QTY_MM_1	\n "
                + "     , 100 AS PERCENT_MM_1	\n "
                + " FROM (	\n "
                + " 	SELECT 'TOTAL' AS GUBUN	\n "
                + " 	    , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + " 		WHEN '4' THEN	\n "
                + " 			    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + " 					AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + " 				THEN 1	\n "
                + " 				ELSE 0	\n "
                + " 			    END	\n "
                + " 		WHEN '3' THEN	\n "
                + " 			    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + " 					AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + " 				THEN 1	\n "
                + " 				ELSE 0	\n "
                + " 			    END	\n "
                + " 		WHEN '2' THEN	\n "
                + " 			    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + " 					AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + " 				THEN 1	\n "
                + " 				ELSE 0	\n "
                + " 			    END	\n "
                + " 		WHEN '1' THEN	\n "
                + " 			    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + " 					AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + " 				THEN 1	\n "
                + " 				ELSE 0	\n "
                + " 			    END	\n "
                + " 	      END) AS QTY_QQ_1	\n "
                + " 	    , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + " 		WHEN '4' THEN	\n "
                + " 			    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + " 					AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + " 				THEN 1	\n "
                + " 				ELSE 0	\n "
                + " 			    END	\n "
                + " 		WHEN '3' THEN	\n "
                + " 			    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + " 					AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + " 				THEN 1	\n "
                + " 				ELSE 0	\n "
                + " 			    END	\n "
                + " 		WHEN '2' THEN	\n "
                + " 			    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + " 					AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + " 				THEN 1	\n "
                + " 				ELSE 0	\n "
                + " 			    END	\n "
                + " 		WHEN '1' THEN	\n "
                + " 			    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + " 					AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + " 				THEN 1	\n "
                + " 				ELSE 0	\n "
                + " 			    END	\n "
                + " 	      END) AS QTY_QQ_2	\n "
                + " 	    , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + " 		WHEN '4' THEN	\n "
                + " 			    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + " 					AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + " 				THEN 1	\n "
                + " 				ELSE 0	\n "
                + " 			    END	\n "
                + " 		WHEN '3' THEN	\n "
                + " 			    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + " 					AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + " 				THEN 1	\n "
                + " 				ELSE 0	\n "
                + " 			    END	\n "
                + " 		WHEN '2' THEN	\n "
                + " 			    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + " 					AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + " 				THEN 1	\n "
                + " 				ELSE 0	\n "
                + " 			    END	\n "
                + " 		WHEN '1' THEN	\n "
                + " 			    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + " 					AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + " 				THEN 1	\n "
                + " 				ELSE 0	\n "
                + " 			    END	\n "
                + " 	      END) AS QTY_QQ_3	\n "
                + " 	    , 0 AS QTY_MM_1	\n "
                + " 	FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + " 	WHERE 1=1	\n "
                + " 	AND STS.FACTORY = DEF.FACTORY	\n "
                + " 	AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + " 	AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + " 	AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -10)), 'YYYYMMDD')||'220000'	\n "
                + " 	AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + " 	AND STS.OPER_1 >= 'A0000'	\n "
                + " 	AND STS.OPER_1 <= 'AZ010'	\n "
                + " 	AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + " 	AND ABR_NO LIKE 'CCN%'	\n "
                + " 	AND STS.DEL_FLAG = ' '	\n "
                + " 	UNION ALL	\n "
                + " 	SELECT 'TOTAL' AS GUBUN	\n "
                + " 	    , 0 AS QTY_QQ_1	\n "
                + " 	    , 0 AS QTY_QQ_2	\n "
                + " 	    , 0 AS QTY_QQ_3	\n "
                + " 	    , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n "
                + " 			    AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0)), 'YYYYMMDD')||'220000'	\n "
                + " 		       THEN 1	\n "
                + " 		       ELSE 0	\n "
                + " 		  END) AS QTY_MM_1	\n "
                + " 	FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + " 	WHERE 1=1	\n "
                + " 	AND STS.FACTORY = DEF.FACTORY	\n "
                + " 	AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + " 	AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + " 	AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n "
                + " 	AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + " 	AND STS.OPER_1 >= 'A0000'	\n "
                + " 	AND STS.OPER_1 <= 'AZ010'	\n "
                + " 	AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + " 	AND ABR_NO LIKE 'CCN%'	\n "
                + " 	AND STS.DEL_FLAG = ' '	\n "
                + " 	UNION ALL	\n "
                + " 	SELECT '월 평균' AS GUBUN	\n "
                + " 	    , ROUND(SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + " 		WHEN '4' THEN	\n "
                + " 			    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + " 					AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + " 				THEN 1	\n "
                + " 				ELSE 0	\n "
                + " 			    END	\n "
                + " 		WHEN '3' THEN	\n "
                + " 			    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + " 					AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + " 				THEN 1	\n "
                + " 				ELSE 0	\n "
                + " 			    END	\n "
                + " 		WHEN '2' THEN	\n "
                + " 			    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + " 					AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + " 				THEN 1	\n "
                + " 				ELSE 0	\n "
                + " 			    END	\n "
                + " 		WHEN '1' THEN	\n "
                + " 			    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + " 					AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + " 				THEN 1	\n "
                + " 				ELSE 0	\n "
                + " 			    END	\n "
                + " 	      END) / 3) AS QTY_QQ_1	\n "
                + " 	    , ROUND(SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + " 		WHEN '4' THEN	\n "
                + " 			    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + " 					AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + " 				THEN 1	\n "
                + " 				ELSE 0	\n "
                + " 			    END	\n "
                + " 		WHEN '3' THEN	\n "
                + " 			    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + " 					AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + " 				THEN 1	\n "
                + " 				ELSE 0	\n "
                + " 			    END	\n "
                + " 		WHEN '2' THEN	\n "
                + " 			    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + " 					AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + " 				THEN 1	\n "
                + " 				ELSE 0	\n "
                + " 			    END	\n "
                + " 		WHEN '1' THEN	\n "
                + " 			    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + " 					AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + " 				THEN 1	\n "
                + " 				ELSE 0	\n "
                + " 			    END	\n "
                + " 	      END) / 3) AS QTY_QQ_2	\n "
                + " 	    , ROUND(SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n "
                + " 		WHEN '4' THEN	\n "
                + " 			    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + " 					AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + " 				THEN 1	\n "
                + " 				ELSE 0	\n "
                + " 			    END	\n "
                + " 		WHEN '3' THEN	\n "
                + " 			    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + " 					AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + " 				THEN 1	\n "
                + " 				ELSE 0	\n "
                + " 			    END	\n "
                + " 		WHEN '2' THEN	\n "
                + " 			    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + " 					AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + " 				THEN 1	\n "
                + " 				ELSE 0	\n "
                + " 			    END	\n "
                + " 		WHEN '1' THEN	\n "
                + " 			    CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n "
                + " 					AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n "
                + " 				THEN 1	\n "
                + " 				ELSE 0	\n "
                + " 			    END	\n "
                + " 	      END) / 3) AS QTY_QQ_3	\n "
                + " 	    , 0 AS QTY_MM_1	\n "
                + " 	FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n "
                + " 	WHERE 1=1	\n "
                + " 	AND STS.FACTORY = DEF.FACTORY	\n "
                + " 	AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n "
                + " 	AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n "
                + " 	AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -10)), 'YYYYMMDD')||'220000'	\n "
                + " 	AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n "
                + " 	AND STS.OPER_1 >= 'A0000'	\n "
                + " 	AND STS.OPER_1 <= 'AZ010'	\n "
                + " 	AND CLOSE_FLAG IN ( ' ', 'Y')	\n "
                + " 	AND ABR_NO LIKE 'CCN%'	\n "
                + " 	AND STS.DEL_FLAG = ' '	\n "
                + " )GROUP BY GUBUN	\n ";

            if (GlobalVariable.gsUserGroup == "ADMIN_GROUP" || GlobalVariable.gsUserGroup == "HANA_ADMIN_GROUP")
            {
                System.Windows.Forms.Clipboard.SetText(QRY.Replace((char)Keys.Tab, ' '));
            }

            return QRY.Replace((char)Keys.Tab, ' ');
        }

        private bool MakeSheetData(DataTable dt)
        {
            /****************************************************
            * Comment : DataBase에서 조회한 데이터를 가공하여 Sheet에 뿌려준다.(공정품질 기상도)
            * 
            * Created By : 김선호(2012-08-16-목요일)
            * 
            * Modified By :
            ****************************************************/
            try
            {
                Image weatherImg = null;

                int i = 0;

                // 조회하여 가져온 데이터를 알맞은 Cell에 값을 채운 후 기준값에 따라 날씨 이미지를 맵핑한다.
                for (int irow = 1; irow < spdData_Sheet1.RowCount - 1; irow += 2)
                {
                    for (int icol = 3; icol < dt.Columns.Count; icol++)
                    {
                        spdData_Sheet1.Cells[irow, icol].Value = dt.Rows[i][icol].ToString();

                        if (irow >= 1 && irow <= 5)
                        {
                            if (CmnFunction.ToDbl(dt.Rows[i][icol]) <= 1.0)
                            {
                                weatherImg = Properties.Resources.Best;
                            }
                            else if (CmnFunction.ToDbl(dt.Rows[i][icol]) >= 1.01 && CmnFunction.ToDbl(dt.Rows[i][icol]) <= 1.46)
                            {
                                weatherImg = Properties.Resources.Good;
                            }
                            else if (CmnFunction.ToDbl(dt.Rows[i][icol]) >= 1.47 && CmnFunction.ToDbl(dt.Rows[i][icol]) <= 1.91)
                            {
                                weatherImg = Properties.Resources.Warning;
                            }
                            else if (CmnFunction.ToDbl(dt.Rows[i][icol]) >= 1.92 && CmnFunction.ToDbl(dt.Rows[i][icol]) <= 2.37)
                            {
                                weatherImg = Properties.Resources.Bad;
                            }
                            else
                            {
                                weatherImg = Properties.Resources.Worst;
                            }
                            spdData_Sheet1.Cells[irow + 1, icol].Value = weatherImg;
                        }
                        else if (irow == 7)
                        {
                            if (CmnFunction.ToDbl(dt.Rows[i][icol]) <= 1.0)
                            {
                                weatherImg = Properties.Resources.Best;
                            }
                            else if (CmnFunction.ToDbl(dt.Rows[i][icol]) >= 1.01 && CmnFunction.ToDbl(dt.Rows[i][icol]) <= 1.69)
                            {
                                weatherImg = Properties.Resources.Good;
                            }
                            else if (CmnFunction.ToDbl(dt.Rows[i][icol]) >= 1.70 && CmnFunction.ToDbl(dt.Rows[i][icol]) <= 2.40)
                            {
                                weatherImg = Properties.Resources.Warning;
                            }
                            else if (CmnFunction.ToDbl(dt.Rows[i][icol]) >= 2.41 && CmnFunction.ToDbl(dt.Rows[i][icol]) <= 3.10)
                            {
                                weatherImg = Properties.Resources.Bad;
                            }
                            else
                            {
                                weatherImg = Properties.Resources.Worst;
                            }
                            spdData_Sheet1.Cells[irow + 1, icol].Value = weatherImg;
                        }
                    }
                    i++;
                }

                // 공정품질 기상도를 판단하여 값을 채운다.
                for(int icol = 3; icol < spdData_Sheet1.ColumnCount; icol++)
                {
                    if (CmnFunction.ToDbl(spdData_Sheet1.Cells[1, icol].Value) <= 1.46 && CmnFunction.ToDbl(spdData_Sheet1.Cells[3, icol].Value) <= 1.46
                        && CmnFunction.ToDbl(spdData_Sheet1.Cells[5, icol].Value) <= 1.46 && CmnFunction.ToDbl(spdData_Sheet1.Cells[7, icol].Value) <= 1.69)
                    {
                            spdData_Sheet1.Cells[0, icol].ForeColor = Color.Blue;
                            spdData_Sheet1.Cells[0, icol].Value = "만족";
                    }
                    else
                    {
                        spdData_Sheet1.Cells[0, icol].ForeColor = Color.Red;
                        spdData_Sheet1.Cells[0, icol].Value = "위험";
                    }
                }

                spdData.RPT_AutoFit(false);

                return true;
            }
            catch (Exception ex)
            {
                CmnFunction.ShowMsgBox(ex.Message);
                return false;
            }
        }

        private bool MakeSheetData1(DataTable dt)
        {
            /****************************************************
            * Comment : DataBase에서 조회한 데이터를 가공하여 Sheet에 뿌려준다.(품질기상도/LRR)
            * 
            * Created By : 김선호(2012-08-16-목요일)
            * 
            * Modified By :
            ****************************************************/
            try
            {
                int i = 1;

                for (int icol = 1; icol < spdData_Sheet1.ColumnCount; icol++)
                {
                    if (icol == 1 || icol == 4 || icol == 8)
                    {
                        spdData_Sheet1.Cells[1, icol].Value = dt.Rows[0][i].ToString() + "%";

                        if (icol == 1 || icol == 4)
                        {
                            if (CmnFunction.ToDbl(dt.Rows[0][i]) <= 1.46)
                            {
                                spdData_Sheet1.Cells[0, icol].ForeColor = Color.Blue;
                                spdData_Sheet1.Cells[0, icol].Value = "만족";
                            }
                            else
                            {
                                spdData_Sheet1.Cells[0, icol].ForeColor = Color.Red;
                                spdData_Sheet1.Cells[0, icol].Value = "위험";
                            }
                        }
                        if (icol == 8)
                        {
                            if (CmnFunction.ToDbl(dt.Rows[0][1]) - CmnFunction.ToDbl(dt.Rows[0][2]) > 0)
                            {
                                spdData_Sheet1.Cells[0, icol].Value = "▼";
                            }
                            else
                            {
                                spdData_Sheet1.Cells[0, icol].Value = "▲";
                            }
                        }

                        i++;
                    }
                    else if (icol == 10 || icol == 13 || icol == 17)
                    {
                        spdData_Sheet1.Cells[1, icol].Value = dt.Rows[0][i].ToString() + "%";

                        if (icol == 10 || icol == 13)
                        {
                            if (CmnFunction.ToDbl(dt.Rows[0][i]) <= 1.69)
                            {
                                spdData_Sheet1.Cells[0, icol].ForeColor = Color.Blue;
                                spdData_Sheet1.Cells[0, icol].Value = "만족";
                            }
                            else
                            {
                                spdData_Sheet1.Cells[0, icol].ForeColor = Color.Red;
                                spdData_Sheet1.Cells[0, icol].Value = "위험";
                            }
                        }
                        if (icol == 17)
                        {
                            if (CmnFunction.ToDbl(dt.Rows[0][4]) - CmnFunction.ToDbl(dt.Rows[0][5]) > 0)
                            {
                                spdData_Sheet1.Cells[0, 17].Value = "▼";
                            }
                            else
                            {
                                spdData_Sheet1.Cells[0, 17].Value = "▲";
                            }
                        }
                        i++;
                    }
                }
                spdData.RPT_AutoFit(false);

                return true;
            }
            catch (Exception ex)
            {
                CmnFunction.ShowMsgBox(ex.Message);
                return false;
            }
        }

        private bool MakeSheetData2(DataTable dt, int iselCol)
        {
            /****************************************************
            * Comment : DataBase에서 조회한 데이터를 가공하여 Sheet에 뿌려준다.(불량 Mode/공정)
            * 
            * Created By : 김선호(2012-08-16-목요일)
            * 
            * Modified By :
            ****************************************************/
            try
            {
                for (int irow = 0; irow < dt.Rows.Count; irow++)
                {
                    for (int icol = 0; icol < dt.Columns.Count; icol++)
                    {
                        spdData_Sheet1.Cells[irow + 4, icol + iselCol].Value = dt.Rows[irow][icol].ToString();
                    }
                }
                

                spdData.RPT_AutoFit(false);

                return true;
            }
            catch (Exception ex)
            {
                CmnFunction.ShowMsgBox(ex.Message);
                return false;
            }
        }

        #endregion


        #region " Form Event "

        private void btnView_Click(object sender, EventArgs e)
        {
            /****************************************************
             * Comment : View Button을 클릭하면
             * 
             * Created By : 김선호(2012-08-14-화요일)
             * 
             * Modified By : 
             ****************************************************/
            try
            {
                Cursor.Current = Cursors.WaitCursor;

                fnDataFind();
            }
            catch (Exception ex)
            {
                CmnFunction.ShowMsgBox(ex.Message);
                return;
            }
            finally
            {
                Cursor.Current = Cursors.Default;
            }
        }

        private void btnExcelExport_Click(object sender, EventArgs e)
        {
            /****************************************************
             * Comment : Excel Export Button을 클릭하면
             * 
             * Created By : 김선호(2012-08-14-화요일)
             * 
             * Modified By :
             ****************************************************/
            try
            {
                Cursor.Current = Cursors.WaitCursor;

                spdData.ExportExcel();
            }
            catch (Exception ex)
            {
                CmnFunction.ShowMsgBox(ex.Message);
                return;
            }
            finally
            {
                Cursor.Current = Cursors.Default;
            }
        }

        private void cboGraph_SelectedIndexChanged(object sender, EventArgs e)
        {
            InitSpreadSheet();
        }

        private void cdvDate_CloseUp(object sender, EventArgs e)
        {
            fnSSInitial();
        }

        #endregion

    }
}