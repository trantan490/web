using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Drawing;
using System.Data;
using System.Text;
using System.Windows.Forms;

using Miracom.UI;
using Miracom.SmartWeb;
using Miracom.SmartWeb.UI;
using Miracom.SmartWeb.FWX;
using Miracom.SmartWeb.UI.Controls;

namespace Hana.PQC
{
    public partial class PQC031203 : Miracom.SmartWeb.UI.Controls.udcCUSReport002
    {
        private bool isGraphChange = true;

        #region " PQC031203 : Program Initial "

        public PQC031203()
        {
            InitializeComponent();

            pnlTrend.Dock = DockStyle.Fill;
            pnlList.Dock = DockStyle.Fill;

            this.SetFactory(GlobalVariable.gsAssyDefaultFactory);
            cdvFactory.Text = GlobalVariable.gsAssyDefaultFactory;

            cdvDate.Value = System.DateTime.Now;

            cboGraph.SelectedIndex = 0;
            isGraphChange = true;
        }

        #endregion


        #region " Common Function "

        private void fnSSInitial(Miracom.SmartWeb.UI.Controls.udcFarPoint SS)
        {
            /****************************************************
             * Comment : SS의 Header를 설정한다.
             * 
             * Created By : 김선호(2012-07-26-목요일)
             * 
             * Modified By : 
             ****************************************************/

            // 분기
            string squery1 = "";
            DataTable dtQuarter = null;
            //월
            string squery2 = "";
            DataTable dtMonth = null;
            //주차
            string squery3 = "";
            DataTable dtWeek = null;
            // 목요일 가져오기
            string squeryThu = "";
            DataTable dtThu = null;
            //일가져오기
            string squery4 = "";
            DataTable dtDay = null;

            int iindex = 0;
            try
            {
                Cursor.Current = Cursors.WaitCursor;

                SS.RPT_ColumnInit();
                
                string todate = cdvDate.Value.ToString("yyyyMMddHHmmss");

                switch (cboGraph.SelectedIndex)
                {
                    #region - QCN Total/월별 Trend

                    case 0:

                        squery1 = "SELECT CASE WHEN TO_CHAR(TO_DATE('" + todate + "'), 'Q') - 3 > 0 \n"
                            + "            THEN SUBSTR(TO_CHAR(TO_DATE('" + todate + "'),'YYYY'),3,2) || 'Y ' || TO_CHAR(TO_CHAR(TO_DATE('" + todate + "'), 'Q') - 3) || 'Q' \n"
                            + "            WHEN TO_CHAR(TO_DATE('" + todate + "'), 'Q') - 3 = 0 \n"
                            + "            THEN SUBSTR(TO_CHAR(TO_DATE('" + todate + "'),'YYYY'),3,2) - 1 || 'Y ' || '4' || 'Q' \n"
                            + "            WHEN TO_CHAR(TO_DATE('" + todate + "'), 'Q') - 3 = -1 \n"
                            + "            THEN SUBSTR(TO_CHAR(TO_DATE('" + todate + "'),'YYYY'),3,2) - 1 || 'Y ' || '3' || 'Q' \n"
                            + "            WHEN TO_CHAR(TO_DATE('" + todate + "'), 'Q') - 3 = -2 \n"
                            + "            THEN SUBSTR(TO_CHAR(TO_DATE('" + todate + "'),'YYYY'),3,2) - 1 || 'Y ' || '2' || 'Q' \n"
                            + "       END AS Q4, \n"
                            + "       CASE WHEN TO_CHAR(TO_DATE('" + todate + "'), 'Q') - 2 > 0 \n"
                            + "            THEN SUBSTR(TO_CHAR(TO_DATE('" + todate + "'),'YYYY'),3,2) || 'Y ' || TO_CHAR(TO_CHAR(TO_DATE('" + todate + "'), 'Q') - 2)|| 'Q' \n"
                            + "            WHEN TO_CHAR(TO_DATE('" + todate + "'), 'Q') - 2 = 0 \n"
                            + "            THEN SUBSTR(TO_CHAR(TO_DATE('" + todate + "'),'YYYY'),3,2) - 1 || 'Y ' || '4' || 'Q' \n"
                            + "            WHEN TO_CHAR(TO_DATE('" + todate + "'), 'Q') - 2 = -1 \n"
                            + "            THEN SUBSTR(TO_CHAR(TO_DATE('" + todate + "'),'YYYY'),3,2) - 1 || 'Y ' || '3' || 'Q' \n"
                            + "       END AS Q3, \n"
                            + "       CASE WHEN TO_CHAR(TO_DATE('" + todate + "'), 'Q') - 1 > 0 \n"
                            + "            THEN SUBSTR(TO_CHAR(TO_DATE('" + todate + "'),'YYYY'),3,2) || 'Y ' || TO_CHAR(TO_CHAR(TO_DATE('" + todate + "'), 'Q') - 1)|| 'Q' \n"
                            + "            WHEN TO_CHAR(TO_DATE('" + todate + "'), 'Q') - 1 = 0 \n"
                            + "            THEN SUBSTR(TO_CHAR(TO_DATE('" + todate + "'),'YYYY'),3,2) - 1 || 'Y ' || '4' || 'Q' \n"
                            + "            END AS Q2, \n"
                            + "            SUBSTR(TO_CHAR(TO_DATE('" + todate + "'),'YYYY'),3,2) || 'Y ' || TO_CHAR(TO_DATE('" + todate + "'), 'Q') || 'Q' AS Q1 \n"
                            + "  FROM DUAL";

                        dtQuarter = CmnFunction.oComm.GetFuncDataTable("DYNAMIC", squery1.Replace((char)Keys.Tab, ' '));

                        squery2 = "SELECT SUBSTR(TO_CHAR(TO_DATE('" + todate + "'),'YYYYMM'),5,2)||'월' AS MM4 \n"
                               + "	   , SUBSTR(TO_CHAR(ADD_MONTHS(TO_DATE('" + todate + "'),-1),'YYYYMM'),5,2)||'월' AS MM3 \n"
                               + "	   , SUBSTR(TO_CHAR(ADD_MONTHS(TO_DATE('" + todate + "'),-2),'YYYYMM'),5,2)||'월' AS MM2 \n"
                               + "	   , SUBSTR(TO_CHAR(ADD_MONTHS(TO_DATE('" + todate + "'),-3),'YYYYMM'),5,2)||'월' AS MM1 \n"
                               + "  FROM DUAL";

                        dtMonth = CmnFunction.oComm.GetFuncDataTable("DYNAMIC", squery2.Replace((char)Keys.Tab, ' '));

                        todate = cdvDate.Value.ToString("yyyyMMdd");

                        squery3 = "SELECT DECODE(PLAN_WEEK - 3,-2,51,-1,52, 0,53, PLAN_WEEK - 3)||'주' AS WW1 \n"
                               + "      , DECODE(PLAN_WEEK - 2,-1,52, 0,53, PLAN_WEEK - 2)||'주' AS WW2 \n"
                               + "	    , DECODE(PLAN_WEEK - 1, 0,53, PLAN_WEEK - 1)||'주' AS WW3 \n"
                               + "	    , PLAN_WEEK||'주' AS WW4 \n"
                               + "	 FROM MWIPCALDEF \n"
                               + "	WHERE CALENDAR_ID = 'QC' \n"
                               + "	  AND SYS_DATE = TO_CHAR(TO_DATE('" + todate + "','YYYYMMDD'),'YYYYMMDD')";

                        dtWeek = CmnFunction.oComm.GetFuncDataTable("DYNAMIC", squery3.Replace((char)Keys.Tab, ' '));


                        squeryThu = "SELECT CASE TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD') + 6, 'YYYYMMDD') \n"
                               + "        WHEN '토' THEN TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD') + 5, 'YYYYMMDD') \n"
                               + "        WHEN '일' THEN TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD') + 4, 'YYYYMMDD') \n"
                               + "        WHEN '월' THEN TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD') + 3, 'YYYYMMDD') \n"
                               + "        WHEN '화' THEN TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD') + 2, 'YYYYMMDD') \n"
                               + "        WHEN '수' THEN TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD') + 1, 'YYYYMMDD') \n"
                               + "        WHEN '목' THEN TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD') + 0, 'YYYYMMDD') \n"
                               + "        END AS DAY \n"
                               + "	 FROM DUAL";

                        dtThu = CmnFunction.oComm.GetFuncDataTable("DYNAMIC", squeryThu.Replace((char)Keys.Tab, ' '));

                        squery4 = "SELECT SUBSTR(TO_CHAR(TO_DATE('" + dtThu.Rows[0][0] + "'),'YYYYMMDD'),7,2)||'일(목)' AS DD \n"
                               + "      , SUBSTR(TO_CHAR(TO_DATE('" + dtThu.Rows[0][0] + "')-1,'YYYYMMDD'),7,2)||'일(수)' AS DD1 \n"
                               + "      , SUBSTR(TO_CHAR(TO_DATE('" + dtThu.Rows[0][0] + "')-2,'YYYYMMDD'),7,2)||'일(화)' AS DD2 \n"
                               + "      , SUBSTR(TO_CHAR(TO_DATE('" + dtThu.Rows[0][0] + "')-3,'YYYYMMDD'),7,2)||'일(월)' AS DD3 \n"
                               + "      , SUBSTR(TO_CHAR(TO_DATE('" + dtThu.Rows[0][0] + "')-4,'YYYYMMDD'),7,2)||'일(일)' AS DD4 \n"
                               + "      , SUBSTR(TO_CHAR(TO_DATE('" + dtThu.Rows[0][0] + "')-5,'YYYYMMDD'),7,2)||'일(토)' AS DD5 \n"
                               + "      , SUBSTR(TO_CHAR(TO_DATE('" + dtThu.Rows[0][0] + "')-6,'YYYYMMDD'),7,2)||'일(금)' AS DD6 \n"
                               + "	 FROM DUAL";
                        dtDay = CmnFunction.oComm.GetFuncDataTable("DYNAMIC", squery4.Replace((char)Keys.Tab, ' '));

                        SS.RPT_AddBasicColumn("구 분", 0, iindex, Visibles.True, Frozen.False, Align.Center, Merge.True, Formatter.String, 80);

                        if (dtQuarter.Rows.Count <= 0)
                        {
                            dtQuarter.Dispose();
                            SS.RPT_AddBasicColumn("Q-1", 0, iindex + 1, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn("Q-2", 0, iindex + 2, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn("Q-3", 0, iindex + 3, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn("Q-4", 0, iindex + 4, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                        }
                        else
                        {
                            SS.RPT_AddBasicColumn(dtQuarter.Rows[0][0].ToString(), 0, iindex + 1, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn(dtQuarter.Rows[0][1].ToString(), 0, iindex + 2, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn(dtQuarter.Rows[0][2].ToString(), 0, iindex + 3, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn(dtQuarter.Rows[0][3].ToString(), 0, iindex + 4, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                        }

                        if (dtMonth.Rows.Count <= 0)
                        {
                            dtMonth.Dispose();
                            SS.RPT_AddBasicColumn("MM-1", 0, iindex + 5, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn("MM-2", 0, iindex + 6, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn("MM-3", 0, iindex + 7, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn("MM-4", 0, iindex + 8, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                        }
                        else
                        {
                            SS.RPT_AddBasicColumn(dtMonth.Rows[0][3].ToString(), 0, iindex + 5, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn(dtMonth.Rows[0][2].ToString(), 0, iindex + 6, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn(dtMonth.Rows[0][1].ToString(), 0, iindex + 7, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn(dtMonth.Rows[0][0].ToString(), 0, iindex + 8, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                        }

                        if (dtWeek.Rows.Count <= 0)
                        {
                            dtWeek.Dispose();
                            SS.RPT_AddBasicColumn("WW-4", 0, iindex + 9, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn("WW-3", 0, iindex + 10, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn("WW-2", 0, iindex + 11, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn("WW-1", 0, iindex + 12, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                        }
                        else
                        {
                            SS.RPT_AddBasicColumn(dtWeek.Rows[0][0].ToString(), 0, iindex + 9, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn(dtWeek.Rows[0][1].ToString(), 0, iindex + 10, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn(dtWeek.Rows[0][2].ToString(), 0, iindex + 11, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn(dtWeek.Rows[0][3].ToString(), 0, iindex + 12, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                        }

                        if (dtDay.Rows.Count <= 0)
                        {
                            dtDay.Dispose();
                            SS.RPT_AddBasicColumn("금(-6)", 0, iindex + 13, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn("토(-5)", 0, iindex + 14, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn("일(-4)", 0, iindex + 15, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn("월(-3)", 0, iindex + 16, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn("화(-2)", 0, iindex + 17, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn("수(-1)", 0, iindex + 18, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn("목(-0)", 0, iindex + 19, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                        }
                        else
                        {

                            SS.RPT_AddBasicColumn(dtDay.Rows[0][6].ToString(), 0, iindex + 13, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn(dtDay.Rows[0][5].ToString(), 0, iindex + 14, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn(dtDay.Rows[0][4].ToString(), 0, iindex + 15, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn(dtDay.Rows[0][3].ToString(), 0, iindex + 16, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn(dtDay.Rows[0][2].ToString(), 0, iindex + 17, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn(dtDay.Rows[0][1].ToString(), 0, iindex + 18, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn(dtDay.Rows[0][0].ToString(), 0, iindex + 19, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                        }

                        break;

                    #endregion

                    #region - QCN 발생 건수 Top 2 불량 현황

                    case 2:

                        squery1 = "SELECT CASE WHEN TO_CHAR(TO_DATE('" + todate + "'), 'Q') - 3 > 0 \n"
                            + "            THEN SUBSTR(TO_CHAR(TO_DATE('" + todate + "'),'YYYY'),3,2) || 'Y ' || TO_CHAR(TO_CHAR(TO_DATE('" + todate + "'), 'Q') - 3) || 'Q' \n"
                            + "            WHEN TO_CHAR(TO_DATE('" + todate + "'), 'Q') - 3 = 0 \n"
                            + "            THEN SUBSTR(TO_CHAR(TO_DATE('" + todate + "'),'YYYY'),3,2) - 1 || 'Y ' || '4' || 'Q' \n"
                            + "            WHEN TO_CHAR(TO_DATE('" + todate + "'), 'Q') - 3 = -1 \n"
                            + "            THEN SUBSTR(TO_CHAR(TO_DATE('" + todate + "'),'YYYY'),3,2) - 1 || 'Y ' || '3' || 'Q' \n"
                            + "            WHEN TO_CHAR(TO_DATE('" + todate + "'), 'Q') - 3 = -2 \n"
                            + "            THEN SUBSTR(TO_CHAR(TO_DATE('" + todate + "'),'YYYY'),3,2) - 1 || 'Y ' || '2' || 'Q' \n"
                            + "       END AS Q4, \n"
                            + "       CASE WHEN TO_CHAR(TO_DATE('" + todate + "'), 'Q') - 2 > 0 \n"
                            + "            THEN SUBSTR(TO_CHAR(TO_DATE('" + todate + "'),'YYYY'),3,2) || 'Y ' || TO_CHAR(TO_CHAR(TO_DATE('" + todate + "'), 'Q') - 2)|| 'Q' \n"
                            + "            WHEN TO_CHAR(TO_DATE('" + todate + "'), 'Q') - 2 = 0 \n"
                            + "            THEN SUBSTR(TO_CHAR(TO_DATE('" + todate + "'),'YYYY'),3,2) - 1 || 'Y ' || '4' || 'Q' \n"
                            + "            WHEN TO_CHAR(TO_DATE('" + todate + "'), 'Q') - 2 = -1 \n"
                            + "            THEN SUBSTR(TO_CHAR(TO_DATE('" + todate + "'),'YYYY'),3,2) - 1 || 'Y ' || '3' || 'Q' \n"
                            + "       END AS Q3, \n"
                            + "       CASE WHEN TO_CHAR(TO_DATE('" + todate + "'), 'Q') - 1 > 0 \n"
                            + "            THEN SUBSTR(TO_CHAR(TO_DATE('" + todate + "'),'YYYY'),3,2) || 'Y ' || TO_CHAR(TO_CHAR(TO_DATE('" + todate + "'), 'Q') - 1)|| 'Q' \n"
                            + "            WHEN TO_CHAR(TO_DATE('" + todate + "'), 'Q') - 1 = 0 \n"
                            + "            THEN SUBSTR(TO_CHAR(TO_DATE('" + todate + "'),'YYYY'),3,2) - 1 || 'Y ' || '4' || 'Q' \n"
                            + "            END AS Q2, \n"
                            + "            SUBSTR(TO_CHAR(TO_DATE('" + todate + "'),'YYYY'),3,2) || 'Y ' || TO_CHAR(TO_DATE('" + todate + "'), 'Q') || 'Q' AS Q1 \n"
                            + "  FROM DUAL";

                        dtQuarter = CmnFunction.oComm.GetFuncDataTable("DYNAMIC", squery1.Replace((char)Keys.Tab, ' '));

                        squery2 = "SELECT SUBSTR(TO_CHAR(TO_DATE('" + todate + "'),'YYYYMM'),5,2)||'월' AS MM4 \n"
                               + "	   , SUBSTR(TO_CHAR(ADD_MONTHS(TO_DATE('" + todate + "'),-1),'YYYYMM'),5,2)||'월' AS MM3 \n"
                               + "	   , SUBSTR(TO_CHAR(ADD_MONTHS(TO_DATE('" + todate + "'),-2),'YYYYMM'),5,2)||'월' AS MM2 \n"
                               + "	   , SUBSTR(TO_CHAR(ADD_MONTHS(TO_DATE('" + todate + "'),-3),'YYYYMM'),5,2)||'월' AS MM1 \n"
                               + "  FROM DUAL";

                        dtMonth = CmnFunction.oComm.GetFuncDataTable("DYNAMIC", squery2.Replace((char)Keys.Tab, ' '));

                        squery4 = "SELECT SUBSTR(TO_CHAR(TO_DATE('" + todate + "'),'YYYYMMDD'),7,2)||'일' AS DD \n"
                               + "      , SUBSTR(TO_CHAR(TO_DATE('" + todate + "')-1,'YYYYMMDD'),7,2)||'일' AS DD1 \n"
                               + "      , SUBSTR(TO_CHAR(TO_DATE('" + todate + "')-2,'YYYYMMDD'),7,2)||'일' AS DD2 \n"
                               + "      , SUBSTR(TO_CHAR(TO_DATE('" + todate + "')-3,'YYYYMMDD'),7,2)||'일' AS DD3 \n"
                               + "      , SUBSTR(TO_CHAR(TO_DATE('" + todate + "')-4,'YYYYMMDD'),7,2)||'일' AS DD4 \n"
                               + "	 FROM DUAL";
                        dtDay = CmnFunction.oComm.GetFuncDataTable("DYNAMIC", squery4.Replace((char)Keys.Tab, ' '));

                        SS.RPT_AddBasicColumn("구 분", 0, iindex, Visibles.True, Frozen.False, Align.Center, Merge.True, Formatter.String, 80);

                        if (dtQuarter.Rows.Count <= 0)
                        {
                            dtQuarter.Dispose();
                            SS.RPT_AddBasicColumn("Q-1", 0, iindex + 1, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                            SS.RPT_AddBasicColumn("Q-2", 0, iindex + 2, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                            SS.RPT_AddBasicColumn("Q-3", 0, iindex + 3, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                            SS.RPT_AddBasicColumn("Q-4", 0, iindex + 4, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                        }
                        else
                        {
                            SS.RPT_AddBasicColumn(dtQuarter.Rows[0][0].ToString(), 0, iindex + 1, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                            SS.RPT_AddBasicColumn(dtQuarter.Rows[0][1].ToString(), 0, iindex + 2, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                            SS.RPT_AddBasicColumn(dtQuarter.Rows[0][2].ToString(), 0, iindex + 3, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                            SS.RPT_AddBasicColumn(dtQuarter.Rows[0][3].ToString(), 0, iindex + 4, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                        }

                        if (dtMonth.Rows.Count <= 0)
                        {
                            dtMonth.Dispose();
                            SS.RPT_AddBasicColumn("MM-1", 0, iindex + 5, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                            SS.RPT_AddBasicColumn("MM-2", 0, iindex + 6, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                            SS.RPT_AddBasicColumn("MM-3", 0, iindex + 7, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                            SS.RPT_AddBasicColumn("MM-4", 0, iindex + 8, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                        }
                        else
                        {
                            SS.RPT_AddBasicColumn(dtMonth.Rows[0][3].ToString(), 0, iindex + 5, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                            SS.RPT_AddBasicColumn(dtMonth.Rows[0][2].ToString(), 0, iindex + 6, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                            SS.RPT_AddBasicColumn(dtMonth.Rows[0][1].ToString(), 0, iindex + 7, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                            SS.RPT_AddBasicColumn(dtMonth.Rows[0][0].ToString(), 0, iindex + 8, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                        }

                        if (dtDay.Rows.Count <= 0)
                        {
                            dtDay.Dispose();
                            SS.RPT_AddBasicColumn("DD-1", 0, iindex + 9, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                            SS.RPT_AddBasicColumn("DD-2", 0, iindex + 10, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                            SS.RPT_AddBasicColumn("DD-3", 0, iindex + 11, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                            SS.RPT_AddBasicColumn("DD-4", 0, iindex + 12, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                            SS.RPT_AddBasicColumn("DD-5", 0, iindex + 13, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                        }
                        else
                        {
                            SS.RPT_AddBasicColumn(dtDay.Rows[0][4].ToString(), 0, iindex + 9, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                            SS.RPT_AddBasicColumn(dtDay.Rows[0][3].ToString(), 0, iindex + 10, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                            SS.RPT_AddBasicColumn(dtDay.Rows[0][2].ToString(), 0, iindex + 11, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                            SS.RPT_AddBasicColumn(dtDay.Rows[0][1].ToString(), 0, iindex + 12, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                            SS.RPT_AddBasicColumn(dtDay.Rows[0][0].ToString(), 0, iindex + 13, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                        }

                        break;

                    #endregion
                }
            }
            catch (Exception ex)
            {
                CmnFunction.ShowMsgBox(ex.Message);
                return;
            }
            finally
            {
                Cursor.Current = Cursors.Default;
            }
        }

        private bool fnDataFind()
        {
            /****************************************************
             * Comment : DataBase에 저장된 데이터를 조회한다.(QCN 발생 건수 Top 2 불량 현황)
             * 
             * Created By : 김선호(2012-07-30-월요일)
             * 
             * Modified By :
             ****************************************************/
            DataTable dt = null;
            string QRY = "";
            string fromOper = "";
            string toOper = "";
            try
            {
                Cursor.Current = Cursors.WaitCursor;
                LoadingPopUp.LoadIngPopUpShow(this);

                fnSSInitial(spdData);

                // Sheet / Listview를 초기화 한다.
                CmnInitFunction.ClearList(spdData, true);

                string date = cdvDate.Value.ToString("yyyyMMddHHmmss");

                switch (cboOper.SelectedIndex)
                {
                    case 0:
                        {
                            fromOper = "A0000";
                            toOper = "A0970";
                        }
                        break;

                    case 1:
                        {
                            fromOper = "A1000";
                            toOper = "AZ010";
                        }
                        break;
                }

                #region - QCN 발생 건수 TOP 2 불량 현황 쿼리

                QRY = "	SELECT *	\n"
                    + "	FROM	\n"
                    + "	(	\n"
                    + "	    SELECT DEFECT	\n"
                    + "	        ,QTY_QQ_1,QTY_QQ_2,QTY_QQ_3,QTY_QQ_4	\n"
                    + "	        ,QTY_MM_1,QTY_MM_2,QTY_MM_3,QTY_MM_4	\n"
                    + "	        ,QTY_DD_1,QTY_DD_2,QTY_DD_3,QTY_DD_4,QTY_DD_5	\n"
                    + "	        ,SUM(QTY_QQ_1 + QTY_QQ_2 + QTY_QQ_3 + QTY_QQ_4 + QTY_MM_1 + QTY_MM_2 + QTY_MM_3 + QTY_MM_4 + QTY_DD_1 + QTY_DD_2 + QTY_DD_3 + QTY_DD_4 + QTY_DD_5) AS TOTAL	\n"
                    + "	    FROM	\n"
                    + "	    (	\n"
                    + "	        SELECT DEFECT	\n"
                    + "	                , SUM(QTY_QQ_1) AS QTY_QQ_1, SUM(QTY_QQ_2) AS QTY_QQ_2, SUM(QTY_QQ_3) AS QTY_QQ_3, SUM(QTY_QQ_4) AS QTY_QQ_4	\n"
                    + "	                , SUM(QTY_MM_1) AS QTY_MM_1, SUM(QTY_MM_2) AS QTY_MM_2, SUM(QTY_MM_3) AS QTY_MM_3, SUM(QTY_MM_4) AS QTY_MM_4	\n"
                    + "	                , SUM(QTY_DD_1) AS QTY_DD_1, SUM(QTY_DD_2) AS QTY_DD_2, SUM(QTY_DD_3) AS QTY_DD_3, SUM(QTY_DD_4) AS QTY_DD_4, SUM(QTY_DD_5) AS QTY_DD_5	\n"
                    + "	            FROM (	\n"
                    + "	                SELECT DEF.DESC_1 AS DEFECT	\n"
                    + "	                    , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                    + "	                            WHEN '4' THEN 	\n"
                    + "	                                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                    + "	                                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                    + "	                                            THEN 1	\n"
                    + "	                                            ELSE 0 	\n"
                    + "	                                        END	\n"
                    + "	                            WHEN '3' THEN 	\n"
                    + "	                                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                    + "	                                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                    + "	                                            THEN 1	\n"
                    + "	                                            ELSE 0 	\n"
                    + "	                                        END	\n"
                    + "	                            WHEN '2' THEN 	\n"
                    + "	                                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                    + "	                                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                    + "	                                            THEN 1	\n"
                    + "	                                            ELSE 0 	\n"
                    + "	                                        END	\n"
                    + "	                            WHEN '1' THEN 	\n"
                    + "	                                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                    + "	                                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                    + "	                                            THEN 1	\n"
                    + "	                                            ELSE 0 	\n"
                    + "	                                        END	\n"
                    + "	                          END) AS QTY_QQ_1	\n"
                    + "	                    , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                    + "	                            WHEN '4' THEN 	\n"
                    + "	                                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                    + "	                                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                    + "	                                            THEN 1	\n"
                    + "	                                            ELSE 0 	\n"
                    + "	                                        END	\n"
                    + "	                            WHEN '3' THEN 	\n"
                    + "	                                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                    + "	                                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                    + "	                                            THEN 1	\n"
                    + "	                                            ELSE 0 	\n"
                    + "	                                        END	\n"
                    + "	                            WHEN '2' THEN 	\n"
                    + "	                                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                    + "	                                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                    + "	                                            THEN 1	\n"
                    + "	                                            ELSE 0 	\n"
                    + "	                                        END	\n"
                    + "	                            WHEN '1' THEN 	\n"
                    + "	                                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                    + "	                                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                    + "	                                            THEN 1	\n"
                    + "	                                            ELSE 0 	\n"
                    + "	                                        END	\n"
                    + "	                          END) AS QTY_QQ_2	\n"
                    + "	                    , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                    + "	                            WHEN '4' THEN 	\n"
                    + "	                                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                    + "	                                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                    + "	                                            THEN 1	\n"
                    + "	                                            ELSE 0 	\n"
                    + "	                                        END	\n"
                    + "	                            WHEN '3' THEN 	\n"
                    + "	                                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                    + "	                                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                    + "	                                            THEN 1	\n"
                    + "	                                            ELSE 0 	\n"
                    + "	                                        END	\n"
                    + "	                            WHEN '2' THEN 	\n"
                    + "	                                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                    + "	                                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                    + "	                                            THEN 1	\n"
                    + "	                                            ELSE 0 	\n"
                    + "	                                        END	\n"
                    + "	                            WHEN '1' THEN 	\n"
                    + "	                                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                    + "	                                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                    + "	                                            THEN 1	\n"
                    + "	                                            ELSE 0 	\n"
                    + "	                                        END	\n"
                    + "	                          END) AS QTY_QQ_3	\n"
                    + "	                    , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                    + "	                            WHEN '4' THEN 	\n"
                    + "	                                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                    + "	                                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                    + "	                                            THEN 1	\n"
                    + "	                                            ELSE 0 	\n"
                    + "	                                        END	\n"
                    + "	                            WHEN '3' THEN 	\n"
                    + "	                                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                    + "	                                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                    + "	                                            THEN 1	\n"
                    + "	                                            ELSE 0 	\n"
                    + "	                                        END	\n"
                    + "	                            WHEN '2' THEN 	\n"
                    + "	                                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                    + "	                                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                    + "	                                            THEN 1	\n"
                    + "	                                            ELSE 0 	\n"
                    + "	                                        END	\n"
                    + "	                            WHEN '1' THEN 	\n"
                    + "	                                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                    + "	                                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                    + "	                                            THEN 1	\n"
                    + "	                                            ELSE 0 	\n"
                    + "	                                        END	\n"
                    + "	                          END) AS QTY_QQ_4	\n"
                    + "	                    , 0 AS QTY_MM_1	\n"
                    + "	                    , 0 AS QTY_MM_2	\n"
                    + "	                    , 0 AS QTY_MM_3	\n"
                    + "	                    , 0 AS QTY_MM_4	\n"
                    + "	                    , 0 AS QTY_DD_1	\n"
                    + "	                    , 0 AS QTY_DD_2	\n"
                    + "	                    , 0 AS QTY_DD_3	\n"
                    + "	                    , 0 AS QTY_DD_4	\n"
                    + "	                    , 0 AS QTY_DD_5	\n"
                    + "	                FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n"
                    + "	                WHERE 1=1	\n"
                    + "	                AND STS.FACTORY = DEF.FACTORY	\n"
                    + "	                AND STS.FACTORY = '" + cdvFactory.Text + "'	\n"
                    + "	                AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n"
                    + "	                AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -13)), 'YYYYMMDD')||'220000'	\n"
                    + "	                AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                    + "	                AND STS.OPER_1 >= '" + fromOper + "'	\n"
                    + "	                AND STS.OPER_1 <= '" + toOper + "'	\n"
                    + "	                AND CLOSE_FLAG IN ( ' ', 'Y')	\n"
                    + "	                AND ABR_NO LIKE 'QCN%'	\n"
                    + "	                AND STS.DEL_FLAG = ' '	\n"
                    + "	                GROUP BY DEF.DESC_1	\n"
                    + "	                UNION ALL	\n"
                    + "	                SELECT DEF.DESC_1 AS DEFECT	\n"
                    + "	                    , 0 AS QTY_QQ_1 	\n"
                    + "	                    , 0 AS QTY_QQ_2 	\n"
                    + "	                    , 0 AS QTY_QQ_3 	\n"
                    + "	                    , 0 AS QTY_QQ_4	\n"
                    + "	                    ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                    + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                    + "	                                THEN 1	\n"
                    + "	                                ELSE 0	\n"
                    + "	                         END) AS QTY_MM_1	\n"
                    + "	                    ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                    + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                    + "	                                THEN 1	\n"
                    + "	                                ELSE 0	\n"
                    + "	                         END) AS QTY_MM_2	\n"
                    + "	                    ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                    + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                    + "	                                THEN 1	\n"
                    + "	                                ELSE 0	\n"
                    + "	                         END) AS QTY_MM_3	\n"
                    + "	                    ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                    + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 0)), 'YYYYMMDD')||'220000'	\n"
                    + "	                                THEN 1	\n"
                    + "	                                ELSE 0	\n"
                    + "	                         END) AS QTY_MM_4	\n"
                    + "	                    , 0 AS QTY_DD_1	\n"
                    + "	                    , 0 AS QTY_DD_2	\n"
                    + "	                    , 0 AS QTY_DD_3	\n"
                    + "	                    , 0 AS QTY_DD_4	\n"
                    + "	                    , 0 AS QTY_DD_5	\n"
                    + "	                FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n"
                    + "	                WHERE 1=1	\n"
                    + "	                AND STS.FACTORY = DEF.FACTORY	\n"
                    + "	                AND STS.FACTORY = '" + cdvFactory.Text + "'	\n"
                    + "	                AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n"
                    + "	                AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                    + "	                AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                    + "	                AND STS.OPER_1 >= '" + fromOper + "'	\n"
                    + "	                AND STS.OPER_1 <= '" + toOper + "'	\n"
                    + "	                AND CLOSE_FLAG IN ( ' ', 'Y')	\n"
                    + "	                AND ABR_NO LIKE 'QCN%'	\n"
                    + "	                AND STS.DEL_FLAG = ' '	\n"
                    + "	                GROUP BY DEF.DESC_1	\n"
                    + "	                UNION ALL	\n"
                    + "	                SELECT DEF.DESC_1 AS DEFECT	\n"
                    + "	                    , 0 AS QTY_QQ_1 	\n"
                    + "	                    , 0 AS QTY_QQ_2 	\n"
                    + "	                    , 0 AS QTY_QQ_3 	\n"
                    + "	                    , 0 AS QTY_QQ_4	\n"
                    + "	                    , 0 AS QTY_MM_1 	\n"
                    + "	                    , 0 AS QTY_MM_2 	\n"
                    + "	                    , 0 AS QTY_MM_3 	\n"
                    + "	                    , 0 AS QTY_MM_4	\n"
                    + "	                    ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000'	\n"
                    + "	                                    AND STS.STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000'	\n"
                    + "	                                THEN 1	\n"
                    + "	                                ELSE 0	\n"
                    + "	                         END) AS QTY_DD_1	\n"
                    + "	                    ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000'	\n"
                    + "	                                    AND STS.STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000'	\n"
                    + "	                                THEN 1	\n"
                    + "	                                ELSE 0	\n"
                    + "	                         END) AS QTY_DD_2	\n"
                    + "	                    ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000'	\n"
                    + "	                                    AND STS.STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000'	\n"
                    + "	                                THEN 1	\n"
                    + "	                                ELSE 0	\n"
                    + "	                         END) AS QTY_DD_3	\n"
                    + "	                    ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000'	\n"
                    + "	                                    AND STS.STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000'	\n"
                    + "	                                THEN 1	\n"
                    + "	                                ELSE 0	\n"
                    + "	                         END) AS QTY_DD_4	\n"
                    + "	                    ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000'	\n"
                    + "	                                    AND STS.STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 0, 'YYYYMMDD')||'220000'	\n"
                    + "	                                THEN 1	\n"
                    + "	                                ELSE 0	\n"
                    + "	                         END) AS QTY_DD_5	\n"
                    + "	                FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n"
                    + "	                WHERE 1=1	\n"
                    + "	                AND STS.FACTORY = DEF.FACTORY	\n"
                    + "	                AND STS.FACTORY = '" + cdvFactory.Text + "'	\n"
                    + "	                AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n"
                    + "	                AND STEP10_TIME >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000'	\n"
                    + "	                AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                    + "	                AND STS.OPER_1 >= '" + fromOper + "'	\n"
                    + "	                AND STS.OPER_1 <= '" + toOper + "'	\n"
                    + "	                AND CLOSE_FLAG IN ( ' ', 'Y')	\n"
                    + "	                AND ABR_NO LIKE 'QCN%'	\n"
                    + "	                AND STS.DEL_FLAG = ' '	\n"
                    + "	                GROUP BY DEF.DESC_1	\n"
                    + "	            )GROUP BY DEFECT	\n"
                    + "	    )GROUP BY DEFECT, QTY_QQ_1, QTY_QQ_2, QTY_QQ_3, QTY_QQ_4	\n"
                    + "	        ,QTY_MM_1, QTY_MM_2, QTY_MM_3, QTY_MM_4, QTY_DD_1, QTY_DD_2, QTY_DD_3, QTY_DD_4, QTY_DD_5	\n"
                    + "	    ORDER BY TOTAL DESC	\n"
                    + "	)	\n"
                    + "	WHERE ROWNUM <= 2	\n";

                #endregion

                if (GlobalVariable.gsUserGroup == "ADMIN_GROUP" || GlobalVariable.gsUserGroup == "HANA_ADMIN_GROUP")
                {
                    System.Windows.Forms.Clipboard.SetText(QRY.Replace((char)Keys.Tab, ' '));
                }

                dt = CmnFunction.oComm.GetFuncDataTable("DYNAMIC", QRY.Replace((char)Keys.Tab, ' '));

                if (dt.Rows.Count == 0)
                {
                    dt.Dispose();
                    LoadingPopUp.LoadingPopUpHidden();
                    CmnFunction.ShowMsgBox(RptMessages.GetMessage("STD010", GlobalVariable.gcLanguage));
                    return false;
                }

                dt.Columns.RemoveAt(dt.Columns.Count - 1);

                spdData.DataSource = dt;
                spdData.RPT_AutoFit(false);

                fnMakeChart(spdData, 0, 0);

                return true;
            }
            catch (Exception ex)
            {
                LoadingPopUp.LoadingPopUpHidden();
                MessageBox.Show(ex.Message);
                return false;
            }
            finally
            {
                LoadingPopUp.LoadingPopUpHidden();
                Cursor.Current = Cursors.Default;
            }
        }

        private bool fnDataFind1()
        {
            /****************************************************
             * Comment : DataBase에 저장된 데이터를 조회한다.(QCN Total/월별 Trend)
             * 
             * Created By : 김선호(2012-08-09-목요일)
             * 
             * Modified By :
             ****************************************************/
            DataTable dt1 = null;
            DataTable dt2 = null;
            DataTable dt3 = null;

            //string QRY = "";
            int step = 1;
            int selrow = 0;
            try
            {
                Cursor.Current = Cursors.WaitCursor;
                LoadingPopUp.LoadIngPopUpShow(this);

                string date = cdvDate.Value.ToString("yyyyMMddHHmmss");

                switch (cboOper.SelectedIndex)
                {
                    case 0:
                        step = 1;
                        selrow = 3;
                        break;
                    case 1:
                        step = 2;
                        selrow = 8;
                        break;
                }

                // Sheet / Listview를 초기화 한다.
                if (isGraphChange == true)
                {
                    fnSSInitial(spdData);
                    CmnInitFunction.ClearList(spdData, true);
                }
                else
                {
                    fnMakeChart(spdData, selrow, step);
                    return true;
                }


                #region - QCN Total/월별 Trend 쿼리

                //QRY = "	SELECT GUBUN	\n"
                //    + "	    , SUM(QTY_QQ_1) AS QTY_QQ_1	\n"
                //    + "	    , SUM(QTY_QQ_2) AS QTY_QQ_2	\n"
                //    + "	    , SUM(QTY_QQ_3) AS QTY_QQ_3	\n"
                //    + "	    , SUM(QTY_QQ_4) AS QTY_QQ_4	\n"
                //    + "	    , SUM(QTY_MM_1) AS QTY_MM_1	\n"
                //    + "	    , SUM(QTY_MM_2) AS QTY_MM_2	\n"
                //    + "	    , SUM(QTY_MM_3) AS QTY_MM_3	\n"
                //    + "	    , SUM(QTY_MM_4) AS QTY_MM_4	\n"
                //    + "	    , SUM(QTY_WW_1) AS QTY_WW_1	\n"
                //    + "	    , SUM(QTY_WW_2) AS QTY_WW_2	\n"
                //    + "	    , SUM(QTY_WW_3) AS QTY_WW_3	\n"
                //    + "	    , SUM(QTY_WW_4) AS QTY_WW_4	\n"
                //    + "	    , SUM(QTY_DD_1) AS QTY_DD_1	\n"
                //    + "	    , SUM(QTY_DD_2) AS QTY_DD_2	\n"
                //    + "	    , SUM(QTY_DD_3) AS QTY_DD_3	\n"
                //    + "	    , SUM(QTY_DD_4) AS QTY_DD_4	\n"
                //    + "	    , SUM(QTY_DD_5) AS QTY_DD_5	\n"
                //    + "	    , SUM(QTY_DD_6) AS QTY_DD_6	\n"
                //    + "	    , SUM(QTY_DD_7) AS QTY_DD_7	\n"
                //    + "	FROM	\n"
                //    + "	(	\n"
                //    + "	    SELECT 'FRONT - QCN 건수' AS GUBUN	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                WHEN '4' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '3' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '2' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '1' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	              END) AS QTY_QQ_1	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                WHEN '4' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '3' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '2' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '1' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	              END) AS QTY_QQ_2	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                WHEN '4' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '3' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '2' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '1' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	              END) AS QTY_QQ_3	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                WHEN '4' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '3' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '2' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '1' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	              END) AS QTY_QQ_4	\n"
                //    + "	        , 0 AS QTY_MM_1	\n"
                //    + "	        , 0 AS QTY_MM_2	\n"
                //    + "	        , 0 AS QTY_MM_3	\n"
                //    + "	        , 0 AS QTY_MM_4	\n"
                //    + "	        , 0 AS QTY_WW_1	\n"
                //    + "	        , 0 AS QTY_WW_2	\n"
                //    + "	        , 0 AS QTY_WW_3	\n"
                //    + "	        , 0 AS QTY_WW_4	\n"
                //    + "	        , 0 AS QTY_DD_1	\n"
                //    + "	        , 0 AS QTY_DD_2	\n"
                //    + "	        , 0 AS QTY_DD_3	\n"
                //    + "	        , 0 AS QTY_DD_4	\n"
                //    + "	        , 0 AS QTY_DD_5	\n"
                //    + "	        , 0 AS QTY_DD_6	\n"
                //    + "	        , 0 AS QTY_DD_7	\n"
                //    + "	    FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n"
                //    + "	    WHERE 1=1 	\n"
                //    + "	    AND SUBSTR(STS.ABR_NO,1,3) = 'QCN'	\n"
                //    + "	    AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n"
                //    + "	    AND STS.FACTORY = MAT.FACTORY 	\n"
                //    + "	    AND STS.MAT_ID = MAT.MAT_ID 	\n"
                //    + "	    AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -13)), 'YYYYMMDD')||'220000'	\n"
                //    + "	    AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	    AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n"
                //    + "	    AND STS.DEFECT_CODE LIKE '%'	\n"
                //    + "	    AND STS.CUR_STEP LIKE '%'	\n"
                //    + "	    AND STS.OPER_1 >= 'A0000'	\n"
                //    + "	    AND STS.OPER_1 <= 'A0970'	\n"
                //    + "	    AND STS.DEL_FLAG = ' '	\n"
                //    + "	    UNION ALL	\n"
                //    + "	    SELECT 'FRONT - QCN 건수' AS GUBUN	\n"
                //    + "	        , 0 AS QTY_QQ_1 	\n"
                //    + "	        , 0 AS QTY_QQ_2 	\n"
                //    + "	        , 0 AS QTY_QQ_3 	\n"
                //    + "	        , 0 AS QTY_QQ_4	\n"
                //    + "	        ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                    THEN 1	\n"
                //    + "	                    ELSE 0	\n"
                //    + "	             END) AS QTY_MM_1	\n"
                //    + "	        ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                    THEN 1	\n"
                //    + "	                    ELSE 0	\n"
                //    + "	             END) AS QTY_MM_2	\n"
                //    + "	        ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                    THEN 1	\n"
                //    + "	                    ELSE 0	\n"
                //    + "	             END) AS QTY_MM_3	\n"
                //    + "	        ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 0)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                    THEN 1	\n"
                //    + "	                    ELSE 0	\n"
                //    + "	             END) AS QTY_MM_4	\n"
                //    + "	        , 0 AS QTY_WW_1	\n"
                //    + "	        , 0 AS QTY_WW_2	\n"
                //    + "	        , 0 AS QTY_WW_3	\n"
                //    + "	        , 0 AS QTY_WW_4	\n"
                //    + "	        , 0 AS QTY_DD_1	\n"
                //    + "	        , 0 AS QTY_DD_2	\n"
                //    + "	        , 0 AS QTY_DD_3	\n"
                //    + "	        , 0 AS QTY_DD_4	\n"
                //    + "	        , 0 AS QTY_DD_5	\n"
                //    + "	        , 0 AS QTY_DD_6	\n"
                //    + "	        , 0 AS QTY_DD_7	\n"
                //    + "	    FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n"
                //    + "	    WHERE 1=1 	\n"
                //    + "	    AND SUBSTR(STS.ABR_NO,1,3) = 'QCN'	\n"
                //    + "	    AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n"
                //    + "	    AND STS.FACTORY = MAT.FACTORY 	\n"
                //    + "	    AND STS.MAT_ID = MAT.MAT_ID 	\n"
                //    + "	    AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                //    + "	    AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	    AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n"
                //    + "	    AND STS.DEFECT_CODE LIKE '%'	\n"
                //    + "	    AND STS.CUR_STEP LIKE '%'	\n"
                //    + "	    AND STS.OPER_1 >= 'A0000'	\n"
                //    + "	    AND STS.OPER_1 <= 'A0970'	\n"
                //    + "	    AND STS.DEL_FLAG = ' '	\n"
                //    + "	    UNION ALL	\n"
                //    + "	    SELECT 'FRONT - QCN 건수' AS GUBUN	\n"
                //    + "	        , 0 AS QTY_QQ_1	\n"
                //    + "	        , 0 AS QTY_QQ_2	\n"
                //    + "	        , 0 AS QTY_QQ_3	\n"
                //    + "	        , 0 AS QTY_QQ_4	\n"
                //    + "	        , 0 AS QTY_MM_1	\n"
                //    + "	        , 0 AS QTY_MM_2	\n"
                //    + "	        , 0 AS QTY_MM_3	\n"
                //    + "	        , 0 AS QTY_MM_4	\n"
                //    + "	        , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 28, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                       END                                                 	\n"
                //    + "	                    AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                  WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                  WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                  WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                  WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                  WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                  WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                       END THEN 1 ELSE 0 END) AS QTY_WW_1	\n"
                //    + "	        , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                       END                                                 	\n"
                //    + "	                    AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')||'220000'   	\n"
                //    + "	                                                                  WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')||'220000'   	\n"
                //    + "	                                                                  WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                  WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                  WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                  WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                  WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                       END THEN 1 ELSE 0 END) AS QTY_WW_2	\n"
                //    + "	        , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                       END                                                 	\n"
                //    + "	                    AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                  WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                  WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                  WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                  WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                  WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                  WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                       END THEN 1 ELSE 0 END) AS QTY_WW_3	\n"
                //    + "	        , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                       END 	\n"
                //    + "	                    AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 6, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                  WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 5, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                  WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 4, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                  WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 3, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                  WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 2, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                  WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 1, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                  WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 0, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                       END THEN 1 ELSE 0 END) AS QTY_WW_4	\n"
                //    + "	        , 0 AS QTY_DD_1	\n"
                //    + "	        , 0 AS QTY_DD_2	\n"
                //    + "	        , 0 AS QTY_DD_3	\n"
                //    + "	        , 0 AS QTY_DD_4	\n"
                //    + "	        , 0 AS QTY_DD_5	\n"
                //    + "	        , 0 AS QTY_DD_6	\n"
                //    + "	        , 0 AS QTY_DD_7	\n"
                //    + "	    FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n"
                //    + "	    WHERE 1=1 	\n"
                //    + "	    AND SUBSTR(STS.ABR_NO,1,3) = 'QCN'	\n"
                //    + "	    AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n"
                //    + "	    AND STS.FACTORY = MAT.FACTORY 	\n"
                //    + "	    AND STS.MAT_ID = MAT.MAT_ID	\n"
                //    + "	    AND STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 28, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                           END 	\n"
                //    + "	    AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	    AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n"
                //    + "	    AND STS.DEFECT_CODE LIKE '%'	\n"
                //    + "	    AND STS.CUR_STEP LIKE '%'	\n"
                //    + "	    AND STS.OPER_1 >= 'A0000'	\n"
                //    + "	    AND STS.OPER_1 <= 'A0970'	\n"
                //    + "	    AND STS.DEL_FLAG = ' '	\n"
                //    + "	    UNION ALL	\n"
                //    + "	    SELECT 'FRONT - QCN 건수' AS GUBUN	\n"
                //    + "	        , 0 AS QTY_QQ_1	\n"
                //    + "	        , 0 AS QTY_QQ_2	\n"
                //    + "	        , 0 AS QTY_QQ_3	\n"
                //    + "	        , 0 AS QTY_QQ_4	\n"
                //    + "	        , 0 AS QTY_MM_1	\n"
                //    + "	        , 0 AS QTY_MM_2	\n"
                //    + "	        , 0 AS QTY_MM_3	\n"
                //    + "	        , 0 AS QTY_MM_4	\n"
                //    + "	        , 0 AS QTY_WW_1	\n"
                //    + "	        , 0 AS QTY_WW_2	\n"
                //    + "	        , 0 AS QTY_WW_3	\n"
                //    + "	        , 0 AS QTY_WW_4	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                    WHEN '금' 	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	                    WHEN '목'	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	              END) AS QTY_DD_1	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                    WHEN '토'	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	                    WHEN '금'	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	              END) AS QTY_DD_2 	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                    WHEN '일' 	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	                    WHEN '토'	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	              END) AS QTY_DD_3 	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                    WHEN '월' 	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	                    WHEN '일'	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	              END) AS QTY_DD_4 	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                    WHEN '화'	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	                    WHEN '월'	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	              END) AS QTY_DD_5 	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                    WHEN '수'	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	                    WHEN '화'	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	              END) AS QTY_DD_6 	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                    WHEN '목' 	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	                    WHEN '수'	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	              END) AS QTY_DD_7	\n"
                //    + "	    FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n"
                //    + "	    WHERE 1=1 	\n"
                //    + "	    AND SUBSTR(STS.ABR_NO,1,3) = 'QCN'	\n"
                //    + "	    AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n"
                //    + "	    AND STS.FACTORY = MAT.FACTORY 	\n"
                //    + "	    AND STS.MAT_ID = MAT.MAT_ID	\n"
                //    + "	    AND STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                           END 	\n"
                //    + "	    AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	    AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n"
                //    + "	    AND STS.DEFECT_CODE LIKE '%'	\n"
                //    + "	    AND STS.CUR_STEP LIKE '%'	\n"
                //    + "	    AND STS.OPER_1 >= 'A0000'	\n"
                //    + "	    AND STS.OPER_1 <= 'A0970'	\n"
                //    + "	    AND STS.DEL_FLAG = ' '	\n"
                //    + "	    UNION ALL	\n"
                //    + "	    SELECT 'B/E - QCN 건수' AS GUBUN	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                WHEN '4' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '3' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '2' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '1' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	              END) AS QTY_QQ_1	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                WHEN '4' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '3' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '2' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '1' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	              END) AS QTY_QQ_2	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                WHEN '4' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '3' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '2' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '1' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	              END) AS QTY_QQ_3	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                WHEN '4' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '3' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '2' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '1' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	              END) AS QTY_QQ_4	\n"
                //    + "	        , 0 AS QTY_MM_1	\n"
                //    + "	        , 0 AS QTY_MM_2	\n"
                //    + "	        , 0 AS QTY_MM_3	\n"
                //    + "	        , 0 AS QTY_MM_4	\n"
                //    + "	        , 0 AS QTY_WW_1	\n"
                //    + "	        , 0 AS QTY_WW_2	\n"
                //    + "	        , 0 AS QTY_WW_3	\n"
                //    + "	        , 0 AS QTY_WW_4	\n"
                //    + "	        , 0 AS QTY_DD_1	\n"
                //    + "	        , 0 AS QTY_DD_2	\n"
                //    + "	        , 0 AS QTY_DD_3	\n"
                //    + "	        , 0 AS QTY_DD_4	\n"
                //    + "	        , 0 AS QTY_DD_5	\n"
                //    + "	        , 0 AS QTY_DD_6	\n"
                //    + "	        , 0 AS QTY_DD_7	\n"
                //    + "	    FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n"
                //    + "	    WHERE 1=1 	\n"
                //    + "	    AND SUBSTR(STS.ABR_NO,1,3) = 'QCN'	\n"
                //    + "	    AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n"
                //    + "	    AND STS.FACTORY = MAT.FACTORY 	\n"
                //    + "	    AND STS.MAT_ID = MAT.MAT_ID 	\n"
                //    + "	    AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -13)), 'YYYYMMDD')||'220000'	\n"
                //    + "	    AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	    AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n"
                //    + "	    AND STS.DEFECT_CODE LIKE '%'	\n"
                //    + "	    AND STS.CUR_STEP LIKE '%'	\n"
                //    + "	    AND STS.OPER_1 >= 'A1000'	\n"
                //    + "	    AND STS.OPER_1 <= 'AZ010'	\n"
                //    + "	    AND STS.DEL_FLAG = ' '	\n"
                //    + "	    UNION ALL	\n"
                //    + "	    SELECT 'B/E - QCN 건수' AS GUBUN	\n"
                //    + "	        , 0 AS QTY_QQ_1 	\n"
                //    + "	        , 0 AS QTY_QQ_2 	\n"
                //    + "	        , 0 AS QTY_QQ_3 	\n"
                //    + "	        , 0 AS QTY_QQ_4	\n"
                //    + "	        ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                    THEN 1	\n"
                //    + "	                    ELSE 0	\n"
                //    + "	             END) AS QTY_MM_1	\n"
                //    + "	        ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                    THEN 1	\n"
                //    + "	                    ELSE 0	\n"
                //    + "	             END) AS QTY_MM_2	\n"
                //    + "	        ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                    THEN 1	\n"
                //    + "	                    ELSE 0	\n"
                //    + "	             END) AS QTY_MM_3	\n"
                //    + "	        ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 0)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                    THEN 1	\n"
                //    + "	                    ELSE 0	\n"
                //    + "	             END) AS QTY_MM_4	\n"
                //    + "	        , 0 AS QTY_WW_1	\n"
                //    + "	        , 0 AS QTY_WW_2	\n"
                //    + "	        , 0 AS QTY_WW_3	\n"
                //    + "	        , 0 AS QTY_WW_4	\n"
                //    + "	        , 0 AS QTY_DD_1	\n"
                //    + "	        , 0 AS QTY_DD_2	\n"
                //    + "	        , 0 AS QTY_DD_3	\n"
                //    + "	        , 0 AS QTY_DD_4	\n"
                //    + "	        , 0 AS QTY_DD_5	\n"
                //    + "	        , 0 AS QTY_DD_6	\n"
                //    + "	        , 0 AS QTY_DD_7	\n"
                //    + "	    FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n"
                //    + "	    WHERE 1=1 	\n"
                //    + "	    AND SUBSTR(STS.ABR_NO,1,3) = 'QCN'	\n"
                //    + "	    AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n"
                //    + "	    AND STS.FACTORY = MAT.FACTORY 	\n"
                //    + "	    AND STS.MAT_ID = MAT.MAT_ID 	\n"
                //    + "	    AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                //    + "	    AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	    AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n"
                //    + "	    AND STS.DEFECT_CODE LIKE '%'	\n"
                //    + "	    AND STS.CUR_STEP LIKE '%'	\n"
                //    + "	    AND STS.OPER_1 >= 'A1000'	\n"
                //    + "	    AND STS.OPER_1 <= 'AZ010'	\n"
                //    + "	    AND STS.DEL_FLAG = ' '	\n"
                //    + "	    UNION ALL	\n"
                //    + "	    SELECT 'B/E - QCN 건수' AS GUBUN	\n"
                //    + "	        , 0 AS QTY_QQ_1	\n"
                //    + "	        , 0 AS QTY_QQ_2	\n"
                //    + "	        , 0 AS QTY_QQ_3	\n"
                //    + "	        , 0 AS QTY_QQ_4	\n"
                //    + "	        , 0 AS QTY_MM_1	\n"
                //    + "	        , 0 AS QTY_MM_2	\n"
                //    + "	        , 0 AS QTY_MM_3	\n"
                //    + "	        , 0 AS QTY_MM_4	\n"
                //    + "	        , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 28, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                       END                                                 	\n"
                //    + "	                    AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                  WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                  WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                  WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                  WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                  WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                  WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                       END THEN 1 ELSE 0 END) AS QTY_WW_1	\n"
                //    + "	        , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                       END                                                 	\n"
                //    + "	                    AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')||'220000'   	\n"
                //    + "	                                                                  WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')||'220000'   	\n"
                //    + "	                                                                  WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                  WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                  WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                  WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                  WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                       END THEN 1 ELSE 0 END) AS QTY_WW_2	\n"
                //    + "	        , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                       END                                                 	\n"
                //    + "	                    AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                  WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                  WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                  WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                  WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                  WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                  WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                       END THEN 1 ELSE 0 END) AS QTY_WW_3	\n"
                //    + "	        , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                       END 	\n"
                //    + "	                    AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 6, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                  WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 5, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                  WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 4, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                  WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 3, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                  WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 2, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                  WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 1, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                  WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 0, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                       END THEN 1 ELSE 0 END) AS QTY_WW_4	\n"
                //    + "	        , 0 AS QTY_DD_1	\n"
                //    + "	        , 0 AS QTY_DD_2	\n"
                //    + "	        , 0 AS QTY_DD_3	\n"
                //    + "	        , 0 AS QTY_DD_4	\n"
                //    + "	        , 0 AS QTY_DD_5	\n"
                //    + "	        , 0 AS QTY_DD_6	\n"
                //    + "	        , 0 AS QTY_DD_7	\n"
                //    + "	    FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n"
                //    + "	    WHERE 1=1 	\n"
                //    + "	    AND SUBSTR(STS.ABR_NO,1,3) = 'QCN'	\n"
                //    + "	    AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n"
                //    + "	    AND STS.FACTORY = MAT.FACTORY 	\n"
                //    + "	    AND STS.MAT_ID = MAT.MAT_ID	\n"
                //    + "	    AND STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 28, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                           END 	\n"
                //    + "	    AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	    AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n"
                //    + "	    AND STS.DEFECT_CODE LIKE '%'	\n"
                //    + "	    AND STS.CUR_STEP LIKE '%'	\n"
                //    + "	    AND STS.OPER_1 >= 'A1000'	\n"
                //    + "	    AND STS.OPER_1 <= 'AZ010'	\n"
                //    + "	    AND STS.DEL_FLAG = ' '	\n"
                //    + "	    UNION ALL	\n"
                //    + "	    SELECT 'B/E - QCN 건수' AS GUBUN	\n"
                //    + "	        , 0 AS QTY_QQ_1	\n"
                //    + "	        , 0 AS QTY_QQ_2	\n"
                //    + "	        , 0 AS QTY_QQ_3	\n"
                //    + "	        , 0 AS QTY_QQ_4	\n"
                //    + "	        , 0 AS QTY_MM_1	\n"
                //    + "	        , 0 AS QTY_MM_2	\n"
                //    + "	        , 0 AS QTY_MM_3	\n"
                //    + "	        , 0 AS QTY_MM_4	\n"
                //    + "	        , 0 AS QTY_WW_1	\n"
                //    + "	        , 0 AS QTY_WW_2	\n"
                //    + "	        , 0 AS QTY_WW_3	\n"
                //    + "	        , 0 AS QTY_WW_4	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                    WHEN '금' 	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	                    WHEN '목'	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	              END) AS QTY_DD_1	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                    WHEN '토'	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	                    WHEN '금'	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	              END) AS QTY_DD_2 	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                    WHEN '일' 	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	                    WHEN '토'	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	              END) AS QTY_DD_3 	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                    WHEN '월' 	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	                    WHEN '일'	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	              END) AS QTY_DD_4 	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                    WHEN '화'	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	                    WHEN '월'	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	              END) AS QTY_DD_5 	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                    WHEN '수'	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	                    WHEN '화'	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	              END) AS QTY_DD_6 	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                    WHEN '목' 	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	                    WHEN '수'	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	              END) AS QTY_DD_7	\n"
                //    + "	    FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n"
                //    + "	    WHERE 1=1 	\n"
                //    + "	    AND SUBSTR(STS.ABR_NO,1,3) = 'QCN'	\n"
                //    + "	    AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n"
                //    + "	    AND STS.FACTORY = MAT.FACTORY 	\n"
                //    + "	    AND STS.MAT_ID = MAT.MAT_ID	\n"
                //    + "	    AND STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                           END 	\n"
                //    + "	    AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	    AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n"
                //    + "	    AND STS.DEFECT_CODE LIKE '%'	\n"
                //    + "	    AND STS.CUR_STEP LIKE '%'	\n"
                //    + "	    AND STS.OPER_1 >= 'A1000'	\n"
                //    + "	    AND STS.OPER_1 <= 'AZ010'	\n"
                //    + "	    AND STS.DEL_FLAG = ' '	\n"
                //    + "	    UNION ALL	\n"
                //    + "	    SELECT CASE STS.CUS_ID WHEN 'SE' THEN 'SEC - QCN 건수'	\n"
                //    + "	                           WHEN 'HX' THEN 'HYNIX - QCN 건수'	\n"
                //    + "	                           ELSE 'ETC - QCN 건수'	\n"
                //    + "	           END AS GUBUN	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                WHEN '4' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '3' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '2' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '1' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	              END) AS QTY_QQ_1	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                WHEN '4' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '3' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '2' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '1' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	              END) AS QTY_QQ_2	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                WHEN '4' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '3' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '2' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '1' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	              END) AS QTY_QQ_3	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                WHEN '4' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '3' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '2' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '1' THEN 	\n"
                //    + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                THEN 1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	              END) AS QTY_QQ_4	\n"
                //    + "	        , 0 AS QTY_MM_1	\n"
                //    + "	        , 0 AS QTY_MM_2	\n"
                //    + "	        , 0 AS QTY_MM_3	\n"
                //    + "	        , 0 AS QTY_MM_4	\n"
                //    + "	        , 0 AS QTY_WW_1	\n"
                //    + "	        , 0 AS QTY_WW_2	\n"
                //    + "	        , 0 AS QTY_WW_3	\n"
                //    + "	        , 0 AS QTY_WW_4	\n"
                //    + "	        , 0 AS QTY_DD_1	\n"
                //    + "	        , 0 AS QTY_DD_2	\n"
                //    + "	        , 0 AS QTY_DD_3	\n"
                //    + "	        , 0 AS QTY_DD_4	\n"
                //    + "	        , 0 AS QTY_DD_5	\n"
                //    + "	        , 0 AS QTY_DD_6	\n"
                //    + "	        , 0 AS QTY_DD_7	\n"
                //    + "	    FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n"
                //    + "	    WHERE 1=1 	\n"
                //    + "	    AND SUBSTR(STS.ABR_NO,1,3) = 'QCN'	\n"
                //    + "	    AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n"
                //    + "	    AND STS.FACTORY = MAT.FACTORY 	\n"
                //    + "	    AND STS.MAT_ID = MAT.MAT_ID 	\n"
                //    + "	    AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -13)), 'YYYYMMDD')||'220000'	\n"
                //    + "	    AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	    AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n"
                //    + "	    AND STS.DEFECT_CODE LIKE '%'	\n"
                //    + "	    AND STS.CUR_STEP LIKE '%'	\n"
                //    + "	    AND STS.OPER_1 >= 'A0000'	\n"
                //    + "	    AND STS.OPER_1 <= 'AZ010'	\n"
                //    + "	    AND STS.DEL_FLAG = ' '	\n"
                //    + "	    GROUP BY CASE STS.CUS_ID WHEN 'SE' THEN 'SEC - QCN 건수'	\n"
                //    + "	                             WHEN 'HX' THEN 'HYNIX - QCN 건수'	\n"
                //    + "	                             ELSE 'ETC - QCN 건수'	\n"
                //    + "	             END	\n"
                //    + "	    UNION ALL	\n"
                //    + "	    SELECT CASE STS.CUS_ID WHEN 'SE' THEN 'SEC - QCN 건수'	\n"
                //    + "	                           WHEN 'HX' THEN 'HYNIX - QCN 건수'	\n"
                //    + "	                           ELSE 'ETC - QCN 건수'	\n"
                //    + "	           END AS GUBUN	\n"
                //    + "	        , 0 AS QTY_QQ_1 	\n"
                //    + "	        , 0 AS QTY_QQ_2 	\n"
                //    + "	        , 0 AS QTY_QQ_3 	\n"
                //    + "	        , 0 AS QTY_QQ_4	\n"
                //    + "	        ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                    THEN 1	\n"
                //    + "	                    ELSE 0	\n"
                //    + "	             END) AS QTY_MM_1	\n"
                //    + "	        ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                    THEN 1	\n"
                //    + "	                    ELSE 0	\n"
                //    + "	             END) AS QTY_MM_2	\n"
                //    + "	        ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                    THEN 1	\n"
                //    + "	                    ELSE 0	\n"
                //    + "	             END) AS QTY_MM_3	\n"
                //    + "	        ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 0)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                    THEN 1	\n"
                //    + "	                    ELSE 0	\n"
                //    + "	             END) AS QTY_MM_4	\n"
                //    + "	        , 0 AS QTY_WW_1	\n"
                //    + "	        , 0 AS QTY_WW_2	\n"
                //    + "	        , 0 AS QTY_WW_3	\n"
                //    + "	        , 0 AS QTY_WW_4	\n"
                //    + "	        , 0 AS QTY_DD_1	\n"
                //    + "	        , 0 AS QTY_DD_2	\n"
                //    + "	        , 0 AS QTY_DD_3	\n"
                //    + "	        , 0 AS QTY_DD_4	\n"
                //    + "	        , 0 AS QTY_DD_5	\n"
                //    + "	        , 0 AS QTY_DD_6	\n"
                //    + "	        , 0 AS QTY_DD_7	\n"
                //    + "	    FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n"
                //    + "	    WHERE 1=1 	\n"
                //    + "	    AND SUBSTR(STS.ABR_NO,1,3) = 'QCN'	\n"
                //    + "	    AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n"
                //    + "	    AND STS.FACTORY = MAT.FACTORY 	\n"
                //    + "	    AND STS.MAT_ID = MAT.MAT_ID 	\n"
                //    + "	    AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                //    + "	    AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	    AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n"
                //    + "	    AND STS.DEFECT_CODE LIKE '%'	\n"
                //    + "	    AND STS.CUR_STEP LIKE '%'	\n"
                //    + "	    AND STS.OPER_1 >= 'A0000'	\n"
                //    + "	    AND STS.OPER_1 <= 'AZ010'	\n"
                //    + "	    AND STS.DEL_FLAG = ' '	\n"
                //    + "	    GROUP BY CASE STS.CUS_ID WHEN 'SE' THEN 'SEC - QCN 건수'	\n"
                //    + "	                             WHEN 'HX' THEN 'HYNIX - QCN 건수'	\n"
                //    + "	                             ELSE 'ETC - QCN 건수'	\n"
                //    + "	             END	\n"
                //    + "	    UNION ALL	\n"
                //    + "	    SELECT CASE STS.CUS_ID WHEN 'SE' THEN 'SEC - QCN 건수'	\n"
                //    + "	                           WHEN 'HX' THEN 'HYNIX - QCN 건수'	\n"
                //    + "	                           ELSE 'ETC - QCN 건수'	\n"
                //    + "	           END AS GUBUN	\n"
                //    + "	        , 0 AS QTY_QQ_1	\n"
                //    + "	        , 0 AS QTY_QQ_2	\n"
                //    + "	        , 0 AS QTY_QQ_3	\n"
                //    + "	        , 0 AS QTY_QQ_4	\n"
                //    + "	        , 0 AS QTY_MM_1	\n"
                //    + "	        , 0 AS QTY_MM_2	\n"
                //    + "	        , 0 AS QTY_MM_3	\n"
                //    + "	        , 0 AS QTY_MM_4	\n"
                //    + "	        , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 28, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                       END                                                 	\n"
                //    + "	                    AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                  WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                  WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                  WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                  WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                  WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                  WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                       END THEN 1 ELSE 0 END) AS QTY_WW_1	\n"
                //    + "	        , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                       END                                                 	\n"
                //    + "	                    AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')||'220000'   	\n"
                //    + "	                                                                  WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')||'220000'   	\n"
                //    + "	                                                                  WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                  WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                  WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                  WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                  WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                       END THEN 1 ELSE 0 END) AS QTY_WW_2	\n"
                //    + "	        , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                       END                                                 	\n"
                //    + "	                    AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                  WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                  WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                  WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                  WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                  WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                  WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                       END THEN 1 ELSE 0 END) AS QTY_WW_3	\n"
                //    + "	        , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                       END 	\n"
                //    + "	                    AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 6, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                  WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 5, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                  WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 4, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                  WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 3, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                  WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 2, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                  WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 1, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                  WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 0, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                       END THEN 1 ELSE 0 END) AS QTY_WW_4	\n"
                //    + "	        , 0 AS QTY_DD_1	\n"
                //    + "	        , 0 AS QTY_DD_2	\n"
                //    + "	        , 0 AS QTY_DD_3	\n"
                //    + "	        , 0 AS QTY_DD_4	\n"
                //    + "	        , 0 AS QTY_DD_5	\n"
                //    + "	        , 0 AS QTY_DD_6	\n"
                //    + "	        , 0 AS QTY_DD_7	\n"
                //    + "	    FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n"
                //    + "	    WHERE 1=1 	\n"
                //    + "	    AND SUBSTR(STS.ABR_NO,1,3) = 'QCN'	\n"
                //    + "	    AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n"
                //    + "	    AND STS.FACTORY = MAT.FACTORY 	\n"
                //    + "	    AND STS.MAT_ID = MAT.MAT_ID	\n"
                //    + "	    AND STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 28, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                           END 	\n"
                //    + "	    AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	    AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n"
                //    + "	    AND STS.DEFECT_CODE LIKE '%'	\n"
                //    + "	    AND STS.CUR_STEP LIKE '%'	\n"
                //    + "	    AND STS.OPER_1 >= 'A0000'	\n"
                //    + "	    AND STS.OPER_1 <= 'AZ010'	\n"
                //    + "	    AND STS.DEL_FLAG = ' '	\n"
                //    + "	    GROUP BY CASE STS.CUS_ID WHEN 'SE' THEN 'SEC - QCN 건수'	\n"
                //    + "	                             WHEN 'HX' THEN 'HYNIX - QCN 건수'	\n"
                //    + "	                             ELSE 'ETC - QCN 건수'	\n"
                //    + "	             END	\n"
                //    + "	    UNION ALL	\n"
                //    + "	    SELECT CASE STS.CUS_ID WHEN 'SE' THEN 'SEC - QCN 건수'	\n"
                //    + "	                           WHEN 'HX' THEN 'HYNIX - QCN 건수'	\n"
                //    + "	                           ELSE 'ETC - QCN 건수'	\n"
                //    + "	           END AS GUBUN	\n"
                //    + "	        , 0 AS QTY_QQ_1	\n"
                //    + "	        , 0 AS QTY_QQ_2	\n"
                //    + "	        , 0 AS QTY_QQ_3	\n"
                //    + "	        , 0 AS QTY_QQ_4	\n"
                //    + "	        , 0 AS QTY_MM_1	\n"
                //    + "	        , 0 AS QTY_MM_2	\n"
                //    + "	        , 0 AS QTY_MM_3	\n"
                //    + "	        , 0 AS QTY_MM_4	\n"
                //    + "	        , 0 AS QTY_WW_1	\n"
                //    + "	        , 0 AS QTY_WW_2	\n"
                //    + "	        , 0 AS QTY_WW_3	\n"
                //    + "	        , 0 AS QTY_WW_4	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                    WHEN '금' 	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	                    WHEN '목'	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	              END) AS QTY_DD_1	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                    WHEN '토'	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	                    WHEN '금'	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	              END) AS QTY_DD_2 	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                    WHEN '일' 	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	                    WHEN '토'	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	              END) AS QTY_DD_3 	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                    WHEN '월' 	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	                    WHEN '일'	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	              END) AS QTY_DD_4 	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                    WHEN '화'	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	                    WHEN '월'	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	              END) AS QTY_DD_5 	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                    WHEN '수'	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	                    WHEN '화'	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	              END) AS QTY_DD_6 	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                    WHEN '목' 	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	                    WHEN '수'	\n"
                //    + "	                    THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                              THEN 1	\n"
                //    + "	                              ELSE 0	\n"
                //    + "	                         END	\n"
                //    + "	              END) AS QTY_DD_7	\n"
                //    + "	    FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n"
                //    + "	    WHERE 1=1 	\n"
                //    + "	    AND SUBSTR(STS.ABR_NO,1,3) = 'QCN'	\n"
                //    + "	    AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n"
                //    + "	    AND STS.FACTORY = MAT.FACTORY 	\n"
                //    + "	    AND STS.MAT_ID = MAT.MAT_ID	\n"
                //    + "	    AND STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                           END 	\n"
                //    + "	    AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	    AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n"
                //    + "	    AND STS.DEFECT_CODE LIKE '%'	\n"
                //    + "	    AND STS.CUR_STEP LIKE '%'	\n"
                //    + "	    AND STS.OPER_1 >= 'A0000'	\n"
                //    + "	    AND STS.OPER_1 <= 'AZ010'	\n"
                //    + "	    AND STS.DEL_FLAG = ' '	\n"
                //    + "	    GROUP BY CASE STS.CUS_ID WHEN 'SE' THEN 'SEC - QCN 건수'	\n"
                //    + "	                             WHEN 'HX' THEN 'HYNIX - QCN 건수'	\n"
                //    + "	                             ELSE 'ETC - QCN 건수'	\n"
                //    + "	             END	\n"
                //    + "		\n"
                //    + "	    UNION ALL	\n"
                //    + "		\n"
                //    + "	    SELECT '검사LOT수' AS GUBUN	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                WHEN '4' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '3' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '2' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '1' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'04'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'04', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	              END) AS QTY_QQ_1	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                WHEN '4' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '3' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '2' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '1' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	              END) AS QTY_QQ_2	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                WHEN '4' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '3' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '2' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '1' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	              END) AS QTY_QQ_3	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                WHEN '4' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'10'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'10', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '3' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '2' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '1' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	              END) AS QTY_QQ_4	\n"
                //    + "	        , 0 AS QTY_MM_1	\n"
                //    + "	        , 0 AS QTY_MM_2	\n"
                //    + "	        , 0 AS QTY_MM_3	\n"
                //    + "	        , 0 AS QTY_MM_4	\n"
                //    + "	        , 0 AS QTY_WW_1	\n"
                //    + "	        , 0 AS QTY_WW_2	\n"
                //    + "	        , 0 AS QTY_WW_3	\n"
                //    + "	        , 0 AS QTY_WW_4	\n"
                //    + "	        , 0 AS QTY_DD_1	\n"
                //    + "	        , 0 AS QTY_DD_2	\n"
                //    + "	        , 0 AS QTY_DD_3	\n"
                //    + "	        , 0 AS QTY_DD_4	\n"
                //    + "	        , 0 AS QTY_DD_5	\n"
                //    + "	        , 0 AS QTY_DD_6	\n"
                //    + "	        , 0 AS QTY_DD_7	\n"
                //    + "	    FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n"
                //    + "	    WHERE A.FACTORY = B.FACTORY  	\n"
                //    + "	    AND A.MAT_ID = B.MAT_ID  	\n"
                //    + "	    AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                //    + "	    AND A.WORK_MONTH >= TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -11), 'YYYYMM') 	\n"
                //    + "	    AND A.WORK_MONTH <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMM')	\n"
                //    + "	    AND A.QC_OPER IN ('PVI','QC GATE')    	\n"
                //    + "	    AND A.QC_TYPE LIKE 'GATE' || '%'  	\n"
                //    + "	    AND B.MAT_GRP_1 LIKE '%'	\n"
                //    + "	    UNION ALL	\n"
                //    + "	    SELECT '검사LOT수' AS GUBUN	\n"
                //    + "	        , 0 AS QTY_QQ_1  	\n"
                //    + "	        , 0 AS QTY_QQ_2  	\n"
                //    + "	        , 0 AS QTY_QQ_3  	\n"
                //    + "	        , 0 AS QTY_QQ_4 	\n"
                //    + "	        , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_MM_1	\n"
                //    + "	        , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_MM_2	\n"
                //    + "	        , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_MM_3	\n"
                //    + "	        , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_MM_4	\n"
                //    + "	        , 0 AS QTY_WW_1	\n"
                //    + "	        , 0 AS QTY_WW_2	\n"
                //    + "	        , 0 AS QTY_WW_3	\n"
                //    + "	        , 0 AS QTY_WW_4	\n"
                //    + "	        , 0 AS QTY_DD_1	\n"
                //    + "	        , 0 AS QTY_DD_2	\n"
                //    + "	        , 0 AS QTY_DD_3	\n"
                //    + "	        , 0 AS QTY_DD_4	\n"
                //    + "	        , 0 AS QTY_DD_5	\n"
                //    + "	        , 0 AS QTY_DD_6	\n"
                //    + "	        , 0 AS QTY_DD_7	\n"
                //    + "	    FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n"
                //    + "	    WHERE A.FACTORY = B.FACTORY  	\n"
                //    + "	    AND A.MAT_ID = B.MAT_ID  	\n"
                //    + "	    AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                //    + "	    AND A.WORK_MONTH >= TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4), 'YYYYMM') 	\n"
                //    + "	    AND A.WORK_MONTH <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMM')	\n"
                //    + "	    AND A.QC_OPER IN ('PVI','QC GATE')    	\n"
                //    + "	    AND A.QC_TYPE LIKE 'GATE' || '%'  	\n"
                //    + "	    AND B.MAT_GRP_1 LIKE '%'	\n"
                //    + "	    UNION ALL 	\n"
                //    + "	    SELECT '검사LOT수' AS GUBUN	\n"
                //    + "	        , 0 AS QTY_QQ_1  	\n"
                //    + "	        , 0 AS QTY_QQ_2  	\n"
                //    + "	        , 0 AS QTY_QQ_3  	\n"
                //    + "	        , 0 AS QTY_QQ_4	\n"
                //    + "	        , 0 AS QTY_MM_1  	\n"
                //    + "	        , 0 AS QTY_MM_2  	\n"
                //    + "	        , 0 AS QTY_MM_3  	\n"
                //    + "	        , 0 AS QTY_MM_4	\n"
                //    + "	        , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD') 	\n"
                //    + "	                                       END	\n"
                //    + "	                    AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')	\n"
                //    + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')	\n"
                //    + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD') 	\n"
                //    + "	                                       END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_WW_1	\n"
                //    + "	        , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD') 	\n"
                //    + "	                                       END	\n"
                //    + "	                    AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')  	\n"
                //    + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')  	\n"
                //    + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD') 	\n"
                //    + "	                                       END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_WW_2	\n"
                //    + "	        , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')	\n"
                //    + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD') 	\n"
                //    + "	                                       END	\n"
                //    + "	                    AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD') 	\n"
                //    + "	                                       END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_WW_3	\n"
                //    + "	        , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 0, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD') 	\n"
                //    + "	                                       END	\n"
                //    + "	                    AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 6, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 5, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 4, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 3, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 2, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 1, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 0, 'YYYYMMDD') 	\n"
                //    + "	                                       END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_WW_4	\n"
                //    + "	        , 0 AS QTY_DD_1 	\n"
                //    + "	        , 0 AS QTY_DD_2 	\n"
                //    + "	        , 0 AS QTY_DD_3 	\n"
                //    + "	        , 0 AS QTY_DD_4 	\n"
                //    + "	        , 0 AS QTY_DD_5 	\n"
                //    + "	        , 0 AS QTY_DD_6 	\n"
                //    + "	        , 0 AS QTY_DD_7 	\n"
                //    + "	    FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n"
                //    + "	    WHERE A.FACTORY = B.FACTORY  	\n"
                //    + "	    AND A.MAT_ID = B.MAT_ID  	\n"
                //    + "	    AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                //    + "	    AND A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD') 	\n"
                //    + "	                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD') 	\n"
                //    + "	                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD') 	\n"
                //    + "	                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD') 	\n"
                //    + "	                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD') 	\n"
                //    + "	                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD') 	\n"
                //    + "	                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD') 	\n"
                //    + "	                                           END 	\n"
                //    + "	    AND A.WORK_DATE <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD') 	\n"
                //    + "	    AND A.QC_OPER IN ('PVI','QC GATE')    	\n"
                //    + "	    AND A.QC_TYPE LIKE 'GATE' || '%'  	\n"
                //    + "	    AND B.MAT_GRP_1 LIKE '%'	\n"
                //    + "	    UNION ALL	\n"
                //    + "	    SELECT '검사LOT수' AS GUBUN 	\n"
                //    + "	        , 0 AS QTY_QQ_1	\n"
                //    + "	        , 0 AS QTY_QQ_2	\n"
                //    + "	        , 0 AS QTY_QQ_3	\n"
                //    + "	        , 0 AS QTY_QQ_4	\n"
                //    + "	        , 0 AS QTY_MM_1	\n"
                //    + "	        , 0 AS QTY_MM_2	\n"
                //    + "	        , 0 AS QTY_MM_3	\n"
                //    + "	        , 0 AS QTY_MM_4	\n"
                //    + "	        , 0 AS QTY_WW_1	\n"
                //    + "	        , 0 AS QTY_WW_2	\n"
                //    + "	        , 0 AS QTY_WW_3	\n"
                //    + "	        , 0 AS QTY_WW_4	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '금' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_DD_1	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '토' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_DD_2	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '일' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_DD_3	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '월' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_DD_4	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '화' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_DD_5	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '수' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_DD_6	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '목' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_DD_7	\n"
                //    + "	    FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B	\n"
                //    + "	    WHERE A.FACTORY = B.FACTORY	\n"
                //    + "	    AND A.MAT_ID = B.MAT_ID	\n"
                //    + "	    AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n"
                //    + "	    AND A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 0, 'YYYYMMDD')	\n"
                //    + "	                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')	\n"
                //    + "	                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')	\n"
                //    + "	                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')	\n"
                //    + "	                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')	\n"
                //    + "	                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')	\n"
                //    + "	                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')	\n"
                //    + "	                       END  	\n"
                //    + "	    AND A.WORK_DATE <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD') 	\n"
                //    + "	    AND A.QC_OPER IN ('PVI','QC GATE')    	\n"
                //    + "	    AND A.QC_TYPE LIKE 'GATE' || '%'  	\n"
                //    + "	    AND B.MAT_GRP_1 LIKE '%'	\n"
                //    + "	    UNION ALL	\n"
                //    + "	    SELECT CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC - 검사 LOT 수'	\n"
                //    + "	                            WHEN 'HX' THEN 'HYNIX - 검사 LOT 수'	\n"
                //    + "	                            ELSE 'ETC - 검사 LOT 수'	\n"
                //    + "	           END AS GUBUN	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                WHEN '4' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '3' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '2' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '1' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'04'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'04', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	              END) AS QTY_QQ_1	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                WHEN '4' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '3' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '2' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '1' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	              END) AS QTY_QQ_2	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                WHEN '4' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '3' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '2' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '1' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	              END) AS QTY_QQ_3	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                WHEN '4' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'10'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'10', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '3' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '2' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '1' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	              END) AS QTY_QQ_4	\n"
                //    + "	        , 0 AS QTY_MM_1	\n"
                //    + "	        , 0 AS QTY_MM_2	\n"
                //    + "	        , 0 AS QTY_MM_3	\n"
                //    + "	        , 0 AS QTY_MM_4	\n"
                //    + "	        , 0 AS QTY_WW_1	\n"
                //    + "	        , 0 AS QTY_WW_2	\n"
                //    + "	        , 0 AS QTY_WW_3	\n"
                //    + "	        , 0 AS QTY_WW_4	\n"
                //    + "	        , 0 AS QTY_DD_1	\n"
                //    + "	        , 0 AS QTY_DD_2	\n"
                //    + "	        , 0 AS QTY_DD_3	\n"
                //    + "	        , 0 AS QTY_DD_4	\n"
                //    + "	        , 0 AS QTY_DD_5	\n"
                //    + "	        , 0 AS QTY_DD_6	\n"
                //    + "	        , 0 AS QTY_DD_7	\n"
                //    + "	    FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n"
                //    + "	    WHERE A.FACTORY = B.FACTORY  	\n"
                //    + "	    AND A.MAT_ID = B.MAT_ID  	\n"
                //    + "	    AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                //    + "	    AND A.WORK_MONTH >= TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -11), 'YYYYMM') 	\n"
                //    + "	    AND A.WORK_MONTH <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMM')	\n"
                //    + "	    AND A.QC_OPER IN ('PVI','QC GATE')    	\n"
                //    + "	    AND A.QC_TYPE LIKE 'GATE' || '%'  	\n"
                //    + "	    AND B.MAT_GRP_1 LIKE '%'	\n"
                //    + "	    GROUP BY CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC - 검사 LOT 수'	\n"
                //    + "	                              WHEN 'HX' THEN 'HYNIX - 검사 LOT 수'	\n"
                //    + "	                              ELSE 'ETC - 검사 LOT 수'	\n"
                //    + "	             END	\n"
                //    + "	    UNION ALL	\n"
                //    + "	    SELECT CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC - 검사 LOT 수'	\n"
                //    + "	                            WHEN 'HX' THEN 'HYNIX - 검사 LOT 수'	\n"
                //    + "	                            ELSE 'ETC - 검사 LOT 수'	\n"
                //    + "	           END AS GUBUN	\n"
                //    + "	        , 0 AS QTY_QQ_1	\n"
                //    + "	        , 0 AS QTY_QQ_2	\n"
                //    + "	        , 0 AS QTY_QQ_3	\n"
                //    + "	        , 0 AS QTY_QQ_4	\n"
                //    + "	        , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_MM_1	\n"
                //    + "	        , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_MM_2	\n"
                //    + "	        , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_MM_3	\n"
                //    + "	        , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_MM_4	\n"
                //    + "	        , 0 AS QTY_WW_1	\n"
                //    + "	        , 0 AS QTY_WW_2	\n"
                //    + "	        , 0 AS QTY_WW_3	\n"
                //    + "	        , 0 AS QTY_WW_4	\n"
                //    + "	        , 0 AS QTY_DD_1	\n"
                //    + "	        , 0 AS QTY_DD_2	\n"
                //    + "	        , 0 AS QTY_DD_3	\n"
                //    + "	        , 0 AS QTY_DD_4	\n"
                //    + "	        , 0 AS QTY_DD_5	\n"
                //    + "	        , 0 AS QTY_DD_6	\n"
                //    + "	        , 0 AS QTY_DD_7	\n"
                //    + "	    FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n"
                //    + "	    WHERE A.FACTORY = B.FACTORY  	\n"
                //    + "	    AND A.MAT_ID = B.MAT_ID  	\n"
                //    + "	    AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                //    + "	    AND A.WORK_MONTH >= TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4), 'YYYYMM') 	\n"
                //    + "	    AND A.WORK_MONTH <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMM')	\n"
                //    + "	    AND A.QC_OPER IN ('PVI','QC GATE')    	\n"
                //    + "	    AND A.QC_TYPE LIKE 'GATE' || '%'  	\n"
                //    + "	    AND B.MAT_GRP_1 LIKE '%'	\n"
                //    + "	    GROUP BY CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC - 검사 LOT 수'	\n"
                //    + "	                              WHEN 'HX' THEN 'HYNIX - 검사 LOT 수'	\n"
                //    + "	                              ELSE 'ETC - 검사 LOT 수'	\n"
                //    + "	             END	\n"
                //    + "	    UNION ALL	\n"
                //    + "	    SELECT CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC - 검사 LOT 수'	\n"
                //    + "	                            WHEN 'HX' THEN 'HYNIX - 검사 LOT 수'	\n"
                //    + "	                            ELSE 'ETC - 검사 LOT 수'	\n"
                //    + "	           END AS GUBUN	\n"
                //    + "	        , 0 AS QTY_QQ_1	\n"
                //    + "	        , 0 AS QTY_QQ_2	\n"
                //    + "	        , 0 AS QTY_QQ_3	\n"
                //    + "	        , 0 AS QTY_QQ_4	\n"
                //    + "	        , 0 AS QTY_MM_1	\n"
                //    + "	        , 0 AS QTY_MM_2	\n"
                //    + "	        , 0 AS QTY_MM_3	\n"
                //    + "	        , 0 AS QTY_MM_4	\n"
                //    + "	        , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD') 	\n"
                //    + "	                                       END	\n"
                //    + "	                    AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')	\n"
                //    + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')	\n"
                //    + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD') 	\n"
                //    + "	                                       END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_WW_1	\n"
                //    + "	        , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD') 	\n"
                //    + "	                                       END	\n"
                //    + "	                    AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')  	\n"
                //    + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')  	\n"
                //    + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD') 	\n"
                //    + "	                                       END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_WW_2	\n"
                //    + "	        , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')	\n"
                //    + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD') 	\n"
                //    + "	                                       END	\n"
                //    + "	                    AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD') 	\n"
                //    + "	                                       END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_WW_3	\n"
                //    + "	        , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 0, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD') 	\n"
                //    + "	                                       END	\n"
                //    + "	                    AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 6, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 5, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 4, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 3, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 2, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 1, 'YYYYMMDD') 	\n"
                //    + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 0, 'YYYYMMDD') 	\n"
                //    + "	                                       END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_WW_4	\n"
                //    + "	        , 0 AS QTY_DD_1 	\n"
                //    + "	        , 0 AS QTY_DD_2 	\n"
                //    + "	        , 0 AS QTY_DD_3 	\n"
                //    + "	        , 0 AS QTY_DD_4 	\n"
                //    + "	        , 0 AS QTY_DD_5 	\n"
                //    + "	        , 0 AS QTY_DD_6 	\n"
                //    + "	        , 0 AS QTY_DD_7 	\n"
                //    + "	    FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n"
                //    + "	    WHERE A.FACTORY = B.FACTORY  	\n"
                //    + "	    AND A.MAT_ID = B.MAT_ID  	\n"
                //    + "	    AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                //    + "	    AND A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD') 	\n"
                //    + "	                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD') 	\n"
                //    + "	                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD') 	\n"
                //    + "	                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD') 	\n"
                //    + "	                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD') 	\n"
                //    + "	                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD') 	\n"
                //    + "	                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD') 	\n"
                //    + "	                                           END 	\n"
                //    + "	    AND A.WORK_DATE <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD') 	\n"
                //    + "	    AND A.QC_OPER IN ('PVI','QC GATE')    	\n"
                //    + "	    AND A.QC_TYPE LIKE 'GATE' || '%'  	\n"
                //    + "	    AND B.MAT_GRP_1 LIKE '%'	\n"
                //    + "	    GROUP BY CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC - 검사 LOT 수'	\n"
                //    + "	                              WHEN 'HX' THEN 'HYNIX - 검사 LOT 수'	\n"
                //    + "	                              ELSE 'ETC - 검사 LOT 수'	\n"
                //    + "	             END	\n"
                //    + "	    UNION ALL	\n"
                //    + "	    SELECT CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC - 검사 LOT 수'	\n"
                //    + "	                            WHEN 'HX' THEN 'HYNIX - 검사 LOT 수'	\n"
                //    + "	                            ELSE 'ETC - 검사 LOT 수'	\n"
                //    + "	           END AS GUBUN	\n"
                //    + "	        , 0 AS QTY_QQ_1	\n"
                //    + "	        , 0 AS QTY_QQ_2	\n"
                //    + "	        , 0 AS QTY_QQ_3	\n"
                //    + "	        , 0 AS QTY_QQ_4	\n"
                //    + "	        , 0 AS QTY_MM_1	\n"
                //    + "	        , 0 AS QTY_MM_2	\n"
                //    + "	        , 0 AS QTY_MM_3	\n"
                //    + "	        , 0 AS QTY_MM_4	\n"
                //    + "	        , 0 AS QTY_WW_1	\n"
                //    + "	        , 0 AS QTY_WW_2	\n"
                //    + "	        , 0 AS QTY_WW_3	\n"
                //    + "	        , 0 AS QTY_WW_4	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '금' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_DD_1	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '토' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_DD_2	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '일' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_DD_3	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '월' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_DD_4	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '화' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_DD_5	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '수' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_DD_6	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '목' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_DD_7	\n"
                //    + "	    FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B	\n"
                //    + "	    WHERE A.FACTORY = B.FACTORY	\n"
                //    + "	    AND A.MAT_ID = B.MAT_ID	\n"
                //    + "	    AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n"
                //    + "	    AND A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 0, 'YYYYMMDD')	\n"
                //    + "	                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')	\n"
                //    + "	                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')	\n"
                //    + "	                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')	\n"
                //    + "	                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')	\n"
                //    + "	                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')	\n"
                //    + "	                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')	\n"
                //    + "	                       END  	\n"
                //    + "	    AND A.WORK_DATE <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD') 	\n"
                //    + "	    AND A.QC_OPER IN ('PVI','QC GATE')    	\n"
                //    + "	    AND A.QC_TYPE LIKE 'GATE' || '%'  	\n"
                //    + "	    AND B.MAT_GRP_1 LIKE '%'	\n"
                //    + "	    GROUP BY CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC - 검사 LOT 수'	\n"
                //    + "	                              WHEN 'HX' THEN 'HYNIX - 검사 LOT 수'	\n"
                //    + "	                              ELSE 'ETC - 검사 LOT 수'	\n"
                //    + "	             END	\n"
                //    + "	    	\n"
                //    + "	    UNION ALL	\n"
                //    + "		\n"
                //    + "	    SELECT A.CUSTOMER AS GUBUN	\n"
                //    + "	        , CASE WHEN A.QTY_QQ_1 > 0 AND B.LOT_QTY_QQ_1 > 0 THEN ROUND(A.QTY_QQ_1 / B.LOT_QTY_QQ_1 * 100, 2) ELSE 0 END AS QTY_QQ_1	\n"
                //    + "	        , CASE WHEN A.QTY_QQ_2 > 0 AND B.LOT_QTY_QQ_2 > 0 THEN ROUND(A.QTY_QQ_2 / B.LOT_QTY_QQ_2 * 100, 2) ELSE 0 END AS QTY_QQ_2	\n"
                //    + "	        , CASE WHEN A.QTY_QQ_3 > 0 AND B.LOT_QTY_QQ_3 > 0 THEN ROUND(A.QTY_QQ_3 / B.LOT_QTY_QQ_3 * 100, 2) ELSE 0 END AS QTY_QQ_3	\n"
                //    + "	        , CASE WHEN A.QTY_QQ_4 > 0 AND B.LOT_QTY_QQ_4 > 0 THEN ROUND(A.QTY_QQ_4 / B.LOT_QTY_QQ_4 * 100, 2) ELSE 0 END AS QTY_QQ_4	\n"
                //    + "	        , 0 AS QTY_MM_1	\n"
                //    + "	        , 0 AS QTY_MM_2	\n"
                //    + "	        , 0 AS QTY_MM_3	\n"
                //    + "	        , 0 AS QTY_MM_4	\n"
                //    + "	        , 0 AS QTY_WW_1	\n"
                //    + "	        , 0 AS QTY_WW_2	\n"
                //    + "	        , 0 AS QTY_WW_3	\n"
                //    + "	        , 0 AS QTY_WW_4	\n"
                //    + "	        , 0 AS QTY_DD_1	\n"
                //    + "	        , 0 AS QTY_DD_2	\n"
                //    + "	        , 0 AS QTY_DD_3	\n"
                //    + "	        , 0 AS QTY_DD_4	\n"
                //    + "	        , 0 AS QTY_DD_5	\n"
                //    + "	        , 0 AS QTY_DD_6	\n"
                //    + "	        , 0 AS QTY_DD_7	\n"
                //    + "	    FROM(	\n"
                //    + "	        SELECT 'Front - LRR' AS CUSTOMER	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                    WHEN '4' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '3' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '2' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '1' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                  END) AS QTY_QQ_1	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                    WHEN '4' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '3' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '2' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '1' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                  END) AS QTY_QQ_2	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                    WHEN '4' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '3' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '2' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '1' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                  END) AS QTY_QQ_3	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                    WHEN '4' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '3' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '2' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '1' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                  END) AS QTY_QQ_4	\n"
                //    + "	        FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n"
                //    + "	        WHERE 1=1 	\n"
                //    + "	        AND SUBSTR(STS.ABR_NO,1,3) = 'QCN'	\n"
                //    + "	        AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n"
                //    + "	        AND STS.FACTORY = MAT.FACTORY 	\n"
                //    + "	        AND STS.MAT_ID = MAT.MAT_ID 	\n"
                //    + "	        AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -13)), 'YYYYMMDD')||'220000'	\n"
                //    + "	        AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	        AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n"
                //    + "	        AND STS.DEFECT_CODE LIKE '%'	\n"
                //    + "	        AND STS.CUR_STEP LIKE '%'	\n"
                //    + "	        AND STS.OPER_1 >= 'A0000'	\n"
                //    + "	        AND STS.OPER_1 <= 'A0970'	\n"
                //    + "	        AND STS.DEL_FLAG = ' '	\n"
                //    + "	        UNION ALL	\n"
                //    + "	        SELECT 'B/E - LRR' AS CUSTOMER	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                    WHEN '4' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '3' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '2' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '1' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                  END) AS QTY_QQ_1	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                    WHEN '4' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '3' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '2' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '1' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                  END) AS QTY_QQ_2	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                    WHEN '4' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '3' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '2' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '1' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                  END) AS QTY_QQ_3	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                    WHEN '4' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '3' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '2' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '1' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                  END) AS QTY_QQ_4	\n"
                //    + "	        FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n"
                //    + "	        WHERE 1=1 	\n"
                //    + "	        AND SUBSTR(STS.ABR_NO,1,3) = 'QCN'	\n"
                //    + "	        AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n"
                //    + "	        AND STS.FACTORY = MAT.FACTORY 	\n"
                //    + "	        AND STS.MAT_ID = MAT.MAT_ID 	\n"
                //    + "	        AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -13)), 'YYYYMMDD')||'220000'	\n"
                //    + "	        AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	        AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n"
                //    + "	        AND STS.DEFECT_CODE LIKE '%'	\n"
                //    + "	        AND STS.CUR_STEP LIKE '%'	\n"
                //    + "	        AND STS.OPER_1 >= 'A1000'	\n"
                //    + "	        AND STS.OPER_1 <= 'AZ010'	\n"
                //    + "	        AND STS.DEL_FLAG = ' '	\n"
                //    + "	        UNION ALL	\n"
                //    + "	        SELECT 'TOTAL - LRR' AS CUSTOMER	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                    WHEN '4' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '3' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '2' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '1' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                  END) AS QTY_QQ_1	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                    WHEN '4' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '3' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '2' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '1' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                  END) AS QTY_QQ_2	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                    WHEN '4' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '3' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '2' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '1' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                  END) AS QTY_QQ_3	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                    WHEN '4' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '3' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '2' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '1' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                  END) AS QTY_QQ_4	\n"
                //    + "	        FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n"
                //    + "	        WHERE 1=1 	\n"
                //    + "	        AND SUBSTR(STS.ABR_NO,1,3) = 'QCN'	\n"
                //    + "	        AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n"
                //    + "	        AND STS.FACTORY = MAT.FACTORY 	\n"
                //    + "	        AND STS.MAT_ID = MAT.MAT_ID 	\n"
                //    + "	        AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -13)), 'YYYYMMDD')||'220000'	\n"
                //    + "	        AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	        AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n"
                //    + "	        AND STS.DEFECT_CODE LIKE '%'	\n"
                //    + "	        AND STS.CUR_STEP LIKE '%'	\n"
                //    + "	        AND STS.OPER_1 >= 'A0000'	\n"
                //    + "	        AND STS.OPER_1 <= 'AZ010'	\n"
                //    + "	        AND STS.DEL_FLAG = ' '	\n"
                //    + "	        UNION ALL	\n"
                //    + "	        SELECT CASE STS.CUS_ID WHEN 'SE' THEN 'SEC - LRR'	\n"
                //    + "	                               WHEN 'HX' THEN 'HYNIX - LRR'	\n"
                //    + "	                               ELSE 'ETC - LRR'	\n"
                //    + "	               END AS CUSTOMER	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                    WHEN '4' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '3' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '2' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '1' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                  END) AS QTY_QQ_1	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                    WHEN '4' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '3' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '2' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '1' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                  END) AS QTY_QQ_2	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                    WHEN '4' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '3' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '2' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '1' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                  END) AS QTY_QQ_3	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                    WHEN '4' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '3' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '2' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                    WHEN '1' THEN 	\n"
                //    + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                    THEN 1	\n"
                //    + "	                                    ELSE 0 	\n"
                //    + "	                                END	\n"
                //    + "	                  END) AS QTY_QQ_4	\n"
                //    + "	        FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n"
                //    + "	        WHERE 1=1 	\n"
                //    + "	        AND SUBSTR(STS.ABR_NO,1,3) = 'QCN'	\n"
                //    + "	        AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n"
                //    + "	        AND STS.FACTORY = MAT.FACTORY 	\n"
                //    + "	        AND STS.MAT_ID = MAT.MAT_ID 	\n"
                //    + "	        AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -13)), 'YYYYMMDD')||'220000'	\n"
                //    + "	        AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	        AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n"
                //    + "	        AND STS.DEFECT_CODE LIKE '%'	\n"
                //    + "	        AND STS.CUR_STEP LIKE '%'	\n"
                //    + "	        AND STS.OPER_1 >= 'A0000'	\n"
                //    + "	        AND STS.OPER_1 <= 'AZ010'	\n"
                //    + "	        AND STS.DEL_FLAG = ' '	\n"
                //    + "	        GROUP BY CASE STS.CUS_ID WHEN 'SE' THEN 'SEC - LRR'	\n"
                //    + "	                               WHEN 'HX' THEN 'HYNIX - LRR'	\n"
                //    + "	                               ELSE 'ETC - LRR'	\n"
                //    + "	                 END	\n"
                //    + "	    ) A,	\n"
                //    + "	    (	\n"
                //    + "	        SELECT 'Front - LRR' AS CUSTOMER 	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                WHEN '4' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '3' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '2' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '1' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'04'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'04', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	              END) AS LOT_QTY_QQ_1	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                WHEN '4' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '3' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '2' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '1' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	              END) AS LOT_QTY_QQ_2	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                WHEN '4' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '3' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '2' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '1' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	              END) AS LOT_QTY_QQ_3	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                WHEN '4' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'10'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'10', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '3' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '2' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '1' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	              END) AS LOT_QTY_QQ_4	\n"
                //    + "	        FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n"
                //    + "	        WHERE A.FACTORY = B.FACTORY  	\n"
                //    + "	        AND A.MAT_ID = B.MAT_ID  	\n"
                //    + "	        AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                //    + "	        AND A.WORK_MONTH >= TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -11), 'YYYYMM') 	\n"
                //    + "	        AND A.WORK_MONTH <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMM')	\n"
                //    + "	        AND A.QC_OPER IN ('PVI','QC GATE')    	\n"
                //    + "	        AND A.QC_TYPE LIKE 'GATE' || '%'  	\n"
                //    + "	        AND B.MAT_GRP_1 LIKE '%'	\n"
                //    + "	        UNION ALL	\n"
                //    + "	        SELECT 'B/E - LRR' AS CUSTOMER 	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                WHEN '4' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '3' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '2' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '1' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'04'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'04', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	              END) AS LOT_QTY_QQ_1	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                WHEN '4' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '3' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '2' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '1' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	              END) AS LOT_QTY_QQ_2	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                WHEN '4' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '3' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '2' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '1' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	              END) AS LOT_QTY_QQ_3	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                WHEN '4' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'10'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'10', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '3' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '2' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '1' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	              END) AS LOT_QTY_QQ_4	\n"
                //    + "	        FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n"
                //    + "	        WHERE A.FACTORY = B.FACTORY  	\n"
                //    + "	        AND A.MAT_ID = B.MAT_ID  	\n"
                //    + "	        AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                //    + "	        AND A.WORK_MONTH >= TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -11), 'YYYYMM') 	\n"
                //    + "	        AND A.WORK_MONTH <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMM')	\n"
                //    + "	        AND A.QC_OPER IN ('PVI','QC GATE')    	\n"
                //    + "	        AND A.QC_TYPE LIKE 'GATE' || '%'  	\n"
                //    + "	        AND B.MAT_GRP_1 LIKE '%'	\n"
                //    + "	        UNION ALL	\n"
                //    + "	        SELECT 'TOTAL - LRR' AS CUSTOMER 	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                WHEN '4' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '3' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '2' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '1' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'04'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'04', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	              END) AS LOT_QTY_QQ_1	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                WHEN '4' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '3' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '2' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '1' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	              END) AS LOT_QTY_QQ_2	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                WHEN '4' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '3' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '2' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '1' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	              END) AS LOT_QTY_QQ_3	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                WHEN '4' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'10'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'10', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '3' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '2' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '1' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	              END) AS LOT_QTY_QQ_4	\n"
                //    + "	        FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n"
                //    + "	        WHERE A.FACTORY = B.FACTORY  	\n"
                //    + "	        AND A.MAT_ID = B.MAT_ID  	\n"
                //    + "	        AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                //    + "	        AND A.WORK_MONTH >= TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -11), 'YYYYMM') 	\n"
                //    + "	        AND A.WORK_MONTH <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMM')	\n"
                //    + "	        AND A.QC_OPER IN ('PVI','QC GATE')    	\n"
                //    + "	        AND A.QC_TYPE LIKE 'GATE' || '%'  	\n"
                //    + "	        AND B.MAT_GRP_1 LIKE '%'	\n"
                //    + "	        UNION ALL	\n"
                //    + "	        SELECT CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC - LRR'	\n"
                //    + "	                                WHEN 'HX' THEN 'HYNIX - LRR'	\n"
                //    + "	                                ELSE 'ETC - LRR'	\n"
                //    + "	               END AS CUSTOMER 	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                WHEN '4' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '3' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '2' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '1' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'04'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'04', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	              END) AS LOT_QTY_QQ_1	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                WHEN '4' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '3' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '2' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '1' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	              END) AS LOT_QTY_QQ_2	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                WHEN '4' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '3' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '2' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '1' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	              END) AS LOT_QTY_QQ_3	\n"
                //    + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                //    + "	                WHEN '4' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'10'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'10', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '3' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '2' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	                WHEN '1' THEN 	\n"
                //    + "	                            CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n"
                //    + "	                                        AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n"
                //    + "	                                THEN A.QC_LOT_QTY_1	\n"
                //    + "	                                ELSE 0 	\n"
                //    + "	                            END	\n"
                //    + "	              END) AS LOT_QTY_QQ_4	\n"
                //    + "	        FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n"
                //    + "	        WHERE A.FACTORY = B.FACTORY  	\n"
                //    + "	        AND A.MAT_ID = B.MAT_ID  	\n"
                //    + "	        AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                //    + "	        AND A.WORK_MONTH >= TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -11), 'YYYYMM') 	\n"
                //    + "	        AND A.WORK_MONTH <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMM')	\n"
                //    + "	        AND A.QC_OPER IN ('PVI','QC GATE')    	\n"
                //    + "	        AND A.QC_TYPE LIKE 'GATE' || '%'  	\n"
                //    + "	        AND B.MAT_GRP_1 LIKE '%'	\n"
                //    + "	        GROUP BY CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC - LRR'	\n"
                //    + "	                                  WHEN 'HX' THEN 'HYNIX - LRR'	\n"
                //    + "	                                  ELSE 'ETC - LRR'	\n"
                //    + "	                 END	\n"
                //    + "	    ) B	\n"
                //    + "	    WHERE A.CUSTOMER = B.CUSTOMER	\n"
                //    + "	    UNION ALL	\n"
                //    + "	    SELECT A.CUSTOMER AS GUBUN	\n"
                //    + "	        , 0 AS QTY_QQ_1	\n"
                //    + "	        , 0 AS QTY_QQ_2	\n"
                //    + "	        , 0 AS QTY_QQ_3	\n"
                //    + "	        , 0 AS QTY_QQ_4	\n"
                //    + "	        , CASE WHEN A.QTY_MM_1 > 0 AND B.LOT_QTY_MM_1 > 0 THEN ROUND(A.QTY_MM_1 / B.LOT_QTY_MM_1 * 100, 2) ELSE 0 END AS QTY_MM_1	\n"
                //    + "	        , CASE WHEN A.QTY_MM_2 > 0 AND B.LOT_QTY_MM_2 > 0 THEN ROUND(A.QTY_MM_2 / B.LOT_QTY_MM_2 * 100, 2) ELSE 0 END AS QTY_MM_2	\n"
                //    + "	        , CASE WHEN A.QTY_MM_3 > 0 AND B.LOT_QTY_MM_3 > 0 THEN ROUND(A.QTY_MM_3 / B.LOT_QTY_MM_3 * 100, 2) ELSE 0 END AS QTY_MM_3	\n"
                //    + "	        , CASE WHEN A.QTY_MM_4 > 0 AND B.LOT_QTY_MM_4 > 0 THEN ROUND(A.QTY_MM_4 / B.LOT_QTY_MM_4 * 100, 2) ELSE 0 END AS QTY_MM_4	\n"
                //    + "	        , 0 AS QTY_WW_1	\n"
                //    + "	        , 0 AS QTY_WW_2	\n"
                //    + "	        , 0 AS QTY_WW_3	\n"
                //    + "	        , 0 AS QTY_WW_4	\n"
                //    + "	        , 0 AS QTY_DD_1	\n"
                //    + "	        , 0 AS QTY_DD_2	\n"
                //    + "	        , 0 AS QTY_DD_3	\n"
                //    + "	        , 0 AS QTY_DD_4	\n"
                //    + "	        , 0 AS QTY_DD_5	\n"
                //    + "	        , 0 AS QTY_DD_6	\n"
                //    + "	        , 0 AS QTY_DD_7	\n"
                //    + "	    FROM(	\n"
                //    + "	        SELECT 'Front - LRR' AS CUSTOMER	\n"
                //    + "	            ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                        THEN 1	\n"
                //    + "	                        ELSE 0	\n"
                //    + "	                 END) AS QTY_MM_1	\n"
                //    + "	            ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                        THEN 1	\n"
                //    + "	                        ELSE 0	\n"
                //    + "	                 END) AS QTY_MM_2	\n"
                //    + "	            ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                        THEN 1	\n"
                //    + "	                        ELSE 0	\n"
                //    + "	                 END) AS QTY_MM_3	\n"
                //    + "	            ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 0)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                        THEN 1	\n"
                //    + "	                        ELSE 0	\n"
                //    + "	                 END) AS QTY_MM_4	\n"
                //    + "	        FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n"
                //    + "	        WHERE 1=1 	\n"
                //    + "	        AND SUBSTR(STS.ABR_NO,1,3) = 'QCN'	\n"
                //    + "	        AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n"
                //    + "	        AND STS.FACTORY = MAT.FACTORY 	\n"
                //    + "	        AND STS.MAT_ID = MAT.MAT_ID 	\n"
                //    + "	        AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                //    + "	        AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	        AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n"
                //    + "	        AND STS.DEFECT_CODE LIKE '%'	\n"
                //    + "	        AND STS.CUR_STEP LIKE '%'	\n"
                //    + "	        AND STS.OPER_1 >= 'A0000'	\n"
                //    + "	        AND STS.OPER_1 <= 'A0970'	\n"
                //    + "	        AND STS.DEL_FLAG = ' '	\n"
                //    + "	        UNION ALL	\n"
                //    + "	        SELECT 'B/E - LRR' AS CUSTOMER	\n"
                //    + "	            ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                        THEN 1	\n"
                //    + "	                        ELSE 0	\n"
                //    + "	                 END) AS QTY_MM_1	\n"
                //    + "	            ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                        THEN 1	\n"
                //    + "	                        ELSE 0	\n"
                //    + "	                 END) AS QTY_MM_2	\n"
                //    + "	            ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                        THEN 1	\n"
                //    + "	                        ELSE 0	\n"
                //    + "	                 END) AS QTY_MM_3	\n"
                //    + "	            ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 0)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                        THEN 1	\n"
                //    + "	                        ELSE 0	\n"
                //    + "	                 END) AS QTY_MM_4	\n"
                //    + "	        FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n"
                //    + "	        WHERE 1=1 	\n"
                //    + "	        AND SUBSTR(STS.ABR_NO,1,3) = 'QCN'	\n"
                //    + "	        AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n"
                //    + "	        AND STS.FACTORY = MAT.FACTORY 	\n"
                //    + "	        AND STS.MAT_ID = MAT.MAT_ID 	\n"
                //    + "	        AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                //    + "	        AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	        AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n"
                //    + "	        AND STS.DEFECT_CODE LIKE '%'	\n"
                //    + "	        AND STS.CUR_STEP LIKE '%'	\n"
                //    + "	        AND STS.OPER_1 >= 'A1000'	\n"
                //    + "	        AND STS.OPER_1 <= 'AZ010'	\n"
                //    + "	        AND STS.DEL_FLAG = ' '	\n"
                //    + "	        UNION ALL	\n"
                //    + "	        SELECT 'TOTAL - LRR' AS CUSTOMER	\n"
                //    + "	            ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                        THEN 1	\n"
                //    + "	                        ELSE 0	\n"
                //    + "	                 END) AS QTY_MM_1	\n"
                //    + "	            ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                        THEN 1	\n"
                //    + "	                        ELSE 0	\n"
                //    + "	                 END) AS QTY_MM_2	\n"
                //    + "	            ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                        THEN 1	\n"
                //    + "	                        ELSE 0	\n"
                //    + "	                 END) AS QTY_MM_3	\n"
                //    + "	            ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 0)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                        THEN 1	\n"
                //    + "	                        ELSE 0	\n"
                //    + "	                 END) AS QTY_MM_4	\n"
                //    + "	        FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n"
                //    + "	        WHERE 1=1 	\n"
                //    + "	        AND SUBSTR(STS.ABR_NO,1,3) = 'QCN'	\n"
                //    + "	        AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n"
                //    + "	        AND STS.FACTORY = MAT.FACTORY 	\n"
                //    + "	        AND STS.MAT_ID = MAT.MAT_ID 	\n"
                //    + "	        AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                //    + "	        AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	        AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n"
                //    + "	        AND STS.DEFECT_CODE LIKE '%'	\n"
                //    + "	        AND STS.CUR_STEP LIKE '%'	\n"
                //    + "	        AND STS.OPER_1 >= 'A0000'	\n"
                //    + "	        AND STS.OPER_1 <= 'AZ010'	\n"
                //    + "	        AND STS.DEL_FLAG = ' '	\n"
                //    + "	        UNION ALL	\n"
                //    + "	        SELECT CASE STS.CUS_ID WHEN 'SE' THEN 'SEC - LRR'	\n"
                //    + "	                               WHEN 'HX' THEN 'HYNIX - LRR'	\n"
                //    + "	                               ELSE 'ETC - LRR'	\n"
                //    + "	               END AS CUSTOMER	\n"
                //    + "	            ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                        THEN 1	\n"
                //    + "	                        ELSE 0	\n"
                //    + "	                 END) AS QTY_MM_1	\n"
                //    + "	            ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                        THEN 1	\n"
                //    + "	                        ELSE 0	\n"
                //    + "	                 END) AS QTY_MM_2	\n"
                //    + "	            ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                        THEN 1	\n"
                //    + "	                        ELSE 0	\n"
                //    + "	                 END) AS QTY_MM_3	\n"
                //    + "	            ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 0)), 'YYYYMMDD')||'220000'	\n"
                //    + "	                        THEN 1	\n"
                //    + "	                        ELSE 0	\n"
                //    + "	                 END) AS QTY_MM_4	\n"
                //    + "	        FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n"
                //    + "	        WHERE 1=1 	\n"
                //    + "	        AND SUBSTR(STS.ABR_NO,1,3) = 'QCN'	\n"
                //    + "	        AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n"
                //    + "	        AND STS.FACTORY = MAT.FACTORY 	\n"
                //    + "	        AND STS.MAT_ID = MAT.MAT_ID 	\n"
                //    + "	        AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                //    + "	        AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	        AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n"
                //    + "	        AND STS.DEFECT_CODE LIKE '%'	\n"
                //    + "	        AND STS.CUR_STEP LIKE '%'	\n"
                //    + "	        AND STS.OPER_1 >= 'A0000'	\n"
                //    + "	        AND STS.OPER_1 <= 'AZ010'	\n"
                //    + "	        AND STS.DEL_FLAG = ' '	\n"
                //    + "	        GROUP BY CASE STS.CUS_ID WHEN 'SE' THEN 'SEC - LRR'	\n"
                //    + "	                               WHEN 'HX' THEN 'HYNIX - LRR'	\n"
                //    + "	                               ELSE 'ETC - LRR'	\n"
                //    + "	                 END	\n"
                //    + "	    ) A,	\n"
                //    + "	    (	\n"
                //    + "	        SELECT 'Front - LRR' AS CUSTOMER 	\n"
                //    + "	            , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_1	\n"
                //    + "	            , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_2	\n"
                //    + "	            , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_3	\n"
                //    + "	            , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_4	\n"
                //    + "	        FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n"
                //    + "	        WHERE A.FACTORY = B.FACTORY  	\n"
                //    + "	        AND A.MAT_ID = B.MAT_ID  	\n"
                //    + "	        AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                //    + "	        AND A.WORK_MONTH >= TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4), 'YYYYMM') 	\n"
                //    + "	        AND A.WORK_MONTH <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMM')	\n"
                //    + "	        AND A.QC_OPER IN ('PVI','QC GATE')    	\n"
                //    + "	        AND A.QC_TYPE LIKE 'GATE' || '%'  	\n"
                //    + "	        AND B.MAT_GRP_1 LIKE '%'	\n"
                //    + "	        UNION ALL	\n"
                //    + "	        SELECT 'B/E - LRR' AS CUSTOMER 	\n"
                //    + "	            , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_1	\n"
                //    + "	            , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_2	\n"
                //    + "	            , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_3	\n"
                //    + "	            , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_4	\n"
                //    + "	        FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n"
                //    + "	        WHERE A.FACTORY = B.FACTORY  	\n"
                //    + "	        AND A.MAT_ID = B.MAT_ID  	\n"
                //    + "	        AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                //    + "	        AND A.WORK_MONTH >= TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4), 'YYYYMM') 	\n"
                //    + "	        AND A.WORK_MONTH <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMM')	\n"
                //    + "	        AND A.QC_OPER IN ('PVI','QC GATE')    	\n"
                //    + "	        AND A.QC_TYPE LIKE 'GATE' || '%'  	\n"
                //    + "	        AND B.MAT_GRP_1 LIKE '%'	\n"
                //    + "	        UNION ALL	\n"
                //    + "	        SELECT 'TOTAL - LRR' AS CUSTOMER 	\n"
                //    + "	            , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_1	\n"
                //    + "	            , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_2	\n"
                //    + "	            , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_3	\n"
                //    + "	            , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_4	\n"
                //    + "	        FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n"
                //    + "	        WHERE A.FACTORY = B.FACTORY  	\n"
                //    + "	        AND A.MAT_ID = B.MAT_ID  	\n"
                //    + "	        AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                //    + "	        AND A.WORK_MONTH >= TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4), 'YYYYMM') 	\n"
                //    + "	        AND A.WORK_MONTH <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMM')	\n"
                //    + "	        AND A.QC_OPER IN ('PVI','QC GATE')    	\n"
                //    + "	        AND A.QC_TYPE LIKE 'GATE' || '%'  	\n"
                //    + "	        AND B.MAT_GRP_1 LIKE '%'	\n"
                //    + "	        UNION ALL	\n"
                //    + "	        SELECT CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC - LRR'	\n"
                //    + "	                                WHEN 'HX' THEN 'HYNIX - LRR'	\n"
                //    + "	                                ELSE 'ETC - LRR'	\n"
                //    + "	               END AS CUSTOMER 	\n"
                //    + "	            , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_1	\n"
                //    + "	            , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_2	\n"
                //    + "	            , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_3	\n"
                //    + "	            , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_4	\n"
                //    + "	        FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n"
                //    + "	        WHERE A.FACTORY = B.FACTORY  	\n"
                //    + "	        AND A.MAT_ID = B.MAT_ID  	\n"
                //    + "	        AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                //    + "	        AND A.WORK_MONTH >= TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4), 'YYYYMM') 	\n"
                //    + "	        AND A.WORK_MONTH <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMM')	\n"
                //    + "	        AND A.QC_OPER IN ('PVI','QC GATE')    	\n"
                //    + "	        AND A.QC_TYPE LIKE 'GATE' || '%'  	\n"
                //    + "	        AND B.MAT_GRP_1 LIKE '%'	\n"
                //    + "	        GROUP BY CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC - LRR'	\n"
                //    + "	                                  WHEN 'HX' THEN 'HYNIX - LRR'	\n"
                //    + "	                                  ELSE 'ETC - LRR'	\n"
                //    + "	                 END	\n"
                //    + "	    ) B	\n"
                //    + "	    WHERE A.CUSTOMER = B.CUSTOMER	\n"
                //    + "	    UNION ALL	\n"
                //    + "	    SELECT A.CUSTOMER AS GUBUN	\n"
                //    + "	        , 0 AS QTY_QQ_1	\n"
                //    + "	        , 0 AS QTY_QQ_2	\n"
                //    + "	        , 0 AS QTY_QQ_3	\n"
                //    + "	        , 0 AS QTY_QQ_4	\n"
                //    + "	        , 0 AS QTY_MM_1	\n"
                //    + "	        , 0 AS QTY_MM_2	\n"
                //    + "	        , 0 AS QTY_MM_3	\n"
                //    + "	        , 0 AS QTY_MM_4	\n"
                //    + "	        , CASE WHEN A.QTY_WW_1 > 0 AND B.LOT_QTY_WW_1 > 0 THEN ROUND(A.QTY_WW_1 / B.LOT_QTY_WW_1 * 100, 2) ELSE 0 END AS QTY_WW_1	\n"
                //    + "	        , CASE WHEN A.QTY_WW_2 > 0 AND B.LOT_QTY_WW_2 > 0 THEN ROUND(A.QTY_WW_2 / B.LOT_QTY_WW_2 * 100, 2) ELSE 0 END AS QTY_WW_2	\n"
                //    + "	        , CASE WHEN A.QTY_WW_3 > 0 AND B.LOT_QTY_WW_3 > 0 THEN ROUND(A.QTY_WW_3 / B.LOT_QTY_WW_3 * 100, 2) ELSE 0 END AS QTY_WW_3	\n"
                //    + "	        , CASE WHEN A.QTY_WW_4 > 0 AND B.LOT_QTY_WW_4 > 0 THEN ROUND(A.QTY_WW_4 / B.LOT_QTY_WW_4 * 100, 2) ELSE 0 END AS QTY_WW_4	\n"
                //    + "	        , 0 AS QTY_DD_1	\n"
                //    + "	        , 0 AS QTY_DD_2	\n"
                //    + "	        , 0 AS QTY_DD_3	\n"
                //    + "	        , 0 AS QTY_DD_4	\n"
                //    + "	        , 0 AS QTY_DD_5	\n"
                //    + "	        , 0 AS QTY_DD_6	\n"
                //    + "	        , 0 AS QTY_DD_7	\n"
                //    + "	    FROM(	\n"
                //    + "	        SELECT 'Front - LRR' AS CUSTOMER	\n"
                //    + "	            , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 28, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                           END	\n"
                //    + "	                        AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                      WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                      WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                           END THEN 1 ELSE 0 END) AS QTY_WW_1	\n"
                //    + "	            , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                           END	\n"
                //    + "	                        AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')||'220000'   	\n"
                //    + "	                                                                      WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')||'220000'   	\n"
                //    + "	                                                                      WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                      WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                      WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                      WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                      WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                           END THEN 1 ELSE 0 END) AS QTY_WW_2	\n"
                //    + "	            , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                           END	\n"
                //    + "	                        AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                           END THEN 1 ELSE 0 END) AS QTY_WW_3	\n"
                //    + "	            , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                           END	\n"
                //    + "	                        AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 6, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 5, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 4, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                      WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 3, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                      WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 2, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                      WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 1, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                      WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 0, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                           END THEN 1 ELSE 0 END) AS QTY_WW_4	\n"
                //    + "	        FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n"
                //    + "	        WHERE 1=1 	\n"
                //    + "	        AND SUBSTR(STS.ABR_NO,1,3) = 'QCN'	\n"
                //    + "	        AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n"
                //    + "	        AND STS.FACTORY = MAT.FACTORY 	\n"
                //    + "	        AND STS.MAT_ID = MAT.MAT_ID	\n"
                //    + "	        AND STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 28, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                               END 	\n"
                //    + "	        AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	        AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n"
                //    + "	        AND STS.DEFECT_CODE LIKE '%'	\n"
                //    + "	        AND STS.CUR_STEP LIKE '%'	\n"
                //    + "	        AND STS.OPER_1 >= 'A0000'	\n"
                //    + "	        AND STS.OPER_1 <= 'A0970'	\n"
                //    + "	        AND STS.DEL_FLAG = ' '	\n"
                //    + "	        UNION ALL	\n"
                //    + "	        SELECT 'B/E - LRR' AS CUSTOMER	\n"
                //    + "	            , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 28, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                           END	\n"
                //    + "	                        AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                      WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                      WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                           END THEN 1 ELSE 0 END) AS QTY_WW_1	\n"
                //    + "	            , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                           END	\n"
                //    + "	                        AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')||'220000'   	\n"
                //    + "	                                                                      WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')||'220000'   	\n"
                //    + "	                                                                      WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                      WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                      WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                      WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                      WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                           END THEN 1 ELSE 0 END) AS QTY_WW_2	\n"
                //    + "	            , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                           END	\n"
                //    + "	                        AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                           END THEN 1 ELSE 0 END) AS QTY_WW_3	\n"
                //    + "	            , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                           END	\n"
                //    + "	                        AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 6, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 5, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 4, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                      WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 3, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                      WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 2, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                      WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 1, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                      WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 0, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                           END THEN 1 ELSE 0 END) AS QTY_WW_4	\n"
                //    + "	        FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n"
                //    + "	        WHERE 1=1 	\n"
                //    + "	        AND SUBSTR(STS.ABR_NO,1,3) = 'QCN'	\n"
                //    + "	        AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n"
                //    + "	        AND STS.FACTORY = MAT.FACTORY 	\n"
                //    + "	        AND STS.MAT_ID = MAT.MAT_ID	\n"
                //    + "	        AND STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 28, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                               END 	\n"
                //    + "	        AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	        AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n"
                //    + "	        AND STS.DEFECT_CODE LIKE '%'	\n"
                //    + "	        AND STS.CUR_STEP LIKE '%'	\n"
                //    + "	        AND STS.OPER_1 >= 'A1000'	\n"
                //    + "	        AND STS.OPER_1 <= 'AZ010'	\n"
                //    + "	        AND STS.DEL_FLAG = ' '	\n"
                //    + "	        UNION ALL	\n"
                //    + "	        SELECT 'TOTAL - LRR' AS CUSTOMER	\n"
                //    + "	            , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 28, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                           END	\n"
                //    + "	                        AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                      WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                      WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                           END THEN 1 ELSE 0 END) AS QTY_WW_1	\n"
                //    + "	            , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                           END	\n"
                //    + "	                        AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')||'220000'   	\n"
                //    + "	                                                                      WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')||'220000'   	\n"
                //    + "	                                                                      WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                      WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                      WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                      WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                      WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                           END THEN 1 ELSE 0 END) AS QTY_WW_2	\n"
                //    + "	            , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                           END	\n"
                //    + "	                        AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                           END THEN 1 ELSE 0 END) AS QTY_WW_3	\n"
                //    + "	            , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                           END	\n"
                //    + "	                        AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 6, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 5, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 4, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                      WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 3, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                      WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 2, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                      WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 1, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                      WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 0, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                           END THEN 1 ELSE 0 END) AS QTY_WW_4 	\n"
                //    + "	        FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n"
                //    + "	        WHERE 1=1 	\n"
                //    + "	        AND SUBSTR(STS.ABR_NO,1,3) = 'QCN'	\n"
                //    + "	        AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n"
                //    + "	        AND STS.FACTORY = MAT.FACTORY 	\n"
                //    + "	        AND STS.MAT_ID = MAT.MAT_ID	\n"
                //    + "	        AND STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 28, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                               END 	\n"
                //    + "	        AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	        AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n"
                //    + "	        AND STS.DEFECT_CODE LIKE '%'	\n"
                //    + "	        AND STS.CUR_STEP LIKE '%'	\n"
                //    + "	        AND STS.OPER_1 >= 'A0000'	\n"
                //    + "	        AND STS.OPER_1 <= 'AZ010'	\n"
                //    + "	        AND STS.DEL_FLAG = ' '	\n"
                //    + "	        UNION ALL	\n"
                //    + "	        SELECT CASE STS.CUS_ID WHEN 'SE' THEN 'SEC - LRR'	\n"
                //    + "	                               WHEN 'HX' THEN 'HYNIX - LRR'	\n"
                //    + "	                               ELSE 'ETC - LRR'	\n"
                //    + "	               END AS CUSTOMER	\n"
                //    + "	            , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 28, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                           END	\n"
                //    + "	                        AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                      WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                      WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                           END THEN 1 ELSE 0 END) AS QTY_WW_1	\n"
                //    + "	            , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                           END	\n"
                //    + "	                        AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')||'220000'   	\n"
                //    + "	                                                                      WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')||'220000'   	\n"
                //    + "	                                                                      WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                      WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                      WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                      WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                      WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                           END THEN 1 ELSE 0 END) AS QTY_WW_2	\n"
                //    + "	            , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')||'220000'  	\n"
                //    + "	                                           END	\n"
                //    + "	                        AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                           END THEN 1 ELSE 0 END) AS QTY_WW_3	\n"
                //    + "	            , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                           END	\n"
                //    + "	                        AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 6, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 5, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                                      WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 4, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                      WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 3, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                      WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 2, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                      WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 1, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                                      WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 0, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                           END THEN 1 ELSE 0 END) AS QTY_WW_4	\n"
                //    + "	        FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n"
                //    + "	        WHERE 1=1 	\n"
                //    + "	        AND SUBSTR(STS.ABR_NO,1,3) = 'QCN'	\n"
                //    + "	        AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n"
                //    + "	        AND STS.FACTORY = MAT.FACTORY 	\n"
                //    + "	        AND STS.MAT_ID = MAT.MAT_ID	\n"
                //    + "	        AND STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')||'220000' 	\n"
                //    + "	                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 28, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                               END 	\n"
                //    + "	        AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	        AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n"
                //    + "	        AND STS.DEFECT_CODE LIKE '%'	\n"
                //    + "	        AND STS.CUR_STEP LIKE '%'	\n"
                //    + "	        AND STS.OPER_1 >= 'A0000'	\n"
                //    + "	        AND STS.OPER_1 <= 'AZ010'	\n"
                //    + "	        AND STS.DEL_FLAG = ' '	\n"
                //    + "	        GROUP BY CASE STS.CUS_ID WHEN 'SE' THEN 'SEC - LRR'	\n"
                //    + "	                               WHEN 'HX' THEN 'HYNIX - LRR'	\n"
                //    + "	                               ELSE 'ETC - LRR'	\n"
                //    + "	                 END	\n"
                //    + "	    ) A,	\n"
                //    + "	    (	\n"
                //    + "	        SELECT 'Front - LRR' AS CUSTOMER 	\n"
                //    + "	            , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')	\n"
                //    + "	                                           END	\n"
                //    + "	                        AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')	\n"
                //    + "	                                           END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_1	\n"
                //    + "	            , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')	\n"
                //    + "	                                           END	\n"
                //    + "	                        AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')	\n"
                //    + "	                                           END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_2	\n"
                //    + "	            , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')	\n"
                //    + "	                                           END	\n"
                //    + "	                        AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')	\n"
                //    + "	                                           END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_3	\n"
                //    + "	            , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 0, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')	\n"
                //    + "	                                           END	\n"
                //    + "	                        AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 6, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 5, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 4, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 3, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 2, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 1, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 0, 'YYYYMMDD')	\n"
                //    + "	                                           END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_4	\n"
                //    + "	        FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n"
                //    + "	        WHERE A.FACTORY = B.FACTORY  	\n"
                //    + "	        AND A.MAT_ID = B.MAT_ID  	\n"
                //    + "	        AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                //    + "	        AND A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')	\n"
                //    + "	                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')	\n"
                //    + "	                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')	\n"
                //    + "	                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')	\n"
                //    + "	                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')	\n"
                //    + "	                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')	\n"
                //    + "	                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')	\n"
                //    + "	                           END 	\n"
                //    + "	        AND A.WORK_DATE <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD') 	\n"
                //    + "	        AND A.QC_OPER IN ('PVI','QC GATE')    	\n"
                //    + "	        AND A.QC_TYPE LIKE 'GATE' || '%'  	\n"
                //    + "	        AND B.MAT_GRP_1 LIKE '%'	\n"
                //    + "	        UNION ALL	\n"
                //    + "	        SELECT 'B/E - LRR' AS CUSTOMER 	\n"
                //    + "	            , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')	\n"
                //    + "	                                           END	\n"
                //    + "	                        AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')	\n"
                //    + "	                                           END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_1	\n"
                //    + "	            , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')	\n"
                //    + "	                                           END	\n"
                //    + "	                        AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')	\n"
                //    + "	                                           END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_2	\n"
                //    + "	            , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')	\n"
                //    + "	                                           END	\n"
                //    + "	                        AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')	\n"
                //    + "	                                           END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_3	\n"
                //    + "	            , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 0, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')	\n"
                //    + "	                                           END	\n"
                //    + "	                        AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 6, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 5, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 4, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 3, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 2, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 1, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 0, 'YYYYMMDD')	\n"
                //    + "	                                           END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_4	\n"
                //    + "	        FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n"
                //    + "	        WHERE A.FACTORY = B.FACTORY  	\n"
                //    + "	        AND A.MAT_ID = B.MAT_ID  	\n"
                //    + "	        AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                //    + "	        AND A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')	\n"
                //    + "	                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')	\n"
                //    + "	                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')	\n"
                //    + "	                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')	\n"
                //    + "	                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')	\n"
                //    + "	                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')	\n"
                //    + "	                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')	\n"
                //    + "	                           END 	\n"
                //    + "	        AND A.WORK_DATE <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD') 	\n"
                //    + "	        AND A.QC_OPER IN ('PVI','QC GATE')    	\n"
                //    + "	        AND A.QC_TYPE LIKE 'GATE' || '%'  	\n"
                //    + "	        AND B.MAT_GRP_1 LIKE '%'	\n"
                //    + "	        UNION ALL	\n"
                //    + "	        SELECT 'TOTAL - LRR' AS CUSTOMER 	\n"
                //    + "	            , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')	\n"
                //    + "	                                           END	\n"
                //    + "	                        AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')	\n"
                //    + "	                                           END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_1	\n"
                //    + "	            , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')	\n"
                //    + "	                                           END	\n"
                //    + "	                        AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')	\n"
                //    + "	                                           END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_2	\n"
                //    + "	            , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')	\n"
                //    + "	                                           END	\n"
                //    + "	                        AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')	\n"
                //    + "	                                           END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_3	\n"
                //    + "	            , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 0, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')	\n"
                //    + "	                                           END	\n"
                //    + "	                        AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 6, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 5, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 4, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 3, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 2, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 1, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 0, 'YYYYMMDD')	\n"
                //    + "	                                           END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_4	\n"
                //    + "	        FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n"
                //    + "	        WHERE A.FACTORY = B.FACTORY  	\n"
                //    + "	        AND A.MAT_ID = B.MAT_ID  	\n"
                //    + "	        AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                //    + "	        AND A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')	\n"
                //    + "	                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')	\n"
                //    + "	                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')	\n"
                //    + "	                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')	\n"
                //    + "	                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')	\n"
                //    + "	                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')	\n"
                //    + "	                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')	\n"
                //    + "	                           END 	\n"
                //    + "	        AND A.WORK_DATE <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD') 	\n"
                //    + "	        AND A.QC_OPER IN ('PVI','QC GATE')    	\n"
                //    + "	        AND A.QC_TYPE LIKE 'GATE' || '%'  	\n"
                //    + "	        AND B.MAT_GRP_1 LIKE '%'	\n"
                //    + "	        UNION ALL	\n"
                //    + "	        SELECT CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC - LRR'	\n"
                //    + "	                                WHEN 'HX' THEN 'HYNIX - LRR'	\n"
                //    + "	                                ELSE 'ETC - LRR'	\n"
                //    + "	               END AS CUSTOMER 	\n"
                //    + "	            , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')	\n"
                //    + "	                                           END	\n"
                //    + "	                        AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')	\n"
                //    + "	                                           END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_1	\n"
                //    + "	            , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')	\n"
                //    + "	                                           END	\n"
                //    + "	                        AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')	\n"
                //    + "	                                           END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_2	\n"
                //    + "	            , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')	\n"
                //    + "	                                           END	\n"
                //    + "	                        AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')	\n"
                //    + "	                                           END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_3	\n"
                //    + "	            , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 0, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')	\n"
                //    + "	                                           END	\n"
                //    + "	                        AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 6, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 5, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 4, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 3, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 2, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 1, 'YYYYMMDD')	\n"
                //    + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 0, 'YYYYMMDD')	\n"
                //    + "	                                           END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_4	\n"
                //    + "	        FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n"
                //    + "	        WHERE A.FACTORY = B.FACTORY  	\n"
                //    + "	        AND A.MAT_ID = B.MAT_ID  	\n"
                //    + "	        AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                //    + "	        AND A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')	\n"
                //    + "	                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')	\n"
                //    + "	                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')	\n"
                //    + "	                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')	\n"
                //    + "	                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')	\n"
                //    + "	                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')	\n"
                //    + "	                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')	\n"
                //    + "	                           END 	\n"
                //    + "	        AND A.WORK_DATE <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD') 	\n"
                //    + "	        AND A.QC_OPER IN ('PVI','QC GATE')    	\n"
                //    + "	        AND A.QC_TYPE LIKE 'GATE' || '%'  	\n"
                //    + "	        AND B.MAT_GRP_1 LIKE '%'	\n"
                //    + "	        GROUP BY CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC - LRR'	\n"
                //    + "	                                  WHEN 'HX' THEN 'HYNIX - LRR'	\n"
                //    + "	                                  ELSE 'ETC - LRR'	\n"
                //    + "	                 END	\n"
                //    + "	    ) B	\n"
                //    + "	    WHERE A.CUSTOMER = B.CUSTOMER	\n"
                //    + "	    UNION ALL	\n"
                //    + "	    SELECT A.CUSTOMER AS GUBUN	\n"
                //    + "	        , 0 AS QTY_QQ_1	\n"
                //    + "	        , 0 AS QTY_QQ_2	\n"
                //    + "	        , 0 AS QTY_QQ_3	\n"
                //    + "	        , 0 AS QTY_QQ_4	\n"
                //    + "	        , 0 AS QTY_MM_1	\n"
                //    + "	        , 0 AS QTY_MM_2	\n"
                //    + "	        , 0 AS QTY_MM_3	\n"
                //    + "	        , 0 AS QTY_MM_4	\n"
                //    + "	        , 0 AS QTY_WW_1	\n"
                //    + "	        , 0 AS QTY_WW_2	\n"
                //    + "	        , 0 AS QTY_WW_3	\n"
                //    + "	        , 0 AS QTY_WW_4	\n"
                //    + "	        , CASE WHEN A.QTY_DD_1 > 0 AND B.LOT_QTY_DD_1 > 0 THEN ROUND(A.QTY_DD_1 / B.LOT_QTY_DD_1 * 100, 2) ELSE 0 END AS QTY_DD_1	\n"
                //    + "	        , CASE WHEN A.QTY_DD_2 > 0 AND B.LOT_QTY_DD_2 > 0 THEN ROUND(A.QTY_DD_2 / B.LOT_QTY_DD_2 * 100, 2) ELSE 0 END AS QTY_DD_2	\n"
                //    + "	        , CASE WHEN A.QTY_DD_3 > 0 AND B.LOT_QTY_DD_3 > 0 THEN ROUND(A.QTY_DD_3 / B.LOT_QTY_DD_3 * 100, 2) ELSE 0 END AS QTY_DD_3	\n"
                //    + "	        , CASE WHEN A.QTY_DD_4 > 0 AND B.LOT_QTY_DD_4 > 0 THEN ROUND(A.QTY_DD_4 / B.LOT_QTY_DD_4 * 100, 2) ELSE 0 END AS QTY_DD_4	\n"
                //    + "	        , CASE WHEN A.QTY_DD_5 > 0 AND B.LOT_QTY_DD_5 > 0 THEN ROUND(A.QTY_DD_5 / B.LOT_QTY_DD_5 * 100, 2) ELSE 0 END AS QTY_DD_5	\n"
                //    + "	        , CASE WHEN A.QTY_DD_6 > 0 AND B.LOT_QTY_DD_6 > 0 THEN ROUND(A.QTY_DD_6 / B.LOT_QTY_DD_6 * 100, 2) ELSE 0 END AS QTY_DD_6	\n"
                //    + "	        , CASE WHEN A.QTY_DD_7 > 0 AND B.LOT_QTY_DD_7 > 0 THEN ROUND(A.QTY_DD_7 / B.LOT_QTY_DD_7 * 100, 2) ELSE 0 END AS QTY_DD_7	\n"
                //    + "	    FROM(	\n"
                //    + "	        SELECT 'Front - LRR' AS CUSTOMER	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                        WHEN '금' 	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                        WHEN '목'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                  END) AS QTY_DD_1	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                        WHEN '토'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                        WHEN '금'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                  END) AS QTY_DD_2 	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                        WHEN '일' 	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                        WHEN '토'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                  END) AS QTY_DD_3 	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                        WHEN '월' 	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                        WHEN '일'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                  END) AS QTY_DD_4 	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                        WHEN '화'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                        WHEN '월'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                  END) AS QTY_DD_5 	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                        WHEN '수'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                        WHEN '화'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                  END) AS QTY_DD_6 	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                        WHEN '목' 	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                        WHEN '수'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                  END) AS QTY_DD_7	\n"
                //    + "	        FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n"
                //    + "	        WHERE 1=1 	\n"
                //    + "	        AND SUBSTR(STS.ABR_NO,1,3) = 'QCN'	\n"
                //    + "	        AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n"
                //    + "	        AND STS.FACTORY = MAT.FACTORY 	\n"
                //    + "	        AND STS.MAT_ID = MAT.MAT_ID	\n"
                //    + "	        AND STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                               END 	\n"
                //    + "	        AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	        AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n"
                //    + "	        AND STS.DEFECT_CODE LIKE '%'	\n"
                //    + "	        AND STS.CUR_STEP LIKE '%'	\n"
                //    + "	        AND STS.OPER_1 >= 'A0000'	\n"
                //    + "	        AND STS.OPER_1 <= 'A0970'	\n"
                //    + "	        AND STS.DEL_FLAG = ' '	\n"
                //    + "	        UNION ALL	\n"
                //    + "	        SELECT 'B/E - LRR' AS CUSTOMER	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                        WHEN '금' 	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                        WHEN '목'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                  END) AS QTY_DD_1	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                        WHEN '토'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                        WHEN '금'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                  END) AS QTY_DD_2 	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                        WHEN '일' 	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                        WHEN '토'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                  END) AS QTY_DD_3 	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                        WHEN '월' 	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                        WHEN '일'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                  END) AS QTY_DD_4 	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                        WHEN '화'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                        WHEN '월'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                  END) AS QTY_DD_5 	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                        WHEN '수'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                        WHEN '화'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                  END) AS QTY_DD_6 	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                        WHEN '목' 	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                        WHEN '수'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                  END) AS QTY_DD_7	\n"
                //    + "	        FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n"
                //    + "	        WHERE 1=1 	\n"
                //    + "	        AND SUBSTR(STS.ABR_NO,1,3) = 'QCN'	\n"
                //    + "	        AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n"
                //    + "	        AND STS.FACTORY = MAT.FACTORY 	\n"
                //    + "	        AND STS.MAT_ID = MAT.MAT_ID	\n"
                //    + "	        AND STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                               END 	\n"
                //    + "	        AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	        AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n"
                //    + "	        AND STS.DEFECT_CODE LIKE '%'	\n"
                //    + "	        AND STS.CUR_STEP LIKE '%'	\n"
                //    + "	        AND STS.OPER_1 >= 'A1000'	\n"
                //    + "	        AND STS.OPER_1 <= 'AZ010'	\n"
                //    + "	        AND STS.DEL_FLAG = ' '	\n"
                //    + "	        UNION ALL	\n"
                //    + "	        SELECT 'TOTAL - LRR' AS CUSTOMER	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                        WHEN '금' 	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                        WHEN '목'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                  END) AS QTY_DD_1	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                        WHEN '토'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                        WHEN '금'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                  END) AS QTY_DD_2 	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                        WHEN '일' 	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                        WHEN '토'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                  END) AS QTY_DD_3 	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                        WHEN '월' 	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                        WHEN '일'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                  END) AS QTY_DD_4 	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                        WHEN '화'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                        WHEN '월'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                  END) AS QTY_DD_5 	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                        WHEN '수'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                        WHEN '화'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                  END) AS QTY_DD_6 	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                        WHEN '목' 	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                        WHEN '수'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                  END) AS QTY_DD_7	\n"
                //    + "	        FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n"
                //    + "	        WHERE 1=1 	\n"
                //    + "	        AND SUBSTR(STS.ABR_NO,1,3) = 'QCN'	\n"
                //    + "	        AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n"
                //    + "	        AND STS.FACTORY = MAT.FACTORY 	\n"
                //    + "	        AND STS.MAT_ID = MAT.MAT_ID	\n"
                //    + "	        AND STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                               END 	\n"
                //    + "	        AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	        AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n"
                //    + "	        AND STS.DEFECT_CODE LIKE '%'	\n"
                //    + "	        AND STS.CUR_STEP LIKE '%'	\n"
                //    + "	        AND STS.OPER_1 >= 'A0000'	\n"
                //    + "	        AND STS.OPER_1 <= 'AZ010'	\n"
                //    + "	        AND STS.DEL_FLAG = ' '	\n"
                //    + "	        UNION ALL	\n"
                //    + "	        SELECT CASE STS.CUS_ID WHEN 'SE' THEN 'SEC - LRR'	\n"
                //    + "	                               WHEN 'HX' THEN 'HYNIX - LRR'	\n"
                //    + "	                               ELSE 'ETC - LRR'	\n"
                //    + "	               END AS CUSTOMER	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                        WHEN '금' 	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                        WHEN '목'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                  END) AS QTY_DD_1	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                        WHEN '토'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                        WHEN '금'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                  END) AS QTY_DD_2 	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                        WHEN '일' 	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                        WHEN '토'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                  END) AS QTY_DD_3 	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                        WHEN '월' 	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                        WHEN '일'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                  END) AS QTY_DD_4 	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                        WHEN '화'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                        WHEN '월'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                  END) AS QTY_DD_5 	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                        WHEN '수'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                        WHEN '화'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                  END) AS QTY_DD_6 	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                //    + "	                        WHEN '목' 	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                        WHEN '수'	\n"
                //    + "	                        THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	                                  THEN 1	\n"
                //    + "	                                  ELSE 0	\n"
                //    + "	                             END	\n"
                //    + "	                  END) AS QTY_DD_7	\n"
                //    + "	        FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n"
                //    + "	        WHERE 1=1 	\n"
                //    + "	        AND SUBSTR(STS.ABR_NO,1,3) = 'QCN'	\n"
                //    + "	        AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'	\n"
                //    + "	        AND STS.FACTORY = MAT.FACTORY 	\n"
                //    + "	        AND STS.MAT_ID = MAT.MAT_ID	\n"
                //    + "	        AND STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000'	\n"
                //    + "	                                               END 	\n"
                //    + "	        AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                //    + "	        AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n"
                //    + "	        AND STS.DEFECT_CODE LIKE '%'	\n"
                //    + "	        AND STS.CUR_STEP LIKE '%'	\n"
                //    + "	        AND STS.OPER_1 >= 'A0000'	\n"
                //    + "	        AND STS.OPER_1 <= 'AZ010'	\n"
                //    + "	        AND STS.DEL_FLAG = ' '	\n"
                //    + "	        GROUP BY CASE STS.CUS_ID WHEN 'SE' THEN 'SEC - LRR'	\n"
                //    + "	                               WHEN 'HX' THEN 'HYNIX - LRR'	\n"
                //    + "	                               ELSE 'ETC - LRR'	\n"
                //    + "	                 END	\n"
                //    + "	    ) A,	\n"
                //    + "	    (	\n"
                //    + "	        SELECT 'Front - LRR' AS CUSTOMER 	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '금' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_1 	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '토' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_2	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '일' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_3	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '월' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_4	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '화' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_5	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '수' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_6	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '목' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_7	\n"
                //    + "	        FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n"
                //    + "	        WHERE A.FACTORY = B.FACTORY  	\n"
                //    + "	        AND A.MAT_ID = B.MAT_ID  	\n"
                //    + "	        AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                //    + "	        AND A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 0, 'YYYYMMDD') 	\n"
                //    + "	                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD') 	\n"
                //    + "	                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD') 	\n"
                //    + "	                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD') 	\n"
                //    + "	                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD') 	\n"
                //    + "	                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD') 	\n"
                //    + "	                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD') 	\n"
                //    + "	                           END  	\n"
                //    + "	        AND A.WORK_DATE <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD') 	\n"
                //    + "	        AND A.QC_OPER IN ('PVI','QC GATE')    	\n"
                //    + "	        AND A.QC_TYPE LIKE 'GATE' || '%'  	\n"
                //    + "	        AND B.MAT_GRP_1 LIKE '%'	\n"
                //    + "	        UNION ALL	\n"
                //    + "	        SELECT 'B/E - LRR' AS CUSTOMER 	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '금' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_1 	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '토' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_2	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '일' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_3	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '월' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_4	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '화' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_5	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '수' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_6	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '목' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_7	\n"
                //    + "	        FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n"
                //    + "	        WHERE A.FACTORY = B.FACTORY  	\n"
                //    + "	        AND A.MAT_ID = B.MAT_ID  	\n"
                //    + "	        AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                //    + "	        AND A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 0, 'YYYYMMDD') 	\n"
                //    + "	                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD') 	\n"
                //    + "	                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD') 	\n"
                //    + "	                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD') 	\n"
                //    + "	                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD') 	\n"
                //    + "	                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD') 	\n"
                //    + "	                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD') 	\n"
                //    + "	                           END  	\n"
                //    + "	        AND A.WORK_DATE <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD') 	\n"
                //    + "	        AND A.QC_OPER IN ('PVI','QC GATE')    	\n"
                //    + "	        AND A.QC_TYPE LIKE 'GATE' || '%'  	\n"
                //    + "	        AND B.MAT_GRP_1 LIKE '%'	\n"
                //    + "	        UNION ALL	\n"
                //    + "	        SELECT 'TOTAL - LRR' AS CUSTOMER 	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '금' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_1 	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '토' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_2	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '일' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_3	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '월' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_4	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '화' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_5	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '수' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_6	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '목' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_7	\n"
                //    + "	        FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n"
                //    + "	        WHERE A.FACTORY = B.FACTORY  	\n"
                //    + "	        AND A.MAT_ID = B.MAT_ID  	\n"
                //    + "	        AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                //    + "	        AND A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 0, 'YYYYMMDD') 	\n"
                //    + "	                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD') 	\n"
                //    + "	                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD') 	\n"
                //    + "	                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD') 	\n"
                //    + "	                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD') 	\n"
                //    + "	                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD') 	\n"
                //    + "	                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD') 	\n"
                //    + "	                           END  	\n"
                //    + "	        AND A.WORK_DATE <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD') 	\n"
                //    + "	        AND A.QC_OPER IN ('PVI','QC GATE')    	\n"
                //    + "	        AND A.QC_TYPE LIKE 'GATE' || '%'  	\n"
                //    + "	        AND B.MAT_GRP_1 LIKE '%'	\n"
                //    + "	        UNION ALL	\n"
                //    + "	        SELECT CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC - LRR'	\n"
                //    + "	                                WHEN 'HX' THEN 'HYNIX - LRR'	\n"
                //    + "	                                ELSE 'ETC - LRR'	\n"
                //    + "	               END AS CUSTOMER 	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '금' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_1 	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '토' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_2	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '일' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_3	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '월' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_4	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '화' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_5	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '수' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_6	\n"
                //    + "	            , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '목' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_7	\n"
                //    + "	        FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n"
                //    + "	        WHERE A.FACTORY = B.FACTORY  	\n"
                //    + "	        AND A.MAT_ID = B.MAT_ID  	\n"
                //    + "	        AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                //    + "	        AND A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 0, 'YYYYMMDD') 	\n"
                //    + "	                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD') 	\n"
                //    + "	                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD') 	\n"
                //    + "	                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD') 	\n"
                //    + "	                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD') 	\n"
                //    + "	                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD') 	\n"
                //    + "	                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD') 	\n"
                //    + "	                           END	\n"
                //    + "	        AND A.WORK_DATE <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')	\n"
                //    + "	        AND A.QC_OPER IN ('PVI','QC GATE') 	\n"
                //    + "	        AND A.QC_TYPE LIKE 'GATE' || '%'	\n"
                //    + "	        AND B.MAT_GRP_1 LIKE '%'	\n"
                //    + "	        GROUP BY CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC - LRR'	\n"
                //    + "	                                  WHEN 'HX' THEN 'HYNIX - LRR'	\n"
                //    + "	                                  ELSE 'ETC - LRR'	\n"
                //    + "	                 END	\n"
                //    + "	    ) B	\n"
                //    + "	    WHERE A.CUSTOMER = B.CUSTOMER	\n"
                //    + "	)GROUP BY GUBUN	\n"
                //    + "	ORDER BY DECODE(GUBUN	\n"
                //    + "	                , 'FRONT - QCN 건수', 0, 'B/E - QCN 건수', 1, '검사LOT수', 2	\n"
                //    + "	                , 'Front - LRR', 3, 'B/E - LRR', 4, 'TOTAL - LRR', 5	\n"
                //    + "	                , 'SEC - QCN 건수', 6, 'SEC - 검사 LOT 수', 7, 'SEC - LRR', 8	\n"
                //    + "	                , 'HYNIX - QCN 건수', 9, 'HYNIX - 검사 LOT 수', 10, 'HYNIX - LRR', 11	\n"
                //    + "	                , 'ETC - QCN 건수', 12, 'ETC - 검사 LOT 수', 13, 'ETC - LRR', 14)	\n";


                #endregion

                // 쿼리를 하는데 시간이 오래 걸려 나눠서 Data를 가져오도록 수정
                dt1 = CmnFunction.oComm.GetFuncDataTable("DYNAMIC", MakeSqlString1(date));
                dt2 = CmnFunction.oComm.GetFuncDataTable("DYNAMIC", MakeSqlString2(date));
                dt3 = CmnFunction.oComm.GetFuncDataTable("DYNAMIC", MakeSqlString3(date));

                if (dt1.Rows.Count > 0)
                {
                    foreach (DataRow dr in dt1.Rows)
                    {
                        spdData_Sheet1.RowCount++;

                        for (int icol = 0; icol < dt1.Columns.Count; icol++)
                        {
                            spdData_Sheet1.Cells[spdData_Sheet1.RowCount - 1, icol].Value = dr[icol];
                        }
                    }
                }
                if (dt2.Rows.Count > 0)
                {
                    foreach (DataRow dr in dt2.Rows)
                    {
                        spdData_Sheet1.RowCount++;

                        for (int icol = 0; icol < dt2.Columns.Count; icol++)
                        {
                            spdData_Sheet1.Cells[spdData_Sheet1.RowCount - 1, icol].Value = dr[icol];
                        }
                    }
                }
                if (dt3.Rows.Count > 0)
                {
                    foreach (DataRow dr in dt3.Rows)
                    {
                        spdData_Sheet1.RowCount++;

                        for (int icol = 0; icol < dt3.Columns.Count; icol++)
                        {
                            spdData_Sheet1.Cells[spdData_Sheet1.RowCount - 1, icol].Value = dr[icol];
                        }
                    }
                }

                if (spdData_Sheet1.RowCount == 0)
                {
                    LoadingPopUp.LoadingPopUpHidden();
                    CmnFunction.ShowMsgBox(RptMessages.GetMessage("STD010", GlobalVariable.gcLanguage));
                    return false;
                }

                for (int irow = 0; irow < spdData_Sheet1.RowCount; irow++)
                {
                    if(spdData_Sheet1.Cells[irow, 0].Text.Contains("LRR"))
                    {
                        if(spdData_Sheet1.Cells[irow, 0].Text.Contains("SEC") ||
                            spdData_Sheet1.Cells[irow, 0].Text.Contains("HYNIX") ||
                            spdData_Sheet1.Cells[irow, 0].Text.Contains("ETC"))
                        {
                            spdData_Sheet1.Rows[irow].ForeColor = Color.Red;
                        }
                        else
                        {
                            spdData_Sheet1.Rows[irow].ForeColor = Color.SteelBlue;
                        }
                    }
                }

                spdData.RPT_AutoFit(false);

                fnMakeChart(spdData, selrow, step);

                isGraphChange = false;

                return true;
            }
            catch (Exception ex)
            {
                LoadingPopUp.LoadingPopUpHidden();
                MessageBox.Show(ex.Message);
                return false;
            }
            finally
            {
                LoadingPopUp.LoadingPopUpHidden();
                Cursor.Current = Cursors.Default;
            }
        }

        private string MakeSqlString1(string date)
        {
            /****************************************************
             * Comment : DataBase에 저장된 데이터를 조회한다.( Front/BACK END - QCN건수, 검사 LOT수 )
             * 
             * Created By : 김선호(2012-09-05-수요일)
             * 
             * Modified By :
             ****************************************************/

            string QRY = "";

            #region - Front/BACK END - QCN건수, 검사 LOT수

            QRY = "	SELECT GUBUN 	\n"
                + "	     , SUM(QTY_QQ_1) AS QTY_QQ_1 	\n"
                + "	     , SUM(QTY_QQ_2) AS QTY_QQ_2 	\n"
                + "	     , SUM(QTY_QQ_3) AS QTY_QQ_3 	\n"
                + "	     , SUM(QTY_QQ_4) AS QTY_QQ_4 	\n"
                + "	     , SUM(QTY_MM_1) AS QTY_MM_1 	\n"
                + "	     , SUM(QTY_MM_2) AS QTY_MM_2 	\n"
                + "	     , SUM(QTY_MM_3) AS QTY_MM_3 	\n"
                + "	     , SUM(QTY_MM_4) AS QTY_MM_4 	\n"
                + "	     , SUM(QTY_WW_1) AS QTY_WW_1 	\n"
                + "	     , SUM(QTY_WW_2) AS QTY_WW_2 	\n"
                + "	     , SUM(QTY_WW_3) AS QTY_WW_3 	\n"
                + "	     , SUM(QTY_WW_4) AS QTY_WW_4 	\n"
                + "	     , SUM(QTY_DD_1) AS QTY_DD_1 	\n"
                + "	     , SUM(QTY_DD_2) AS QTY_DD_2 	\n"
                + "	     , SUM(QTY_DD_3) AS QTY_DD_3 	\n"
                + "	     , SUM(QTY_DD_4) AS QTY_DD_4 	\n"
                + "	     , SUM(QTY_DD_5) AS QTY_DD_5 	\n"
                + "	     , SUM(QTY_DD_6) AS QTY_DD_6 	\n"
                + "	     , SUM(QTY_DD_7) AS QTY_DD_7 	\n"
                + "	FROM 	\n"
                + "	( 	\n"
                + "	    SELECT 'FRONT - QCN 건수' AS GUBUN 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                 WHEN '4' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '3' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '2' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '1' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	               END) AS QTY_QQ_1 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                 WHEN '4' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '3' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '2' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '1' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	               END) AS QTY_QQ_2 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                 WHEN '4' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '3' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '2' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '1' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	               END) AS QTY_QQ_3 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                 WHEN '4' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '3' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '2' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '1' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	               END) AS QTY_QQ_4 	\n"
                + "	         , 0 AS QTY_MM_1 	\n"
                + "	         , 0 AS QTY_MM_2 	\n"
                + "	         , 0 AS QTY_MM_3 	\n"
                + "	         , 0 AS QTY_MM_4 	\n"
                + "	         , 0 AS QTY_WW_1 	\n"
                + "	         , 0 AS QTY_WW_2 	\n"
                + "	         , 0 AS QTY_WW_3 	\n"
                + "	         , 0 AS QTY_WW_4 	\n"
                + "	         , 0 AS QTY_DD_1 	\n"
                + "	         , 0 AS QTY_DD_2 	\n"
                + "	         , 0 AS QTY_DD_3 	\n"
                + "	         , 0 AS QTY_DD_4 	\n"
                + "	         , 0 AS QTY_DD_5 	\n"
                + "	         , 0 AS QTY_DD_6 	\n"
                + "	         , 0 AS QTY_DD_7 	\n"
                + "	     FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT  	\n"
                + "	     WHERE 1=1  	\n"
                + "	     AND SUBSTR(STS.ABR_NO,1,3) = 'QCN' 	\n"
                + "	     AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                + "	     AND STS.FACTORY = MAT.FACTORY  	\n"
                + "	     AND STS.MAT_ID = MAT.MAT_ID  	\n"
                + "	     AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -13)), 'YYYYMMDD')||'220000' 	\n"
                + "	     AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000' 	\n"
                + "	     AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%' 	\n"
                + "	     AND STS.DEFECT_CODE LIKE '%' 	\n"
                + "	     AND STS.CUR_STEP LIKE '%' 	\n"
                + "	     AND STS.OPER_1 >= 'A0000' 	\n"
                + "	     AND STS.OPER_1 <= 'A0970' 	\n"
                + "	     AND STS.DEL_FLAG = ' ' 	\n"
                + "	     UNION ALL 	\n"
                + "	     SELECT 'FRONT - QCN 건수' AS GUBUN 	\n"
                + "	         , 0 AS QTY_QQ_1  	\n"
                + "	         , 0 AS QTY_QQ_2  	\n"
                + "	         , 0 AS QTY_QQ_3  	\n"
                + "	         , 0 AS QTY_QQ_4 	\n"
                + "	         ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000' 	\n"
                + "	                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                     THEN 1 	\n"
                + "	                     ELSE 0 	\n"
                + "	              END) AS QTY_MM_1 	\n"
                + "	         ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000' 	\n"
                + "	                     THEN 1 	\n"
                + "	                     ELSE 0 	\n"
                + "	              END) AS QTY_MM_2 	\n"
                + "	         ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000' 	\n"
                + "	                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000' 	\n"
                + "	                     THEN 1 	\n"
                + "	                     ELSE 0 	\n"
                + "	              END) AS QTY_MM_3 	\n"
                + "	         ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000' 	\n"
                + "	                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 0)), 'YYYYMMDD')||'220000' 	\n"
                + "	                     THEN 1 	\n"
                + "	                     ELSE 0 	\n"
                + "	              END) AS QTY_MM_4 	\n"
                + "	         , 0 AS QTY_WW_1 	\n"
                + "	         , 0 AS QTY_WW_2 	\n"
                + "	         , 0 AS QTY_WW_3 	\n"
                + "	         , 0 AS QTY_WW_4 	\n"
                + "	         , 0 AS QTY_DD_1 	\n"
                + "	         , 0 AS QTY_DD_2 	\n"
                + "	         , 0 AS QTY_DD_3 	\n"
                + "	         , 0 AS QTY_DD_4 	\n"
                + "	         , 0 AS QTY_DD_5 	\n"
                + "	         , 0 AS QTY_DD_6 	\n"
                + "	         , 0 AS QTY_DD_7 	\n"
                + "	     FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT  	\n"
                + "	     WHERE 1=1  	\n"
                + "	     AND SUBSTR(STS.ABR_NO,1,3) = 'QCN' 	\n"
                + "	     AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                + "	     AND STS.FACTORY = MAT.FACTORY  	\n"
                + "	     AND STS.MAT_ID = MAT.MAT_ID  	\n"
                + "	     AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000' 	\n"
                + "	     AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000' 	\n"
                + "	     AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%' 	\n"
                + "	     AND STS.DEFECT_CODE LIKE '%' 	\n"
                + "	     AND STS.CUR_STEP LIKE '%' 	\n"
                + "	     AND STS.OPER_1 >= 'A0000' 	\n"
                + "	     AND STS.OPER_1 <= 'A0970' 	\n"
                + "	     AND STS.DEL_FLAG = ' ' 	\n"
                + "	     UNION ALL 	\n"
                + "	     SELECT 'FRONT - QCN 건수' AS GUBUN 	\n"
                + "	         , 0 AS QTY_QQ_1 	\n"
                + "	         , 0 AS QTY_QQ_2 	\n"
                + "	         , 0 AS QTY_QQ_3 	\n"
                + "	         , 0 AS QTY_QQ_4 	\n"
                + "	         , 0 AS QTY_MM_1 	\n"
                + "	         , 0 AS QTY_MM_2 	\n"
                + "	         , 0 AS QTY_MM_3 	\n"
                + "	         , 0 AS QTY_MM_4 	\n"
                + "	         , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 28, 'YYYYMMDD')||'220000'  	\n"
                + "	                                        END                                                  	\n"
                + "	                     AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')||'220000'  	\n"
                + "	                                        END THEN 1 ELSE 0 END) AS QTY_WW_1 	\n"
                + "	         , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')||'220000'  	\n"
                + "	                                        END                                                  	\n"
                + "	                     AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')||'220000'    	\n"
                + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')||'220000'    	\n"
                + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')||'220000'   	\n"
                + "	                                        END THEN 1 ELSE 0 END) AS QTY_WW_2 	\n"
                + "	         , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                    WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                    WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                    WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                    WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                    WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')||'220000'   	\n"
                + "	                                        END                                                  	\n"
                + "	                     AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000'  	\n"
                + "	                                        END THEN 1 ELSE 0 END) AS QTY_WW_3 	\n"
                + "	         , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000'  	\n"
                + "	                                        END  	\n"
                + "	                     AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 6, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 5, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 4, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 3, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 2, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 1, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 0, 'YYYYMMDD')||'220000' 	\n"
                + "	                                        END THEN 1 ELSE 0 END) AS QTY_WW_4 	\n"
                + "	         , 0 AS QTY_DD_1 	\n"
                + "	         , 0 AS QTY_DD_2 	\n"
                + "	         , 0 AS QTY_DD_3 	\n"
                + "	         , 0 AS QTY_DD_4 	\n"
                + "	         , 0 AS QTY_DD_5 	\n"
                + "	         , 0 AS QTY_DD_6 	\n"
                + "	         , 0 AS QTY_DD_7 	\n"
                + "	     FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT  	\n"
                + "	     WHERE 1=1  	\n"
                + "	     AND SUBSTR(STS.ABR_NO,1,3) = 'QCN' 	\n"
                + "	     AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                + "	     AND STS.FACTORY = MAT.FACTORY  	\n"
                + "	     AND STS.MAT_ID = MAT.MAT_ID 	\n"
                + "	     AND STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                    WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                    WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                    WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                    WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                    WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                    WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 28, 'YYYYMMDD')||'220000' 	\n"
                + "	                                            END  	\n"
                + "	     AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000' 	\n"
                + "	     AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%' 	\n"
                + "	     AND STS.DEFECT_CODE LIKE '%' 	\n"
                + "	     AND STS.CUR_STEP LIKE '%' 	\n"
                + "	     AND STS.OPER_1 >= 'A0000' 	\n"
                + "	     AND STS.OPER_1 <= 'A0970' 	\n"
                + "	     AND STS.DEL_FLAG = ' ' 	\n"
                + "	     UNION ALL 	\n"
                + "	     SELECT 'FRONT - QCN 건수' AS GUBUN 	\n"
                + "	         , 0 AS QTY_QQ_1 	\n"
                + "	         , 0 AS QTY_QQ_2 	\n"
                + "	         , 0 AS QTY_QQ_3 	\n"
                + "	         , 0 AS QTY_QQ_4 	\n"
                + "	         , 0 AS QTY_MM_1 	\n"
                + "	         , 0 AS QTY_MM_2 	\n"
                + "	         , 0 AS QTY_MM_3 	\n"
                + "	         , 0 AS QTY_MM_4 	\n"
                + "	         , 0 AS QTY_WW_1 	\n"
                + "	         , 0 AS QTY_WW_2 	\n"
                + "	         , 0 AS QTY_WW_3 	\n"
                + "	         , 0 AS QTY_WW_4 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                     WHEN '금'  	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	                     WHEN '목' 	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	               END) AS QTY_DD_1 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                     WHEN '토' 	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	                     WHEN '금' 	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	               END) AS QTY_DD_2  	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                     WHEN '일'  	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	                     WHEN '토' 	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	               END) AS QTY_DD_3  	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                     WHEN '월'  	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	                     WHEN '일' 	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	               END) AS QTY_DD_4  	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                     WHEN '화' 	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	                     WHEN '월' 	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	               END) AS QTY_DD_5  	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                     WHEN '수' 	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	                     WHEN '화' 	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	               END) AS QTY_DD_6  	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                     WHEN '목'  	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	                     WHEN '수' 	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	               END) AS QTY_DD_7 	\n"
                + "	     FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT  	\n"
                + "	     WHERE 1=1  	\n"
                + "	     AND SUBSTR(STS.ABR_NO,1,3) = 'QCN' 	\n"
                + "	     AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                + "	     AND STS.FACTORY = MAT.FACTORY  	\n"
                + "	     AND STS.MAT_ID = MAT.MAT_ID 	\n"
                + "	     AND STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                    WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                    WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                    WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                    WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                    WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                    WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000' 	\n"
                + "	                                            END  	\n"
                + "	     AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000' 	\n"
                + "	     AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%' 	\n"
                + "	     AND STS.DEFECT_CODE LIKE '%' 	\n"
                + "	     AND STS.CUR_STEP LIKE '%' 	\n"
                + "	     AND STS.OPER_1 >= 'A0000' 	\n"
                + "	     AND STS.OPER_1 <= 'A0970' 	\n"
                + "	     AND STS.DEL_FLAG = ' ' 	\n"
                + "	     UNION ALL 	\n"
                + "	     SELECT 'B/E - QCN 건수' AS GUBUN 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                 WHEN '4' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '3' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '2' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '1' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	               END) AS QTY_QQ_1 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                 WHEN '4' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '3' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '2' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '1' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	               END) AS QTY_QQ_2 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                 WHEN '4' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '3' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '2' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '1' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	               END) AS QTY_QQ_3 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                 WHEN '4' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '3' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '2' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '1' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	               END) AS QTY_QQ_4 	\n"
                + "	         , 0 AS QTY_MM_1 	\n"
                + "	         , 0 AS QTY_MM_2 	\n"
                + "	         , 0 AS QTY_MM_3 	\n"
                + "	         , 0 AS QTY_MM_4 	\n"
                + "	         , 0 AS QTY_WW_1 	\n"
                + "	         , 0 AS QTY_WW_2 	\n"
                + "	         , 0 AS QTY_WW_3 	\n"
                + "	         , 0 AS QTY_WW_4 	\n"
                + "	         , 0 AS QTY_DD_1 	\n"
                + "	         , 0 AS QTY_DD_2 	\n"
                + "	         , 0 AS QTY_DD_3 	\n"
                + "	         , 0 AS QTY_DD_4 	\n"
                + "	         , 0 AS QTY_DD_5 	\n"
                + "	         , 0 AS QTY_DD_6 	\n"
                + "	         , 0 AS QTY_DD_7 	\n"
                + "	     FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT  	\n"
                + "	     WHERE 1=1  	\n"
                + "	     AND SUBSTR(STS.ABR_NO,1,3) = 'QCN' 	\n"
                + "	     AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                + "	     AND STS.FACTORY = MAT.FACTORY  	\n"
                + "	     AND STS.MAT_ID = MAT.MAT_ID  	\n"
                + "	     AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -13)), 'YYYYMMDD')||'220000' 	\n"
                + "	     AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000' 	\n"
                + "	     AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%' 	\n"
                + "	     AND STS.DEFECT_CODE LIKE '%' 	\n"
                + "	     AND STS.CUR_STEP LIKE '%' 	\n"
                + "	     AND STS.OPER_1 >= 'A1000' 	\n"
                + "	     AND STS.OPER_1 <= 'AZ010' 	\n"
                + "	     AND STS.DEL_FLAG = ' ' 	\n"
                + "	     UNION ALL 	\n"
                + "	     SELECT 'B/E - QCN 건수' AS GUBUN 	\n"
                + "	         , 0 AS QTY_QQ_1  	\n"
                + "	         , 0 AS QTY_QQ_2  	\n"
                + "	         , 0 AS QTY_QQ_3  	\n"
                + "	         , 0 AS QTY_QQ_4 	\n"
                + "	         ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000' 	\n"
                + "	                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                     THEN 1 	\n"
                + "	                     ELSE 0 	\n"
                + "	              END) AS QTY_MM_1 	\n"
                + "	         ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000' 	\n"
                + "	                     THEN 1 	\n"
                + "	                     ELSE 0 	\n"
                + "	              END) AS QTY_MM_2 	\n"
                + "	         ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000' 	\n"
                + "	                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000' 	\n"
                + "	                     THEN 1 	\n"
                + "	                     ELSE 0 	\n"
                + "	              END) AS QTY_MM_3 	\n"
                + "	         ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000' 	\n"
                + "	                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 0)), 'YYYYMMDD')||'220000' 	\n"
                + "	                     THEN 1 	\n"
                + "	                     ELSE 0 	\n"
                + "	              END) AS QTY_MM_4 	\n"
                + "	         , 0 AS QTY_WW_1 	\n"
                + "	         , 0 AS QTY_WW_2 	\n"
                + "	         , 0 AS QTY_WW_3 	\n"
                + "	         , 0 AS QTY_WW_4 	\n"
                + "	         , 0 AS QTY_DD_1 	\n"
                + "	         , 0 AS QTY_DD_2 	\n"
                + "	         , 0 AS QTY_DD_3 	\n"
                + "	         , 0 AS QTY_DD_4 	\n"
                + "	         , 0 AS QTY_DD_5 	\n"
                + "	         , 0 AS QTY_DD_6 	\n"
                + "	         , 0 AS QTY_DD_7 	\n"
                + "	     FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT  	\n"
                + "	     WHERE 1=1  	\n"
                + "	     AND SUBSTR(STS.ABR_NO,1,3) = 'QCN' 	\n"
                + "	     AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                + "	     AND STS.FACTORY = MAT.FACTORY  	\n"
                + "	     AND STS.MAT_ID = MAT.MAT_ID  	\n"
                + "	     AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000' 	\n"
                + "	     AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000' 	\n"
                + "	     AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%' 	\n"
                + "	     AND STS.DEFECT_CODE LIKE '%' 	\n"
                + "	     AND STS.CUR_STEP LIKE '%' 	\n"
                + "	     AND STS.OPER_1 >= 'A1000' 	\n"
                + "	     AND STS.OPER_1 <= 'AZ010' 	\n"
                + "	     AND STS.DEL_FLAG = ' ' 	\n"
                + "	     UNION ALL 	\n"
                + "	     SELECT 'B/E - QCN 건수' AS GUBUN 	\n"
                + "	         , 0 AS QTY_QQ_1 	\n"
                + "	         , 0 AS QTY_QQ_2 	\n"
                + "	         , 0 AS QTY_QQ_3 	\n"
                + "	         , 0 AS QTY_QQ_4 	\n"
                + "	         , 0 AS QTY_MM_1 	\n"
                + "	         , 0 AS QTY_MM_2 	\n"
                + "	         , 0 AS QTY_MM_3 	\n"
                + "	         , 0 AS QTY_MM_4 	\n"
                + "	         , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 28, 'YYYYMMDD')||'220000'  	\n"
                + "	                                        END                                                  	\n"
                + "	                     AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')||'220000'  	\n"
                + "	                                        END THEN 1 ELSE 0 END) AS QTY_WW_1 	\n"
                + "	         , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')||'220000'  	\n"
                + "	                                        END                                                  	\n"
                + "	                     AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')||'220000'    	\n"
                + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')||'220000'    	\n"
                + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')||'220000'   	\n"
                + "	                                        END THEN 1 ELSE 0 END) AS QTY_WW_2 	\n"
                + "	         , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                    WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                    WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                    WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                    WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                    WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')||'220000'   	\n"
                + "	                                        END                                                  	\n"
                + "	                     AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000'  	\n"
                + "	                                        END THEN 1 ELSE 0 END) AS QTY_WW_3 	\n"
                + "	         , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000'  	\n"
                + "	                                        END  	\n"
                + "	                     AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 6, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 5, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 4, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 3, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 2, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 1, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 0, 'YYYYMMDD')||'220000' 	\n"
                + "	                                        END THEN 1 ELSE 0 END) AS QTY_WW_4 	\n"
                + "	         , 0 AS QTY_DD_1 	\n"
                + "	         , 0 AS QTY_DD_2 	\n"
                + "	         , 0 AS QTY_DD_3 	\n"
                + "	         , 0 AS QTY_DD_4 	\n"
                + "	         , 0 AS QTY_DD_5 	\n"
                + "	         , 0 AS QTY_DD_6 	\n"
                + "	         , 0 AS QTY_DD_7 	\n"
                + "	     FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT  	\n"
                + "	     WHERE 1=1  	\n"
                + "	     AND SUBSTR(STS.ABR_NO,1,3) = 'QCN' 	\n"
                + "	     AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                + "	     AND STS.FACTORY = MAT.FACTORY  	\n"
                + "	     AND STS.MAT_ID = MAT.MAT_ID 	\n"
                + "	     AND STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                    WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                    WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                    WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                    WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                    WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                    WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 28, 'YYYYMMDD')||'220000' 	\n"
                + "	                                            END  	\n"
                + "	     AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000' 	\n"
                + "	     AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%' 	\n"
                + "	     AND STS.DEFECT_CODE LIKE '%' 	\n"
                + "	     AND STS.CUR_STEP LIKE '%' 	\n"
                + "	     AND STS.OPER_1 >= 'A1000' 	\n"
                + "	     AND STS.OPER_1 <= 'AZ010' 	\n"
                + "	     AND STS.DEL_FLAG = ' ' 	\n"
                + "	     UNION ALL 	\n"
                + "	     SELECT 'B/E - QCN 건수' AS GUBUN 	\n"
                + "	         , 0 AS QTY_QQ_1 	\n"
                + "	         , 0 AS QTY_QQ_2 	\n"
                + "	         , 0 AS QTY_QQ_3 	\n"
                + "	         , 0 AS QTY_QQ_4 	\n"
                + "	         , 0 AS QTY_MM_1 	\n"
                + "	         , 0 AS QTY_MM_2 	\n"
                + "	         , 0 AS QTY_MM_3 	\n"
                + "	         , 0 AS QTY_MM_4 	\n"
                + "	         , 0 AS QTY_WW_1 	\n"
                + "	         , 0 AS QTY_WW_2 	\n"
                + "	         , 0 AS QTY_WW_3 	\n"
                + "	         , 0 AS QTY_WW_4 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                     WHEN '금'  	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	                     WHEN '목' 	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	               END) AS QTY_DD_1 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                     WHEN '토' 	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	                     WHEN '금' 	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	               END) AS QTY_DD_2  	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                     WHEN '일'  	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	                     WHEN '토' 	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	               END) AS QTY_DD_3  	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                     WHEN '월'  	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	                     WHEN '일' 	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	               END) AS QTY_DD_4  	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                     WHEN '화' 	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	                     WHEN '월' 	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	               END) AS QTY_DD_5  	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                     WHEN '수' 	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	                     WHEN '화' 	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	               END) AS QTY_DD_6  	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                     WHEN '목'  	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	                     WHEN '수' 	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	               END) AS QTY_DD_7 	\n"
                + "	     FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT  	\n"
                + "	     WHERE 1=1  	\n"
                + "	     AND SUBSTR(STS.ABR_NO,1,3) = 'QCN' 	\n"
                + "	     AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                + "	     AND STS.FACTORY = MAT.FACTORY  	\n"
                + "	     AND STS.MAT_ID = MAT.MAT_ID 	\n"
                + "	     AND STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                    WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                    WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                    WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                    WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                    WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                    WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000' 	\n"
                + "	                                            END  	\n"
                + "	     AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000' 	\n"
                + "	     AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%' 	\n"
                + "	     AND STS.DEFECT_CODE LIKE '%' 	\n"
                + "	     AND STS.CUR_STEP LIKE '%' 	\n"
                + "	     AND STS.OPER_1 >= 'A1000' 	\n"
                + "	     AND STS.OPER_1 <= 'AZ010' 	\n"
                + "	     AND STS.DEL_FLAG = ' ' 	\n"
                + "	     UNION ALL     	\n"
                + "	     SELECT '검사LOT수' AS GUBUN 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                 WHEN '4' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '3' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '2' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '1' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'04' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'04', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	               END) AS QTY_QQ_1 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                 WHEN '4' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '3' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '2' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '1' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	               END) AS QTY_QQ_2 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                 WHEN '4' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '3' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '2' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '1' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	               END) AS QTY_QQ_3 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                 WHEN '4' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'10' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'10', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '3' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '2' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '1' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	               END) AS QTY_QQ_4 	\n"
                + "	         , 0 AS QTY_MM_1 	\n"
                + "	         , 0 AS QTY_MM_2 	\n"
                + "	         , 0 AS QTY_MM_3 	\n"
                + "	         , 0 AS QTY_MM_4 	\n"
                + "	         , 0 AS QTY_WW_1 	\n"
                + "	         , 0 AS QTY_WW_2 	\n"
                + "	         , 0 AS QTY_WW_3 	\n"
                + "	         , 0 AS QTY_WW_4 	\n"
                + "	         , 0 AS QTY_DD_1 	\n"
                + "	         , 0 AS QTY_DD_2 	\n"
                + "	         , 0 AS QTY_DD_3 	\n"
                + "	         , 0 AS QTY_DD_4 	\n"
                + "	         , 0 AS QTY_DD_5 	\n"
                + "	         , 0 AS QTY_DD_6 	\n"
                + "	         , 0 AS QTY_DD_7 	\n"
                + "	     FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B   	\n"
                + "	     WHERE A.FACTORY = B.FACTORY   	\n"
                + "	     AND A.MAT_ID = B.MAT_ID   	\n"
                + "	     AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'  	\n"
                + "	     AND A.WORK_MONTH >= TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -11), 'YYYYMM')  	\n"
                + "	     AND A.WORK_MONTH <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMM') 	\n"
                + "	     AND A.QC_OPER IN ('PVI','QC GATE')     	\n"
                + "	     AND A.QC_TYPE LIKE 'GATE' || '%'   	\n"
                + "	     AND B.MAT_GRP_1 LIKE '%' 	\n"
                + "	     UNION ALL 	\n"
                + "	     SELECT '검사LOT수' AS GUBUN 	\n"
                + "	         , 0 AS QTY_QQ_1   	\n"
                + "	         , 0 AS QTY_QQ_2   	\n"
                + "	         , 0 AS QTY_QQ_3   	\n"
                + "	         , 0 AS QTY_QQ_4  	\n"
                + "	         , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_MM_1 	\n"
                + "	         , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_MM_2 	\n"
                + "	         , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_MM_3 	\n"
                + "	         , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_MM_4 	\n"
                + "	         , 0 AS QTY_WW_1 	\n"
                + "	         , 0 AS QTY_WW_2 	\n"
                + "	         , 0 AS QTY_WW_3 	\n"
                + "	         , 0 AS QTY_WW_4 	\n"
                + "	         , 0 AS QTY_DD_1 	\n"
                + "	         , 0 AS QTY_DD_2 	\n"
                + "	         , 0 AS QTY_DD_3 	\n"
                + "	         , 0 AS QTY_DD_4 	\n"
                + "	         , 0 AS QTY_DD_5 	\n"
                + "	         , 0 AS QTY_DD_6 	\n"
                + "	         , 0 AS QTY_DD_7 	\n"
                + "	     FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B   	\n"
                + "	     WHERE A.FACTORY = B.FACTORY   	\n"
                + "	     AND A.MAT_ID = B.MAT_ID   	\n"
                + "	     AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'  	\n"
                + "	     AND A.WORK_MONTH >= TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4), 'YYYYMM')  	\n"
                + "	     AND A.WORK_MONTH <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMM') 	\n"
                + "	     AND A.QC_OPER IN ('PVI','QC GATE')     	\n"
                + "	     AND A.QC_TYPE LIKE 'GATE' || '%'   	\n"
                + "	     AND B.MAT_GRP_1 LIKE '%' 	\n"
                + "	     UNION ALL  	\n"
                + "	     SELECT '검사LOT수' AS GUBUN 	\n"
                + "	         , 0 AS QTY_QQ_1   	\n"
                + "	         , 0 AS QTY_QQ_2   	\n"
                + "	         , 0 AS QTY_QQ_3   	\n"
                + "	         , 0 AS QTY_QQ_4 	\n"
                + "	         , 0 AS QTY_MM_1   	\n"
                + "	         , 0 AS QTY_MM_2   	\n"
                + "	         , 0 AS QTY_MM_3   	\n"
                + "	         , 0 AS QTY_MM_4 	\n"
                + "	         , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')  	\n"
                + "	                                        END 	\n"
                + "	                     AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD') 	\n"
                + "	                                                                    WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD') 	\n"
                + "	                                                                    WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')  	\n"
                + "	                                        END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_WW_1 	\n"
                + "	         , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')  	\n"
                + "	                                        END 	\n"
                + "	                     AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')   	\n"
                + "	                                                                    WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')   	\n"
                + "	                                                                    WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')  	\n"
                + "	                                        END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_WW_2 	\n"
                + "	         , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD') 	\n"
                + "	                                                                    WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')  	\n"
                + "	                                        END 	\n"
                + "	                     AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')  	\n"
                + "	                                        END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_WW_3 	\n"
                + "	         , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 0, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')  	\n"
                + "	                                        END 	\n"
                + "	                     AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 6, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 5, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 4, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 3, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 2, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 1, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 0, 'YYYYMMDD')  	\n"
                + "	                                        END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_WW_4 	\n"
                + "	         , 0 AS QTY_DD_1  	\n"
                + "	         , 0 AS QTY_DD_2  	\n"
                + "	         , 0 AS QTY_DD_3  	\n"
                + "	         , 0 AS QTY_DD_4  	\n"
                + "	         , 0 AS QTY_DD_5  	\n"
                + "	         , 0 AS QTY_DD_6  	\n"
                + "	         , 0 AS QTY_DD_7  	\n"
                + "	     FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B   	\n"
                + "	     WHERE A.FACTORY = B.FACTORY   	\n"
                + "	     AND A.MAT_ID = B.MAT_ID   	\n"
                + "	     AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'  	\n"
                + "	     AND A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')  	\n"
                + "	                                                    WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')  	\n"
                + "	                                                    WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')  	\n"
                + "	                                                    WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')  	\n"
                + "	                                                    WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')  	\n"
                + "	                                                    WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')  	\n"
                + "	                                                    WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')  	\n"
                + "	                                            END  	\n"
                + "	     AND A.WORK_DATE <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')  	\n"
                + "	     AND A.QC_OPER IN ('PVI','QC GATE')     	\n"
                + "	     AND A.QC_TYPE LIKE 'GATE' || '%'   	\n"
                + "	     AND B.MAT_GRP_1 LIKE '%' 	\n"
                + "	     UNION ALL 	\n"
                + "	     SELECT '검사LOT수' AS GUBUN  	\n"
                + "	         , 0 AS QTY_QQ_1 	\n"
                + "	         , 0 AS QTY_QQ_2 	\n"
                + "	         , 0 AS QTY_QQ_3 	\n"
                + "	         , 0 AS QTY_QQ_4 	\n"
                + "	         , 0 AS QTY_MM_1 	\n"
                + "	         , 0 AS QTY_MM_2 	\n"
                + "	         , 0 AS QTY_MM_3 	\n"
                + "	         , 0 AS QTY_MM_4 	\n"
                + "	         , 0 AS QTY_WW_1 	\n"
                + "	         , 0 AS QTY_WW_2 	\n"
                + "	         , 0 AS QTY_WW_3 	\n"
                + "	         , 0 AS QTY_WW_4 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '금' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_DD_1 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '토' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_DD_2 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '일' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_DD_3 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '월' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_DD_4 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '화' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_DD_5 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '수' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_DD_6 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '목' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_DD_7 	\n"
                + "	     FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B 	\n"
                + "	     WHERE A.FACTORY = B.FACTORY 	\n"
                + "	     AND A.MAT_ID = B.MAT_ID 	\n"
                + "	     AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                + "	     AND A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 0, 'YYYYMMDD') 	\n"
                + "	                                                    WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD') 	\n"
                + "	                                                    WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD') 	\n"
                + "	                                                    WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD') 	\n"
                + "	                                                    WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD') 	\n"
                + "	                                                    WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD') 	\n"
                + "	                                                    WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD') 	\n"
                + "	                        END   	\n"
                + "	     AND A.WORK_DATE <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')  	\n"
                + "	     AND A.QC_OPER IN ('PVI','QC GATE')     	\n"
                + "	     AND A.QC_TYPE LIKE 'GATE' || '%'   	\n"
                + "	     AND B.MAT_GRP_1 LIKE '%' 	\n"
                + "	)GROUP BY GUBUN 	\n"
                + "	ORDER BY DECODE(GUBUN, 'FRONT - QCN 건수', 0, 'B/E - QCN 건수', 1, '검사 LOT 수', 2)";

            #endregion
            
            if (GlobalVariable.gsUserGroup == "ADMIN_GROUP" || GlobalVariable.gsUserGroup == "HANA_ADMIN_GROUP")
            {
                System.Windows.Forms.Clipboard.SetText(QRY.Replace((char)Keys.Tab, ' '));
            }

            return QRY.Replace((char)Keys.Tab, ' ');
        }

        private string MakeSqlString2(string date)
        {
            /****************************************************
             * Comment : DataBase에 저장된 데이터를 조회한다.( FRONT/BACK END/TOTAL - LRR )
             * 
             * Created By : 김선호(2012-09-05-수요일)
             * 
             * Modified By :
             ****************************************************/

            string QRY = "";

            #region - FRONT/BACK END/TOTAL - LRR

            QRY = "	SELECT GUBUN 	\n"
                + "	     , SUM(QTY_QQ_1) AS QTY_QQ_1 	\n"
                + "	     , SUM(QTY_QQ_2) AS QTY_QQ_2 	\n"
                + "	     , SUM(QTY_QQ_3) AS QTY_QQ_3 	\n"
                + "	     , SUM(QTY_QQ_4) AS QTY_QQ_4 	\n"
                + "	     , SUM(QTY_MM_1) AS QTY_MM_1 	\n"
                + "	     , SUM(QTY_MM_2) AS QTY_MM_2 	\n"
                + "	     , SUM(QTY_MM_3) AS QTY_MM_3 	\n"
                + "	     , SUM(QTY_MM_4) AS QTY_MM_4 	\n"
                + "	     , SUM(QTY_WW_1) AS QTY_WW_1 	\n"
                + "	     , SUM(QTY_WW_2) AS QTY_WW_2 	\n"
                + "	     , SUM(QTY_WW_3) AS QTY_WW_3 	\n"
                + "	     , SUM(QTY_WW_4) AS QTY_WW_4 	\n"
                + "	     , SUM(QTY_DD_1) AS QTY_DD_1 	\n"
                + "	     , SUM(QTY_DD_2) AS QTY_DD_2 	\n"
                + "	     , SUM(QTY_DD_3) AS QTY_DD_3 	\n"
                + "	     , SUM(QTY_DD_4) AS QTY_DD_4 	\n"
                + "	     , SUM(QTY_DD_5) AS QTY_DD_5 	\n"
                + "	     , SUM(QTY_DD_6) AS QTY_DD_6 	\n"
                + "	     , SUM(QTY_DD_7) AS QTY_DD_7 	\n"
                + "	FROM 	\n"
                + "	( 	\n"
                + "	     SELECT A.CUSTOMER AS GUBUN 	\n"
                + "	         , CASE WHEN A.QTY_QQ_1 > 0 AND B.LOT_QTY_QQ_1 > 0 THEN ROUND(A.QTY_QQ_1 / B.LOT_QTY_QQ_1 * 100, 2) ELSE 0 END AS QTY_QQ_1 	\n"
                + "	         , CASE WHEN A.QTY_QQ_2 > 0 AND B.LOT_QTY_QQ_2 > 0 THEN ROUND(A.QTY_QQ_2 / B.LOT_QTY_QQ_2 * 100, 2) ELSE 0 END AS QTY_QQ_2 	\n"
                + "	         , CASE WHEN A.QTY_QQ_3 > 0 AND B.LOT_QTY_QQ_3 > 0 THEN ROUND(A.QTY_QQ_3 / B.LOT_QTY_QQ_3 * 100, 2) ELSE 0 END AS QTY_QQ_3 	\n"
                + "	         , CASE WHEN A.QTY_QQ_4 > 0 AND B.LOT_QTY_QQ_4 > 0 THEN ROUND(A.QTY_QQ_4 / B.LOT_QTY_QQ_4 * 100, 2) ELSE 0 END AS QTY_QQ_4 	\n"
                + "	         , 0 AS QTY_MM_1 	\n"
                + "	         , 0 AS QTY_MM_2 	\n"
                + "	         , 0 AS QTY_MM_3 	\n"
                + "	         , 0 AS QTY_MM_4 	\n"
                + "	         , 0 AS QTY_WW_1 	\n"
                + "	         , 0 AS QTY_WW_2 	\n"
                + "	         , 0 AS QTY_WW_3 	\n"
                + "	         , 0 AS QTY_WW_4 	\n"
                + "	         , 0 AS QTY_DD_1 	\n"
                + "	         , 0 AS QTY_DD_2 	\n"
                + "	         , 0 AS QTY_DD_3 	\n"
                + "	         , 0 AS QTY_DD_4 	\n"
                + "	         , 0 AS QTY_DD_5 	\n"
                + "	         , 0 AS QTY_DD_6 	\n"
                + "	         , 0 AS QTY_DD_7 	\n"
                + "	     FROM( 	\n"
                + "	         SELECT 'Front - LRR' AS CUSTOMER 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                     WHEN '4' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '3' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '2' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '1' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                   END) AS QTY_QQ_1 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                     WHEN '4' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '3' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '2' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '1' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                   END) AS QTY_QQ_2 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                     WHEN '4' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '3' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '2' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '1' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                   END) AS QTY_QQ_3 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                     WHEN '4' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '3' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '2' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '1' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                   END) AS QTY_QQ_4 	\n"
                + "	         FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT  	\n"
                + "	         WHERE 1=1  	\n"
                + "	         AND SUBSTR(STS.ABR_NO,1,3) = 'QCN' 	\n"
                + "	         AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                + "	         AND STS.FACTORY = MAT.FACTORY  	\n"
                + "	         AND STS.MAT_ID = MAT.MAT_ID  	\n"
                + "	         AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -13)), 'YYYYMMDD')||'220000' 	\n"
                + "	         AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000' 	\n"
                + "	         AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%' 	\n"
                + "	         AND STS.DEFECT_CODE LIKE '%' 	\n"
                + "	         AND STS.CUR_STEP LIKE '%' 	\n"
                + "	         AND STS.OPER_1 >= 'A0000' 	\n"
                + "	         AND STS.OPER_1 <= 'A0970' 	\n"
                + "	         AND STS.DEL_FLAG = ' ' 	\n"
                + "	         UNION ALL 	\n"
                + "	         SELECT 'B/E - LRR' AS CUSTOMER 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                     WHEN '4' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '3' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '2' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '1' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                   END) AS QTY_QQ_1 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                     WHEN '4' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '3' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '2' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '1' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                   END) AS QTY_QQ_2 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                     WHEN '4' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '3' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '2' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '1' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                   END) AS QTY_QQ_3 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                     WHEN '4' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '3' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '2' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '1' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                   END) AS QTY_QQ_4 	\n"
                + "	         FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT  	\n"
                + "	         WHERE 1=1  	\n"
                + "	         AND SUBSTR(STS.ABR_NO,1,3) = 'QCN' 	\n"
                + "	         AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                + "	         AND STS.FACTORY = MAT.FACTORY  	\n"
                + "	         AND STS.MAT_ID = MAT.MAT_ID  	\n"
                + "	         AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -13)), 'YYYYMMDD')||'220000' 	\n"
                + "	         AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000' 	\n"
                + "	         AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%' 	\n"
                + "	         AND STS.DEFECT_CODE LIKE '%' 	\n"
                + "	         AND STS.CUR_STEP LIKE '%' 	\n"
                + "	         AND STS.OPER_1 >= 'A1000' 	\n"
                + "	         AND STS.OPER_1 <= 'AZ010' 	\n"
                + "	         AND STS.DEL_FLAG = ' ' 	\n"
                + "	         UNION ALL 	\n"
                + "	         SELECT 'TOTAL - LRR' AS CUSTOMER 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                     WHEN '4' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '3' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '2' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '1' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                   END) AS QTY_QQ_1 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                     WHEN '4' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '3' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '2' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '1' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                   END) AS QTY_QQ_2 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                     WHEN '4' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '3' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '2' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '1' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                   END) AS QTY_QQ_3 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                     WHEN '4' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '3' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '2' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '1' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                   END) AS QTY_QQ_4 	\n"
                + "	         FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT  	\n"
                + "	         WHERE 1=1  	\n"
                + "	         AND SUBSTR(STS.ABR_NO,1,3) = 'QCN' 	\n"
                + "	         AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                + "	         AND STS.FACTORY = MAT.FACTORY  	\n"
                + "	         AND STS.MAT_ID = MAT.MAT_ID  	\n"
                + "	         AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -13)), 'YYYYMMDD')||'220000' 	\n"
                + "	         AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000' 	\n"
                + "	         AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%' 	\n"
                + "	         AND STS.DEFECT_CODE LIKE '%' 	\n"
                + "	         AND STS.CUR_STEP LIKE '%' 	\n"
                + "	         AND STS.OPER_1 >= 'A0000' 	\n"
                + "	         AND STS.OPER_1 <= 'AZ010' 	\n"
                + "	         AND STS.DEL_FLAG = ' ' 	\n"
                + "	         ) A, 	\n"
                + "	     ( 	\n"
                + "	         SELECT 'Front - LRR' AS CUSTOMER  	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                 WHEN '4' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '3' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '2' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '1' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'04' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'04', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	               END) AS LOT_QTY_QQ_1 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                 WHEN '4' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '3' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '2' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '1' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	               END) AS LOT_QTY_QQ_2 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                 WHEN '4' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '3' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '2' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '1' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	               END) AS LOT_QTY_QQ_3 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                 WHEN '4' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'10' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'10', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '3' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '2' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '1' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	               END) AS LOT_QTY_QQ_4 	\n"
                + "	         FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B   	\n"
                + "	         WHERE A.FACTORY = B.FACTORY   	\n"
                + "	         AND A.MAT_ID = B.MAT_ID   	\n"
                + "	         AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'  	\n"
                + "	         AND A.WORK_MONTH >= TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -11), 'YYYYMM')  	\n"
                + "	         AND A.WORK_MONTH <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMM') 	\n"
                + "	         AND A.QC_OPER IN ('PVI','QC GATE')     	\n"
                + "	         AND A.QC_TYPE LIKE 'GATE' || '%'   	\n"
                + "	         AND B.MAT_GRP_1 LIKE '%' 	\n"
                + "	         UNION ALL 	\n"
                + "	         SELECT 'B/E - LRR' AS CUSTOMER  	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                 WHEN '4' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '3' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '2' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '1' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'04' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'04', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	               END) AS LOT_QTY_QQ_1 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                 WHEN '4' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '3' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '2' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '1' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	               END) AS LOT_QTY_QQ_2 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                 WHEN '4' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '3' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '2' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '1' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	               END) AS LOT_QTY_QQ_3 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                 WHEN '4' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'10' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'10', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '3' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '2' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '1' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	               END) AS LOT_QTY_QQ_4 	\n"
                + "	         FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B   	\n"
                + "	         WHERE A.FACTORY = B.FACTORY   	\n"
                + "	         AND A.MAT_ID = B.MAT_ID   	\n"
                + "	         AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'  	\n"
                + "	         AND A.WORK_MONTH >= TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -11), 'YYYYMM')  	\n"
                + "	         AND A.WORK_MONTH <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMM') 	\n"
                + "	         AND A.QC_OPER IN ('PVI','QC GATE')     	\n"
                + "	         AND A.QC_TYPE LIKE 'GATE' || '%'   	\n"
                + "	         AND B.MAT_GRP_1 LIKE '%' 	\n"
                + "	         UNION ALL 	\n"
                + "	         SELECT 'TOTAL - LRR' AS CUSTOMER  	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                 WHEN '4' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '3' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '2' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '1' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'04' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'04', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	               END) AS LOT_QTY_QQ_1 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                 WHEN '4' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '3' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '2' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '1' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	               END) AS LOT_QTY_QQ_2 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                 WHEN '4' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '3' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '2' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '1' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	               END) AS LOT_QTY_QQ_3 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                 WHEN '4' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'10' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'10', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '3' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '2' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '1' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	               END) AS LOT_QTY_QQ_4 	\n"
                + "	         FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B   	\n"
                + "	         WHERE A.FACTORY = B.FACTORY   	\n"
                + "	         AND A.MAT_ID = B.MAT_ID   	\n"
                + "	         AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'  	\n"
                + "	         AND A.WORK_MONTH >= TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -11), 'YYYYMM')  	\n"
                + "	         AND A.WORK_MONTH <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMM') 	\n"
                + "	         AND A.QC_OPER IN ('PVI','QC GATE')     	\n"
                + "	         AND A.QC_TYPE LIKE 'GATE' || '%'   	\n"
                + "	         AND B.MAT_GRP_1 LIKE '%' 	\n"
                + "	         ) B 	\n"
                + "	     WHERE A.CUSTOMER = B.CUSTOMER 	\n"
                + "	     UNION ALL 	\n"
                + "	     SELECT A.CUSTOMER AS GUBUN 	\n"
                + "	         , 0 AS QTY_QQ_1 	\n"
                + "	         , 0 AS QTY_QQ_2 	\n"
                + "	         , 0 AS QTY_QQ_3 	\n"
                + "	         , 0 AS QTY_QQ_4 	\n"
                + "	         , CASE WHEN A.QTY_MM_1 > 0 AND B.LOT_QTY_MM_1 > 0 THEN ROUND(A.QTY_MM_1 / B.LOT_QTY_MM_1 * 100, 2) ELSE 0 END AS QTY_MM_1 	\n"
                + "	         , CASE WHEN A.QTY_MM_2 > 0 AND B.LOT_QTY_MM_2 > 0 THEN ROUND(A.QTY_MM_2 / B.LOT_QTY_MM_2 * 100, 2) ELSE 0 END AS QTY_MM_2 	\n"
                + "	         , CASE WHEN A.QTY_MM_3 > 0 AND B.LOT_QTY_MM_3 > 0 THEN ROUND(A.QTY_MM_3 / B.LOT_QTY_MM_3 * 100, 2) ELSE 0 END AS QTY_MM_3 	\n"
                + "	         , CASE WHEN A.QTY_MM_4 > 0 AND B.LOT_QTY_MM_4 > 0 THEN ROUND(A.QTY_MM_4 / B.LOT_QTY_MM_4 * 100, 2) ELSE 0 END AS QTY_MM_4 	\n"
                + "	         , 0 AS QTY_WW_1 	\n"
                + "	         , 0 AS QTY_WW_2 	\n"
                + "	         , 0 AS QTY_WW_3 	\n"
                + "	         , 0 AS QTY_WW_4 	\n"
                + "	         , 0 AS QTY_DD_1 	\n"
                + "	         , 0 AS QTY_DD_2 	\n"
                + "	         , 0 AS QTY_DD_3 	\n"
                + "	         , 0 AS QTY_DD_4 	\n"
                + "	         , 0 AS QTY_DD_5 	\n"
                + "	         , 0 AS QTY_DD_6 	\n"
                + "	         , 0 AS QTY_DD_7 	\n"
                + "	     FROM( 	\n"
                + "	         SELECT 'Front - LRR' AS CUSTOMER 	\n"
                + "	             ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000' 	\n"
                + "	                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                         THEN 1 	\n"
                + "	                         ELSE 0 	\n"
                + "	                  END) AS QTY_MM_1 	\n"
                + "	             ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000' 	\n"
                + "	                         THEN 1 	\n"
                + "	                         ELSE 0 	\n"
                + "	                  END) AS QTY_MM_2 	\n"
                + "	             ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000' 	\n"
                + "	                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000' 	\n"
                + "	                         THEN 1 	\n"
                + "	                         ELSE 0 	\n"
                + "	                  END) AS QTY_MM_3 	\n"
                + "	             ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000' 	\n"
                + "	                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 0)), 'YYYYMMDD')||'220000' 	\n"
                + "	                         THEN 1 	\n"
                + "	                         ELSE 0 	\n"
                + "	                  END) AS QTY_MM_4 	\n"
                + "	         FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT  	\n"
                + "	         WHERE 1=1  	\n"
                + "	         AND SUBSTR(STS.ABR_NO,1,3) = 'QCN' 	\n"
                + "	         AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                + "	         AND STS.FACTORY = MAT.FACTORY  	\n"
                + "	         AND STS.MAT_ID = MAT.MAT_ID  	\n"
                + "	         AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000' 	\n"
                + "	         AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000' 	\n"
                + "	         AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%' 	\n"
                + "	         AND STS.DEFECT_CODE LIKE '%' 	\n"
                + "	         AND STS.CUR_STEP LIKE '%' 	\n"
                + "	         AND STS.OPER_1 >= 'A0000' 	\n"
                + "	         AND STS.OPER_1 <= 'A0970' 	\n"
                + "	         AND STS.DEL_FLAG = ' ' 	\n"
                + "	         UNION ALL 	\n"
                + "	         SELECT 'B/E - LRR' AS CUSTOMER 	\n"
                + "	             ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000' 	\n"
                + "	                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                         THEN 1 	\n"
                + "	                         ELSE 0 	\n"
                + "	                  END) AS QTY_MM_1 	\n"
                + "	             ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000' 	\n"
                + "	                         THEN 1 	\n"
                + "	                         ELSE 0 	\n"
                + "	                  END) AS QTY_MM_2 	\n"
                + "	             ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000' 	\n"
                + "	                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000' 	\n"
                + "	                         THEN 1 	\n"
                + "	                         ELSE 0 	\n"
                + "	                  END) AS QTY_MM_3 	\n"
                + "	             ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000' 	\n"
                + "	                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 0)), 'YYYYMMDD')||'220000' 	\n"
                + "	                         THEN 1 	\n"
                + "	                         ELSE 0 	\n"
                + "	                  END) AS QTY_MM_4 	\n"
                + "	         FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT  	\n"
                + "	         WHERE 1=1  	\n"
                + "	         AND SUBSTR(STS.ABR_NO,1,3) = 'QCN' 	\n"
                + "	         AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                + "	         AND STS.FACTORY = MAT.FACTORY  	\n"
                + "	         AND STS.MAT_ID = MAT.MAT_ID  	\n"
                + "	         AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000' 	\n"
                + "	         AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000' 	\n"
                + "	         AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%' 	\n"
                + "	         AND STS.DEFECT_CODE LIKE '%' 	\n"
                + "	         AND STS.CUR_STEP LIKE '%' 	\n"
                + "	         AND STS.OPER_1 >= 'A1000' 	\n"
                + "	         AND STS.OPER_1 <= 'AZ010' 	\n"
                + "	         AND STS.DEL_FLAG = ' ' 	\n"
                + "	         UNION ALL 	\n"
                + "	         SELECT 'TOTAL - LRR' AS CUSTOMER 	\n"
                + "	             ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000' 	\n"
                + "	                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                         THEN 1 	\n"
                + "	                         ELSE 0 	\n"
                + "	                  END) AS QTY_MM_1 	\n"
                + "	             ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000' 	\n"
                + "	                         THEN 1 	\n"
                + "	                         ELSE 0 	\n"
                + "	                  END) AS QTY_MM_2 	\n"
                + "	             ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000' 	\n"
                + "	                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000' 	\n"
                + "	                         THEN 1 	\n"
                + "	                         ELSE 0 	\n"
                + "	                  END) AS QTY_MM_3 	\n"
                + "	             ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000' 	\n"
                + "	                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 0)), 'YYYYMMDD')||'220000' 	\n"
                + "	                         THEN 1 	\n"
                + "	                         ELSE 0 	\n"
                + "	                  END) AS QTY_MM_4 	\n"
                + "	         FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT  	\n"
                + "	         WHERE 1=1  	\n"
                + "	         AND SUBSTR(STS.ABR_NO,1,3) = 'QCN' 	\n"
                + "	         AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                + "	         AND STS.FACTORY = MAT.FACTORY  	\n"
                + "	         AND STS.MAT_ID = MAT.MAT_ID  	\n"
                + "	         AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000' 	\n"
                + "	         AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000' 	\n"
                + "	         AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%' 	\n"
                + "	         AND STS.DEFECT_CODE LIKE '%' 	\n"
                + "	         AND STS.CUR_STEP LIKE '%' 	\n"
                + "	         AND STS.OPER_1 >= 'A0000' 	\n"
                + "	         AND STS.OPER_1 <= 'AZ010' 	\n"
                + "	         AND STS.DEL_FLAG = ' ' 	\n"
                + "	     ) A, 	\n"
                + "	     ( 	\n"
                + "	         SELECT 'Front - LRR' AS CUSTOMER  	\n"
                + "	             , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_1 	\n"
                + "	             , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_2 	\n"
                + "	             , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_3 	\n"
                + "	             , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_4 	\n"
                + "	         FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B   	\n"
                + "	         WHERE A.FACTORY = B.FACTORY   	\n"
                + "	         AND A.MAT_ID = B.MAT_ID   	\n"
                + "	         AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'  	\n"
                + "	         AND A.WORK_MONTH >= TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4), 'YYYYMM')  	\n"
                + "	         AND A.WORK_MONTH <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMM') 	\n"
                + "	         AND A.QC_OPER IN ('PVI','QC GATE')     	\n"
                + "	         AND A.QC_TYPE LIKE 'GATE' || '%'   	\n"
                + "	         AND B.MAT_GRP_1 LIKE '%' 	\n"
                + "	         UNION ALL 	\n"
                + "	         SELECT 'B/E - LRR' AS CUSTOMER  	\n"
                + "	             , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_1 	\n"
                + "	             , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_2 	\n"
                + "	             , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_3 	\n"
                + "	             , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_4 	\n"
                + "	         FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B   	\n"
                + "	         WHERE A.FACTORY = B.FACTORY   	\n"
                + "	         AND A.MAT_ID = B.MAT_ID   	\n"
                + "	         AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'  	\n"
                + "	         AND A.WORK_MONTH >= TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4), 'YYYYMM')  	\n"
                + "	         AND A.WORK_MONTH <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMM') 	\n"
                + "	         AND A.QC_OPER IN ('PVI','QC GATE')     	\n"
                + "	         AND A.QC_TYPE LIKE 'GATE' || '%'   	\n"
                + "	         AND B.MAT_GRP_1 LIKE '%' 	\n"
                + "	         UNION ALL 	\n"
                + "	         SELECT 'TOTAL - LRR' AS CUSTOMER  	\n"
                + "	             , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_1 	\n"
                + "	             , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_2 	\n"
                + "	             , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_3 	\n"
                + "	             , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_4 	\n"
                + "	         FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B   	\n"
                + "	         WHERE A.FACTORY = B.FACTORY   	\n"
                + "	         AND A.MAT_ID = B.MAT_ID   	\n"
                + "	         AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'  	\n"
                + "	         AND A.WORK_MONTH >= TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4), 'YYYYMM')  	\n"
                + "	         AND A.WORK_MONTH <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMM') 	\n"
                + "	         AND A.QC_OPER IN ('PVI','QC GATE')     	\n"
                + "	         AND A.QC_TYPE LIKE 'GATE' || '%'   	\n"
                + "	         AND B.MAT_GRP_1 LIKE '%' 	\n"
                + "	     ) B 	\n"
                + "	     WHERE A.CUSTOMER = B.CUSTOMER 	\n"
                + "	     UNION ALL 	\n"
                + "	     SELECT A.CUSTOMER AS GUBUN 	\n"
                + "	         , 0 AS QTY_QQ_1 	\n"
                + "	         , 0 AS QTY_QQ_2 	\n"
                + "	         , 0 AS QTY_QQ_3 	\n"
                + "	         , 0 AS QTY_QQ_4 	\n"
                + "	         , 0 AS QTY_MM_1 	\n"
                + "	         , 0 AS QTY_MM_2 	\n"
                + "	         , 0 AS QTY_MM_3 	\n"
                + "	         , 0 AS QTY_MM_4 	\n"
                + "	         , CASE WHEN A.QTY_WW_1 > 0 AND B.LOT_QTY_WW_1 > 0 THEN ROUND(A.QTY_WW_1 / B.LOT_QTY_WW_1 * 100, 2) ELSE 0 END AS QTY_WW_1 	\n"
                + "	         , CASE WHEN A.QTY_WW_2 > 0 AND B.LOT_QTY_WW_2 > 0 THEN ROUND(A.QTY_WW_2 / B.LOT_QTY_WW_2 * 100, 2) ELSE 0 END AS QTY_WW_2 	\n"
                + "	         , CASE WHEN A.QTY_WW_3 > 0 AND B.LOT_QTY_WW_3 > 0 THEN ROUND(A.QTY_WW_3 / B.LOT_QTY_WW_3 * 100, 2) ELSE 0 END AS QTY_WW_3 	\n"
                + "	         , CASE WHEN A.QTY_WW_4 > 0 AND B.LOT_QTY_WW_4 > 0 THEN ROUND(A.QTY_WW_4 / B.LOT_QTY_WW_4 * 100, 2) ELSE 0 END AS QTY_WW_4 	\n"
                + "	         , 0 AS QTY_DD_1 	\n"
                + "	         , 0 AS QTY_DD_2 	\n"
                + "	         , 0 AS QTY_DD_3 	\n"
                + "	         , 0 AS QTY_DD_4 	\n"
                + "	         , 0 AS QTY_DD_5 	\n"
                + "	         , 0 AS QTY_DD_6 	\n"
                + "	         , 0 AS QTY_DD_7 	\n"
                + "	     FROM( 	\n"
                + "	         SELECT 'Front - LRR' AS CUSTOMER 	\n"
                + "	             , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 28, 'YYYYMMDD')||'220000'  	\n"
                + "	                                            END 	\n"
                + "	                         AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')||'220000'  	\n"
                + "	                                            END THEN 1 ELSE 0 END) AS QTY_WW_1 	\n"
                + "	             , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')||'220000'  	\n"
                + "	                                            END 	\n"
                + "	                         AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')||'220000'    	\n"
                + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')||'220000'    	\n"
                + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')||'220000'   	\n"
                + "	                                            END THEN 1 ELSE 0 END) AS QTY_WW_2 	\n"
                + "	             , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')||'220000'   	\n"
                + "	                                            END 	\n"
                + "	                         AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000'  	\n"
                + "	                                            END THEN 1 ELSE 0 END) AS QTY_WW_3 	\n"
                + "	             , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000'  	\n"
                + "	                                            END 	\n"
                + "	                         AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 6, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 5, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 4, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 3, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 2, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 1, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 0, 'YYYYMMDD')||'220000' 	\n"
                + "	                                            END THEN 1 ELSE 0 END) AS QTY_WW_4 	\n"
                + "	         FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT  	\n"
                + "	         WHERE 1=1  	\n"
                + "	         AND SUBSTR(STS.ABR_NO,1,3) = 'QCN' 	\n"
                + "	         AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                + "	         AND STS.FACTORY = MAT.FACTORY  	\n"
                + "	         AND STS.MAT_ID = MAT.MAT_ID 	\n"
                + "	         AND STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 28, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                END  	\n"
                + "	         AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000' 	\n"
                + "	         AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%' 	\n"
                + "	         AND STS.DEFECT_CODE LIKE '%' 	\n"
                + "	         AND STS.CUR_STEP LIKE '%' 	\n"
                + "	         AND STS.OPER_1 >= 'A0000' 	\n"
                + "	         AND STS.OPER_1 <= 'A0970' 	\n"
                + "	         AND STS.DEL_FLAG = ' ' 	\n"
                + "	         UNION ALL 	\n"
                + "	         SELECT 'B/E - LRR' AS CUSTOMER 	\n"
                + "	             , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 28, 'YYYYMMDD')||'220000'  	\n"
                + "	                                            END 	\n"
                + "	                         AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')||'220000'  	\n"
                + "	                                            END THEN 1 ELSE 0 END) AS QTY_WW_1 	\n"
                + "	             , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')||'220000'  	\n"
                + "	                                            END 	\n"
                + "	                         AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')||'220000'    	\n"
                + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')||'220000'    	\n"
                + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')||'220000'   	\n"
                + "	                                            END THEN 1 ELSE 0 END) AS QTY_WW_2 	\n"
                + "	             , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')||'220000'   	\n"
                + "	                                            END 	\n"
                + "	                         AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000'  	\n"
                + "	                                            END THEN 1 ELSE 0 END) AS QTY_WW_3 	\n"
                + "	             , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000'  	\n"
                + "	                                            END 	\n"
                + "	                         AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 6, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 5, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 4, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 3, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 2, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 1, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 0, 'YYYYMMDD')||'220000' 	\n"
                + "	                                            END THEN 1 ELSE 0 END) AS QTY_WW_4 	\n"
                + "	         FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT  	\n"
                + "	         WHERE 1=1  	\n"
                + "	         AND SUBSTR(STS.ABR_NO,1,3) = 'QCN' 	\n"
                + "	         AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                + "	         AND STS.FACTORY = MAT.FACTORY  	\n"
                + "	         AND STS.MAT_ID = MAT.MAT_ID 	\n"
                + "	         AND STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 28, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                END  	\n"
                + "	         AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000' 	\n"
                + "	         AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%' 	\n"
                + "	         AND STS.DEFECT_CODE LIKE '%' 	\n"
                + "	         AND STS.CUR_STEP LIKE '%' 	\n"
                + "	         AND STS.OPER_1 >= 'A1000' 	\n"
                + "	         AND STS.OPER_1 <= 'AZ010' 	\n"
                + "	         AND STS.DEL_FLAG = ' ' 	\n"
                + "	         UNION ALL 	\n"
                + "	         SELECT 'TOTAL - LRR' AS CUSTOMER 	\n"
                + "	             , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 28, 'YYYYMMDD')||'220000'  	\n"
                + "	                                            END 	\n"
                + "	                         AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')||'220000'  	\n"
                + "	                                            END THEN 1 ELSE 0 END) AS QTY_WW_1 	\n"
                + "	             , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')||'220000'  	\n"
                + "	                                            END 	\n"
                + "	                         AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')||'220000'    	\n"
                + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')||'220000'    	\n"
                + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')||'220000'   	\n"
                + "	                                            END THEN 1 ELSE 0 END) AS QTY_WW_2 	\n"
                + "	             , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')||'220000'   	\n"
                + "	                                            END 	\n"
                + "	                         AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000'  	\n"
                + "	                                            END THEN 1 ELSE 0 END) AS QTY_WW_3 	\n"
                + "	             , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000'  	\n"
                + "	                                            END 	\n"
                + "	                         AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 6, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 5, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 4, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 3, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 2, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 1, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 0, 'YYYYMMDD')||'220000' 	\n"
                + "	                                            END THEN 1 ELSE 0 END) AS QTY_WW_4  	\n"
                + "	         FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT  	\n"
                + "	         WHERE 1=1  	\n"
                + "	         AND SUBSTR(STS.ABR_NO,1,3) = 'QCN' 	\n"
                + "	         AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                + "	         AND STS.FACTORY = MAT.FACTORY  	\n"
                + "	         AND STS.MAT_ID = MAT.MAT_ID 	\n"
                + "	         AND STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 28, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                END  	\n"
                + "	         AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000' 	\n"
                + "	         AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%' 	\n"
                + "	         AND STS.DEFECT_CODE LIKE '%' 	\n"
                + "	         AND STS.CUR_STEP LIKE '%' 	\n"
                + "	         AND STS.OPER_1 >= 'A0000' 	\n"
                + "	         AND STS.OPER_1 <= 'AZ010' 	\n"
                + "	         AND STS.DEL_FLAG = ' ' 	\n"
                + "	     ) A, 	\n"
                + "	     ( 	\n"
                + "	         SELECT 'Front - LRR' AS CUSTOMER  	\n"
                + "	             , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD') 	\n"
                + "	                                            END 	\n"
                + "	                         AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD') 	\n"
                + "	                                            END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_1 	\n"
                + "	             , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD') 	\n"
                + "	                                            END 	\n"
                + "	                         AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD') 	\n"
                + "	                                            END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_2 	\n"
                + "	             , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD') 	\n"
                + "	                                            END 	\n"
                + "	                         AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD') 	\n"
                + "	                                            END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_3 	\n"
                + "	             , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 0, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD') 	\n"
                + "	                                            END 	\n"
                + "	                         AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 6, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 5, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 4, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 3, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 2, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 1, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 0, 'YYYYMMDD') 	\n"
                + "	                                            END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_4 	\n"
                + "	         FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B   	\n"
                + "	         WHERE A.FACTORY = B.FACTORY   	\n"
                + "	         AND A.MAT_ID = B.MAT_ID   	\n"
                + "	         AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'  	\n"
                + "	         AND A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD') 	\n"
                + "	                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD') 	\n"
                + "	                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD') 	\n"
                + "	                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD') 	\n"
                + "	                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD') 	\n"
                + "	                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD') 	\n"
                + "	                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD') 	\n"
                + "	                            END  	\n"
                + "	         AND A.WORK_DATE <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')  	\n"
                + "	         AND A.QC_OPER IN ('PVI','QC GATE')     	\n"
                + "	         AND A.QC_TYPE LIKE 'GATE' || '%'   	\n"
                + "	         AND B.MAT_GRP_1 LIKE '%' 	\n"
                + "	         UNION ALL 	\n"
                + "	         SELECT 'B/E - LRR' AS CUSTOMER  	\n"
                + "	             , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD') 	\n"
                + "	                                            END 	\n"
                + "	                         AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD') 	\n"
                + "	                                            END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_1 	\n"
                + "	             , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD') 	\n"
                + "	                                            END 	\n"
                + "	                         AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD') 	\n"
                + "	                                            END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_2 	\n"
                + "	             , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD') 	\n"
                + "	                                            END 	\n"
                + "	                         AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD') 	\n"
                + "	                                            END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_3 	\n"
                + "	             , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 0, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD') 	\n"
                + "	                                            END 	\n"
                + "	                         AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 6, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 5, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 4, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 3, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 2, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 1, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 0, 'YYYYMMDD') 	\n"
                + "	                                            END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_4 	\n"
                + "	         FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B   	\n"
                + "	         WHERE A.FACTORY = B.FACTORY   	\n"
                + "	         AND A.MAT_ID = B.MAT_ID   	\n"
                + "	         AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'  	\n"
                + "	         AND A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD') 	\n"
                + "	                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD') 	\n"
                + "	                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD') 	\n"
                + "	                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD') 	\n"
                + "	                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD') 	\n"
                + "	                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD') 	\n"
                + "	                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD') 	\n"
                + "	                            END  	\n"
                + "	         AND A.WORK_DATE <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')  	\n"
                + "	         AND A.QC_OPER IN ('PVI','QC GATE')     	\n"
                + "	         AND A.QC_TYPE LIKE 'GATE' || '%'   	\n"
                + "	         AND B.MAT_GRP_1 LIKE '%' 	\n"
                + "	         UNION ALL 	\n"
                + "	         SELECT 'TOTAL - LRR' AS CUSTOMER  	\n"
                + "	             , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD') 	\n"
                + "	                                            END 	\n"
                + "	                         AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD') 	\n"
                + "	                                            END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_1 	\n"
                + "	             , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD') 	\n"
                + "	                                            END 	\n"
                + "	                         AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD') 	\n"
                + "	                                            END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_2 	\n"
                + "	             , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD') 	\n"
                + "	                                            END 	\n"
                + "	                         AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD') 	\n"
                + "	                                            END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_3 	\n"
                + "	             , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 0, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD') 	\n"
                + "	                                            END 	\n"
                + "	                         AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 6, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 5, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 4, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 3, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 2, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 1, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 0, 'YYYYMMDD') 	\n"
                + "	                                            END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_4 	\n"
                + "	         FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B   	\n"
                + "	         WHERE A.FACTORY = B.FACTORY   	\n"
                + "	         AND A.MAT_ID = B.MAT_ID   	\n"
                + "	         AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'  	\n"
                + "	         AND A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD') 	\n"
                + "	                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD') 	\n"
                + "	                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD') 	\n"
                + "	                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD') 	\n"
                + "	                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD') 	\n"
                + "	                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD') 	\n"
                + "	                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD') 	\n"
                + "	                            END  	\n"
                + "	         AND A.WORK_DATE <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')  	\n"
                + "	         AND A.QC_OPER IN ('PVI','QC GATE')     	\n"
                + "	         AND A.QC_TYPE LIKE 'GATE' || '%'   	\n"
                + "	         AND B.MAT_GRP_1 LIKE '%' 	\n"
                + "	     ) B 	\n"
                + "	     WHERE A.CUSTOMER = B.CUSTOMER 	\n"
                + "	     UNION ALL 	\n"
                + "	     SELECT A.CUSTOMER AS GUBUN 	\n"
                + "	         , 0 AS QTY_QQ_1 	\n"
                + "	         , 0 AS QTY_QQ_2 	\n"
                + "	         , 0 AS QTY_QQ_3 	\n"
                + "	         , 0 AS QTY_QQ_4 	\n"
                + "	         , 0 AS QTY_MM_1 	\n"
                + "	         , 0 AS QTY_MM_2 	\n"
                + "	         , 0 AS QTY_MM_3 	\n"
                + "	         , 0 AS QTY_MM_4 	\n"
                + "	         , 0 AS QTY_WW_1 	\n"
                + "	         , 0 AS QTY_WW_2 	\n"
                + "	         , 0 AS QTY_WW_3 	\n"
                + "	         , 0 AS QTY_WW_4 	\n"
                + "	         , CASE WHEN A.QTY_DD_1 > 0 AND B.LOT_QTY_DD_1 > 0 THEN ROUND(A.QTY_DD_1 / B.LOT_QTY_DD_1 * 100, 2) ELSE 0 END AS QTY_DD_1 	\n"
                + "	         , CASE WHEN A.QTY_DD_2 > 0 AND B.LOT_QTY_DD_2 > 0 THEN ROUND(A.QTY_DD_2 / B.LOT_QTY_DD_2 * 100, 2) ELSE 0 END AS QTY_DD_2 	\n"
                + "	         , CASE WHEN A.QTY_DD_3 > 0 AND B.LOT_QTY_DD_3 > 0 THEN ROUND(A.QTY_DD_3 / B.LOT_QTY_DD_3 * 100, 2) ELSE 0 END AS QTY_DD_3 	\n"
                + "	         , CASE WHEN A.QTY_DD_4 > 0 AND B.LOT_QTY_DD_4 > 0 THEN ROUND(A.QTY_DD_4 / B.LOT_QTY_DD_4 * 100, 2) ELSE 0 END AS QTY_DD_4 	\n"
                + "	         , CASE WHEN A.QTY_DD_5 > 0 AND B.LOT_QTY_DD_5 > 0 THEN ROUND(A.QTY_DD_5 / B.LOT_QTY_DD_5 * 100, 2) ELSE 0 END AS QTY_DD_5 	\n"
                + "	         , CASE WHEN A.QTY_DD_6 > 0 AND B.LOT_QTY_DD_6 > 0 THEN ROUND(A.QTY_DD_6 / B.LOT_QTY_DD_6 * 100, 2) ELSE 0 END AS QTY_DD_6 	\n"
                + "	         , CASE WHEN A.QTY_DD_7 > 0 AND B.LOT_QTY_DD_7 > 0 THEN ROUND(A.QTY_DD_7 / B.LOT_QTY_DD_7 * 100, 2) ELSE 0 END AS QTY_DD_7 	\n"
                + "	     FROM( 	\n"
                + "	         SELECT 'Front - LRR' AS CUSTOMER 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                         WHEN '금'  	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                         WHEN '목' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                   END) AS QTY_DD_1 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                         WHEN '토' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                         WHEN '금' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                   END) AS QTY_DD_2  	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                         WHEN '일'  	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                         WHEN '토' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                   END) AS QTY_DD_3  	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                         WHEN '월'  	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                         WHEN '일' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                   END) AS QTY_DD_4  	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                         WHEN '화' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                         WHEN '월' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                   END) AS QTY_DD_5  	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                         WHEN '수' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                         WHEN '화' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                   END) AS QTY_DD_6  	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                         WHEN '목'  	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                         WHEN '수' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                   END) AS QTY_DD_7 	\n"
                + "	         FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT  	\n"
                + "	         WHERE 1=1  	\n"
                + "	         AND SUBSTR(STS.ABR_NO,1,3) = 'QCN' 	\n"
                + "	         AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                + "	         AND STS.FACTORY = MAT.FACTORY  	\n"
                + "	         AND STS.MAT_ID = MAT.MAT_ID 	\n"
                + "	         AND STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                END  	\n"
                + "	         AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000' 	\n"
                + "	         AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%' 	\n"
                + "	         AND STS.DEFECT_CODE LIKE '%' 	\n"
                + "	         AND STS.CUR_STEP LIKE '%' 	\n"
                + "	         AND STS.OPER_1 >= 'A0000' 	\n"
                + "	         AND STS.OPER_1 <= 'A0970' 	\n"
                + "	         AND STS.DEL_FLAG = ' ' 	\n"
                + "	         UNION ALL 	\n"
                + "	         SELECT 'B/E - LRR' AS CUSTOMER 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                         WHEN '금'  	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                         WHEN '목' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                   END) AS QTY_DD_1 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                         WHEN '토' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                         WHEN '금' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                   END) AS QTY_DD_2  	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                         WHEN '일'  	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                         WHEN '토' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                   END) AS QTY_DD_3  	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                         WHEN '월'  	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                         WHEN '일' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                   END) AS QTY_DD_4  	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                         WHEN '화' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                         WHEN '월' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                   END) AS QTY_DD_5  	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                         WHEN '수' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                         WHEN '화' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                   END) AS QTY_DD_6  	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                         WHEN '목'  	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                         WHEN '수' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                   END) AS QTY_DD_7 	\n"
                + "	         FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT  	\n"
                + "	         WHERE 1=1  	\n"
                + "	         AND SUBSTR(STS.ABR_NO,1,3) = 'QCN' 	\n"
                + "	         AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                + "	         AND STS.FACTORY = MAT.FACTORY  	\n"
                + "	         AND STS.MAT_ID = MAT.MAT_ID 	\n"
                + "	         AND STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                END  	\n"
                + "	         AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000' 	\n"
                + "	         AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%' 	\n"
                + "	         AND STS.DEFECT_CODE LIKE '%' 	\n"
                + "	         AND STS.CUR_STEP LIKE '%' 	\n"
                + "	         AND STS.OPER_1 >= 'A1000' 	\n"
                + "	         AND STS.OPER_1 <= 'AZ010' 	\n"
                + "	         AND STS.DEL_FLAG = ' ' 	\n"
                + "	         UNION ALL 	\n"
                + "	         SELECT 'TOTAL - LRR' AS CUSTOMER 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                         WHEN '금'  	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                         WHEN '목' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                   END) AS QTY_DD_1 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                         WHEN '토' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                         WHEN '금' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                   END) AS QTY_DD_2  	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                         WHEN '일'  	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                         WHEN '토' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                   END) AS QTY_DD_3  	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                         WHEN '월'  	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                         WHEN '일' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                   END) AS QTY_DD_4  	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                         WHEN '화' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                         WHEN '월' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                   END) AS QTY_DD_5  	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                         WHEN '수' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                         WHEN '화' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                   END) AS QTY_DD_6  	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                         WHEN '목'  	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                         WHEN '수' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                   END) AS QTY_DD_7 	\n"
                + "	         FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT  	\n"
                + "	         WHERE 1=1  	\n"
                + "	         AND SUBSTR(STS.ABR_NO,1,3) = 'QCN' 	\n"
                + "	         AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                + "	         AND STS.FACTORY = MAT.FACTORY  	\n"
                + "	         AND STS.MAT_ID = MAT.MAT_ID 	\n"
                + "	         AND STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                END  	\n"
                + "	         AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000' 	\n"
                + "	         AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%' 	\n"
                + "	         AND STS.DEFECT_CODE LIKE '%' 	\n"
                + "	         AND STS.CUR_STEP LIKE '%' 	\n"
                + "	         AND STS.OPER_1 >= 'A0000' 	\n"
                + "	         AND STS.OPER_1 <= 'AZ010' 	\n"
                + "	         AND STS.DEL_FLAG = ' ' 	\n"
                + "	     ) A, 	\n"
                + "	     ( 	\n"
                + "	         SELECT 'Front - LRR' AS CUSTOMER  	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '금' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_1  	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '토' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_2 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '일' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_3 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '월' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_4 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '화' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_5 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '수' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_6 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '목' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_7 	\n"
                + "	         FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B   	\n"
                + "	         WHERE A.FACTORY = B.FACTORY   	\n"
                + "	         AND A.MAT_ID = B.MAT_ID   	\n"
                + "	         AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'  	\n"
                + "	         AND A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 0, 'YYYYMMDD')  	\n"
                + "	                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')  	\n"
                + "	                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')  	\n"
                + "	                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')  	\n"
                + "	                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')  	\n"
                + "	                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')  	\n"
                + "	                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')  	\n"
                + "	                            END   	\n"
                + "	         AND A.WORK_DATE <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')  	\n"
                + "	         AND A.QC_OPER IN ('PVI','QC GATE')     	\n"
                + "	         AND A.QC_TYPE LIKE 'GATE' || '%'   	\n"
                + "	         AND B.MAT_GRP_1 LIKE '%' 	\n"
                + "	         UNION ALL 	\n"
                + "	         SELECT 'B/E - LRR' AS CUSTOMER  	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '금' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_1  	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '토' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_2 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '일' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_3 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '월' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_4 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '화' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_5 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '수' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_6 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '목' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_7 	\n"
                + "	         FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B   	\n"
                + "	         WHERE A.FACTORY = B.FACTORY   	\n"
                + "	         AND A.MAT_ID = B.MAT_ID   	\n"
                + "	         AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'  	\n"
                + "	         AND A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 0, 'YYYYMMDD')  	\n"
                + "	                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')  	\n"
                + "	                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')  	\n"
                + "	                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')  	\n"
                + "	                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')  	\n"
                + "	                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')  	\n"
                + "	                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')  	\n"
                + "	                            END   	\n"
                + "	         AND A.WORK_DATE <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')  	\n"
                + "	         AND A.QC_OPER IN ('PVI','QC GATE')     	\n"
                + "	         AND A.QC_TYPE LIKE 'GATE' || '%'   	\n"
                + "	         AND B.MAT_GRP_1 LIKE '%' 	\n"
                + "	         UNION ALL 	\n"
                + "	         SELECT 'TOTAL - LRR' AS CUSTOMER  	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '금' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_1  	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '토' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_2 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '일' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_3 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '월' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_4 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '화' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_5 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '수' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_6 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '목' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_7 	\n"
                + "	         FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B   	\n"
                + "	         WHERE A.FACTORY = B.FACTORY   	\n"
                + "	         AND A.MAT_ID = B.MAT_ID   	\n"
                + "	         AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'  	\n"
                + "	         AND A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 0, 'YYYYMMDD')  	\n"
                + "	                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')  	\n"
                + "	                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')  	\n"
                + "	                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')  	\n"
                + "	                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')  	\n"
                + "	                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')  	\n"
                + "	                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')  	\n"
                + "	                            END   	\n"
                + "	         AND A.WORK_DATE <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')  	\n"
                + "	         AND A.QC_OPER IN ('PVI','QC GATE')     	\n"
                + "	         AND A.QC_TYPE LIKE 'GATE' || '%'   	\n"
                + "	         AND B.MAT_GRP_1 LIKE '%' 	\n"
                + "	     ) B 	\n"
                + "	     WHERE A.CUSTOMER = B.CUSTOMER	\n"
                + "	)GROUP BY GUBUN	\n"
                + "	ORDER BY DECODE(GUBUN, 'Front - LRR', 0, 'B/E - LRR', 1, 'TOTAL - LRR', 2)	\n";
            #endregion

            if (GlobalVariable.gsUserGroup == "ADMIN_GROUP" || GlobalVariable.gsUserGroup == "HANA_ADMIN_GROUP")
            {
                System.Windows.Forms.Clipboard.SetText(QRY.Replace((char)Keys.Tab, ' '));
            }

            return QRY.Replace((char)Keys.Tab, ' ');
        }

        private string MakeSqlString3(string date)
        {
            /****************************************************
             * Comment : DataBase에 저장된 데이터를 조회한다.(SEC/HINIX/ETC - QCN건수, 검사LOT수, LRR)
             * 
             * Created By : 김선호(2012-09-05-수요일)
             * 
             * Modified By :
             ****************************************************/

            string QRY = "";

            #region - SEC/HINIX/ETC - QCN건수, 검사LOT수, LRR

            QRY = "	 SELECT GUBUN 	\n"
                + "	     , SUM(QTY_QQ_1) AS QTY_QQ_1 	\n"
                + "	     , SUM(QTY_QQ_2) AS QTY_QQ_2 	\n"
                + "	     , SUM(QTY_QQ_3) AS QTY_QQ_3 	\n"
                + "	     , SUM(QTY_QQ_4) AS QTY_QQ_4 	\n"
                + "	     , SUM(QTY_MM_1) AS QTY_MM_1 	\n"
                + "	     , SUM(QTY_MM_2) AS QTY_MM_2 	\n"
                + "	     , SUM(QTY_MM_3) AS QTY_MM_3 	\n"
                + "	     , SUM(QTY_MM_4) AS QTY_MM_4 	\n"
                + "	     , SUM(QTY_WW_1) AS QTY_WW_1 	\n"
                + "	     , SUM(QTY_WW_2) AS QTY_WW_2 	\n"
                + "	     , SUM(QTY_WW_3) AS QTY_WW_3 	\n"
                + "	     , SUM(QTY_WW_4) AS QTY_WW_4 	\n"
                + "	     , SUM(QTY_DD_1) AS QTY_DD_1 	\n"
                + "	     , SUM(QTY_DD_2) AS QTY_DD_2 	\n"
                + "	     , SUM(QTY_DD_3) AS QTY_DD_3 	\n"
                + "	     , SUM(QTY_DD_4) AS QTY_DD_4 	\n"
                + "	     , SUM(QTY_DD_5) AS QTY_DD_5 	\n"
                + "	     , SUM(QTY_DD_6) AS QTY_DD_6 	\n"
                + "	     , SUM(QTY_DD_7) AS QTY_DD_7 	\n"
                + "	 FROM 	\n"
                + "	 ( 	\n"
                + "	     SELECT CASE STS.CUS_ID WHEN 'SE' THEN 'SEC - QCN 건수' 	\n"
                + "	                            WHEN 'HX' THEN 'HYNIX - QCN 건수' 	\n"
                + "	                            ELSE 'ETC - QCN 건수' 	\n"
                + "	            END AS GUBUN 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                 WHEN '4' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '3' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '2' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '1' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	               END) AS QTY_QQ_1 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                 WHEN '4' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '3' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '2' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '1' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	               END) AS QTY_QQ_2 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                 WHEN '4' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '3' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '2' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '1' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	               END) AS QTY_QQ_3 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                 WHEN '4' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '3' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '2' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '1' THEN  	\n"
                + "	                             CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                 THEN 1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	               END) AS QTY_QQ_4 	\n"
                + "	         , 0 AS QTY_MM_1 	\n"
                + "	         , 0 AS QTY_MM_2 	\n"
                + "	         , 0 AS QTY_MM_3 	\n"
                + "	         , 0 AS QTY_MM_4 	\n"
                + "	         , 0 AS QTY_WW_1 	\n"
                + "	         , 0 AS QTY_WW_2 	\n"
                + "	         , 0 AS QTY_WW_3 	\n"
                + "	         , 0 AS QTY_WW_4 	\n"
                + "	         , 0 AS QTY_DD_1 	\n"
                + "	         , 0 AS QTY_DD_2 	\n"
                + "	         , 0 AS QTY_DD_3 	\n"
                + "	         , 0 AS QTY_DD_4 	\n"
                + "	         , 0 AS QTY_DD_5 	\n"
                + "	         , 0 AS QTY_DD_6 	\n"
                + "	         , 0 AS QTY_DD_7 	\n"
                + "	     FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT  	\n"
                + "	     WHERE 1=1  	\n"
                + "	     AND SUBSTR(STS.ABR_NO,1,3) = 'QCN' 	\n"
                + "	     AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                + "	     AND STS.FACTORY = MAT.FACTORY  	\n"
                + "	     AND STS.MAT_ID = MAT.MAT_ID  	\n"
                + "	     AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -13)), 'YYYYMMDD')||'220000' 	\n"
                + "	     AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000' 	\n"
                + "	     AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%' 	\n"
                + "	     AND STS.DEFECT_CODE LIKE '%' 	\n"
                + "	     AND STS.CUR_STEP LIKE '%' 	\n"
                + "	     AND STS.OPER_1 >= 'A0000' 	\n"
                + "	     AND STS.OPER_1 <= 'AZ010' 	\n"
                + "	     AND STS.DEL_FLAG = ' ' 	\n"
                + "	     GROUP BY CASE STS.CUS_ID WHEN 'SE' THEN 'SEC - QCN 건수' 	\n"
                + "	                              WHEN 'HX' THEN 'HYNIX - QCN 건수' 	\n"
                + "	                              ELSE 'ETC - QCN 건수' 	\n"
                + "	              END 	\n"
                + "	     UNION ALL 	\n"
                + "	     SELECT CASE STS.CUS_ID WHEN 'SE' THEN 'SEC - QCN 건수' 	\n"
                + "	                            WHEN 'HX' THEN 'HYNIX - QCN 건수' 	\n"
                + "	                            ELSE 'ETC - QCN 건수' 	\n"
                + "	            END AS GUBUN 	\n"
                + "	         , 0 AS QTY_QQ_1  	\n"
                + "	         , 0 AS QTY_QQ_2  	\n"
                + "	         , 0 AS QTY_QQ_3  	\n"
                + "	         , 0 AS QTY_QQ_4 	\n"
                + "	         ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000' 	\n"
                + "	                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                     THEN 1 	\n"
                + "	                     ELSE 0 	\n"
                + "	              END) AS QTY_MM_1 	\n"
                + "	         ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000' 	\n"
                + "	                     THEN 1 	\n"
                + "	                     ELSE 0 	\n"
                + "	              END) AS QTY_MM_2 	\n"
                + "	         ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000' 	\n"
                + "	                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000' 	\n"
                + "	                     THEN 1 	\n"
                + "	                     ELSE 0 	\n"
                + "	              END) AS QTY_MM_3 	\n"
                + "	         ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000' 	\n"
                + "	                         AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 0)), 'YYYYMMDD')||'220000' 	\n"
                + "	                     THEN 1 	\n"
                + "	                     ELSE 0 	\n"
                + "	              END) AS QTY_MM_4 	\n"
                + "	         , 0 AS QTY_WW_1 	\n"
                + "	         , 0 AS QTY_WW_2 	\n"
                + "	         , 0 AS QTY_WW_3 	\n"
                + "	         , 0 AS QTY_WW_4 	\n"
                + "	         , 0 AS QTY_DD_1 	\n"
                + "	         , 0 AS QTY_DD_2 	\n"
                + "	         , 0 AS QTY_DD_3 	\n"
                + "	         , 0 AS QTY_DD_4 	\n"
                + "	         , 0 AS QTY_DD_5 	\n"
                + "	         , 0 AS QTY_DD_6 	\n"
                + "	         , 0 AS QTY_DD_7 	\n"
                + "	     FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT  	\n"
                + "	     WHERE 1=1  	\n"
                + "	     AND SUBSTR(STS.ABR_NO,1,3) = 'QCN' 	\n"
                + "	     AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                + "	     AND STS.FACTORY = MAT.FACTORY  	\n"
                + "	     AND STS.MAT_ID = MAT.MAT_ID  	\n"
                + "	     AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000' 	\n"
                + "	     AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000' 	\n"
                + "	     AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%' 	\n"
                + "	     AND STS.DEFECT_CODE LIKE '%' 	\n"
                + "	     AND STS.CUR_STEP LIKE '%' 	\n"
                + "	     AND STS.OPER_1 >= 'A0000' 	\n"
                + "	     AND STS.OPER_1 <= 'AZ010' 	\n"
                + "	     AND STS.DEL_FLAG = ' ' 	\n"
                + "	     GROUP BY CASE STS.CUS_ID WHEN 'SE' THEN 'SEC - QCN 건수' 	\n"
                + "	                              WHEN 'HX' THEN 'HYNIX - QCN 건수' 	\n"
                + "	                              ELSE 'ETC - QCN 건수' 	\n"
                + "	              END 	\n"
                + "	     UNION ALL 	\n"
                + "	     SELECT CASE STS.CUS_ID WHEN 'SE' THEN 'SEC - QCN 건수' 	\n"
                + "	                            WHEN 'HX' THEN 'HYNIX - QCN 건수' 	\n"
                + "	                            ELSE 'ETC - QCN 건수' 	\n"
                + "	            END AS GUBUN 	\n"
                + "	         , 0 AS QTY_QQ_1 	\n"
                + "	         , 0 AS QTY_QQ_2 	\n"
                + "	         , 0 AS QTY_QQ_3 	\n"
                + "	         , 0 AS QTY_QQ_4 	\n"
                + "	         , 0 AS QTY_MM_1 	\n"
                + "	         , 0 AS QTY_MM_2 	\n"
                + "	         , 0 AS QTY_MM_3 	\n"
                + "	         , 0 AS QTY_MM_4 	\n"
                + "	         , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 28, 'YYYYMMDD')||'220000'  	\n"
                + "	                                        END                                                  	\n"
                + "	                     AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')||'220000'  	\n"
                + "	                                        END THEN 1 ELSE 0 END) AS QTY_WW_1 	\n"
                + "	         , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')||'220000'  	\n"
                + "	                                        END                                                  	\n"
                + "	                     AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')||'220000'    	\n"
                + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')||'220000'    	\n"
                + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')||'220000'   	\n"
                + "	                                        END THEN 1 ELSE 0 END) AS QTY_WW_2 	\n"
                + "	         , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                    WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                    WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                    WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                    WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                    WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')||'220000'   	\n"
                + "	                                        END                                                  	\n"
                + "	                     AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000'  	\n"
                + "	                                        END THEN 1 ELSE 0 END) AS QTY_WW_3 	\n"
                + "	         , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                    WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000'  	\n"
                + "	                                        END  	\n"
                + "	                     AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 6, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 5, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 4, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 3, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 2, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 1, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 0, 'YYYYMMDD')||'220000' 	\n"
                + "	                                        END THEN 1 ELSE 0 END) AS QTY_WW_4 	\n"
                + "	         , 0 AS QTY_DD_1 	\n"
                + "	         , 0 AS QTY_DD_2 	\n"
                + "	         , 0 AS QTY_DD_3 	\n"
                + "	         , 0 AS QTY_DD_4 	\n"
                + "	         , 0 AS QTY_DD_5 	\n"
                + "	         , 0 AS QTY_DD_6 	\n"
                + "	         , 0 AS QTY_DD_7 	\n"
                + "	     FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT  	\n"
                + "	     WHERE 1=1  	\n"
                + "	     AND SUBSTR(STS.ABR_NO,1,3) = 'QCN' 	\n"
                + "	     AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                + "	     AND STS.FACTORY = MAT.FACTORY  	\n"
                + "	     AND STS.MAT_ID = MAT.MAT_ID 	\n"
                + "	     AND STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                    WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                    WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                    WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                    WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                    WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                    WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 28, 'YYYYMMDD')||'220000' 	\n"
                + "	                                            END  	\n"
                + "	     AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000' 	\n"
                + "	     AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%' 	\n"
                + "	     AND STS.DEFECT_CODE LIKE '%' 	\n"
                + "	     AND STS.CUR_STEP LIKE '%' 	\n"
                + "	     AND STS.OPER_1 >= 'A0000' 	\n"
                + "	     AND STS.OPER_1 <= 'AZ010' 	\n"
                + "	     AND STS.DEL_FLAG = ' ' 	\n"
                + "	     GROUP BY CASE STS.CUS_ID WHEN 'SE' THEN 'SEC - QCN 건수' 	\n"
                + "	                              WHEN 'HX' THEN 'HYNIX - QCN 건수' 	\n"
                + "	                              ELSE 'ETC - QCN 건수' 	\n"
                + "	              END 	\n"
                + "	     UNION ALL 	\n"
                + "	     SELECT CASE STS.CUS_ID WHEN 'SE' THEN 'SEC - QCN 건수' 	\n"
                + "	                            WHEN 'HX' THEN 'HYNIX - QCN 건수' 	\n"
                + "	                            ELSE 'ETC - QCN 건수' 	\n"
                + "	            END AS GUBUN 	\n"
                + "	         , 0 AS QTY_QQ_1 	\n"
                + "	         , 0 AS QTY_QQ_2 	\n"
                + "	         , 0 AS QTY_QQ_3 	\n"
                + "	         , 0 AS QTY_QQ_4 	\n"
                + "	         , 0 AS QTY_MM_1 	\n"
                + "	         , 0 AS QTY_MM_2 	\n"
                + "	         , 0 AS QTY_MM_3 	\n"
                + "	         , 0 AS QTY_MM_4 	\n"
                + "	         , 0 AS QTY_WW_1 	\n"
                + "	         , 0 AS QTY_WW_2 	\n"
                + "	         , 0 AS QTY_WW_3 	\n"
                + "	         , 0 AS QTY_WW_4 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                     WHEN '금'  	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	                     WHEN '목' 	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	               END) AS QTY_DD_1 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                     WHEN '토' 	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	                     WHEN '금' 	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	               END) AS QTY_DD_2  	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                     WHEN '일'  	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	                     WHEN '토' 	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	               END) AS QTY_DD_3  	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                     WHEN '월'  	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	                     WHEN '일' 	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	               END) AS QTY_DD_4  	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                     WHEN '화' 	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	                     WHEN '월' 	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	               END) AS QTY_DD_5  	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                     WHEN '수' 	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	                     WHEN '화' 	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	               END) AS QTY_DD_6  	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                     WHEN '목'  	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	                     WHEN '수' 	\n"
                + "	                     THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                               THEN 1 	\n"
                + "	                               ELSE 0 	\n"
                + "	                          END 	\n"
                + "	               END) AS QTY_DD_7 	\n"
                + "	     FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT  	\n"
                + "	     WHERE 1=1  	\n"
                + "	     AND SUBSTR(STS.ABR_NO,1,3) = 'QCN' 	\n"
                + "	     AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                + "	     AND STS.FACTORY = MAT.FACTORY  	\n"
                + "	     AND STS.MAT_ID = MAT.MAT_ID 	\n"
                + "	     AND STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                    WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                    WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                    WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                    WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                    WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                    WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000' 	\n"
                + "	                                            END  	\n"
                + "	     AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000' 	\n"
                + "	     AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%' 	\n"
                + "	     AND STS.DEFECT_CODE LIKE '%' 	\n"
                + "	     AND STS.CUR_STEP LIKE '%' 	\n"
                + "	     AND STS.OPER_1 >= 'A0000' 	\n"
                + "	     AND STS.OPER_1 <= 'AZ010' 	\n"
                + "	     AND STS.DEL_FLAG = ' ' 	\n"
                + "	     GROUP BY CASE STS.CUS_ID WHEN 'SE' THEN 'SEC - QCN 건수' 	\n"
                + "	                              WHEN 'HX' THEN 'HYNIX - QCN 건수' 	\n"
                + "	                              ELSE 'ETC - QCN 건수' 	\n"
                + "	              END 	\n"
                + "	  	\n"
                + "	     UNION ALL 	\n"
                + "	     	\n"
                + "	     SELECT CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC - 검사 LOT 수' 	\n"
                + "	                             WHEN 'HX' THEN 'HYNIX - 검사 LOT 수' 	\n"
                + "	                             ELSE 'ETC - 검사 LOT 수' 	\n"
                + "	            END AS GUBUN 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                 WHEN '4' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '3' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '2' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '1' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'04' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'04', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	               END) AS QTY_QQ_1 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                 WHEN '4' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '3' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '2' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '1' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	               END) AS QTY_QQ_2 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                 WHEN '4' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '3' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '2' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '1' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	               END) AS QTY_QQ_3 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                 WHEN '4' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'10' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'10', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '3' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '2' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '1' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	               END) AS QTY_QQ_4 	\n"
                + "	         , 0 AS QTY_MM_1 	\n"
                + "	         , 0 AS QTY_MM_2 	\n"
                + "	         , 0 AS QTY_MM_3 	\n"
                + "	         , 0 AS QTY_MM_4 	\n"
                + "	         , 0 AS QTY_WW_1 	\n"
                + "	         , 0 AS QTY_WW_2 	\n"
                + "	         , 0 AS QTY_WW_3 	\n"
                + "	         , 0 AS QTY_WW_4 	\n"
                + "	         , 0 AS QTY_DD_1 	\n"
                + "	         , 0 AS QTY_DD_2 	\n"
                + "	         , 0 AS QTY_DD_3 	\n"
                + "	         , 0 AS QTY_DD_4 	\n"
                + "	         , 0 AS QTY_DD_5 	\n"
                + "	         , 0 AS QTY_DD_6 	\n"
                + "	         , 0 AS QTY_DD_7 	\n"
                + "	     FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B   	\n"
                + "	     WHERE A.FACTORY = B.FACTORY   	\n"
                + "	     AND A.MAT_ID = B.MAT_ID   	\n"
                + "	     AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'  	\n"
                + "	     AND A.WORK_MONTH >= TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -11), 'YYYYMM')  	\n"
                + "	     AND A.WORK_MONTH <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMM') 	\n"
                + "	     AND A.QC_OPER IN ('PVI','QC GATE')     	\n"
                + "	     AND A.QC_TYPE LIKE 'GATE' || '%'   	\n"
                + "	     AND B.MAT_GRP_1 LIKE '%' 	\n"
                + "	     GROUP BY CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC - 검사 LOT 수' 	\n"
                + "	                               WHEN 'HX' THEN 'HYNIX - 검사 LOT 수' 	\n"
                + "	                               ELSE 'ETC - 검사 LOT 수' 	\n"
                + "	              END 	\n"
                + "	     UNION ALL 	\n"
                + "	     SELECT CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC - 검사 LOT 수' 	\n"
                + "	                             WHEN 'HX' THEN 'HYNIX - 검사 LOT 수' 	\n"
                + "	                             ELSE 'ETC - 검사 LOT 수' 	\n"
                + "	            END AS GUBUN 	\n"
                + "	         , 0 AS QTY_QQ_1 	\n"
                + "	         , 0 AS QTY_QQ_2 	\n"
                + "	         , 0 AS QTY_QQ_3 	\n"
                + "	         , 0 AS QTY_QQ_4 	\n"
                + "	         , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_MM_1 	\n"
                + "	         , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_MM_2 	\n"
                + "	         , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_MM_3 	\n"
                + "	         , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_MM_4 	\n"
                + "	         , 0 AS QTY_WW_1 	\n"
                + "	         , 0 AS QTY_WW_2 	\n"
                + "	         , 0 AS QTY_WW_3 	\n"
                + "	         , 0 AS QTY_WW_4 	\n"
                + "	         , 0 AS QTY_DD_1 	\n"
                + "	         , 0 AS QTY_DD_2 	\n"
                + "	         , 0 AS QTY_DD_3 	\n"
                + "	         , 0 AS QTY_DD_4 	\n"
                + "	         , 0 AS QTY_DD_5 	\n"
                + "	         , 0 AS QTY_DD_6 	\n"
                + "	         , 0 AS QTY_DD_7 	\n"
                + "	     FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B   	\n"
                + "	     WHERE A.FACTORY = B.FACTORY   	\n"
                + "	     AND A.MAT_ID = B.MAT_ID   	\n"
                + "	     AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'  	\n"
                + "	     AND A.WORK_MONTH >= TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4), 'YYYYMM')  	\n"
                + "	     AND A.WORK_MONTH <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMM') 	\n"
                + "	     AND A.QC_OPER IN ('PVI','QC GATE')     	\n"
                + "	     AND A.QC_TYPE LIKE 'GATE' || '%'   	\n"
                + "	     AND B.MAT_GRP_1 LIKE '%' 	\n"
                + "	     GROUP BY CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC - 검사 LOT 수' 	\n"
                + "	                               WHEN 'HX' THEN 'HYNIX - 검사 LOT 수' 	\n"
                + "	                               ELSE 'ETC - 검사 LOT 수' 	\n"
                + "	              END 	\n"
                + "	     UNION ALL 	\n"
                + "	     SELECT CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC - 검사 LOT 수' 	\n"
                + "	                             WHEN 'HX' THEN 'HYNIX - 검사 LOT 수' 	\n"
                + "	                             ELSE 'ETC - 검사 LOT 수' 	\n"
                + "	            END AS GUBUN 	\n"
                + "	         , 0 AS QTY_QQ_1 	\n"
                + "	         , 0 AS QTY_QQ_2 	\n"
                + "	         , 0 AS QTY_QQ_3 	\n"
                + "	         , 0 AS QTY_QQ_4 	\n"
                + "	         , 0 AS QTY_MM_1 	\n"
                + "	         , 0 AS QTY_MM_2 	\n"
                + "	         , 0 AS QTY_MM_3 	\n"
                + "	         , 0 AS QTY_MM_4 	\n"
                + "	         , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')  	\n"
                + "	                                        END 	\n"
                + "	                     AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD') 	\n"
                + "	                                                                    WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD') 	\n"
                + "	                                                                    WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')  	\n"
                + "	                                        END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_WW_1 	\n"
                + "	         , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')  	\n"
                + "	                                        END 	\n"
                + "	                     AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')   	\n"
                + "	                                                                    WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')   	\n"
                + "	                                                                    WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')  	\n"
                + "	                                        END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_WW_2 	\n"
                + "	         , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD') 	\n"
                + "	                                                                    WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')  	\n"
                + "	                                        END 	\n"
                + "	                     AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')  	\n"
                + "	                                        END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_WW_3 	\n"
                + "	         , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 0, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')  	\n"
                + "	                                        END 	\n"
                + "	                     AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 6, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 5, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 4, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 3, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 2, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 1, 'YYYYMMDD')  	\n"
                + "	                                                                    WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 0, 'YYYYMMDD')  	\n"
                + "	                                        END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_WW_4 	\n"
                + "	         , 0 AS QTY_DD_1  	\n"
                + "	         , 0 AS QTY_DD_2  	\n"
                + "	         , 0 AS QTY_DD_3  	\n"
                + "	         , 0 AS QTY_DD_4  	\n"
                + "	         , 0 AS QTY_DD_5  	\n"
                + "	         , 0 AS QTY_DD_6  	\n"
                + "	         , 0 AS QTY_DD_7  	\n"
                + "	     FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B   	\n"
                + "	     WHERE A.FACTORY = B.FACTORY   	\n"
                + "	     AND A.MAT_ID = B.MAT_ID   	\n"
                + "	     AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'  	\n"
                + "	     AND A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')  	\n"
                + "	                                                    WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')  	\n"
                + "	                                                    WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')  	\n"
                + "	                                                    WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')  	\n"
                + "	                                                    WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')  	\n"
                + "	                                                    WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')  	\n"
                + "	                                                    WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')  	\n"
                + "	                                            END  	\n"
                + "	     AND A.WORK_DATE <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')  	\n"
                + "	     AND A.QC_OPER IN ('PVI','QC GATE')     	\n"
                + "	     AND A.QC_TYPE LIKE 'GATE' || '%'   	\n"
                + "	     AND B.MAT_GRP_1 LIKE '%' 	\n"
                + "	     GROUP BY CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC - 검사 LOT 수' 	\n"
                + "	                               WHEN 'HX' THEN 'HYNIX - 검사 LOT 수' 	\n"
                + "	                               ELSE 'ETC - 검사 LOT 수' 	\n"
                + "	              END 	\n"
                + "	     UNION ALL 	\n"
                + "	     SELECT CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC - 검사 LOT 수' 	\n"
                + "	                             WHEN 'HX' THEN 'HYNIX - 검사 LOT 수' 	\n"
                + "	                             ELSE 'ETC - 검사 LOT 수' 	\n"
                + "	            END AS GUBUN 	\n"
                + "	         , 0 AS QTY_QQ_1 	\n"
                + "	         , 0 AS QTY_QQ_2 	\n"
                + "	         , 0 AS QTY_QQ_3 	\n"
                + "	         , 0 AS QTY_QQ_4 	\n"
                + "	         , 0 AS QTY_MM_1 	\n"
                + "	         , 0 AS QTY_MM_2 	\n"
                + "	         , 0 AS QTY_MM_3 	\n"
                + "	         , 0 AS QTY_MM_4 	\n"
                + "	         , 0 AS QTY_WW_1 	\n"
                + "	         , 0 AS QTY_WW_2 	\n"
                + "	         , 0 AS QTY_WW_3 	\n"
                + "	         , 0 AS QTY_WW_4 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '금' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_DD_1 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '토' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_DD_2 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '일' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_DD_3 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '월' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_DD_4 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '화' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_DD_5 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '수' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_DD_6 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '목' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_DD_7 	\n"
                + "	     FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B 	\n"
                + "	     WHERE A.FACTORY = B.FACTORY 	\n"
                + "	     AND A.MAT_ID = B.MAT_ID 	\n"
                + "	     AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                + "	     AND A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 0, 'YYYYMMDD') 	\n"
                + "	                                                    WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD') 	\n"
                + "	                                                    WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD') 	\n"
                + "	                                                    WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD') 	\n"
                + "	                                                    WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD') 	\n"
                + "	                                                    WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD') 	\n"
                + "	                                                    WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD') 	\n"
                + "	                        END   	\n"
                + "	     AND A.WORK_DATE <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')  	\n"
                + "	     AND A.QC_OPER IN ('PVI','QC GATE')     	\n"
                + "	     AND A.QC_TYPE LIKE 'GATE' || '%'   	\n"
                + "	     AND B.MAT_GRP_1 LIKE '%' 	\n"
                + "	     GROUP BY CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC - 검사 LOT 수' 	\n"
                + "	                               WHEN 'HX' THEN 'HYNIX - 검사 LOT 수' 	\n"
                + "	                               ELSE 'ETC - 검사 LOT 수' 	\n"
                + "	              END 	\n"
                + "	      	\n"
                + "	     UNION ALL 	\n"
                + "	  	\n"
                + "	     SELECT A.CUSTOMER AS GUBUN 	\n"
                + "	         , CASE WHEN A.QTY_QQ_1 > 0 AND B.LOT_QTY_QQ_1 > 0 THEN ROUND(A.QTY_QQ_1 / B.LOT_QTY_QQ_1 * 100, 2) ELSE 0 END AS QTY_QQ_1 	\n"
                + "	         , CASE WHEN A.QTY_QQ_2 > 0 AND B.LOT_QTY_QQ_2 > 0 THEN ROUND(A.QTY_QQ_2 / B.LOT_QTY_QQ_2 * 100, 2) ELSE 0 END AS QTY_QQ_2 	\n"
                + "	         , CASE WHEN A.QTY_QQ_3 > 0 AND B.LOT_QTY_QQ_3 > 0 THEN ROUND(A.QTY_QQ_3 / B.LOT_QTY_QQ_3 * 100, 2) ELSE 0 END AS QTY_QQ_3 	\n"
                + "	         , CASE WHEN A.QTY_QQ_4 > 0 AND B.LOT_QTY_QQ_4 > 0 THEN ROUND(A.QTY_QQ_4 / B.LOT_QTY_QQ_4 * 100, 2) ELSE 0 END AS QTY_QQ_4 	\n"
                + "	         , 0 AS QTY_MM_1 	\n"
                + "	         , 0 AS QTY_MM_2 	\n"
                + "	         , 0 AS QTY_MM_3 	\n"
                + "	         , 0 AS QTY_MM_4 	\n"
                + "	         , 0 AS QTY_WW_1 	\n"
                + "	         , 0 AS QTY_WW_2 	\n"
                + "	         , 0 AS QTY_WW_3 	\n"
                + "	         , 0 AS QTY_WW_4 	\n"
                + "	         , 0 AS QTY_DD_1 	\n"
                + "	         , 0 AS QTY_DD_2 	\n"
                + "	         , 0 AS QTY_DD_3 	\n"
                + "	         , 0 AS QTY_DD_4 	\n"
                + "	         , 0 AS QTY_DD_5 	\n"
                + "	         , 0 AS QTY_DD_6 	\n"
                + "	         , 0 AS QTY_DD_7 	\n"
                + "	     FROM(  	\n"
                + "	         SELECT CASE STS.CUS_ID WHEN 'SE' THEN 'SEC - LRR' 	\n"
                + "	                                WHEN 'HX' THEN 'HYNIX - LRR' 	\n"
                + "	                                ELSE 'ETC - LRR' 	\n"
                + "	                END AS CUSTOMER 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                     WHEN '4' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '3' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '2' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '1' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                   END) AS QTY_QQ_1 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                     WHEN '4' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '3' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '2' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '1' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                   END) AS QTY_QQ_2 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                     WHEN '4' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '3' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '2' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '1' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                   END) AS QTY_QQ_3 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                     WHEN '4' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '3' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '2' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                     WHEN '1' THEN  	\n"
                + "	                                 CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000' 	\n"
                + "	                                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                                     THEN 1 	\n"
                + "	                                     ELSE 0  	\n"
                + "	                                 END 	\n"
                + "	                   END) AS QTY_QQ_4 	\n"
                + "	         FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT  	\n"
                + "	         WHERE 1=1  	\n"
                + "	         AND SUBSTR(STS.ABR_NO,1,3) = 'QCN' 	\n"
                + "	         AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                + "	         AND STS.FACTORY = MAT.FACTORY  	\n"
                + "	         AND STS.MAT_ID = MAT.MAT_ID  	\n"
                + "	         AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -13)), 'YYYYMMDD')||'220000' 	\n"
                + "	         AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000' 	\n"
                + "	         AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%' 	\n"
                + "	         AND STS.DEFECT_CODE LIKE '%' 	\n"
                + "	         AND STS.CUR_STEP LIKE '%' 	\n"
                + "	         AND STS.OPER_1 >= 'A0000' 	\n"
                + "	         AND STS.OPER_1 <= 'AZ010' 	\n"
                + "	         AND STS.DEL_FLAG = ' ' 	\n"
                + "	         GROUP BY CASE STS.CUS_ID WHEN 'SE' THEN 'SEC - LRR' 	\n"
                + "	                                WHEN 'HX' THEN 'HYNIX - LRR' 	\n"
                + "	                                ELSE 'ETC - LRR' 	\n"
                + "	                  END 	\n"
                + "	     ) A, 	\n"
                + "	     ( 	\n"
                + "	         SELECT CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC - LRR' 	\n"
                + "	                                 WHEN 'HX' THEN 'HYNIX - LRR' 	\n"
                + "	                                 ELSE 'ETC - LRR' 	\n"
                + "	                END AS CUSTOMER  	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                 WHEN '4' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '3' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '2' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '1' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'04' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'04', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	               END) AS LOT_QTY_QQ_1 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                 WHEN '4' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '3' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '2' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '1' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	               END) AS LOT_QTY_QQ_2 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                 WHEN '4' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '3' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '2' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '1' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	               END) AS LOT_QTY_QQ_3 	\n"
                + "	         , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q') 	\n"
                + "	                 WHEN '4' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'10' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'10', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '3' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '2' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	                 WHEN '1' THEN  	\n"
                + "	                             CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01' 	\n"
                + "	                                         AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM') 	\n"
                + "	                                 THEN A.QC_LOT_QTY_1 	\n"
                + "	                                 ELSE 0  	\n"
                + "	                             END 	\n"
                + "	               END) AS LOT_QTY_QQ_4 	\n"
                + "	         FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B   	\n"
                + "	         WHERE A.FACTORY = B.FACTORY   	\n"
                + "	         AND A.MAT_ID = B.MAT_ID   	\n"
                + "	         AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'  	\n"
                + "	         AND A.WORK_MONTH >= TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -11), 'YYYYMM')  	\n"
                + "	         AND A.WORK_MONTH <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMM') 	\n"
                + "	         AND A.QC_OPER IN ('PVI','QC GATE')     	\n"
                + "	         AND A.QC_TYPE LIKE 'GATE' || '%'   	\n"
                + "	         AND B.MAT_GRP_1 LIKE '%' 	\n"
                + "	         GROUP BY CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC - LRR' 	\n"
                + "	                                   WHEN 'HX' THEN 'HYNIX - LRR' 	\n"
                + "	                                   ELSE 'ETC - LRR' 	\n"
                + "	                  END 	\n"
                + "	     ) B 	\n"
                + "	     WHERE A.CUSTOMER = B.CUSTOMER 	\n"
                + "	     UNION ALL 	\n"
                + "	     SELECT A.CUSTOMER AS GUBUN 	\n"
                + "	         , 0 AS QTY_QQ_1 	\n"
                + "	         , 0 AS QTY_QQ_2 	\n"
                + "	         , 0 AS QTY_QQ_3 	\n"
                + "	         , 0 AS QTY_QQ_4 	\n"
                + "	         , CASE WHEN A.QTY_MM_1 > 0 AND B.LOT_QTY_MM_1 > 0 THEN ROUND(A.QTY_MM_1 / B.LOT_QTY_MM_1 * 100, 2) ELSE 0 END AS QTY_MM_1 	\n"
                + "	         , CASE WHEN A.QTY_MM_2 > 0 AND B.LOT_QTY_MM_2 > 0 THEN ROUND(A.QTY_MM_2 / B.LOT_QTY_MM_2 * 100, 2) ELSE 0 END AS QTY_MM_2 	\n"
                + "	         , CASE WHEN A.QTY_MM_3 > 0 AND B.LOT_QTY_MM_3 > 0 THEN ROUND(A.QTY_MM_3 / B.LOT_QTY_MM_3 * 100, 2) ELSE 0 END AS QTY_MM_3 	\n"
                + "	         , CASE WHEN A.QTY_MM_4 > 0 AND B.LOT_QTY_MM_4 > 0 THEN ROUND(A.QTY_MM_4 / B.LOT_QTY_MM_4 * 100, 2) ELSE 0 END AS QTY_MM_4 	\n"
                + "	         , 0 AS QTY_WW_1 	\n"
                + "	         , 0 AS QTY_WW_2 	\n"
                + "	         , 0 AS QTY_WW_3 	\n"
                + "	         , 0 AS QTY_WW_4 	\n"
                + "	         , 0 AS QTY_DD_1 	\n"
                + "	         , 0 AS QTY_DD_2 	\n"
                + "	         , 0 AS QTY_DD_3 	\n"
                + "	         , 0 AS QTY_DD_4 	\n"
                + "	         , 0 AS QTY_DD_5 	\n"
                + "	         , 0 AS QTY_DD_6 	\n"
                + "	         , 0 AS QTY_DD_7 	\n"
                + "	     FROM( 	\n"
                + "	         SELECT CASE STS.CUS_ID WHEN 'SE' THEN 'SEC - LRR' 	\n"
                + "	                                WHEN 'HX' THEN 'HYNIX - LRR' 	\n"
                + "	                                ELSE 'ETC - LRR' 	\n"
                + "	                END AS CUSTOMER 	\n"
                + "	             ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000' 	\n"
                + "	                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                         THEN 1 	\n"
                + "	                         ELSE 0 	\n"
                + "	                  END) AS QTY_MM_1 	\n"
                + "	             ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000' 	\n"
                + "	                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000' 	\n"
                + "	                         THEN 1 	\n"
                + "	                         ELSE 0 	\n"
                + "	                  END) AS QTY_MM_2 	\n"
                + "	             ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000' 	\n"
                + "	                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000' 	\n"
                + "	                         THEN 1 	\n"
                + "	                         ELSE 0 	\n"
                + "	                  END) AS QTY_MM_3 	\n"
                + "	             ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000' 	\n"
                + "	                             AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 0)), 'YYYYMMDD')||'220000' 	\n"
                + "	                         THEN 1 	\n"
                + "	                         ELSE 0 	\n"
                + "	                  END) AS QTY_MM_4 	\n"
                + "	         FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT  	\n"
                + "	         WHERE 1=1  	\n"
                + "	         AND SUBSTR(STS.ABR_NO,1,3) = 'QCN' 	\n"
                + "	         AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                + "	         AND STS.FACTORY = MAT.FACTORY  	\n"
                + "	         AND STS.MAT_ID = MAT.MAT_ID  	\n"
                + "	         AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000' 	\n"
                + "	         AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000' 	\n"
                + "	         AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%' 	\n"
                + "	         AND STS.DEFECT_CODE LIKE '%' 	\n"
                + "	         AND STS.CUR_STEP LIKE '%' 	\n"
                + "	         AND STS.OPER_1 >= 'A0000' 	\n"
                + "	         AND STS.OPER_1 <= 'AZ010' 	\n"
                + "	         AND STS.DEL_FLAG = ' ' 	\n"
                + "	         GROUP BY CASE STS.CUS_ID WHEN 'SE' THEN 'SEC - LRR' 	\n"
                + "	                                WHEN 'HX' THEN 'HYNIX - LRR' 	\n"
                + "	                                ELSE 'ETC - LRR' 	\n"
                + "	                  END 	\n"
                + "	     ) A, 	\n"
                + "	     ( 	\n"
                + "	         SELECT CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC - LRR' 	\n"
                + "	                                 WHEN 'HX' THEN 'HYNIX - LRR' 	\n"
                + "	                                 ELSE 'ETC - LRR' 	\n"
                + "	                END AS CUSTOMER  	\n"
                + "	             , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_1 	\n"
                + "	             , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_2 	\n"
                + "	             , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_3 	\n"
                + "	             , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_4 	\n"
                + "	         FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B   	\n"
                + "	         WHERE A.FACTORY = B.FACTORY   	\n"
                + "	         AND A.MAT_ID = B.MAT_ID   	\n"
                + "	         AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'  	\n"
                + "	         AND A.WORK_MONTH >= TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4), 'YYYYMM')  	\n"
                + "	         AND A.WORK_MONTH <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMM') 	\n"
                + "	         AND A.QC_OPER IN ('PVI','QC GATE')     	\n"
                + "	         AND A.QC_TYPE LIKE 'GATE' || '%'   	\n"
                + "	         AND B.MAT_GRP_1 LIKE '%' 	\n"
                + "	         GROUP BY CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC - LRR' 	\n"
                + "	                                   WHEN 'HX' THEN 'HYNIX - LRR' 	\n"
                + "	                                   ELSE 'ETC - LRR' 	\n"
                + "	                  END 	\n"
                + "	     ) B 	\n"
                + "	     WHERE A.CUSTOMER = B.CUSTOMER 	\n"
                + "	     UNION ALL 	\n"
                + "	     SELECT A.CUSTOMER AS GUBUN 	\n"
                + "	         , 0 AS QTY_QQ_1 	\n"
                + "	         , 0 AS QTY_QQ_2 	\n"
                + "	         , 0 AS QTY_QQ_3 	\n"
                + "	         , 0 AS QTY_QQ_4 	\n"
                + "	         , 0 AS QTY_MM_1 	\n"
                + "	         , 0 AS QTY_MM_2 	\n"
                + "	         , 0 AS QTY_MM_3 	\n"
                + "	         , 0 AS QTY_MM_4 	\n"
                + "	         , CASE WHEN A.QTY_WW_1 > 0 AND B.LOT_QTY_WW_1 > 0 THEN ROUND(A.QTY_WW_1 / B.LOT_QTY_WW_1 * 100, 2) ELSE 0 END AS QTY_WW_1 	\n"
                + "	         , CASE WHEN A.QTY_WW_2 > 0 AND B.LOT_QTY_WW_2 > 0 THEN ROUND(A.QTY_WW_2 / B.LOT_QTY_WW_2 * 100, 2) ELSE 0 END AS QTY_WW_2 	\n"
                + "	         , CASE WHEN A.QTY_WW_3 > 0 AND B.LOT_QTY_WW_3 > 0 THEN ROUND(A.QTY_WW_3 / B.LOT_QTY_WW_3 * 100, 2) ELSE 0 END AS QTY_WW_3 	\n"
                + "	         , CASE WHEN A.QTY_WW_4 > 0 AND B.LOT_QTY_WW_4 > 0 THEN ROUND(A.QTY_WW_4 / B.LOT_QTY_WW_4 * 100, 2) ELSE 0 END AS QTY_WW_4 	\n"
                + "	         , 0 AS QTY_DD_1 	\n"
                + "	         , 0 AS QTY_DD_2 	\n"
                + "	         , 0 AS QTY_DD_3 	\n"
                + "	         , 0 AS QTY_DD_4 	\n"
                + "	         , 0 AS QTY_DD_5 	\n"
                + "	         , 0 AS QTY_DD_6 	\n"
                + "	         , 0 AS QTY_DD_7 	\n"
                + "	     FROM( 	\n"
                + "	         SELECT CASE STS.CUS_ID WHEN 'SE' THEN 'SEC - LRR' 	\n"
                + "	                                WHEN 'HX' THEN 'HYNIX - LRR' 	\n"
                + "	                                ELSE 'ETC - LRR' 	\n"
                + "	                END AS CUSTOMER 	\n"
                + "	             , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 28, 'YYYYMMDD')||'220000'  	\n"
                + "	                                            END 	\n"
                + "	                         AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')||'220000'  	\n"
                + "	                                            END THEN 1 ELSE 0 END) AS QTY_WW_1 	\n"
                + "	             , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')||'220000'  	\n"
                + "	                                            END 	\n"
                + "	                         AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')||'220000'    	\n"
                + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')||'220000'    	\n"
                + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')||'220000'   	\n"
                + "	                                            END THEN 1 ELSE 0 END) AS QTY_WW_2 	\n"
                + "	             , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')||'220000'   	\n"
                + "	                                            END 	\n"
                + "	                         AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000'  	\n"
                + "	                                            END THEN 1 ELSE 0 END) AS QTY_WW_3 	\n"
                + "	             , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000'  	\n"
                + "	                                            END 	\n"
                + "	                         AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 6, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 5, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 4, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 3, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 2, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 1, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 0, 'YYYYMMDD')||'220000' 	\n"
                + "	                                            END THEN 1 ELSE 0 END) AS QTY_WW_4 	\n"
                + "	         FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT  	\n"
                + "	         WHERE 1=1  	\n"
                + "	         AND SUBSTR(STS.ABR_NO,1,3) = 'QCN' 	\n"
                + "	         AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                + "	         AND STS.FACTORY = MAT.FACTORY  	\n"
                + "	         AND STS.MAT_ID = MAT.MAT_ID 	\n"
                + "	         AND STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 28, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                END  	\n"
                + "	         AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000' 	\n"
                + "	         AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%' 	\n"
                + "	         AND STS.DEFECT_CODE LIKE '%' 	\n"
                + "	         AND STS.CUR_STEP LIKE '%' 	\n"
                + "	         AND STS.OPER_1 >= 'A0000' 	\n"
                + "	         AND STS.OPER_1 <= 'AZ010' 	\n"
                + "	         AND STS.DEL_FLAG = ' ' 	\n"
                + "	         GROUP BY CASE STS.CUS_ID WHEN 'SE' THEN 'SEC - LRR' 	\n"
                + "	                                WHEN 'HX' THEN 'HYNIX - LRR' 	\n"
                + "	                                ELSE 'ETC - LRR' 	\n"
                + "	                  END 	\n"
                + "	     ) A, 	\n"
                + "	     ( 	\n"
                + "	         SELECT CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC - LRR' 	\n"
                + "	                                 WHEN 'HX' THEN 'HYNIX - LRR' 	\n"
                + "	                                 ELSE 'ETC - LRR' 	\n"
                + "	                END AS CUSTOMER  	\n"
                + "	             , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD') 	\n"
                + "	                                            END 	\n"
                + "	                         AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD') 	\n"
                + "	                                            END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_1 	\n"
                + "	             , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD') 	\n"
                + "	                                            END 	\n"
                + "	                         AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD') 	\n"
                + "	                                            END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_2 	\n"
                + "	             , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD') 	\n"
                + "	                                            END 	\n"
                + "	                         AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD') 	\n"
                + "	                                            END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_3 	\n"
                + "	             , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 0, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD') 	\n"
                + "	                                            END 	\n"
                + "	                         AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 6, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 5, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 4, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 3, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 2, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 1, 'YYYYMMDD') 	\n"
                + "	                                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 0, 'YYYYMMDD') 	\n"
                + "	                                            END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_4 	\n"
                + "	         FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B   	\n"
                + "	         WHERE A.FACTORY = B.FACTORY   	\n"
                + "	         AND A.MAT_ID = B.MAT_ID   	\n"
                + "	         AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'  	\n"
                + "	         AND A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD') 	\n"
                + "	                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD') 	\n"
                + "	                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD') 	\n"
                + "	                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD') 	\n"
                + "	                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD') 	\n"
                + "	                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD') 	\n"
                + "	                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD') 	\n"
                + "	                            END  	\n"
                + "	         AND A.WORK_DATE <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')  	\n"
                + "	         AND A.QC_OPER IN ('PVI','QC GATE')     	\n"
                + "	         AND A.QC_TYPE LIKE 'GATE' || '%'   	\n"
                + "	         AND B.MAT_GRP_1 LIKE '%' 	\n"
                + "	         GROUP BY CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC - LRR' 	\n"
                + "	                                   WHEN 'HX' THEN 'HYNIX - LRR' 	\n"
                + "	                                   ELSE 'ETC - LRR' 	\n"
                + "	                  END 	\n"
                + "	     ) B 	\n"
                + "	     WHERE A.CUSTOMER = B.CUSTOMER 	\n"
                + "	     UNION ALL 	\n"
                + "	     SELECT A.CUSTOMER AS GUBUN 	\n"
                + "	         , 0 AS QTY_QQ_1 	\n"
                + "	         , 0 AS QTY_QQ_2 	\n"
                + "	         , 0 AS QTY_QQ_3 	\n"
                + "	         , 0 AS QTY_QQ_4 	\n"
                + "	         , 0 AS QTY_MM_1 	\n"
                + "	         , 0 AS QTY_MM_2 	\n"
                + "	         , 0 AS QTY_MM_3 	\n"
                + "	         , 0 AS QTY_MM_4 	\n"
                + "	         , 0 AS QTY_WW_1 	\n"
                + "	         , 0 AS QTY_WW_2 	\n"
                + "	         , 0 AS QTY_WW_3 	\n"
                + "	         , 0 AS QTY_WW_4 	\n"
                + "	         , CASE WHEN A.QTY_DD_1 > 0 AND B.LOT_QTY_DD_1 > 0 THEN ROUND(A.QTY_DD_1 / B.LOT_QTY_DD_1 * 100, 2) ELSE 0 END AS QTY_DD_1 	\n"
                + "	         , CASE WHEN A.QTY_DD_2 > 0 AND B.LOT_QTY_DD_2 > 0 THEN ROUND(A.QTY_DD_2 / B.LOT_QTY_DD_2 * 100, 2) ELSE 0 END AS QTY_DD_2 	\n"
                + "	         , CASE WHEN A.QTY_DD_3 > 0 AND B.LOT_QTY_DD_3 > 0 THEN ROUND(A.QTY_DD_3 / B.LOT_QTY_DD_3 * 100, 2) ELSE 0 END AS QTY_DD_3 	\n"
                + "	         , CASE WHEN A.QTY_DD_4 > 0 AND B.LOT_QTY_DD_4 > 0 THEN ROUND(A.QTY_DD_4 / B.LOT_QTY_DD_4 * 100, 2) ELSE 0 END AS QTY_DD_4 	\n"
                + "	         , CASE WHEN A.QTY_DD_5 > 0 AND B.LOT_QTY_DD_5 > 0 THEN ROUND(A.QTY_DD_5 / B.LOT_QTY_DD_5 * 100, 2) ELSE 0 END AS QTY_DD_5 	\n"
                + "	         , CASE WHEN A.QTY_DD_6 > 0 AND B.LOT_QTY_DD_6 > 0 THEN ROUND(A.QTY_DD_6 / B.LOT_QTY_DD_6 * 100, 2) ELSE 0 END AS QTY_DD_6 	\n"
                + "	         , CASE WHEN A.QTY_DD_7 > 0 AND B.LOT_QTY_DD_7 > 0 THEN ROUND(A.QTY_DD_7 / B.LOT_QTY_DD_7 * 100, 2) ELSE 0 END AS QTY_DD_7 	\n"
                + "	     FROM( 	\n"
                + "	         SELECT CASE STS.CUS_ID WHEN 'SE' THEN 'SEC - LRR' 	\n"
                + "	                                WHEN 'HX' THEN 'HYNIX - LRR' 	\n"
                + "	                                ELSE 'ETC - LRR' 	\n"
                + "	                END AS CUSTOMER 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                         WHEN '금'  	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                         WHEN '목' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                   END) AS QTY_DD_1 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                         WHEN '토' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                         WHEN '금' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                   END) AS QTY_DD_2  	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                         WHEN '일'  	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                         WHEN '토' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                   END) AS QTY_DD_3  	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                         WHEN '월'  	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                         WHEN '일' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                   END) AS QTY_DD_4  	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                         WHEN '화' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                         WHEN '월' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                   END) AS QTY_DD_5  	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                         WHEN '수' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                         WHEN '화' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                   END) AS QTY_DD_6  	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY') 	\n"
                + "	                         WHEN '목'  	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                         WHEN '수' 	\n"
                + "	                         THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000' 	\n"
                + "	                                   THEN 1 	\n"
                + "	                                   ELSE 0 	\n"
                + "	                              END 	\n"
                + "	                   END) AS QTY_DD_7 	\n"
                + "	         FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT  	\n"
                + "	         WHERE 1=1  	\n"
                + "	         AND SUBSTR(STS.ABR_NO,1,3) = 'QCN' 	\n"
                + "	         AND STS.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "' 	\n"
                + "	         AND STS.FACTORY = MAT.FACTORY  	\n"
                + "	         AND STS.MAT_ID = MAT.MAT_ID 	\n"
                + "	         AND STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                END  	\n"
                + "	         AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000' 	\n"
                + "	         AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%' 	\n"
                + "	         AND STS.DEFECT_CODE LIKE '%' 	\n"
                + "	         AND STS.CUR_STEP LIKE '%' 	\n"
                + "	         AND STS.OPER_1 >= 'A0000' 	\n"
                + "	         AND STS.OPER_1 <= 'AZ010' 	\n"
                + "	         AND STS.DEL_FLAG = ' ' 	\n"
                + "	         GROUP BY CASE STS.CUS_ID WHEN 'SE' THEN 'SEC - LRR' 	\n"
                + "	                                WHEN 'HX' THEN 'HYNIX - LRR' 	\n"
                + "	                                ELSE 'ETC - LRR' 	\n"
                + "	                  END 	\n"
                + "	     ) A, 	\n"
                + "	     ( 	\n"
                + "	         SELECT CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC - LRR' 	\n"
                + "	                                 WHEN 'HX' THEN 'HYNIX - LRR' 	\n"
                + "	                                 ELSE 'ETC - LRR' 	\n"
                + "	                END AS CUSTOMER  	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '금' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_1  	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '토' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_2 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '일' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_3 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '월' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_4 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '화' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_5 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '수' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_6 	\n"
                + "	             , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '목' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_7 	\n"
                + "	         FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B   	\n"
                + "	         WHERE A.FACTORY = B.FACTORY   	\n"
                + "	         AND A.MAT_ID = B.MAT_ID   	\n"
                + "	         AND A.FACTORY = '" + GlobalVariable.gsAssyDefaultFactory + "'  	\n"
                + "	         AND A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 0, 'YYYYMMDD')  	\n"
                + "	                                                        WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')  	\n"
                + "	                                                        WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')  	\n"
                + "	                                                        WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')  	\n"
                + "	                                                        WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')  	\n"
                + "	                                                        WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')  	\n"
                + "	                                                        WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')  	\n"
                + "	                            END 	\n"
                + "	         AND A.WORK_DATE <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD') 	\n"
                + "	         AND A.QC_OPER IN ('PVI','QC GATE')  	\n"
                + "	         AND A.QC_TYPE LIKE 'GATE' || '%' 	\n"
                + "	         AND B.MAT_GRP_1 LIKE '%' 	\n"
                + "	         GROUP BY CASE B.MAT_GRP_1 WHEN 'SE' THEN 'SEC - LRR' 	\n"
                + "	                                   WHEN 'HX' THEN 'HYNIX - LRR' 	\n"
                + "	                                   ELSE 'ETC - LRR' 	\n"
                + "	                  END 	\n"
                + "	     ) B 	\n"
                + "	     WHERE A.CUSTOMER = B.CUSTOMER 	\n"
                + "	 )GROUP BY GUBUN 	\n"
                + "	 ORDER BY DECODE(GUBUN  	\n"
                + "	                 , 'SEC - QCN 건수', 0, 'SEC - 검사 LOT 수', 1, 'SEC - LRR', 2 	\n"
                + "	                 , 'HYNIX - QCN 건수', 3, 'HYNIX - 검사 LOT 수', 4, 'HYNIX - LRR', 5 	\n"
                + "	                 , 'ETC - QCN 건수', 6, 'ETC - 검사 LOT 수', 7, 'ETC - LRR', 8) 	\n";

            #endregion

            if (GlobalVariable.gsUserGroup == "ADMIN_GROUP" || GlobalVariable.gsUserGroup == "HANA_ADMIN_GROUP")
            {
                System.Windows.Forms.Clipboard.SetText(QRY.Replace((char)Keys.Tab, ' '));
            }

            return QRY.Replace((char)Keys.Tab, ' ');
        }

        private void fnMakeChart(Miracom.SmartWeb.UI.Controls.udcFarPoint SS, int iselrow, int step)
        {
            /****************************************************
             * Comment : SS의 데이터를 Chart에 표시한다.
             * 
             * Created By : 김선호(2012-07-26-목요일)
             * 
             * Modified By :
             ****************************************************/
            int[] ich_qq = new int[4]; int[] icols_qq = new int[4]; int[] irows_qq = new int[2]; string[] stitle_qq = new string[2];
            int[] ich_mm = new int[4]; int[] icols_mm = new int[4]; int[] irows_mm = new int[2]; string[] stitle_mm = new string[4];

            int[] ich_qq1 = new int[19]; int[] icols_qq1 = new int[19]; int[] irows_qq1 = new int[3]; string[] stitle_qq1 = new string[3];
            int icol = 0, irow = 0;

            try
            {
                Cursor.Current = Cursors.WaitCursor;

                // SS에 데이터가 없으면 종료한다.
                if (SS.Sheets[0].RowCount <= 0)
                {
                    return;
                }

                cf01.RPT_1_ChartInit(); cf02.RPT_1_ChartInit(); cf03.RPT_1_ChartInit();
                cf01.RPT_2_ClearData(); cf02.RPT_2_ClearData(); cf03.RPT_2_ClearData();

                cf01.ClearData(SoftwareFX.ChartFX.ClearDataFlag.AllData);
                cf02.ClearData(SoftwareFX.ChartFX.ClearDataFlag.AllData);
                cf03.ClearData(SoftwareFX.ChartFX.ClearDataFlag.AllData);

                switch(step)
                {
                    #region - QCN 발생건수 Top2 불량 현황

                    case 0:
                        // 분기별 Chart
                        cf02.AxisX.Title.Text = "[ 분기별 불량 현황 : " + cboOper.SelectedItem.ToString() + " ]";
                        cf02.AxisX.Staggered = false;
                        
                        cf02.AxisY.Gridlines = true;
                        cf02.AxisY.DataFormat.Decimals = 0;
                        
                        for (icol = 0; icol < ich_qq.Length; icol++)
                        {
                            ich_qq[icol] = icol + 1;
                            icols_qq[icol] = icol + 1;
                        }
                        // 2012-07-26-김선호 : 선택한 Row에서 아래로 2개의 Row만 Display한다.
                        for (irow = 0; irow < 2; irow++)
                        {
                            if ((iselrow + irow) >= SS.Sheets[0].RowCount)
                            {
                                break;
                            }
                            irows_qq[irow] = iselrow + irow;
                            stitle_qq[irow] = SS.Sheets[0].Cells[iselrow + irow, 0].Text;
                        }

                        cf02.Gallery = SoftwareFX.ChartFX.Gallery.Curve;
                        cf02.AxisY.DataFormat.Decimals = 0;
                        cf02.AxisX.Staggered = false;
                        cf02.PointLabels = true;
                        cf02.Series[0].PointLabelColor = Color.Blue;
                        cf02.Series[0].PointLabelAlign = SoftwareFX.ChartFX.LabelAlign.Right;
                        cf02.Series[1].PointLabelColor = Color.Green;
                        cf02.Series[1].PointLabelAlign = SoftwareFX.ChartFX.LabelAlign.Left;

                        cf02.RPT_3_OpenData(irows_qq.Length, icols_qq.Length);
                        cf02.RPT_4_AddData(SS, irows_qq, icols_qq, SeriseType.Rows);
                        cf02.RPT_5_CloseData();
                        cf02.RPT_7_SetXAsixTitleUsingSpreadHeader(SS, 0, icols_qq);
                        cf02.RPT_8_SetSeriseLegend(stitle_qq, SoftwareFX.ChartFX.Docked.Top);
                        cf02.AxisY.Max = cf02.AxisY.Max * 1.1;

                        // 월별 Chart
                        cf03.AxisX.Title.Text = "[ 전월대비 불량 현황 : " + cboOper.SelectedItem.ToString() + " ]";
                        cf03.Gallery = SoftwareFX.ChartFX.Gallery.Bar;
                        cf03.AxisY.DataFormat.Decimals = 0;
                        cf03.AxisX.Staggered = false;
                        cf03.PointLabels = true;
                        for (icol = 0; icol < ich_mm.Length; icol++)
                        {
                            ich_mm[icol] = icol + 5;
                            icols_mm[icol] = icol + 5;
                            stitle_mm[icol] = SS.Sheets[0].ColumnHeader.Cells[0, icol + 5].Text;
                        }
                        for (irow = 0; irow < 2; irow++)
                        {
                            irows_mm[irow] = iselrow + irow;
                        }
                        cf03.RPT_3_OpenData(icols_mm.Length, irows_mm.Length);
                        cf03.RPT_4_AddData(SS, irows_mm, icols_mm, SeriseType.Column);
                        cf03.RPT_5_CloseData();
                        cf03.RPT_7_SetXAsixTitleUsingSpread(SS, irows_mm, 0);
                        cf03.RPT_8_SetSeriseLegend(stitle_mm, SoftwareFX.ChartFX.Docked.Top);
                        cf03.AxisY.Max = cf03.AxisY.Max * 1.1;

                        break;

                        #endregion

                    #region - QCN 발생 현황 : Front / Back-end

                    case 1:

                        cf01.AxisX.Title.Text = "[ " + cboOper.SelectedItem.ToString() + " ]";
                        cf01.AxisX.Staggered = false;

                        cf01.AxisY.Gridlines = true;
                        cf01.AxisY.DataFormat.Decimals = 2;

                        for (icol = 0; icol < ich_qq1.Length; icol++)
                        {
                            ich_qq1[icol] = icol + 1;
                            icols_qq1[icol] = icol + 1;
                        }
                        // 2012-07-26-김선호 : 선택한 Row에서 아래로 3개의 Row만 Display한다.
                        for (irow = 0; irow < 3; irow++)
                        {
                            if ((iselrow + irow) >= SS.Sheets[0].RowCount)
                            {
                                break;
                            }
                            irows_qq1[irow] = iselrow + irow;
                            stitle_qq1[irow] = SS.Sheets[0].Cells[iselrow + irow, 0].Text;
                        }

                        cf01.Gallery = SoftwareFX.ChartFX.Gallery.Curve;
                        cf01.PointLabels = true;
                        cf01.Series[0].PointLabelColor = Color.Blue;
                        cf01.Series[0].PointLabelAlign = SoftwareFX.ChartFX.LabelAlign.Right;
                        cf01.Series[1].PointLabelColor = Color.Red;
                        cf01.Series[1].PointLabelAlign = SoftwareFX.ChartFX.LabelAlign.Left;
                        cf01.Series[1].PointLabelColor = Color.Black;
                        cf01.Series[1].PointLabelAlign = SoftwareFX.ChartFX.LabelAlign.Bottom;

                        cf01.RPT_3_OpenData(irows_qq1.Length, icols_qq1.Length);
                        cf01.RPT_4_AddData(SS, irows_qq1, icols_qq1, SeriseType.Rows);
                        cf01.RPT_5_CloseData();
                        cf01.RPT_7_SetXAsixTitleUsingSpreadHeader(SS, 0, icols_qq1);
                        cf01.RPT_8_SetSeriseLegend(stitle_qq1, SoftwareFX.ChartFX.Docked.Top);
                        cf01.AxisY.Max = cf01.AxisY.Max * 1.1;
                        //cf01.AxisY.Step = 0.5;

                        break;

                    #endregion

                    #region - QCN 발생 현황 : SEC / HYNIX

                    case 2:

                        cf01.AxisX.Title.Text = "[ " + cboOper.SelectedItem.ToString() + " ]";
                        cf01.AxisX.Staggered = false;

                        cf01.AxisY.Gridlines = true;
                        cf01.AxisY.DataFormat.Decimals = 2;

                        for (icol = 0; icol < ich_qq1.Length; icol++)
                        {
                            ich_qq1[icol] = icol + 1;
                            icols_qq1[icol] = icol + 1;
                        }

                        
                        // 2012-07-26-김선호 : 선택한 Row에서 아래로 3개의 Row만 Display한다.
                        for (int i = 0; i < 3; i++)
                        {
                            if ((iselrow + i) >= SS.Sheets[0].RowCount)
                            {
                                break;
                            }
                            irows_qq1[i] = iselrow + irow ;
                            stitle_qq1[i] = SS.Sheets[0].Cells[iselrow + irow, 0].Text;

                            irow += 3;
                        }

                        cf01.Gallery = SoftwareFX.ChartFX.Gallery.Curve;
                        cf01.PointLabels = true;
                        cf01.Series[0].PointLabelColor = Color.Blue;
                        cf01.Series[0].PointLabelAlign = SoftwareFX.ChartFX.LabelAlign.Right;
                        cf01.Series[1].PointLabelColor = Color.Red;
                        cf01.Series[1].PointLabelAlign = SoftwareFX.ChartFX.LabelAlign.Left;
                        cf01.Series[1].PointLabelColor = Color.Black;
                        cf01.Series[1].PointLabelAlign = SoftwareFX.ChartFX.LabelAlign.Bottom;

                        cf01.RPT_3_OpenData(irows_qq1.Length, icols_qq1.Length);
                        cf01.RPT_4_AddData(SS, irows_qq1, icols_qq1, SeriseType.Rows);
                        cf01.RPT_5_CloseData();
                        cf01.RPT_7_SetXAsixTitleUsingSpreadHeader(SS, 0, icols_qq1);
                        cf01.RPT_8_SetSeriseLegend(stitle_qq1, SoftwareFX.ChartFX.Docked.Top);
                        cf01.AxisY.Max = cf01.AxisY.Max * 1.1;
                        //cf01.AxisY.Step = 0.5;

                        break;

                    #endregion
                }
            }
            catch (Exception ex)
            {
                CmnFunction.ShowMsgBox(ex.Message);
                return;
            }
            finally
            {
                Cursor.Current = Cursors.Default;
            }
        }

        private void ShowChart(int rowCount)
        {
            try
            {
                Cursor.Current = Cursors.WaitCursor;
                LoadingPopUp.LoadIngPopUpShow(this);

                DataTable dt_graph = null;
                cf01.RPT_1_ChartInit(); cf02.RPT_1_ChartInit(); cf03.RPT_1_ChartInit();
                cf01.RPT_2_ClearData(); cf02.RPT_2_ClearData(); cf03.RPT_2_ClearData();

                int monthCount = 3;
                int Step = 0;
                string title = "";

                // 그래프 설정 //                      
                cf01.AxisY.Font = new System.Drawing.Font("굴림체", 8, System.Drawing.FontStyle.Regular);
                cf01.AxisX.Font = new System.Drawing.Font("굴림체", 8, System.Drawing.FontStyle.Regular);
                cf01.PointLabels = true;
                cf01.AxisY.DataFormat.Decimals = 0;
                cf01.Gallery = SoftwareFX.ChartFX.Gallery.Bar;
                cf01.AxisX.Staggered = false;

                //cf01.PointLabelColor 
                cf01.PointLabelColor = System.Drawing.Color.Black;

                // ToolBar 보여주기
                //cf01.ToolBar = true;

                // contion attribute 를 이용한 0 point label hidden
                SoftwareFX.ChartFX.ConditionalAttributes contion = cf01.ConditionalAttributes[0];
                contion.Condition.From = 0;
                contion.Condition.To = 0;
                contion.PointLabels = false;

                cf01.MultipleColors = false;

                switch (cboOper.SelectedIndex)
                {
                    case 0: // Front
                        Step = 0;
                        title = "[ Front Top 불량 현황 비교 ]";
                        break;

                    case 1: // Back-end
                        Step = 1;
                        title = "[ Back-end Top 불량 현황 비교 ]";
                        break;

                    default:
                        LoadingPopUp.LoadingPopUpHidden();
                        //Combo Box가 아닌 TextBox에 직접 입력해야 할 수도 있기 때문에 공정을 선택하는 Message이지만 공정을 입력하는 Message로 수정. 
                        CmnFunction.ShowMsgBox(RptMessages.GetMessage("STD064", GlobalVariable.gcLanguage));
                        return;
                        //break;
                }

                dt_graph = CmnFunction.oComm.GetFuncDataTable("DYNAMIC", MakeSqlString(Step));

                if (dt_graph.Rows.Count == 0)
                {
                    dt_graph.Dispose();
                    LoadingPopUp.LoadingPopUpHidden();
                    CmnFunction.ShowMsgBox(RptMessages.GetMessage("STD010", GlobalVariable.gcLanguage));
                }
                else
                {
                    // DB에서 얻어온 컬럼헤더 이름을 변경 시킨다.
                    for (int iCol = 1; iCol < dt_graph.Columns.Count; iCol++)
                    {
                        dt_graph.Columns[iCol].ColumnName = System.DateTime.Now.AddMonths(-monthCount).Month.ToString() + "월";
                        monthCount--;
                    }

                    dt_graph.Columns.RemoveAt(5);

                    cf01.DataSource = dt_graph;

                    cf01.SerLegBox = true;
                    cf01.AxisY.Max = cf01.AxisY.Max * 1.1;
                    cf01.SerLegBoxObj.Docked = SoftwareFX.ChartFX.Docked.Top;

                    cf01.AxisX.Title.Text = title;
                    cf01.AxisX.Title.Alignment = StringAlignment.Center;
                    cf01.AxisY.Title.Text = "(Count)";
                    cf01.AxisY.Title.Alignment = StringAlignment.Far;
                }
            }
            catch (Exception ex)
            {
                LoadingPopUp.LoadingPopUpHidden();
                MessageBox.Show(ex.Message);
                return;
            }
            finally
            {
                LoadingPopUp.LoadingPopUpHidden();
                Cursor.Current = Cursors.Default;
            }
        }

        #region Chart 생성을 위한 쿼리

        private string MakeSqlString(int Step)
        {
            string QRY = "";

            string fromOper = "";
            string toOper = "";

            string date = cdvDate.Value.ToString("yyyyMMddHHmmss");

            switch (Step)
            {
                case 0:
                    {
                        fromOper = "A0000";
                        toOper = "A0970";
                    }
                    break;

                case 1:
                    {
                        fromOper = "A1000";
                        toOper = "AZ010";
                    }
                    break;
            }

            QRY = "	SELECT *	\n"
                + "	FROM	\n"
                + "	(	\n"
                + "	    SELECT DEFECT, QTY_MM_1, QTY_MM_2, QTY_MM_3, QTY_MM_4	\n"
                + "	        ,SUM(QTY_MM_1 + QTY_MM_2 + QTY_MM_3 + QTY_MM_4) AS TOTAL	\n"
                + "	    FROM	\n"
                + "	    (	\n"
                + "	        SELECT DESC_1 AS DEFECT	\n"
                + "	            , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                + "	                                AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                + "	                             THEN 1	\n"
                + "	                             ELSE 0	\n"
                + "	                    END) AS QTY_MM_1	\n"
                + "	            , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                + "	                             THEN 1	\n"
                + "	                             ELSE 0	\n"
                + "	                    END) AS QTY_MM_2	\n"
                + "	            , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                + "	                                AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                + "	                             THEN 1	\n"
                + "	                             ELSE 0	\n"
                + "	            END) AS QTY_MM_3	\n"
                + "	            , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                + "	                            AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0)), 'YYYYMMDD')||'220000'	\n"
                + "	                             THEN 1	\n"
                + "	                             ELSE 0	\n"
                + "	                    END) AS QTY_MM_4	\n"
                + "	        FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n"
                + "	        WHERE 1=1	\n"
                + "	        AND STS.FACTORY = DEF.FACTORY	\n"
                + "	        AND STS.FACTORY = '" + cdvFactory.Text + "'	\n"
                + "	        AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n"
                + "	        AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                + "	        AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                + "	        AND STS.OPER_1 >= '" + fromOper + "'	\n"
                + "	        AND STS.OPER_1 <= '" + toOper + "'	\n"
                + "	        AND CLOSE_FLAG IN ( ' ', 'Y')	\n"
                + "	        AND ABR_NO LIKE 'QCN%'	\n"
                + "	        AND STS.DEL_FLAG = ' '	\n"
                + "	        GROUP BY DEF.DESC_1	\n"
                + "	    )GROUP BY DEFECT, QTY_MM_1, QTY_MM_2, QTY_MM_3, QTY_MM_4	\n"
                + "	    ORDER BY TOTAL DESC	\n"
                + "	    )	\n"
                + "	WHERE ROWNUM <= 7	\n";

            if (GlobalVariable.gsUserGroup == "ADMIN_GROUP" || GlobalVariable.gsUserGroup == "HANA_ADMIN_GROUP")
            {
                System.Windows.Forms.Clipboard.SetText(QRY);
            }

            return QRY.Replace((char)Keys.Tab, ' ');
        }

        #endregion

        #endregion


        #region " Form Event "

        private void btnView_Click(object sender, EventArgs e)
        {
            /****************************************************
             * Comment : View Button을 클릭하면
             * 
             * Created By : 김선호(2012-07-26-목요일)
             * 
             * Modified By : 
             ****************************************************/
            try
            {
                Cursor.Current = Cursors.WaitCursor;

                //fnSSInitial(spdData);

                this.Refresh();

                switch (cboGraph.SelectedIndex)
                {
                    case 0:
                        fnDataFind1();
                        break;

                    case 1:
                        ShowChart(0);
                        break;

                    case 2:
                        fnDataFind();
                        break;
                }
            }
            catch (Exception ex)
            {
                CmnFunction.ShowMsgBox(ex.Message);
                return;
            }
            finally
            {
                Cursor.Current = Cursors.Default;
            }
        }

        private void btnExcelExport_Click(object sender, EventArgs e)
        {
            /****************************************************
             * Comment : Excel Export Button을 클릭하면
             * 
             * Created By : 김선호(2012-07-26-목요일)
             * 
             * Modified By :
             ****************************************************/
            try
            {
                Cursor.Current = Cursors.WaitCursor;

                spdData.ExportExcel();
            }
            catch (Exception ex)
            {
                CmnFunction.ShowMsgBox(ex.Message);
                return;
            }
            finally
            {
                Cursor.Current = Cursors.Default;
            }
        }

        private void cboGraph_SelectedIndexChanged(object sender, EventArgs e)
        {
            cboOper.Items.Clear();
            isGraphChange = true;
            switch (cboGraph.SelectedIndex)
            {
                case 0:
                    pnlTrend.Visible = true;
                    pnlList.Visible = false;
                    cboOper.Text = "CHART";
                    cboOper.Items.Add("QCN 발생 현황 : Front/Back-end");
                    cboOper.Items.Add("QCN 발생 현황 : SEC/HYNIX");
                    spdData.Visible = true;
                    splitContainer1.SplitterDistance = 350;
                    break;

                case 1:
                    pnlTrend.Visible = true;
                    pnlList.Visible = false;
                    cboOper.Text = "OPER";
                    cboOper.Items.Add("Front");
                    cboOper.Items.Add("Back-end");
                    spdData.Visible = false;
                    splitContainer1.SplitterDistance = 500;
                    break;

                case 2:
                    pnlTrend.Visible = false;
                    pnlList.Visible = true;
                    cboOper.Text = "OPER";
                    cboOper.Items.Add("Front");
                    cboOper.Items.Add("Back-end");
                    spdData.Visible = true;
                    splitContainer1.SplitterDistance = 450;
                    break;
            }

            cboOper.SelectedIndex = 0;
        }

        #endregion

    }
}
