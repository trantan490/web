using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Drawing;
using System.Data;
using System.Text;
using System.Windows.Forms;

using Miracom.UI;
using Miracom.SmartWeb;
using Miracom.SmartWeb.UI;
using Miracom.SmartWeb.FWX;
using Miracom.SmartWeb.UI.Controls;

namespace Hana.PQC
{
    public partial class PQC031204 : Miracom.SmartWeb.UI.Controls.udcCUSReport002
    {
        #region " PQC031204 : Program Initial "

        public PQC031204()
        {
            InitializeComponent();

            this.SetFactory(GlobalVariable.gsAssyDefaultFactory);
            cdvFactory.Text = GlobalVariable.gsAssyDefaultFactory;

            cdvDate.Value = System.DateTime.Now;

            cboGraph.SelectedIndex = 0;
        }

        #endregion


        #region " Common Function "

        private void fnSSInitial(Miracom.SmartWeb.UI.Controls.udcFarPoint SS)
        {
            /****************************************************
             * Comment : SS의 Header를 설정한다.
             * 
             * Created By : 김선호(2012-08-10-금)
             * 
             * Modified By : 
             ****************************************************/
            //월
            string squery = "";
            DataTable dt = null;
            //주차
            string squery2 = "";
            DataTable dtWeek = null;
            // 목요일 가져오기
            string squery3 = "";
            DataTable dtThu = null;
            //일가져오기
            string squery4 = "";
            DataTable dtDay = null;
            // 분기
            string squery5 = "";
            DataTable dtQuarter = null;

            int iindex = 0;
            try
            {
                Cursor.Current = Cursors.WaitCursor;

                SS.RPT_ColumnInit();

                string todate = cdvDate.Value.ToString("yyyyMMddHHmmss");

                squery5 = "SELECT CASE WHEN TO_CHAR(TO_DATE('" + todate + "'), 'Q') - 3 > 0 \n"
                        + "            THEN SUBSTR(TO_CHAR(TO_DATE('" + todate + "'),'YYYY'),3,2) || 'Y ' || TO_CHAR(TO_CHAR(TO_DATE('" + todate + "'), 'Q') - 3) || 'Q' \n"
                        + "            WHEN TO_CHAR(TO_DATE('" + todate + "'), 'Q') - 3 = 0 \n"
                        + "            THEN SUBSTR(TO_CHAR(TO_DATE('" + todate + "'),'YYYY'),3,2) - 1 || 'Y ' || '4' || 'Q' \n"
                        + "            WHEN TO_CHAR(TO_DATE('" + todate + "'), 'Q') - 3 = -1 \n"
                        + "            THEN SUBSTR(TO_CHAR(TO_DATE('" + todate + "'),'YYYY'),3,2) - 1 || 'Y ' || '3' || 'Q' \n"
                        + "            WHEN TO_CHAR(TO_DATE('" + todate + "'), 'Q') - 3 = -2 \n"
                        + "            THEN SUBSTR(TO_CHAR(TO_DATE('" + todate + "'),'YYYY'),3,2) - 1 || 'Y ' || '2' || 'Q' \n"
                        + "       END AS Q4, \n"
                        + "       CASE WHEN TO_CHAR(TO_DATE('" + todate + "'), 'Q') - 2 > 0 \n"
                        + "            THEN SUBSTR(TO_CHAR(TO_DATE('" + todate + "'),'YYYY'),3,2) || 'Y ' || TO_CHAR(TO_CHAR(TO_DATE('" + todate + "'), 'Q') - 2)|| 'Q' \n"
                        + "            WHEN TO_CHAR(TO_DATE('" + todate + "'), 'Q') - 2 = 0 \n"
                        + "            THEN SUBSTR(TO_CHAR(TO_DATE('" + todate + "'),'YYYY'),3,2) - 1 || 'Y ' || '4' || 'Q' \n"
                        + "            WHEN TO_CHAR(TO_DATE('" + todate + "'), 'Q') - 2 = -1 \n"
                        + "            THEN SUBSTR(TO_CHAR(TO_DATE('" + todate + "'),'YYYY'),3,2) - 1 || 'Y ' || '3' || 'Q' \n"
                        + "       END AS Q3, \n"
                        + "       CASE WHEN TO_CHAR(TO_DATE('" + todate + "'), 'Q') - 1 > 0 \n"
                        + "            THEN SUBSTR(TO_CHAR(TO_DATE('" + todate + "'),'YYYY'),3,2) || 'Y ' || TO_CHAR(TO_CHAR(TO_DATE('" + todate + "'), 'Q') - 1)|| 'Q' \n"
                        + "            WHEN TO_CHAR(TO_DATE('" + todate + "'), 'Q') - 1 = 0 \n"
                        + "            THEN SUBSTR(TO_CHAR(TO_DATE('" + todate + "'),'YYYY'),3,2) - 1 || 'Y ' || '4' || 'Q' \n"
                        + "            END AS Q2, \n"
                        + "            SUBSTR(TO_CHAR(TO_DATE('" + todate + "'),'YYYY'),3,2) || 'Y ' || TO_CHAR(TO_DATE('" + todate + "'), 'Q') || 'Q' AS Q1 \n"
                        + "  FROM DUAL";

                dtQuarter = CmnFunction.oComm.GetFuncDataTable("DYNAMIC", squery5.Replace((char)Keys.Tab, ' '));

                switch (cboGraph.SelectedIndex)
                {
                    #region - CCN Total/월별 Trend

                    case 0:

                        squery = "SELECT SUBSTR(TO_CHAR(TO_DATE('" + todate + "'),'YYYYMM'),5,2)||'월' AS MM4 \n"
                               + "	   , SUBSTR(TO_CHAR(ADD_MONTHS(TO_DATE('" + todate + "'),-1),'YYYYMM'),5,2)||'월' AS MM3 \n"
                               + "	   , SUBSTR(TO_CHAR(ADD_MONTHS(TO_DATE('" + todate + "'),-2),'YYYYMM'),5,2)||'월' AS MM2 \n"
                               + "	   , SUBSTR(TO_CHAR(ADD_MONTHS(TO_DATE('" + todate + "'),-3),'YYYYMM'),5,2)||'월' AS MM1 \n"
                               + "  FROM DUAL";

                        dt = CmnFunction.oComm.GetFuncDataTable("DYNAMIC", squery.Replace((char)Keys.Tab, ' '));

                        todate = cdvDate.Value.ToString("yyyyMMdd");

                        squery2 = "SELECT DECODE(PLAN_WEEK - 3,-2,51,-1,52, 0,53, PLAN_WEEK - 3)||'주' AS WW1 \n"
                               + "      , DECODE(PLAN_WEEK - 2,-1,52, 0,53, PLAN_WEEK - 2)||'주' AS WW2 \n"
                               + "	    , DECODE(PLAN_WEEK - 1, 0,53, PLAN_WEEK - 1)||'주' AS WW3 \n"
                               + "	    , PLAN_WEEK||'주' AS WW4 \n"
                               + "	 FROM MWIPCALDEF \n"
                               + "	WHERE CALENDAR_ID = 'QC' \n"
                               + "	  AND SYS_DATE = TO_CHAR(TO_DATE('" + todate + "','YYYYMMDD'),'YYYYMMDD')";

                        dtWeek = CmnFunction.oComm.GetFuncDataTable("DYNAMIC", squery2.Replace((char)Keys.Tab, ' '));

                        squery3 = "SELECT CASE TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD') + 6, 'YYYYMMDD') \n"
                               + "        WHEN '토' THEN TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD') + 5, 'YYYYMMDD') \n"
                               + "        WHEN '일' THEN TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD') + 4, 'YYYYMMDD') \n"
                               + "        WHEN '월' THEN TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD') + 3, 'YYYYMMDD') \n"
                               + "        WHEN '화' THEN TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD') + 2, 'YYYYMMDD') \n"
                               + "        WHEN '수' THEN TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD') + 1, 'YYYYMMDD') \n"
                               + "        WHEN '목' THEN TO_CHAR(TO_DATE('" + todate + "', 'YYYYMMDD') + 0, 'YYYYMMDD') \n"
                               + "        END AS DAY \n"
                               + "	 FROM DUAL";

                        dtThu = CmnFunction.oComm.GetFuncDataTable("DYNAMIC", squery3.Replace((char)Keys.Tab, ' '));

                        squery4 = "SELECT SUBSTR(TO_CHAR(TO_DATE('" + dtThu.Rows[0][0] + "'),'YYYYMMDD'),7,2)||'일(목)' AS DD \n"
                               + "      , SUBSTR(TO_CHAR(TO_DATE('" + dtThu.Rows[0][0] + "')-1,'YYYYMMDD'),7,2)||'일(수)' AS DD1 \n"
                               + "      , SUBSTR(TO_CHAR(TO_DATE('" + dtThu.Rows[0][0] + "')-2,'YYYYMMDD'),7,2)||'일(화)' AS DD2 \n"
                               + "      , SUBSTR(TO_CHAR(TO_DATE('" + dtThu.Rows[0][0] + "')-3,'YYYYMMDD'),7,2)||'일(월)' AS DD3 \n"
                               + "      , SUBSTR(TO_CHAR(TO_DATE('" + dtThu.Rows[0][0] + "')-4,'YYYYMMDD'),7,2)||'일(일)' AS DD4 \n"
                               + "      , SUBSTR(TO_CHAR(TO_DATE('" + dtThu.Rows[0][0] + "')-5,'YYYYMMDD'),7,2)||'일(토)' AS DD5 \n"
                               + "      , SUBSTR(TO_CHAR(TO_DATE('" + dtThu.Rows[0][0] + "')-6,'YYYYMMDD'),7,2)||'일(금)' AS DD6 \n"
                               + "	 FROM DUAL";
                        dtDay = CmnFunction.oComm.GetFuncDataTable("DYNAMIC", squery4.Replace((char)Keys.Tab, ' '));

                        break;

                    #endregion

                    #region - CCN 발생건수 불량현황 : Front/Back-end, CCN 발생 공정현황

                    case 1:
                    case 2:

                        squery = "SELECT SUBSTR(TO_CHAR(TO_DATE('" + todate + "'),'YYYYMM'),5,2)||'월' AS MM6 \n"
                               + "	   , SUBSTR(TO_CHAR(ADD_MONTHS(TO_DATE('" + todate + "'),-1),'YYYYMM'),5,2)||'월' AS MM5 \n"
                               + "	   , SUBSTR(TO_CHAR(ADD_MONTHS(TO_DATE('" + todate + "'),-2),'YYYYMM'),5,2)||'월' AS MM4 \n"
                               + "	   , SUBSTR(TO_CHAR(ADD_MONTHS(TO_DATE('" + todate + "'),-3),'YYYYMM'),5,2)||'월' AS MM3 \n"
                               + "	   , SUBSTR(TO_CHAR(ADD_MONTHS(TO_DATE('" + todate + "'),-4),'YYYYMM'),5,2)||'월' AS MM2 \n"
                               + "	   , SUBSTR(TO_CHAR(ADD_MONTHS(TO_DATE('" + todate + "'),-5),'YYYYMM'),5,2)||'월' AS MM1 \n"
                               + "  FROM DUAL";

                        dt = CmnFunction.oComm.GetFuncDataTable("DYNAMIC", squery.Replace((char)Keys.Tab, ' '));

                        break;

                    #endregion
                }
                
                SS.RPT_AddBasicColumn("구 분", 0, iindex, Visibles.True, Frozen.False, Align.Center, Merge.True, Formatter.String, 100);
                //SS.RPT_AddBasicColumn("CUSTOMER", 0, iindex + 1, Visibles.True, Frozen.False, Align.Center, Merge.True, Formatter.String, 100);

                switch (cboGraph.SelectedIndex)
                {
                    #region - CCN Total/월별 Trend

                    case 0:

                        if (dtQuarter.Rows.Count <= 0)
                        {
                            dtQuarter.Dispose();
                            SS.RPT_AddBasicColumn("Q-1", 0, iindex + 1, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn("Q-2", 0, iindex + 2, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn("Q-3", 0, iindex + 3, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn("Q-4", 0, iindex + 4, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                        }
                        else
                        {
                            SS.RPT_AddBasicColumn(dtQuarter.Rows[0][0].ToString(), 0, iindex + 1, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn(dtQuarter.Rows[0][1].ToString(), 0, iindex + 2, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn(dtQuarter.Rows[0][2].ToString(), 0, iindex + 3, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn(dtQuarter.Rows[0][3].ToString(), 0, iindex + 4, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                        }

                        if (dt.Rows.Count <= 0)
                        {
                            dt.Dispose();
                            SS.RPT_AddBasicColumn("MM-1", 0, iindex + 5, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn("MM-2", 0, iindex + 6, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn("MM-3", 0, iindex + 7, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn("MM-4", 0, iindex + 8, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                        }
                        else
                        {
                            SS.RPT_AddBasicColumn(dt.Rows[0][3].ToString(), 0, iindex + 5, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn(dt.Rows[0][2].ToString(), 0, iindex + 6, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn(dt.Rows[0][1].ToString(), 0, iindex + 7, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn(dt.Rows[0][0].ToString(), 0, iindex + 8, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                        }

                        if (dtWeek.Rows.Count <= 0)
                        {
                            dtWeek.Dispose();
                            SS.RPT_AddBasicColumn("WW-4", 0, iindex + 9, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn("WW-3", 0, iindex + 10, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn("WW-2", 0, iindex + 11, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn("WW-1", 0, iindex + 12, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                        }
                        else
                        {
                            SS.RPT_AddBasicColumn(dtWeek.Rows[0][0].ToString(), 0, iindex + 9, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn(dtWeek.Rows[0][1].ToString(), 0, iindex + 10, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn(dtWeek.Rows[0][2].ToString(), 0, iindex + 11, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn(dtWeek.Rows[0][3].ToString(), 0, iindex + 12, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                        }

                        if (dtDay.Rows.Count <= 0)
                        {
                            dtDay.Dispose();
                            SS.RPT_AddBasicColumn("금(-6)", 0, iindex + 13, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn("토(-5)", 0, iindex + 14, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn("일(-4)", 0, iindex + 15, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn("월(-3)", 0, iindex + 16, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn("화(-2)", 0, iindex + 17, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn("수(-1)", 0, iindex + 18, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn("목(-0)", 0, iindex + 19, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                        }
                        else
                        {

                            SS.RPT_AddBasicColumn(dtDay.Rows[0][6].ToString(), 0, iindex + 13, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn(dtDay.Rows[0][5].ToString(), 0, iindex + 14, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn(dtDay.Rows[0][4].ToString(), 0, iindex + 15, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn(dtDay.Rows[0][3].ToString(), 0, iindex + 16, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn(dtDay.Rows[0][2].ToString(), 0, iindex + 17, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn(dtDay.Rows[0][1].ToString(), 0, iindex + 18, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                            SS.RPT_AddBasicColumn(dtDay.Rows[0][0].ToString(), 0, iindex + 19, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Double2, 80);
                        }

                        break;

                    #endregion

                    #region - CCN 발생건수 불량현황 : Front/Back-end, CCN 발생 공정현황

                    case 1:
                    case 2:

                        if (dtQuarter.Rows.Count <= 0)
                        {
                            dtQuarter.Dispose();
                            SS.RPT_AddBasicColumn("Q-1", 0, iindex + 1, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                            SS.RPT_AddBasicColumn("Q-2", 0, iindex + 2, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                            SS.RPT_AddBasicColumn("Q-3", 0, iindex + 3, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                            SS.RPT_AddBasicColumn("Q-4", 0, iindex + 4, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                        }
                        else
                        {
                            SS.RPT_AddBasicColumn(dtQuarter.Rows[0][0].ToString(), 0, iindex + 1, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                            SS.RPT_AddBasicColumn(dtQuarter.Rows[0][1].ToString(), 0, iindex + 2, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                            SS.RPT_AddBasicColumn(dtQuarter.Rows[0][2].ToString(), 0, iindex + 3, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                            SS.RPT_AddBasicColumn(dtQuarter.Rows[0][3].ToString(), 0, iindex + 4, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                        }

                        if (dt.Rows.Count <= 0)
                        {
                            dt.Dispose();
                            SS.RPT_AddBasicColumn("MM-1", 0, iindex + 5, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                            SS.RPT_AddBasicColumn("MM-2", 0, iindex + 6, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                            SS.RPT_AddBasicColumn("MM-3", 0, iindex + 7, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                            SS.RPT_AddBasicColumn("MM-4", 0, iindex + 8, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                            SS.RPT_AddBasicColumn("MM-5", 0, iindex + 9, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                            SS.RPT_AddBasicColumn("MM-6", 0, iindex + 10, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                        }
                        else
                        {
                            SS.RPT_AddBasicColumn(dt.Rows[0][5].ToString(), 0, iindex + 5, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                            SS.RPT_AddBasicColumn(dt.Rows[0][4].ToString(), 0, iindex + 6, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                            SS.RPT_AddBasicColumn(dt.Rows[0][3].ToString(), 0, iindex + 7, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                            SS.RPT_AddBasicColumn(dt.Rows[0][2].ToString(), 0, iindex + 8, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                            SS.RPT_AddBasicColumn(dt.Rows[0][1].ToString(), 0, iindex + 9, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                            SS.RPT_AddBasicColumn(dt.Rows[0][0].ToString(), 0, iindex + 10, Visibles.True, Frozen.False, Align.Right, Merge.False, Formatter.Number, 80);
                        }
                        break;

                    #endregion
                }
            }
            catch (Exception ex)
            {
                CmnFunction.ShowMsgBox(ex.Message);
                return;
            }
            finally
            {
                Cursor.Current = Cursors.Default;
            }
        }

        private bool fnDataFind()
        {
            /****************************************************
             * Comment : DataBase에 저장된 데이터를 조회한다.
             * 
             * Created By : 김선호(2012-08-10-금)
             * 
             * Modified By :
             ****************************************************/
            DataTable dt = null;
            string QRY = "";

            try
            {
                Cursor.Current = Cursors.WaitCursor;
                LoadingPopUp.LoadIngPopUpShow(this);

                // Sheet / Listview를 초기화 한다.
                CmnInitFunction.ClearList(spdData, true);

                switch (cboGraph.SelectedIndex)
                {
                    // CCN Total/월별 Trend
                    case 0: 
                        QRY = MakeSqlString();
                        break;

                    // CCN 발생건수 불량 현황(Front / Back-end)
                    case 1:
                        QRY = MakeSqlString1();
                        break;

                    // CCN 발생공정
                    case 2:
                        QRY = MakeSqlString2();
                        break;
                }

                if (GlobalVariable.gsUserGroup == "ADMIN_GROUP" || GlobalVariable.gsUserGroup == "HANA_ADMIN_GROUP")
                {
                    System.Windows.Forms.Clipboard.SetText(QRY);
                }

                dt = CmnFunction.oComm.GetFuncDataTable("DYNAMIC", QRY);

                if (dt.Rows.Count == 0)
                {
                    dt.Dispose();
                    LoadingPopUp.LoadingPopUpHidden();
                    CmnFunction.ShowMsgBox(RptMessages.GetMessage("STD010", GlobalVariable.gcLanguage));
                    return false;
                }

                spdData.DataSource = dt;
                spdData.RPT_AutoFit(false);

                for (int irow = 0; irow < spdData_Sheet1.RowCount; irow++)
                {
                    // CCN 발생건수 불량 현황 Top 7에 폰트 컬러를 다르게 표시한다.
                    if (cboGraph.SelectedIndex == 1)
                    {
                        if (irow < 7)
                        {
                            spdData_Sheet1.Rows[irow].ForeColor = Color.Tomato;
                        }
                    }

                    // CCN Total/월별 Trend에서 LRR Row의 폰트 컬러를 다르게 표시한다.
                    if (spdData_Sheet1.Cells[irow, 0].Text.Contains("LRR"))
                    {
                        spdData_Sheet1.Rows[irow].ForeColor = Color.SteelBlue;
                    }

                    // 총계 Row의 바탕색을 다르게 표시한다.
                    if (spdData_Sheet1.Cells[irow, 0].Text.Contains("총계"))
                    {
                        spdData_Sheet1.Rows[irow].BackColor = Color.Yellow;
                    }
                }

                fnMakeChart(spdData, 0);

                return true;
            }
            catch (Exception ex)
            {
                LoadingPopUp.LoadingPopUpHidden();
                MessageBox.Show(ex.Message);
                return false;
            }
            finally
            {
                LoadingPopUp.LoadingPopUpHidden();
                Cursor.Current = Cursors.Default;
            }
        }

        private string MakeSqlString()
        {
            /****************************************************
             * Comment : DataBase에 저장된 데이터를 조회한다.(CCN Total/월별 Trend)
             * 
             * Created By : 김선호(2012-08-10-금)
             * 
             * Modified By :
             ****************************************************/

            string QRY = "";

            string date = cdvDate.Value.ToString("yyyyMMddHHmmss");

            QRY = "	SELECT GUBUN	\n"
                + "	    , SUM(QTY_QQ_1) AS QTY_QQ_1, SUM(QTY_QQ_2) AS QTY_QQ_2, SUM(QTY_QQ_3) AS QTY_QQ_3, SUM(QTY_QQ_4) AS QTY_QQ_4	\n"
                + "	    , SUM(QTY_MM_1) AS QTY_MM_1, SUM(QTY_MM_2) AS QTY_MM_2, SUM(QTY_MM_3) AS QTY_MM_3, SUM(QTY_MM_4) AS QTY_MM_4	\n"
                + "	    , SUM(QTY_WW_1) AS QTY_WW_1, SUM(QTY_WW_2) AS QTY_WW_2, SUM(QTY_WW_3) AS QTY_WW_3, SUM(QTY_WW_4) AS QTY_WW_4	\n"
                + "	    , SUM(QTY_DD_1) AS QTY_DD_1, SUM(QTY_DD_2) AS QTY_DD_2, SUM(QTY_DD_3) AS QTY_DD_3, SUM(QTY_DD_4) AS QTY_DD_4	\n"
                + "	    , SUM(QTY_DD_5) AS QTY_DD_5, SUM(QTY_DD_6) AS QTY_DD_6, SUM(QTY_DD_7) AS QTY_DD_7	\n"
                + "	FROM (	\n"
                + "	SELECT '검사LOT수' AS GUBUN	\n"
                + "	    , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n"
                + "	                                    AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n"
                + "	                            THEN A.QC_LOT_QTY_1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10'	\n"
                + "	                                    AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM')	\n"
                + "	                            THEN A.QC_LOT_QTY_1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07'	\n"
                + "	                                    AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07', 'YYYYMM'),2), 'YYYYMM')	\n"
                + "	                            THEN A.QC_LOT_QTY_1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'04'	\n"
                + "	                                    AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'04', 'YYYYMM'),2), 'YYYYMM')	\n"
                + "	                            THEN A.QC_LOT_QTY_1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_1	\n"
                + "	    , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04'	\n"
                + "	                                    AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM')	\n"
                + "	                            THEN A.QC_LOT_QTY_1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n"
                + "	                                    AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n"
                + "	                            THEN A.QC_LOT_QTY_1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10'	\n"
                + "	                                    AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM')	\n"
                + "	                            THEN A.QC_LOT_QTY_1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07'	\n"
                + "	                                    AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07', 'YYYYMM'),2), 'YYYYMM')	\n"
                + "	                            THEN A.QC_LOT_QTY_1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_2	\n"
                + "	    , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07'	\n"
                + "	                                    AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07', 'YYYYMM'),2), 'YYYYMM')	\n"
                + "	                            THEN A.QC_LOT_QTY_1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04'	\n"
                + "	                                    AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM')	\n"
                + "	                            THEN A.QC_LOT_QTY_1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n"
                + "	                                    AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n"
                + "	                            THEN A.QC_LOT_QTY_1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10'	\n"
                + "	                                    AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM')	\n"
                + "	                            THEN A.QC_LOT_QTY_1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_3	\n"
                + "	    , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'10'	\n"
                + "	                                    AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'10', 'YYYYMM'),2), 'YYYYMM')	\n"
                + "	                            THEN A.QC_LOT_QTY_1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07'	\n"
                + "	                                    AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07', 'YYYYMM'),2), 'YYYYMM')	\n"
                + "	                            THEN A.QC_LOT_QTY_1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04'	\n"
                + "	                                    AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM')	\n"
                + "	                            THEN A.QC_LOT_QTY_1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n"
                + "	                                    AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n"
                + "	                            THEN A.QC_LOT_QTY_1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_4	\n"
                + "	    , 0 AS QTY_MM_1  	\n"
                + "	    , 0 AS QTY_MM_2  	\n"
                + "	    , 0 AS QTY_MM_3  	\n"
                + "	    , 0 AS QTY_MM_4	\n"
                + "	    , 0 AS QTY_WW_1 	\n"
                + "	    , 0 AS QTY_WW_2 	\n"
                + "	    , 0 AS QTY_WW_3 	\n"
                + "	    , 0 AS QTY_WW_4 	\n"
                + "	    , 0 AS QTY_DD_1 	\n"
                + "	    , 0 AS QTY_DD_2 	\n"
                + "	    , 0 AS QTY_DD_3 	\n"
                + "	    , 0 AS QTY_DD_4 	\n"
                + "	    , 0 AS QTY_DD_5 	\n"
                + "	    , 0 AS QTY_DD_6 	\n"
                + "	    , 0 AS QTY_DD_7	\n"
                + "	FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n"
                + "	WHERE A.FACTORY = B.FACTORY  	\n"
                + "	AND A.MAT_ID = B.MAT_ID  	\n"
                + "	AND A.FACTORY = '" + cdvFactory.Text + "' 	\n"
                + "	AND A.WORK_MONTH >= TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -11), 'YYYYMM') 	\n"
                + "	AND A.WORK_MONTH <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMM')	\n"
                + "	AND A.QC_TYPE LIKE 'CCS(변경점)' || '%'	\n"
                + "	AND B.MAT_GRP_1 LIKE '%'	\n"
                + "	UNION ALL	\n"
                + "	SELECT '검사LOT수' AS GUBUN	\n"
                + "	    , 0 AS QTY_QQ_1  	\n"
                + "	    , 0 AS QTY_QQ_2  	\n"
                + "	    , 0 AS QTY_QQ_3  	\n"
                + "	    , 0 AS QTY_QQ_4 	\n"
                + "	    , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_MM_1 	\n"
                + "	    , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_MM_2 	\n"
                + "	    , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_MM_3	\n"
                + "	    , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_MM_4	\n"
                + "	    , 0 AS QTY_WW_1 	\n"
                + "	    , 0 AS QTY_WW_2 	\n"
                + "	    , 0 AS QTY_WW_3 	\n"
                + "	    , 0 AS QTY_WW_4 	\n"
                + "	    , 0 AS QTY_DD_1 	\n"
                + "	    , 0 AS QTY_DD_2 	\n"
                + "	    , 0 AS QTY_DD_3 	\n"
                + "	    , 0 AS QTY_DD_4 	\n"
                + "	    , 0 AS QTY_DD_5 	\n"
                + "	    , 0 AS QTY_DD_6 	\n"
                + "	    , 0 AS QTY_DD_7 	\n"
                + "	FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B	\n"
                + "	WHERE A.FACTORY = B.FACTORY	\n"
                + "	AND A.MAT_ID = B.MAT_ID	\n"
                + "	AND A.FACTORY = '" + cdvFactory.Text + "'	\n"
                + "	AND A.WORK_MONTH >= TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3), 'YYYYMM')	\n"
                + "	AND A.WORK_MONTH <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMM')	\n"
                + "	AND A.QC_TYPE LIKE 'CCS(변경점)' || '%'  	\n"
                + "	AND B.MAT_GRP_1 LIKE '%'	\n"
                + "	UNION ALL 	\n"
                + "	SELECT '검사LOT수' AS GUBUN	\n"
                + "	    , 0 AS QTY_QQ_1  	\n"
                + "	    , 0 AS QTY_QQ_2  	\n"
                + "	    , 0 AS QTY_QQ_3  	\n"
                + "	    , 0 AS QTY_QQ_4	\n"
                + "	    , 0 AS QTY_MM_1  	\n"
                + "	    , 0 AS QTY_MM_2  	\n"
                + "	    , 0 AS QTY_MM_3  	\n"
                + "	    , 0 AS QTY_MM_4 	\n"
                + "	    , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD') 	\n"
                + "	                                   END                                                 	\n"
                + "	                AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')	\n"
                + "	                                                               WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')	\n"
                + "	                                                               WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD') 	\n"
                + "	                                   END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_WW_1 	\n"
                + "	    , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD') 	\n"
                + "	                                   END                                                 	\n"
                + "	                AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')  	\n"
                + "	                                                               WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')  	\n"
                + "	                                                               WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD') 	\n"
                + "	                                   END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_WW_2 	\n"
                + "	    , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')	\n"
                + "	                                                               WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD') 	\n"
                + "	                                   END                                                 	\n"
                + "	                AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD') 	\n"
                + "	                                   END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_WW_3 	\n"
                + "	    , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 0, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD') 	\n"
                + "	                                   END 	\n"
                + "	                AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 6, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 5, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 4, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 3, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 2, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 1, 'YYYYMMDD') 	\n"
                + "	                                                               WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 0, 'YYYYMMDD') 	\n"
                + "	                                   END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_WW_4	\n"
                + "	    , 0 AS QTY_DD_1 	\n"
                + "	    , 0 AS QTY_DD_2 	\n"
                + "	    , 0 AS QTY_DD_3 	\n"
                + "	    , 0 AS QTY_DD_4 	\n"
                + "	    , 0 AS QTY_DD_5 	\n"
                + "	    , 0 AS QTY_DD_6 	\n"
                + "	    , 0 AS QTY_DD_7 	\n"
                + "	FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n"
                + "	WHERE A.FACTORY = B.FACTORY  	\n"
                + "	AND A.MAT_ID = B.MAT_ID  	\n"
                + "	AND A.FACTORY = '" + cdvFactory.Text + "' 	\n"
                + "	AND A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD') 	\n"
                + "	                                               WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD') 	\n"
                + "	                                               WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD') 	\n"
                + "	                                               WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD') 	\n"
                + "	                                               WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD') 	\n"
                + "	                                               WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD') 	\n"
                + "	                                               WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD') 	\n"
                + "	                                       END 	\n"
                + "	AND A.WORK_DATE <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD') 	\n"
                + "	AND A.QC_TYPE LIKE 'CCS(변경점)' || '%'	\n"
                + "	AND B.MAT_GRP_1 LIKE '%'	\n"
                + "	UNION ALL	\n"
                + "	SELECT '검사LOT수' AS GUBUN 	\n"
                + "	    , 0 AS QTY_QQ_1  	\n"
                + "	    , 0 AS QTY_QQ_2  	\n"
                + "	    , 0 AS QTY_QQ_3  	\n"
                + "	    , 0 AS QTY_QQ_4 	\n"
                + "	    , 0 AS QTY_MM_1  	\n"
                + "	    , 0 AS QTY_MM_2  	\n"
                + "	    , 0 AS QTY_MM_3  	\n"
                + "	    , 0 AS QTY_MM_4	\n"
                + "	    , 0 AS QTY_WW_1 	\n"
                + "	    , 0 AS QTY_WW_2 	\n"
                + "	    , 0 AS QTY_WW_3 	\n"
                + "	    , 0 AS QTY_WW_4 	\n"
                + "	    , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '금' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_DD_1  	\n"
                + "	    , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '토' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_DD_2 	\n"
                + "	    , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '일' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_DD_3 	\n"
                + "	    , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '월' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_DD_4 	\n"
                + "	    , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '화' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_DD_5 	\n"
                + "	    , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '수' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_DD_6 	\n"
                + "	    , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '목' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS QTY_DD_7 	\n"
                + "	FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n"
                + "	WHERE A.FACTORY = B.FACTORY  	\n"
                + "	AND A.MAT_ID = B.MAT_ID  	\n"
                + "	AND A.FACTORY = '" + cdvFactory.Text + "' 	\n"
                + "	AND A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 0, 'YYYYMMDD') 	\n"
                + "	                                               WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD') 	\n"
                + "	                                               WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD') 	\n"
                + "	                                               WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD') 	\n"
                + "	                                               WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD') 	\n"
                + "	                                               WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD') 	\n"
                + "	                                               WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD') 	\n"
                + "	                   END  	\n"
                + "	AND A.WORK_DATE <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')     	\n"
                + "	AND A.QC_TYPE LIKE 'CCS(변경점)' || '%'  	\n"
                + "	AND B.MAT_GRP_1 LIKE '%'	\n"
                + "	)	\n"
                + "	GROUP BY GUBUN	\n"
                + "	UNION ALL	\n"
                + "	SELECT GUBUN	\n"
                + "	    , SUM(QTY_QQ_1) AS QTY_QQ_1, SUM(QTY_QQ_2) AS QTY_QQ_2, SUM(QTY_QQ_3) AS QTY_QQ_3, SUM(QTY_QQ_4) AS QTY_QQ_4	\n"
                + "	    , SUM(QTY_MM_1) AS QTY_MM_1, SUM(QTY_MM_2) AS QTY_MM_2, SUM(QTY_MM_3) AS QTY_MM_3, SUM(QTY_MM_4) AS QTY_MM_4	\n"
                + "	    , SUM(QTY_WW_1) AS QTY_WW_1, SUM(QTY_WW_2) AS QTY_WW_2, SUM(QTY_WW_3) AS QTY_WW_3, SUM(QTY_WW_4) AS QTY_WW_4	\n"
                + "	    , SUM(QTY_DD_1) AS QTY_DD_1, SUM(QTY_DD_2) AS QTY_DD_2, SUM(QTY_DD_3) AS QTY_DD_3, SUM(QTY_DD_4) AS QTY_DD_4	\n"
                + "	    , SUM(QTY_DD_5) AS QTY_DD_5, SUM(QTY_DD_6) AS QTY_DD_6, SUM(QTY_DD_7) AS QTY_DD_7	\n"
                + "	FROM (	\n"
                + "	    SELECT 'CCN건수' AS GUBUN	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	                WHEN '4' THEN 	\n"
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                THEN 1	\n"
                + "	                                ELSE 0 	\n"
                + "	                            END	\n"
                + "	                WHEN '3' THEN 	\n"
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                THEN 1	\n"
                + "	                                ELSE 0 	\n"
                + "	                            END	\n"
                + "	                WHEN '2' THEN 	\n"
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                THEN 1	\n"
                + "	                                ELSE 0 	\n"
                + "	                            END	\n"
                + "	                WHEN '1' THEN 	\n"
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                THEN 1	\n"
                + "	                                ELSE 0 	\n"
                + "	                            END	\n"
                + "	              END) AS QTY_QQ_1	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	                WHEN '4' THEN 	\n"
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                THEN 1	\n"
                + "	                                ELSE 0 	\n"
                + "	                            END	\n"
                + "	                WHEN '3' THEN 	\n"
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                THEN 1	\n"
                + "	                                ELSE 0 	\n"
                + "	                            END	\n"
                + "	                WHEN '2' THEN 	\n"
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                THEN 1	\n"
                + "	                                ELSE 0 	\n"
                + "	                            END	\n"
                + "	                WHEN '1' THEN 	\n"
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                THEN 1	\n"
                + "	                                ELSE 0 	\n"
                + "	                            END	\n"
                + "	              END) AS QTY_QQ_2	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	                WHEN '4' THEN 	\n"
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                THEN 1	\n"
                + "	                                ELSE 0 	\n"
                + "	                            END	\n"
                + "	                WHEN '3' THEN 	\n"
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                THEN 1	\n"
                + "	                                ELSE 0 	\n"
                + "	                            END	\n"
                + "	                WHEN '2' THEN 	\n"
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                THEN 1	\n"
                + "	                                ELSE 0 	\n"
                + "	                            END	\n"
                + "	                WHEN '1' THEN 	\n"
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                THEN 1	\n"
                + "	                                ELSE 0 	\n"
                + "	                            END	\n"
                + "	              END) AS QTY_QQ_3	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	                WHEN '4' THEN 	\n"
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                THEN 1	\n"
                + "	                                ELSE 0 	\n"
                + "	                            END	\n"
                + "	                WHEN '3' THEN 	\n"
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                THEN 1	\n"
                + "	                                ELSE 0 	\n"
                + "	                            END	\n"
                + "	                WHEN '2' THEN 	\n"
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                THEN 1	\n"
                + "	                                ELSE 0 	\n"
                + "	                            END	\n"
                + "	                WHEN '1' THEN 	\n"
                + "	                            CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                THEN 1	\n"
                + "	                                ELSE 0 	\n"
                + "	                            END	\n"
                + "	              END) AS QTY_QQ_4	\n"
                + "	        , 0 AS QTY_MM_1	\n"
                + "	        , 0 AS QTY_MM_2	\n"
                + "	        , 0 AS QTY_MM_3	\n"
                + "	        , 0 AS QTY_MM_4	\n"
                + "	        , 0 AS QTY_WW_1	\n"
                + "	        , 0 AS QTY_WW_2	\n"
                + "	        , 0 AS QTY_WW_3	\n"
                + "	        , 0 AS QTY_WW_4	\n"
                + "	        , 0 AS QTY_DD_1	\n"
                + "	        , 0 AS QTY_DD_2	\n"
                + "	        , 0 AS QTY_DD_3	\n"
                + "	        , 0 AS QTY_DD_4	\n"
                + "	        , 0 AS QTY_DD_5	\n"
                + "	        , 0 AS QTY_DD_6	\n"
                + "	        , 0 AS QTY_DD_7	\n"
                + "	    FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n"
                + "	    WHERE 1=1 	\n"
                + "	    AND SUBSTR(STS.ABR_NO,1,3) = 'CCN'	\n"
                + "	    AND STS.FACTORY = '" + cdvFactory.Text + "'	\n"
                + "	    AND STS.FACTORY = MAT.FACTORY 	\n"
                + "	    AND STS.MAT_ID = MAT.MAT_ID 	\n"
                + "	    AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -13)), 'YYYYMMDD')||'220000'	\n"
                + "	    AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                + "	    AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n"
                + "	    AND STS.DEFECT_CODE LIKE '%'	\n"
                + "	    AND STS.CUR_STEP LIKE '%'	\n"
                + "	    AND STS.OPER_1 >= 'A0000'	\n"
                + "	    AND STS.OPER_1 <= 'AZ010'	\n"
                + "	    AND STS.DEL_FLAG = ' '	\n"
                + "	    UNION ALL	\n"
                + "	    SELECT 'CCN건수' AS GUBUN	\n"
                + "	        , 0 AS QTY_QQ_1	\n"
                + "	        , 0 AS QTY_QQ_2	\n"
                + "	        , 0 AS QTY_QQ_3	\n"
                + "	        , 0 AS QTY_QQ_4	\n"
                + "	        ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                + "	                    THEN 1	\n"
                + "	                    ELSE 0	\n"
                + "	             END) AS QTY_MM_1	\n"
                + "	        ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                + "	                    THEN 1	\n"
                + "	                    ELSE 0	\n"
                + "	             END) AS QTY_MM_2	\n"
                + "	        ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                + "	                    THEN 1	\n"
                + "	                    ELSE 0	\n"
                + "	             END) AS QTY_MM_3	\n"
                + "	        ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 0)), 'YYYYMMDD')||'220000'	\n"
                + "	                    THEN 1	\n"
                + "	                    ELSE 0	\n"
                + "	             END) AS QTY_MM_4	\n"
                + "	        , 0 AS QTY_WW_1	\n"
                + "	        , 0 AS QTY_WW_2	\n"
                + "	        , 0 AS QTY_WW_3	\n"
                + "	        , 0 AS QTY_WW_4	\n"
                + "	        , 0 AS QTY_DD_1	\n"
                + "	        , 0 AS QTY_DD_2	\n"
                + "	        , 0 AS QTY_DD_3	\n"
                + "	        , 0 AS QTY_DD_4	\n"
                + "	        , 0 AS QTY_DD_5	\n"
                + "	        , 0 AS QTY_DD_6	\n"
                + "	        , 0 AS QTY_DD_7	\n"
                + "	    FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n"
                + "	    WHERE 1=1 	\n"
                + "	    AND SUBSTR(STS.ABR_NO,1,3) = 'CCN'	\n"
                + "	    AND STS.FACTORY = '" + cdvFactory.Text + "'	\n"
                + "	    AND STS.FACTORY = MAT.FACTORY 	\n"
                + "	    AND STS.MAT_ID = MAT.MAT_ID 	\n"
                + "	    AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                + "	    AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                + "	    AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n"
                + "	    AND STS.DEFECT_CODE LIKE '%'	\n"
                + "	    AND STS.CUR_STEP LIKE '%'	\n"
                + "	    AND STS.OPER_1 >= 'A0000'	\n"
                + "	    AND STS.OPER_1 <= 'AZ010'	\n"
                + "	    AND STS.DEL_FLAG = ' '	\n"
                + "	    UNION ALL	\n"
                + "	    SELECT 'CCN건수' AS GUBUN	\n"
                + "	        , 0 AS QTY_QQ_1  	\n"
                + "	        , 0 AS QTY_QQ_2  	\n"
                + "	        , 0 AS QTY_QQ_3  	\n"
                + "	        , 0 AS QTY_QQ_4	\n"
                + "	        , 0 AS QTY_MM_1  	\n"
                + "	        , 0 AS QTY_MM_2  	\n"
                + "	        , 0 AS QTY_MM_3  	\n"
                + "	        , 0 AS QTY_MM_4	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 28, 'YYYYMMDD')||'220000' 	\n"
                + "	                                       END	\n"
                + "	                    AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')||'220000'	\n"
                + "	                                                                  WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')||'220000'	\n"
                + "	                                                                  WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                  WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                  WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                  WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                  WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')||'220000' 	\n"
                + "	                                       END THEN 1 ELSE 0 END) AS QTY_WW_1	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')||'220000' 	\n"
                + "	                                       END	\n"
                + "	                    AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                  WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                  WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                  WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                  WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                  WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                  WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')||'220000'  	\n"
                + "	                                       END THEN 1 ELSE 0 END) AS QTY_WW_2	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')||'220000'  	\n"
                + "	                                       END	\n"
                + "	                    AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                  WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                  WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                  WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                  WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                  WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                  WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000' 	\n"
                + "	                                       END THEN 1 ELSE 0 END) AS QTY_WW_3	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000' 	\n"
                + "	                                       END	\n"
                + "	                    AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 6, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                  WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 5, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                  WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 4, 'YYYYMMDD')||'220000'	\n"
                + "	                                                                  WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 3, 'YYYYMMDD')||'220000'	\n"
                + "	                                                                  WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 2, 'YYYYMMDD')||'220000'	\n"
                + "	                                                                  WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 1, 'YYYYMMDD')||'220000'	\n"
                + "	                                                                  WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 0, 'YYYYMMDD')||'220000'	\n"
                + "	                                       END THEN 1 ELSE 0 END) AS QTY_WW_4	\n"
                + "	        , 0 AS QTY_DD_1 	\n"
                + "	        , 0 AS QTY_DD_2 	\n"
                + "	        , 0 AS QTY_DD_3 	\n"
                + "	        , 0 AS QTY_DD_4 	\n"
                + "	        , 0 AS QTY_DD_5 	\n"
                + "	        , 0 AS QTY_DD_6 	\n"
                + "	        , 0 AS QTY_DD_7 	\n"
                + "	    FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n"
                + "	    WHERE 1=1 	\n"
                + "	    AND SUBSTR(STS.ABR_NO,1,3) = 'CCN'	\n"
                + "	    AND STS.FACTORY = '" + cdvFactory.Text + "'	\n"
                + "	    AND STS.FACTORY = MAT.FACTORY 	\n"
                + "	    AND STS.MAT_ID = MAT.MAT_ID	\n"
                + "	    AND STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')||'220000'	\n"
                + "	                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')||'220000'	\n"
                + "	                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 28, 'YYYYMMDD')||'220000'	\n"
                + "	                                           END 	\n"
                + "	    AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                + "	    AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n"
                + "	    AND STS.DEFECT_CODE LIKE '%'	\n"
                + "	    AND STS.CUR_STEP LIKE '%'	\n"
                + "	    AND STS.OPER_1 >= 'A0000'	\n"
                + "	    AND STS.OPER_1 <= 'AZ010'	\n"
                + "	    AND STS.DEL_FLAG = ' '	\n"
                + "	    UNION ALL	\n"
                + "	    SELECT 'CCN건수' AS GUBUN	\n"
                + "	        , 0 AS QTY_QQ_1	\n"
                + "	        , 0 AS QTY_QQ_2	\n"
                + "	        , 0 AS QTY_QQ_3	\n"
                + "	        , 0 AS QTY_QQ_4	\n"
                + "	        , 0 AS QTY_MM_1	\n"
                + "	        , 0 AS QTY_MM_2	\n"
                + "	        , 0 AS QTY_MM_3	\n"
                + "	        , 0 AS QTY_MM_4	\n"
                + "	        , 0 AS QTY_WW_1	\n"
                + "	        , 0 AS QTY_WW_2	\n"
                + "	        , 0 AS QTY_WW_3	\n"
                + "	        , 0 AS QTY_WW_4	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                + "	                    WHEN '금' 	\n"
                + "	                    THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                + "	                              THEN 1	\n"
                + "	                              ELSE 0	\n"
                + "	                         END	\n"
                + "	                    WHEN '목'	\n"
                + "	                    THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                + "	                              THEN 1	\n"
                + "	                              ELSE 0	\n"
                + "	                         END	\n"
                + "	              END) AS QTY_DD_1	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                + "	                    WHEN '토'	\n"
                + "	                    THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                + "	                              THEN 1	\n"
                + "	                              ELSE 0	\n"
                + "	                         END	\n"
                + "	                    WHEN '금'	\n"
                + "	                    THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                + "	                              THEN 1	\n"
                + "	                              ELSE 0	\n"
                + "	                         END	\n"
                + "	              END) AS QTY_DD_2 	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                + "	                    WHEN '일' 	\n"
                + "	                    THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                + "	                              THEN 1	\n"
                + "	                              ELSE 0	\n"
                + "	                         END	\n"
                + "	                    WHEN '토'	\n"
                + "	                    THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                + "	                              THEN 1	\n"
                + "	                              ELSE 0	\n"
                + "	                         END	\n"
                + "	              END) AS QTY_DD_3 	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                + "	                    WHEN '월' 	\n"
                + "	                    THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                + "	                              THEN 1	\n"
                + "	                              ELSE 0	\n"
                + "	                         END	\n"
                + "	                    WHEN '일'	\n"
                + "	                    THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                + "	                              THEN 1	\n"
                + "	                              ELSE 0	\n"
                + "	                         END	\n"
                + "	              END) AS QTY_DD_4 	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                + "	                    WHEN '화'	\n"
                + "	                    THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                + "	                              THEN 1	\n"
                + "	                              ELSE 0	\n"
                + "	                         END	\n"
                + "	                    WHEN '월'	\n"
                + "	                    THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                + "	                              THEN 1	\n"
                + "	                              ELSE 0	\n"
                + "	                         END	\n"
                + "	              END) AS QTY_DD_5 	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                + "	                    WHEN '수'	\n"
                + "	                    THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                + "	                              THEN 1	\n"
                + "	                              ELSE 0	\n"
                + "	                         END	\n"
                + "	                    WHEN '화'	\n"
                + "	                    THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                + "	                              THEN 1	\n"
                + "	                              ELSE 0	\n"
                + "	                         END	\n"
                + "	              END) AS QTY_DD_6 	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                + "	                    WHEN '목' 	\n"
                + "	                    THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                + "	                              THEN 1	\n"
                + "	                              ELSE 0	\n"
                + "	                         END	\n"
                + "	                    WHEN '수'	\n"
                + "	                    THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                + "	                              THEN 1	\n"
                + "	                              ELSE 0	\n"
                + "	                         END	\n"
                + "	              END) AS QTY_DD_7	\n"
                + "	    FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n"
                + "	    WHERE 1=1 	\n"
                + "	    AND SUBSTR(STS.ABR_NO,1,3) = 'CCN'	\n"
                + "	    AND STS.FACTORY = '" + cdvFactory.Text + "'	\n"
                + "	    AND STS.FACTORY = MAT.FACTORY 	\n"
                + "	    AND STS.MAT_ID = MAT.MAT_ID	\n"
                + "	    AND STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000'	\n"
                + "	                                                   WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000'	\n"
                + "	                                                   WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000'	\n"
                + "	                                                   WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000'	\n"
                + "	                                                   WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000'	\n"
                + "	                                                   WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000'	\n"
                + "	                                                   WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000'	\n"
                + "	                                           END 	\n"
                + "	    AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                + "	    AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n"
                + "	    AND STS.DEFECT_CODE LIKE '%'	\n"
                + "	    AND STS.CUR_STEP LIKE '%'	\n"
                + "	    AND STS.OPER_1 >= 'A0000'	\n"
                + "	    AND STS.OPER_1 <= 'AZ010'	\n"
                + "	    AND STS.DEL_FLAG = ' '	\n"
                + "	)GROUP BY GUBUN	\n"
                + "	UNION ALL	\n"
                + "	SELECT GUBUN	\n"
                + "	    , SUM(QTY_QQ_1) AS QTY_QQ_1	\n"
                + "	    , SUM(QTY_QQ_2) AS QTY_QQ_2	\n"
                + "	    , SUM(QTY_QQ_3) AS QTY_QQ_3	\n"
                + "	    , SUM(QTY_QQ_4) AS QTY_QQ_4	\n"
                + "	    , SUM(QTY_MM_1) AS QTY_MM_1	\n"
                + "	    , SUM(QTY_MM_2) AS QTY_MM_2	\n"
                + "	    , SUM(QTY_MM_3) AS QTY_MM_3	\n"
                + "	    , SUM(QTY_MM_4) AS QTY_MM_4	\n"
                + "	    , SUM(QTY_WW_1) AS QTY_WW_1	\n"
                + "	    , SUM(QTY_WW_2) AS QTY_WW_2	\n"
                + "	    , SUM(QTY_WW_3) AS QTY_WW_3	\n"
                + "	    , SUM(QTY_WW_4) AS QTY_WW_4	\n"
                + "	    , SUM(QTY_DD_1) AS QTY_DD_1	\n"
                + "	    , SUM(QTY_DD_2) AS QTY_DD_2	\n"
                + "	    , SUM(QTY_DD_3) AS QTY_DD_3	\n"
                + "	    , SUM(QTY_DD_4) AS QTY_DD_4	\n"
                + "	    , SUM(QTY_DD_5) AS QTY_DD_5	\n"
                + "	    , SUM(QTY_DD_6) AS QTY_DD_6	\n"
                + "	    , SUM(QTY_DD_7) AS QTY_DD_7	\n"
                + "	FROM	\n"
                + "	(	\n"
                + "	    SELECT A.GUBUN AS GUBUN	\n"
                + "	        , CASE WHEN A.QTY_QQ_1 > 0 AND B.LOT_QTY_QQ_1 > 0 THEN ROUND(A.QTY_QQ_1 / B.LOT_QTY_QQ_1 * 100, 2) ELSE 0 END AS QTY_QQ_1	\n"
                + "	        , CASE WHEN A.QTY_QQ_2 > 0 AND B.LOT_QTY_QQ_2 > 0 THEN ROUND(A.QTY_QQ_2 / B.LOT_QTY_QQ_2 * 100, 2) ELSE 0 END AS QTY_QQ_2	\n"
                + "	        , CASE WHEN A.QTY_QQ_3 > 0 AND B.LOT_QTY_QQ_3 > 0 THEN ROUND(A.QTY_QQ_3 / B.LOT_QTY_QQ_3 * 100, 2) ELSE 0 END AS QTY_QQ_3	\n"
                + "	        , CASE WHEN A.QTY_QQ_4 > 0 AND B.LOT_QTY_QQ_4 > 0 THEN ROUND(A.QTY_QQ_4 / B.LOT_QTY_QQ_4 * 100, 2) ELSE 0 END AS QTY_QQ_4	\n"
                + "	        , CASE WHEN A.QTY_MM_1 > 0 AND B.LOT_QTY_MM_1 > 0 THEN ROUND(A.QTY_MM_1 / B.LOT_QTY_MM_1 * 100, 2) ELSE 0 END AS QTY_MM_1	\n"
                + "	        , CASE WHEN A.QTY_MM_2 > 0 AND B.LOT_QTY_MM_2 > 0 THEN ROUND(A.QTY_MM_2 / B.LOT_QTY_MM_2 * 100, 2) ELSE 0 END AS QTY_MM_2	\n"
                + "	        , CASE WHEN A.QTY_MM_3 > 0 AND B.LOT_QTY_MM_3 > 0 THEN ROUND(A.QTY_MM_3 / B.LOT_QTY_MM_3 * 100, 2) ELSE 0 END AS QTY_MM_3	\n"
                + "	        , CASE WHEN A.QTY_MM_4 > 0 AND B.LOT_QTY_MM_4 > 0 THEN ROUND(A.QTY_MM_4 / B.LOT_QTY_MM_4 * 100, 2) ELSE 0 END AS QTY_MM_4	\n"
                + "	        , CASE WHEN A.QTY_WW_1 > 0 AND B.LOT_QTY_WW_1 > 0 THEN ROUND(A.QTY_WW_1 / B.LOT_QTY_WW_1 * 100, 2) ELSE 0 END AS QTY_WW_1	\n"
                + "	        , CASE WHEN A.QTY_WW_2 > 0 AND B.LOT_QTY_WW_2 > 0 THEN ROUND(A.QTY_WW_2 / B.LOT_QTY_WW_2 * 100, 2) ELSE 0 END AS QTY_WW_2	\n"
                + "	        , CASE WHEN A.QTY_WW_3 > 0 AND B.LOT_QTY_WW_3 > 0 THEN ROUND(A.QTY_WW_3 / B.LOT_QTY_WW_3 * 100, 2) ELSE 0 END AS QTY_WW_3	\n"
                + "	        , CASE WHEN A.QTY_WW_4 > 0 AND B.LOT_QTY_WW_4 > 0 THEN ROUND(A.QTY_WW_4 / B.LOT_QTY_WW_4 * 100, 2) ELSE 0 END AS QTY_WW_4	\n"
                + "	        , CASE WHEN A.QTY_DD_1 > 0 AND B.LOT_QTY_DD_1 > 0 THEN ROUND(A.QTY_DD_1 / B.LOT_QTY_DD_1 * 100, 2) ELSE 0 END AS QTY_DD_1	\n"
                + "	        , CASE WHEN A.QTY_DD_2 > 0 AND B.LOT_QTY_DD_2 > 0 THEN ROUND(A.QTY_DD_2 / B.LOT_QTY_DD_2 * 100, 2) ELSE 0 END AS QTY_DD_2	\n"
                + "	        , CASE WHEN A.QTY_DD_3 > 0 AND B.LOT_QTY_DD_3 > 0 THEN ROUND(A.QTY_DD_3 / B.LOT_QTY_DD_3 * 100, 2) ELSE 0 END AS QTY_DD_3	\n"
                + "	        , CASE WHEN A.QTY_DD_4 > 0 AND B.LOT_QTY_DD_4 > 0 THEN ROUND(A.QTY_DD_4 / B.LOT_QTY_DD_4 * 100, 2) ELSE 0 END AS QTY_DD_4	\n"
                + "	        , CASE WHEN A.QTY_DD_5 > 0 AND B.LOT_QTY_DD_5 > 0 THEN ROUND(A.QTY_DD_5 / B.LOT_QTY_DD_5 * 100, 2) ELSE 0 END AS QTY_DD_5	\n"
                + "	        , CASE WHEN A.QTY_DD_6 > 0 AND B.LOT_QTY_DD_6 > 0 THEN ROUND(A.QTY_DD_6 / B.LOT_QTY_DD_6 * 100, 2) ELSE 0 END AS QTY_DD_6	\n"
                + "	        , CASE WHEN A.QTY_DD_7 > 0 AND B.LOT_QTY_DD_7 > 0 THEN ROUND(A.QTY_DD_7 / B.LOT_QTY_DD_7 * 100, 2) ELSE 0 END AS QTY_DD_7	\n"
                + "	    FROM(    	\n"
                + "	        SELECT 'LRR' AS GUBUN	\n"
                + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	                    WHEN '4' THEN 	\n"
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                    THEN 1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                    WHEN '3' THEN 	\n"
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                    THEN 1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                    WHEN '2' THEN 	\n"
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                    THEN 1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                    WHEN '1' THEN 	\n"
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                    THEN 1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                  END) AS QTY_QQ_1	\n"
                + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	                    WHEN '4' THEN 	\n"
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                    THEN 1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                    WHEN '3' THEN 	\n"
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                    THEN 1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                    WHEN '2' THEN 	\n"
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                    THEN 1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                    WHEN '1' THEN 	\n"
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                    THEN 1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                  END) AS QTY_QQ_2	\n"
                + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	                    WHEN '4' THEN 	\n"
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                    THEN 1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                    WHEN '3' THEN 	\n"
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                    THEN 1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                    WHEN '2' THEN 	\n"
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                    THEN 1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                    WHEN '1' THEN 	\n"
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                    THEN 1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                  END) AS QTY_QQ_3	\n"
                + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	                    WHEN '4' THEN 	\n"
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                    THEN 1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                    WHEN '3' THEN 	\n"
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                    THEN 1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                    WHEN '2' THEN 	\n"
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                    THEN 1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                    WHEN '1' THEN 	\n"
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                    THEN 1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                  END) AS QTY_QQ_4	\n"
                + "	            , 0 AS QTY_MM_1	\n"
                + "	            , 0 AS QTY_MM_2	\n"
                + "	            , 0 AS QTY_MM_3	\n"
                + "	            , 0 AS QTY_MM_4	\n"
                + "	            , 0 AS QTY_WW_1	\n"
                + "	            , 0 AS QTY_WW_2	\n"
                + "	            , 0 AS QTY_WW_3	\n"
                + "	            , 0 AS QTY_WW_4	\n"
                + "	            , 0 AS QTY_DD_1	\n"
                + "	            , 0 AS QTY_DD_2	\n"
                + "	            , 0 AS QTY_DD_3	\n"
                + "	            , 0 AS QTY_DD_4	\n"
                + "	            , 0 AS QTY_DD_5	\n"
                + "	            , 0 AS QTY_DD_6	\n"
                + "	            , 0 AS QTY_DD_7	\n"
                + "	        FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n"
                + "	        WHERE 1=1 	\n"
                + "	        AND SUBSTR(STS.ABR_NO,1,3) = 'CCN'	\n"
                + "	        AND STS.FACTORY = '" + cdvFactory.Text + "'	\n"
                + "	        AND STS.FACTORY = MAT.FACTORY 	\n"
                + "	        AND STS.MAT_ID = MAT.MAT_ID 	\n"
                + "	        AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -13)), 'YYYYMMDD')||'220000'	\n"
                + "	        AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                + "	        AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n"
                + "	        AND STS.DEFECT_CODE LIKE '%'	\n"
                + "	        AND STS.CUR_STEP LIKE '%'	\n"
                + "	        AND STS.OPER_1 >= 'A0000'	\n"
                + "	        AND STS.OPER_1 <= 'AZ010'	\n"
                + "	        AND STS.DEL_FLAG = ' '	\n"
                + "	        UNION ALL	\n"
                + "	        SELECT 'LRR' AS GUBUN	\n"
                + "	            , 0 AS QTY_QQ_1	\n"
                + "	            , 0 AS QTY_QQ_2	\n"
                + "	            , 0 AS QTY_QQ_3	\n"
                + "	            , 0 AS QTY_QQ_4	\n"
                + "	            ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                + "	                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                + "	                        THEN 1	\n"
                + "	                        ELSE 0	\n"
                + "	                 END) AS QTY_MM_1	\n"
                + "	            ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                + "	                        THEN 1	\n"
                + "	                        ELSE 0	\n"
                + "	                 END) AS QTY_MM_2	\n"
                + "	            ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                + "	                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                + "	                        THEN 1	\n"
                + "	                        ELSE 0	\n"
                + "	                 END) AS QTY_MM_3	\n"
                + "	            ,SUM(CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                + "	                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 0)), 'YYYYMMDD')||'220000'	\n"
                + "	                        THEN 1	\n"
                + "	                        ELSE 0	\n"
                + "	                 END) AS QTY_MM_4	\n"
                + "	            , 0 AS QTY_WW_1	\n"
                + "	            , 0 AS QTY_WW_2	\n"
                + "	            , 0 AS QTY_WW_3	\n"
                + "	            , 0 AS QTY_WW_4	\n"
                + "	            , 0 AS QTY_DD_1	\n"
                + "	            , 0 AS QTY_DD_2	\n"
                + "	            , 0 AS QTY_DD_3	\n"
                + "	            , 0 AS QTY_DD_4	\n"
                + "	            , 0 AS QTY_DD_5	\n"
                + "	            , 0 AS QTY_DD_6	\n"
                + "	            , 0 AS QTY_DD_7	\n"
                + "	        FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n"
                + "	        WHERE 1=1 	\n"
                + "	        AND SUBSTR(STS.ABR_NO,1,3) = 'CCN'	\n"
                + "	        AND STS.FACTORY = '" + cdvFactory.Text + "'	\n"
                + "	        AND STS.FACTORY = MAT.FACTORY 	\n"
                + "	        AND STS.MAT_ID = MAT.MAT_ID 	\n"
                + "	        AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                + "	        AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                + "	        AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n"
                + "	        AND STS.DEFECT_CODE LIKE '%'	\n"
                + "	        AND STS.CUR_STEP LIKE '%'	\n"
                + "	        AND STS.OPER_1 >= 'A0000'	\n"
                + "	        AND STS.OPER_1 <= 'AZ010'	\n"
                + "	        AND STS.DEL_FLAG = ' '	\n"
                + "	        UNION ALL	\n"
                + "	        SELECT 'LRR' AS GUBUN	\n"
                + "	            , 0 AS QTY_QQ_1  	\n"
                + "	            , 0 AS QTY_QQ_2  	\n"
                + "	            , 0 AS QTY_QQ_3  	\n"
                + "	            , 0 AS QTY_QQ_4	\n"
                + "	            , 0 AS QTY_MM_1  	\n"
                + "	            , 0 AS QTY_MM_2  	\n"
                + "	            , 0 AS QTY_MM_3  	\n"
                + "	            , 0 AS QTY_MM_4	\n"
                + "	            , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 28, 'YYYYMMDD')||'220000' 	\n"
                + "	                                           END	\n"
                + "	                        AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')||'220000'	\n"
                + "	                                                                      WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')||'220000'	\n"
                + "	                                                                      WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                      WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                      WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                      WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                      WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')||'220000' 	\n"
                + "	                                           END THEN 1 ELSE 0 END) AS QTY_WW_1	\n"
                + "	            , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD')||'220000' 	\n"
                + "	                                           END	\n"
                + "	                        AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                      WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')||'220000'   	\n"
                + "	                                                                      WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                      WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                      WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                      WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                      WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')||'220000'  	\n"
                + "	                                           END THEN 1 ELSE 0 END) AS QTY_WW_2	\n"
                + "	            , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD')||'220000'  	\n"
                + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD')||'220000'  	\n"
                + "	                                           END	\n"
                + "	                        AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                      WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                      WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                      WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                      WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                      WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                      WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000' 	\n"
                + "	                                           END THEN 1 ELSE 0 END) AS QTY_WW_3	\n"
                + "	            , SUM(CASE WHEN STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000' 	\n"
                + "	                                           END	\n"
                + "	                        AND STEP10_TIME < CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 6, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                      WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 5, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                                      WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 4, 'YYYYMMDD')||'220000'	\n"
                + "	                                                                      WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 3, 'YYYYMMDD')||'220000'	\n"
                + "	                                                                      WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 2, 'YYYYMMDD')||'220000'	\n"
                + "	                                                                      WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 1, 'YYYYMMDD')||'220000'	\n"
                + "	                                                                      WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 0, 'YYYYMMDD')||'220000'	\n"
                + "	                                           END THEN 1 ELSE 0 END) AS QTY_WW_4	\n"
                + "	            , 0 AS QTY_DD_1 	\n"
                + "	            , 0 AS QTY_DD_2 	\n"
                + "	            , 0 AS QTY_DD_3 	\n"
                + "	            , 0 AS QTY_DD_4 	\n"
                + "	            , 0 AS QTY_DD_5 	\n"
                + "	            , 0 AS QTY_DD_6 	\n"
                + "	            , 0 AS QTY_DD_7 	\n"
                + "	        FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n"
                + "	        WHERE 1=1 	\n"
                + "	        AND SUBSTR(STS.ABR_NO,1,3) = 'CCN'	\n"
                + "	        AND STS.FACTORY = '" + cdvFactory.Text + "'	\n"
                + "	        AND STS.FACTORY = MAT.FACTORY 	\n"
                + "	        AND STS.MAT_ID = MAT.MAT_ID	\n"
                + "	        AND STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD')||'220000'	\n"
                + "	                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD')||'220000' 	\n"
                + "	                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD')||'220000'	\n"
                + "	                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 28, 'YYYYMMDD')||'220000'	\n"
                + "	                                               END 	\n"
                + "	        AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                + "	        AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n"
                + "	        AND STS.DEFECT_CODE LIKE '%'	\n"
                + "	        AND STS.CUR_STEP LIKE '%'	\n"
                + "	        AND STS.OPER_1 >= 'A0000'	\n"
                + "	        AND STS.OPER_1 <= 'AZ010'	\n"
                + "	        AND STS.DEL_FLAG = ' '	\n"
                + "	        UNION ALL	\n"
                + "	        SELECT 'LRR' AS GUBUN	\n"
                + "	            , 0 AS QTY_QQ_1	\n"
                + "	            , 0 AS QTY_QQ_2	\n"
                + "	            , 0 AS QTY_QQ_3	\n"
                + "	            , 0 AS QTY_QQ_4	\n"
                + "	            , 0 AS QTY_MM_1	\n"
                + "	            , 0 AS QTY_MM_2	\n"
                + "	            , 0 AS QTY_MM_3	\n"
                + "	            , 0 AS QTY_MM_4	\n"
                + "	            , 0 AS QTY_WW_1	\n"
                + "	            , 0 AS QTY_WW_2	\n"
                + "	            , 0 AS QTY_WW_3	\n"
                + "	            , 0 AS QTY_WW_4	\n"
                + "	            , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                + "	                        WHEN '금' 	\n"
                + "	                        THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                + "	                                  THEN 1	\n"
                + "	                                  ELSE 0	\n"
                + "	                             END	\n"
                + "	                        WHEN '목'	\n"
                + "	                        THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                + "	                                  THEN 1	\n"
                + "	                                  ELSE 0	\n"
                + "	                             END	\n"
                + "	                  END) AS QTY_DD_1	\n"
                + "	            , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                + "	                        WHEN '토'	\n"
                + "	                        THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                + "	                                  THEN 1	\n"
                + "	                                  ELSE 0	\n"
                + "	                             END	\n"
                + "	                        WHEN '금'	\n"
                + "	                        THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                + "	                                  THEN 1	\n"
                + "	                                  ELSE 0	\n"
                + "	                             END	\n"
                + "	                  END) AS QTY_DD_2 	\n"
                + "	            , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                + "	                        WHEN '일' 	\n"
                + "	                        THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                + "	                                  THEN 1	\n"
                + "	                                  ELSE 0	\n"
                + "	                             END	\n"
                + "	                        WHEN '토'	\n"
                + "	                        THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                + "	                                  THEN 1	\n"
                + "	                                  ELSE 0	\n"
                + "	                             END	\n"
                + "	                  END) AS QTY_DD_3 	\n"
                + "	            , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                + "	                        WHEN '월' 	\n"
                + "	                        THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                + "	                                  THEN 1	\n"
                + "	                                  ELSE 0	\n"
                + "	                             END	\n"
                + "	                        WHEN '일'	\n"
                + "	                        THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                + "	                                  THEN 1	\n"
                + "	                                  ELSE 0	\n"
                + "	                             END	\n"
                + "	                  END) AS QTY_DD_4 	\n"
                + "	            , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                + "	                        WHEN '화'	\n"
                + "	                        THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                + "	                                  THEN 1	\n"
                + "	                                  ELSE 0	\n"
                + "	                             END	\n"
                + "	                        WHEN '월'	\n"
                + "	                        THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                + "	                                  THEN 1	\n"
                + "	                                  ELSE 0	\n"
                + "	                             END	\n"
                + "	                  END) AS QTY_DD_5 	\n"
                + "	            , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                + "	                        WHEN '수'	\n"
                + "	                        THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                + "	                                  THEN 1	\n"
                + "	                                  ELSE 0	\n"
                + "	                             END	\n"
                + "	                        WHEN '화'	\n"
                + "	                        THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                + "	                                  THEN 1	\n"
                + "	                                  ELSE 0	\n"
                + "	                             END	\n"
                + "	                  END) AS QTY_DD_6 	\n"
                + "	            , SUM(CASE TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'DY')	\n"
                + "	                        WHEN '목' 	\n"
                + "	                        THEN CASE WHEN STS.STEP10_TIME < TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                + "	                                  THEN 1	\n"
                + "	                                  ELSE 0	\n"
                + "	                             END	\n"
                + "	                        WHEN '수'	\n"
                + "	                        THEN CASE WHEN STS.STEP10_TIME >= TO_CHAR(TO_DATE(STS.STEP10_TIME, 'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD')||'220000'	\n"
                + "	                                  THEN 1	\n"
                + "	                                  ELSE 0	\n"
                + "	                             END	\n"
                + "	                  END) AS QTY_DD_7	\n"
                + "	        FROM CABRLOTSTS@RPTTOMES STS, MWIPMATDEF@RPTTOMES MAT 	\n"
                + "	        WHERE 1=1 	\n"
                + "	        AND SUBSTR(STS.ABR_NO,1,3) = 'CCN'	\n"
                + "	        AND STS.FACTORY = '" + cdvFactory.Text + "'	\n"
                + "	        AND STS.FACTORY = MAT.FACTORY 	\n"
                + "	        AND STS.MAT_ID = MAT.MAT_ID	\n"
                + "	        AND STEP10_TIME >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD')||'220000'	\n"
                + "	                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD')||'220000'	\n"
                + "	                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD')||'220000'	\n"
                + "	                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD')||'220000'	\n"
                + "	                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD')||'220000'	\n"
                + "	                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD')||'220000'	\n"
                + "	                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD')||'220000'	\n"
                + "	                                               END 	\n"
                + "	        AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                + "	        AND SUBSTR(STS.ABR_NO, 0, 3) LIKE '%'	\n"
                + "	        AND STS.DEFECT_CODE LIKE '%'	\n"
                + "	        AND STS.CUR_STEP LIKE '%'	\n"
                + "	        AND STS.OPER_1 >= 'A0000'	\n"
                + "	        AND STS.OPER_1 <= 'AZ010'	\n"
                + "	        AND STS.DEL_FLAG = ' '	\n"
                + "	        ) A,	\n"
                + "	        (SELECT 'LRR' AS GUBUN	\n"
                + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	                    WHEN '4' THEN 	\n"
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n"
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n"
                + "	                                    THEN A.QC_LOT_QTY_1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                    WHEN '3' THEN 	\n"
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10'	\n"
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM')	\n"
                + "	                                    THEN A.QC_LOT_QTY_1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                    WHEN '2' THEN 	\n"
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07'	\n"
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07', 'YYYYMM'),2), 'YYYYMM')	\n"
                + "	                                    THEN A.QC_LOT_QTY_1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                    WHEN '1' THEN 	\n"
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'04'	\n"
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'04', 'YYYYMM'),2), 'YYYYMM')	\n"
                + "	                                    THEN A.QC_LOT_QTY_1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                  END) AS LOT_QTY_QQ_1	\n"
                + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	                    WHEN '4' THEN 	\n"
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04'	\n"
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM')	\n"
                + "	                                    THEN A.QC_LOT_QTY_1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                    WHEN '3' THEN 	\n"
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n"
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n"
                + "	                                    THEN A.QC_LOT_QTY_1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                    WHEN '2' THEN 	\n"
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10'	\n"
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM')	\n"
                + "	                                    THEN A.QC_LOT_QTY_1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                    WHEN '1' THEN 	\n"
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07'	\n"
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'07', 'YYYYMM'),2), 'YYYYMM')	\n"
                + "	                                    THEN A.QC_LOT_QTY_1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                  END) AS LOT_QTY_QQ_2	\n"
                + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	                    WHEN '4' THEN 	\n"
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07'	\n"
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07', 'YYYYMM'),2), 'YYYYMM')	\n"
                + "	                                    THEN A.QC_LOT_QTY_1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                    WHEN '3' THEN 	\n"
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04'	\n"
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM')	\n"
                + "	                                    THEN A.QC_LOT_QTY_1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                    WHEN '2' THEN 	\n"
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n"
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n"
                + "	                                    THEN A.QC_LOT_QTY_1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                    WHEN '1' THEN 	\n"
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10'	\n"
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'10', 'YYYYMM'),2), 'YYYYMM')	\n"
                + "	                                    THEN A.QC_LOT_QTY_1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                  END) AS LOT_QTY_QQ_3	\n"
                + "	            , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	                    WHEN '4' THEN 	\n"
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'10'	\n"
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'10', 'YYYYMM'),2), 'YYYYMM')	\n"
                + "	                                    THEN A.QC_LOT_QTY_1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                    WHEN '3' THEN 	\n"
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07'	\n"
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'07', 'YYYYMM'),2), 'YYYYMM')	\n"
                + "	                                    THEN A.QC_LOT_QTY_1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                    WHEN '2' THEN 	\n"
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04'	\n"
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'04', 'YYYYMM'),2), 'YYYYMM')	\n"
                + "	                                    THEN A.QC_LOT_QTY_1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                    WHEN '1' THEN 	\n"
                + "	                                CASE WHEN A.WORK_MONTH >= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01'	\n"
                + "	                                            AND A.WORK_MONTH <= TO_CHAR(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'01', 'YYYYMM'),2), 'YYYYMM')	\n"
                + "	                                    THEN A.QC_LOT_QTY_1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                  END) AS LOT_QTY_QQ_4	\n"
                + "	            , 0 AS LOT_QTY_MM_1  	\n"
                + "	            , 0 AS LOT_QTY_MM_2  	\n"
                + "	            , 0 AS LOT_QTY_MM_3  	\n"
                + "	            , 0 AS LOT_QTY_MM_4	\n"
                + "	            , 0 AS LOT_QTY_WW_1 	\n"
                + "	            , 0 AS LOT_QTY_WW_2 	\n"
                + "	            , 0 AS LOT_QTY_WW_3 	\n"
                + "	            , 0 AS LOT_QTY_WW_4 	\n"
                + "	            , 0 AS LOT_QTY_DD_1 	\n"
                + "	            , 0 AS LOT_QTY_DD_2 	\n"
                + "	            , 0 AS LOT_QTY_DD_3 	\n"
                + "	            , 0 AS LOT_QTY_DD_4 	\n"
                + "	            , 0 AS LOT_QTY_DD_5 	\n"
                + "	            , 0 AS LOT_QTY_DD_6 	\n"
                + "	            , 0 AS LOT_QTY_DD_7	\n"
                + "	        FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n"
                + "	        WHERE A.FACTORY = B.FACTORY  	\n"
                + "	        AND A.MAT_ID = B.MAT_ID  	\n"
                + "	        AND A.FACTORY = '" + cdvFactory.Text + "' 	\n"
                + "	        AND A.WORK_MONTH >= TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -11), 'YYYYMM') 	\n"
                + "	        AND A.WORK_MONTH <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMM')	\n"
                + "	        AND A.QC_TYPE LIKE 'CCS(변경점)' || '%'	\n"
                + "	        AND B.MAT_GRP_1 LIKE '%'	\n"
                + "	        UNION ALL	\n"
                + "	        SELECT 'LRR' AS GUBUN	\n"
                + "	            , 0 AS LOT_QTY_QQ_1  	\n"
                + "	            , 0 AS LOT_QTY_QQ_2  	\n"
                + "	            , 0 AS LOT_QTY_QQ_3  	\n"
                + "	            , 0 AS LOT_QTY_QQ_4 	\n"
                + "	            , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_1 	\n"
                + "	            , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_2 	\n"
                + "	            , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_3	\n"
                + "	            , SUM(CASE A.WORK_MONTH WHEN TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0), 'YYYYMM') THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_MM_4	\n"
                + "	            , 0 AS LOT_QTY_WW_1 	\n"
                + "	            , 0 AS LOT_QTY_WW_2 	\n"
                + "	            , 0 AS LOT_QTY_WW_3 	\n"
                + "	            , 0 AS LOT_QTY_WW_4 	\n"
                + "	            , 0 AS LOT_QTY_DD_1 	\n"
                + "	            , 0 AS LOT_QTY_DD_2 	\n"
                + "	            , 0 AS LOT_QTY_DD_3 	\n"
                + "	            , 0 AS LOT_QTY_DD_4 	\n"
                + "	            , 0 AS LOT_QTY_DD_5 	\n"
                + "	            , 0 AS LOT_QTY_DD_6 	\n"
                + "	            , 0 AS LOT_QTY_DD_7 	\n"
                + "	        FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B	\n"
                + "	        WHERE A.FACTORY = B.FACTORY	\n"
                + "	        AND A.MAT_ID = B.MAT_ID	\n"
                + "	        AND A.FACTORY = '" + cdvFactory.Text + "'	\n"
                + "	        AND A.WORK_MONTH >= TO_CHAR(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3), 'YYYYMM')	\n"
                + "	        AND A.WORK_MONTH <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMM')	\n"
                + "	        AND A.QC_TYPE LIKE 'CCS(변경점)' || '%'  	\n"
                + "	        AND B.MAT_GRP_1 LIKE '%'	\n"
                + "	        UNION ALL 	\n"
                + "	        SELECT 'LRR' AS GUBUN	\n"
                + "	            , 0 AS LOT_QTY_QQ_1  	\n"
                + "	            , 0 AS LOT_QTY_QQ_2  	\n"
                + "	            , 0 AS LOT_QTY_QQ_3  	\n"
                + "	            , 0 AS LOT_QTY_QQ_4	\n"
                + "	            , 0 AS LOT_QTY_MM_1  	\n"
                + "	            , 0 AS LOT_QTY_MM_2  	\n"
                + "	            , 0 AS LOT_QTY_MM_3  	\n"
                + "	            , 0 AS LOT_QTY_MM_4 	\n"
                + "	            , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD') 	\n"
                + "	                                           END                                                 	\n"
                + "	                        AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD')	\n"
                + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD')	\n"
                + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD') 	\n"
                + "	                                           END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_1 	\n"
                + "	            , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 15, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 16, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 17, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 18, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 19, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 20, 'YYYYMMDD') 	\n"
                + "	                                           END                                                 	\n"
                + "	                        AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD')  	\n"
                + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD')  	\n"
                + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 14, 'YYYYMMDD') 	\n"
                + "	                                           END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_2 	\n"
                + "	            , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 8, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 9, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 10, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 11, 'YYYYMMDD')	\n"
                + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 12, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 13, 'YYYYMMDD') 	\n"
                + "	                                           END                                                 	\n"
                + "	                        AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 7, 'YYYYMMDD') 	\n"
                + "	                                           END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_3 	\n"
                + "	            , SUM(CASE WHEN A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 0, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD') 	\n"
                + "	                                           END 	\n"
                + "	                        AND A.WORK_DATE <= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 6, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 5, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 4, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 3, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 2, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 1, 'YYYYMMDD') 	\n"
                + "	                                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') + 0, 'YYYYMMDD') 	\n"
                + "	                                           END THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_WW_4	\n"
                + "	            , 0 AS LOT_QTY_DD_1 	\n"
                + "	            , 0 AS LOT_QTY_DD_2 	\n"
                + "	            , 0 AS LOT_QTY_DD_3 	\n"
                + "	            , 0 AS LOT_QTY_DD_4 	\n"
                + "	            , 0 AS LOT_QTY_DD_5 	\n"
                + "	            , 0 AS LOT_QTY_DD_6 	\n"
                + "	            , 0 AS LOT_QTY_DD_7 	\n"
                + "	        FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n"
                + "	        WHERE A.FACTORY = B.FACTORY  	\n"
                + "	        AND A.MAT_ID = B.MAT_ID  	\n"
                + "	        AND A.FACTORY = '" + cdvFactory.Text + "' 	\n"
                + "	        AND A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 21, 'YYYYMMDD') 	\n"
                + "	                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 22, 'YYYYMMDD') 	\n"
                + "	                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 23, 'YYYYMMDD') 	\n"
                + "	                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 24, 'YYYYMMDD') 	\n"
                + "	                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 25, 'YYYYMMDD') 	\n"
                + "	                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 26, 'YYYYMMDD') 	\n"
                + "	                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 27, 'YYYYMMDD') 	\n"
                + "	                                               END 	\n"
                + "	        AND A.WORK_DATE <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD') 	\n"
                + "	        AND A.QC_TYPE LIKE 'CCS(변경점)' || '%'	\n"
                + "	        AND B.MAT_GRP_1 LIKE '%'	\n"
                + "	        UNION ALL	\n"
                + "	        SELECT 'LRR' AS GUBUN 	\n"
                + "	            , 0 AS LOT_QTY_QQ_1  	\n"
                + "	            , 0 AS LOT_QTY_QQ_2  	\n"
                + "	            , 0 AS LOT_QTY_QQ_3  	\n"
                + "	            , 0 AS LOT_QTY_QQ_4 	\n"
                + "	            , 0 AS LOT_QTY_MM_1  	\n"
                + "	            , 0 AS LOT_QTY_MM_2  	\n"
                + "	            , 0 AS LOT_QTY_MM_3  	\n"
                + "	            , 0 AS LOT_QTY_MM_4	\n"
                + "	            , 0 AS LOT_QTY_WW_1 	\n"
                + "	            , 0 AS LOT_QTY_WW_2 	\n"
                + "	            , 0 AS LOT_QTY_WW_3 	\n"
                + "	            , 0 AS LOT_QTY_WW_4 	\n"
                + "	            , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '금' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_1  	\n"
                + "	            , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '토' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_2 	\n"
                + "	            , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '일' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_3 	\n"
                + "	            , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '월' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_4 	\n"
                + "	            , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '화' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_5 	\n"
                + "	            , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '수' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_6 	\n"
                + "	            , SUM(CASE TO_CHAR(TO_DATE(A.WORK_DATE, 'YYYYMMDD'), 'DY') WHEN '목' THEN A.QC_LOT_QTY_1 ELSE 0 END) AS LOT_QTY_DD_7 	\n"
                + "	        FROM RSUMPQCLOT A, MESMGR.MWIPMATDEF@RPTTOMES B  	\n"
                + "	        WHERE A.FACTORY = B.FACTORY  	\n"
                + "	        AND A.MAT_ID = B.MAT_ID  	\n"
                + "	        AND A.FACTORY = '" + cdvFactory.Text + "' 	\n"
                + "	        AND A.WORK_DATE >= CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'DY') WHEN '금' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 0, 'YYYYMMDD') 	\n"
                + "	                                                       WHEN '토' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 1, 'YYYYMMDD') 	\n"
                + "	                                                       WHEN '일' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 2, 'YYYYMMDD') 	\n"
                + "	                                                       WHEN '월' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 3, 'YYYYMMDD') 	\n"
                + "	                                                       WHEN '화' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 4, 'YYYYMMDD') 	\n"
                + "	                                                       WHEN '수' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 5, 'YYYYMMDD') 	\n"
                + "	                                                       WHEN '목' THEN TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS') - 6, 'YYYYMMDD') 	\n"
                + "	                           END  	\n"
                + "	        AND A.WORK_DATE <= TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')     	\n"
                + "	        AND A.QC_TYPE LIKE 'CCS(변경점)' || '%'  	\n"
                + "	        AND B.MAT_GRP_1 LIKE '%'	\n"
                + "	    ) B	\n"
                + "	    WHERE A.GUBUN = B.GUBUN	\n"
                + "	)GROUP BY GUBUN	\n";

            return QRY.Replace((char)Keys.Tab, ' ');
        }

        private string MakeSqlString1()
        {
            /****************************************************
             * Comment : DataBase에 저장된 데이터를 조회한다.(CCN 발생건수 불량현황(Front/Back-end))
             * 
             * Created By : 김선호(2012-08-10-금)
             * 
             * Modified By :
             ****************************************************/

            string QRY = "";

            string fromOper = "";
            string toOper = "";

            string date = cdvDate.Value.ToString("yyyyMMddHHmmss");

            switch (cboOper.SelectedIndex)
            {
                case 0:
                    {
                        fromOper = "A0000";
                        toOper = "A0970";
                    }
                    break;

                case 1:
                    {
                        fromOper = "A1000";
                        toOper = "AZ010";
                    }
                    break;
            }

            QRY = "	SELECT DEFECT	\n"
                + "	    , QTY_QQ_1, QTY_QQ_2, QTY_QQ_3, QTY_QQ_4	\n"
                + "	    , QTY_MM_1, QTY_MM_2, QTY_MM_3, QTY_MM_4, QTY_MM_5, QTY_MM_6	\n"
                + "	FROM	\n"
                + "	(	\n"
                + "	    SELECT DECODE(CASE WHEN TOTAL > 1 THEN DEFECT ELSE '기타' END	\n"
                + "	                    , NULL, '총계'	\n"
                + "	                    , CASE WHEN TOTAL > 1 THEN DEFECT ELSE '기타' END) AS DEFECT	\n"
                + "	        , SUM(QTY_QQ_1) AS QTY_QQ_1	\n"
                + "	        , SUM(QTY_QQ_2) AS QTY_QQ_2	\n"
                + "	        , SUM(QTY_QQ_3) AS QTY_QQ_3	\n"
                + "	        , SUM(QTY_QQ_4) AS QTY_QQ_4	\n"
                + "	        , SUM(QTY_MM_1) AS QTY_MM_1	\n"
                + "	        , SUM(QTY_MM_2) AS QTY_MM_2	\n"
                + "	        , SUM(QTY_MM_3) AS QTY_MM_3	\n"
                + "	        , SUM(QTY_MM_4) AS QTY_MM_4	\n"
                + "	        , SUM(QTY_MM_5) AS QTY_MM_5	\n"
                + "	        , SUM(QTY_MM_6) AS QTY_MM_6	\n"
                + "	        , SUM(TOTAL) AS TOTAL	\n"
                + "	    FROM	\n"
                + "	    (	\n"
                + "	        SELECT DEFECT	\n"
                + "	            , SUM(QTY_QQ_1) AS QTY_QQ_1	\n"
                + "	            , SUM(QTY_QQ_2) AS QTY_QQ_2	\n"
                + "	            , SUM(QTY_QQ_3) AS QTY_QQ_3	\n"
                + "	            , SUM(QTY_QQ_4) AS QTY_QQ_4	\n"
                + "	            , SUM(QTY_MM_1) AS QTY_MM_1	\n"
                + "	            , SUM(QTY_MM_2) AS QTY_MM_2	\n"
                + "	            , SUM(QTY_MM_3) AS QTY_MM_3	\n"
                + "	            , SUM(QTY_MM_4) AS QTY_MM_4	\n"
                + "	            , SUM(QTY_MM_5) AS QTY_MM_5	\n"
                + "	            , SUM(QTY_MM_6) AS QTY_MM_6	\n"
                + "	            , SUM(QTY_MM_1 + QTY_MM_2 + QTY_MM_3 + QTY_MM_4 + QTY_MM_5 + QTY_MM_6) AS TOTAL	\n"
                + "	        FROM	\n"
                + "	        (	\n"
                + "	            SELECT DESC_1 AS DEFECT	\n"
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	                    WHEN '4' THEN 	\n"
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                    THEN 1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                    WHEN '3' THEN 	\n"
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                    THEN 1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                    WHEN '2' THEN 	\n"
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                    THEN 1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                    WHEN '1' THEN 	\n"
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                    THEN 1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                  END) AS QTY_QQ_1	\n"
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	                    WHEN '4' THEN 	\n"
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                    THEN 1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                    WHEN '3' THEN 	\n"
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                    THEN 1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                    WHEN '2' THEN 	\n"
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                    THEN 1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                    WHEN '1' THEN 	\n"
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                    THEN 1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                  END) AS QTY_QQ_2	\n"
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	                    WHEN '4' THEN 	\n"
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                    THEN 1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                    WHEN '3' THEN 	\n"
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                    THEN 1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                    WHEN '2' THEN 	\n"
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                    THEN 1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                    WHEN '1' THEN 	\n"
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                    THEN 1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                  END) AS QTY_QQ_3	\n"
                + "	                , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	                    WHEN '4' THEN 	\n"
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                    THEN 1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                    WHEN '3' THEN 	\n"
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                    THEN 1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                    WHEN '2' THEN 	\n"
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                    THEN 1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                    WHEN '1' THEN 	\n"
                + "	                                CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                            AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                    THEN 1	\n"
                + "	                                    ELSE 0 	\n"
                + "	                                END	\n"
                + "	                  END) AS QTY_QQ_4	\n"
                + "	                , 0 AS QTY_MM_1	\n"
                + "	                , 0 AS QTY_MM_2	\n"
                + "	                , 0 AS QTY_MM_3	\n"
                + "	                , 0 AS QTY_MM_4	\n"
                + "	                , 0 AS QTY_MM_5	\n"
                + "	                , 0 AS QTY_MM_6	\n"
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n"
                + "	            WHERE 1=1	\n"
                + "	            AND STS.FACTORY = DEF.FACTORY	\n"
                + "	            AND STS.FACTORY = '" + cdvFactory.Text + "'	\n"
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n"
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -13)), 'YYYYMMDD')||'220000'	\n"
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                + "	            AND STS.OPER_1 >= '" + fromOper + "'	\n"
                + "	            AND STS.OPER_1 <= '" + toOper + "'	\n"
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n"
                + "	            AND ABR_NO LIKE 'CCN%'	\n"
                + "	            AND STS.DEL_FLAG = ' '	\n"
                + "	            GROUP BY DEF.DESC_1	\n"
                + "	            UNION ALL	\n"
                + "	            SELECT DESC_1 AS DEFECT	\n"
                + "	                , 0 AS QTY_QQ_1	\n"
                + "	                , 0 AS QTY_QQ_2	\n"
                + "	                , 0 AS QTY_QQ_3	\n"
                + "	                , 0 AS QTY_QQ_4	\n"
                + "	                , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -6)), 'YYYYMMDD')||'220000'	\n"
                + "	                                AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -5)), 'YYYYMMDD')||'220000'	\n"
                + "	                           THEN 1	\n"
                + "	                           ELSE 0	\n"
                + "	                      END) AS QTY_MM_1	\n"
                + "	                , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -5)), 'YYYYMMDD')||'220000'	\n"
                + "	                                AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                + "	                           THEN 1	\n"
                + "	                           ELSE 0	\n"
                + "	                      END) AS QTY_MM_2	\n"
                + "	                , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                + "	                                AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                + "	                           THEN 1	\n"
                + "	                           ELSE 0	\n"
                + "	                      END) AS QTY_MM_3	\n"
                + "	                , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                + "	                                AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                + "	                           THEN 1	\n"
                + "	                           ELSE 0	\n"
                + "	                      END) AS QTY_MM_4	\n"
                + "	                , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                + "	                                AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                + "	                           THEN 1	\n"
                + "	                           ELSE 0	\n"
                + "	                      END) AS QTY_MM_5	\n"
                + "	                , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                + "	                                AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0)), 'YYYYMMDD')||'220000'	\n"
                + "	                           THEN 1	\n"
                + "	                           ELSE 0	\n"
                + "	                      END) AS QTY_MM_6	\n"
                + "	            FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n"
                + "	            WHERE 1=1	\n"
                + "	            AND STS.FACTORY = DEF.FACTORY	\n"
                + "	            AND STS.FACTORY = '" + cdvFactory.Text + "'	\n"
                + "	            AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n"
                + "	            AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -6)), 'YYYYMMDD')||'220000'	\n"
                + "	            AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                + "	            AND STS.OPER_1 >= '" + fromOper + "'	\n"
                + "	            AND STS.OPER_1 <= '" + toOper + "'	\n"
                + "	            AND CLOSE_FLAG IN ( ' ', 'Y')	\n"
                + "	            AND ABR_NO LIKE 'CCN%'	\n"
                + "	            AND STS.DEL_FLAG = ' '	\n"
                + "	            GROUP BY DEF.DESC_1	\n"
                + "	        )GROUP BY DEFECT	\n"
                + "	        ORDER BY TOTAL DESC	\n"
                + "	    )GROUP BY ROLLUP (CASE WHEN TOTAL > 1	\n"
                + "	                           THEN DEFECT	\n"
                + "	                           ELSE '기타'	\n"
                + "	                      END)	\n"
                + "	    ORDER BY DECODE(DEFECT, '총계', 0, '기타', 1) DESC , TOTAL DESC	\n"
                + "	)	\n";

            return QRY.Replace((char)Keys.Tab, ' ');
        }

        private string MakeSqlString2()
        {
            /****************************************************
             * Comment : DataBase에 저장된 데이터를 조회한다.(CCN 발생공정)
             * 
             * Created By : 김선호(2012-08-10-금)
             * 
             * Modified By :
             ****************************************************/

            string QRY = "";

            string date = cdvDate.Value.ToString("yyyyMMddHHmmss");

            QRY = "	SELECT DECODE(OPER, NULL, '총계', OPER) AS OPER	\n"
                + "	    , SUM(QTY_QQ_1) AS QTY_QQ_1	\n"
                + "	    , SUM(QTY_QQ_2) AS QTY_QQ_2	\n"
                + "	    , SUM(QTY_QQ_3) AS QTY_QQ_3	\n"
                + "	    , SUM(QTY_QQ_4) AS QTY_QQ_4	\n"
                + "	    , SUM(QTY_MM_1) AS QTY_MM_1	\n"
                + "	    , SUM(QTY_MM_2) AS QTY_MM_2	\n"
                + "	    , SUM(QTY_MM_3) AS QTY_MM_3	\n"
                + "	    , SUM(QTY_MM_4) AS QTY_MM_4	\n"
                + "	    , SUM(QTY_MM_5) AS QTY_MM_5	\n"
                + "	    , SUM(QTY_MM_6) AS QTY_MM_6	\n"
                + "	FROM(	\n"
                + "	    SELECT 'B/G' AS OPER	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_1	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_2	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_3	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_4	\n"
                + "	        , 0 AS QTY_MM_1	\n"
                + "	        , 0 AS QTY_MM_2	\n"
                + "	        , 0 AS QTY_MM_3	\n"
                + "	        , 0 AS QTY_MM_4	\n"
                + "	        , 0 AS QTY_MM_5	\n"
                + "	        , 0 AS QTY_MM_6	\n"
                + "	    FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n"
                + "	    WHERE 1=1	\n"
                + "	    AND STS.FACTORY = DEF.FACTORY	\n"
                + "	    AND STS.FACTORY = '" + cdvFactory.Text + "'	\n"
                + "	    AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n"
                + "	    AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -13)), 'YYYYMMDD')||'220000'	\n"
                + "	    AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                + "	    AND STS.OPER_1 = 'A0040'	\n"
                + "	    AND CLOSE_FLAG IN ( ' ', 'Y')	\n"
                + "	    AND ABR_NO LIKE 'CCN%'	\n"
                + "	    AND STS.DEL_FLAG = ' '	\n"
                + "	    GROUP BY DEF.DESC_1	\n"
                + "	    UNION ALL	\n"
                + "	    SELECT 'B/G' AS OPER	\n"
                + "	        , 0 AS QTY_QQ_1	\n"
                + "	        , 0 AS QTY_QQ_2	\n"
                + "	        , 0 AS QTY_QQ_3	\n"
                + "	        , 0 AS QTY_QQ_4	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -6)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -5)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_1	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -5)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_2	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_3	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_4	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_5	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_6	\n"
                + "	    FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n"
                + "	    WHERE 1=1	\n"
                + "	    AND STS.FACTORY = DEF.FACTORY	\n"
                + "	    AND STS.FACTORY = '" + cdvFactory.Text + "'	\n"
                + "	    AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n"
                + "	    AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -6)), 'YYYYMMDD')||'220000'	\n"
                + "	    AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                + "	    AND STS.OPER_1 = 'A0040'	\n"
                + "	    AND CLOSE_FLAG IN ( ' ', 'Y')	\n"
                + "	    AND ABR_NO LIKE 'CCN%'	\n"
                + "	    AND STS.DEL_FLAG = ' '	\n"
                + "	    GROUP BY DEF.DESC_1	\n"
                + "	    UNION ALL	\n"
                + "	        SELECT 'SAW' AS OPER	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_1	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_2	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_3	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_4	\n"
                + "	        , 0 AS QTY_MM_1	\n"
                + "	        , 0 AS QTY_MM_2	\n"
                + "	        , 0 AS QTY_MM_3	\n"
                + "	        , 0 AS QTY_MM_4	\n"
                + "	        , 0 AS QTY_MM_5	\n"
                + "	        , 0 AS QTY_MM_6	\n"
                + "	    FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n"
                + "	    WHERE 1=1	\n"
                + "	    AND STS.FACTORY = DEF.FACTORY	\n"
                + "	    AND STS.FACTORY = '" + cdvFactory.Text + "'	\n"
                + "	    AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n"
                + "	    AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -13)), 'YYYYMMDD')||'220000'	\n"
                + "	    AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                + "	    AND STS.OPER_1 = 'A0200'	\n"
                + "	    AND CLOSE_FLAG IN ( ' ', 'Y')	\n"
                + "	    AND ABR_NO LIKE 'CCN%'	\n"
                + "	    AND STS.DEL_FLAG = ' '	\n"
                + "	    GROUP BY DEF.DESC_1	\n"
                + "	    UNION ALL	\n"
                + "	    SELECT 'SAW' AS OPER	\n"
                + "	        , 0 AS QTY_QQ_1	\n"
                + "	        , 0 AS QTY_QQ_2	\n"
                + "	        , 0 AS QTY_QQ_3	\n"
                + "	        , 0 AS QTY_QQ_4	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -6)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -5)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_1	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -5)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_2	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_3	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_4	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_5	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_6	\n"
                + "	    FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n"
                + "	    WHERE 1=1	\n"
                + "	    AND STS.FACTORY = DEF.FACTORY	\n"
                + "	    AND STS.FACTORY = '" + cdvFactory.Text + "'	\n"
                + "	    AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n"
                + "	    AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -6)), 'YYYYMMDD')||'220000'	\n"
                + "	    AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                + "	    AND STS.OPER_1 = 'A0200'	\n"
                + "	    AND CLOSE_FLAG IN ( ' ', 'Y')	\n"
                + "	    AND ABR_NO LIKE 'CCN%'	\n"
                + "	    AND STS.DEL_FLAG = ' '	\n"
                + "	    GROUP BY DEF.DESC_1	\n"
                + "	    UNION ALL	\n"
                + "	        SELECT 'D/A' AS OPER	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_1	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_2	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_3	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_4	\n"
                + "	        , 0 AS QTY_MM_1	\n"
                + "	        , 0 AS QTY_MM_2	\n"
                + "	        , 0 AS QTY_MM_3	\n"
                + "	        , 0 AS QTY_MM_4	\n"
                + "	        , 0 AS QTY_MM_5	\n"
                + "	        , 0 AS QTY_MM_6	\n"
                + "	    FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n"
                + "	    WHERE 1=1	\n"
                + "	    AND STS.FACTORY = DEF.FACTORY	\n"
                + "	    AND STS.FACTORY = '" + cdvFactory.Text + "'	\n"
                + "	    AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n"
                + "	    AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -13)), 'YYYYMMDD')||'220000'	\n"
                + "	    AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                + "	    AND STS.OPER_1 >= 'A0400'	\n"
                + "	    AND STS.OPER_1 <= 'A0409'	\n"
                + "	    AND CLOSE_FLAG IN ( ' ', 'Y')	\n"
                + "	    AND ABR_NO LIKE 'CCN%'	\n"
                + "	    AND STS.DEL_FLAG = ' '	\n"
                + "	    GROUP BY DEF.DESC_1	\n"
                + "	    UNION ALL	\n"
                + "	    SELECT 'D/A' AS OPER	\n"
                + "	        , 0 AS QTY_QQ_1	\n"
                + "	        , 0 AS QTY_QQ_2	\n"
                + "	        , 0 AS QTY_QQ_3	\n"
                + "	        , 0 AS QTY_QQ_4	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -6)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -5)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_1	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -5)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_2	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_3	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_4	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_5	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_6	\n"
                + "	    FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n"
                + "	    WHERE 1=1	\n"
                + "	    AND STS.FACTORY = DEF.FACTORY	\n"
                + "	    AND STS.FACTORY = '" + cdvFactory.Text + "'	\n"
                + "	    AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n"
                + "	    AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -6)), 'YYYYMMDD')||'220000'	\n"
                + "	    AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                + "	    AND STS.OPER_1 >= 'A0400'	\n"
                + "	    AND STS.OPER_1 <= 'A0409'	\n"
                + "	    AND CLOSE_FLAG IN ( ' ', 'Y')	\n"
                + "	    AND ABR_NO LIKE 'CCN%'	\n"
                + "	    AND STS.DEL_FLAG = ' '	\n"
                + "	    GROUP BY DEF.DESC_1	\n"
                + "	    UNION ALL	\n"
                + "	    SELECT 'W/B' AS OPER	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_1	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_2	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_3	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_4	\n"
                + "	        , 0 AS QTY_MM_1	\n"
                + "	        , 0 AS QTY_MM_2	\n"
                + "	        , 0 AS QTY_MM_3	\n"
                + "	        , 0 AS QTY_MM_4	\n"
                + "	        , 0 AS QTY_MM_5	\n"
                + "	        , 0 AS QTY_MM_6	\n"
                + "	    FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n"
                + "	    WHERE 1=1	\n"
                + "	    AND STS.FACTORY = DEF.FACTORY	\n"
                + "	    AND STS.FACTORY = '" + cdvFactory.Text + "'	\n"
                + "	    AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n"
                + "	    AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -13)), 'YYYYMMDD')||'220000'	\n"
                + "	    AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                + "	    AND STS.OPER_1 >= 'A0600'	\n"
                + "	    AND STS.OPER_1 <= 'A0609'	\n"
                + "	    AND CLOSE_FLAG IN ( ' ', 'Y')	\n"
                + "	    AND ABR_NO LIKE 'CCN%'	\n"
                + "	    AND STS.DEL_FLAG = ' '	\n"
                + "	    GROUP BY DEF.DESC_1	\n"
                + "	    UNION ALL	\n"
                + "	    SELECT 'W/B' AS OPER	\n"
                + "	        , 0 AS QTY_QQ_1	\n"
                + "	        , 0 AS QTY_QQ_2	\n"
                + "	        , 0 AS QTY_QQ_3	\n"
                + "	        , 0 AS QTY_QQ_4	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -6)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -5)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_1	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -5)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_2	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_3	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_4	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_5	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_6	\n"
                + "	    FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n"
                + "	    WHERE 1=1	\n"
                + "	    AND STS.FACTORY = DEF.FACTORY	\n"
                + "	    AND STS.FACTORY = '" + cdvFactory.Text + "'	\n"
                + "	    AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n"
                + "	    AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -6)), 'YYYYMMDD')||'220000'	\n"
                + "	    AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                + "	    AND STS.OPER_1 >= 'A0600'	\n"
                + "	    AND STS.OPER_1 <= 'A0609'	\n"
                + "	    AND CLOSE_FLAG IN ( ' ', 'Y')	\n"
                + "	    AND ABR_NO LIKE 'CCN%'	\n"
                + "	    AND STS.DEL_FLAG = ' '	\n"
                + "	    GROUP BY DEF.DESC_1	\n"
                + "	    UNION ALL	\n"
                + "	    SELECT 'M/D' AS OPER	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_1	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_2	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_3	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_4	\n"
                + "	        , 0 AS QTY_MM_1	\n"
                + "	        , 0 AS QTY_MM_2	\n"
                + "	        , 0 AS QTY_MM_3	\n"
                + "	        , 0 AS QTY_MM_4	\n"
                + "	        , 0 AS QTY_MM_5	\n"
                + "	        , 0 AS QTY_MM_6	\n"
                + "	    FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n"
                + "	    WHERE 1=1	\n"
                + "	    AND STS.FACTORY = DEF.FACTORY	\n"
                + "	    AND STS.FACTORY = '" + cdvFactory.Text + "'	\n"
                + "	    AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n"
                + "	    AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -13)), 'YYYYMMDD')||'220000'	\n"
                + "	    AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                + "	    AND STS.OPER_1 = 'A1000'	\n"
                + "	    AND CLOSE_FLAG IN ( ' ', 'Y')	\n"
                + "	    AND ABR_NO LIKE 'CCN%'	\n"
                + "	    AND STS.DEL_FLAG = ' '	\n"
                + "	    GROUP BY DEF.DESC_1	\n"
                + "	    UNION ALL	\n"
                + "	    SELECT 'M/D' AS OPER	\n"
                + "	        , 0 AS QTY_QQ_1	\n"
                + "	        , 0 AS QTY_QQ_2	\n"
                + "	        , 0 AS QTY_QQ_3	\n"
                + "	        , 0 AS QTY_QQ_4	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -6)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -5)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_1	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -5)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_2	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_3	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_4	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_5	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_6	\n"
                + "	    FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n"
                + "	    WHERE 1=1	\n"
                + "	    AND STS.FACTORY = DEF.FACTORY	\n"
                + "	    AND STS.FACTORY = '" + cdvFactory.Text + "'	\n"
                + "	    AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n"
                + "	    AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -6)), 'YYYYMMDD')||'220000'	\n"
                + "	    AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                + "	    AND STS.OPER_1 = 'A1000'	\n"
                + "	    AND CLOSE_FLAG IN ( ' ', 'Y')	\n"
                + "	    AND ABR_NO LIKE 'CCN%'	\n"
                + "	    AND STS.DEL_FLAG = ' '	\n"
                + "	    GROUP BY DEF.DESC_1	\n"
                + "	    UNION ALL	\n"
                + "	    SELECT 'M/K' AS OPER	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_1	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_2	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_3	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_4	\n"
                + "	        , 0 AS QTY_MM_1	\n"
                + "	        , 0 AS QTY_MM_2	\n"
                + "	        , 0 AS QTY_MM_3	\n"
                + "	        , 0 AS QTY_MM_4	\n"
                + "	        , 0 AS QTY_MM_5	\n"
                + "	        , 0 AS QTY_MM_6	\n"
                + "	    FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n"
                + "	    WHERE 1=1	\n"
                + "	    AND STS.FACTORY = DEF.FACTORY	\n"
                + "	    AND STS.FACTORY = '" + cdvFactory.Text + "'	\n"
                + "	    AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n"
                + "	    AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -13)), 'YYYYMMDD')||'220000'	\n"
                + "	    AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                + "	    AND STS.OPER_1 >= 'A1110'	\n"
                + "	    AND STS.OPER_1 <= 'A1150'	\n"
                + "	    AND CLOSE_FLAG IN ( ' ', 'Y')	\n"
                + "	    AND ABR_NO LIKE 'CCN%'	\n"
                + "	    AND STS.DEL_FLAG = ' '	\n"
                + "	    GROUP BY DEF.DESC_1	\n"
                + "	    UNION ALL	\n"
                + "	    SELECT 'M/K' AS OPER	\n"
                + "	        , 0 AS QTY_QQ_1	\n"
                + "	        , 0 AS QTY_QQ_2	\n"
                + "	        , 0 AS QTY_QQ_3	\n"
                + "	        , 0 AS QTY_QQ_4	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -6)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -5)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_1	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -5)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_2	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_3	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_4	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_5	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_6	\n"
                + "	    FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n"
                + "	    WHERE 1=1	\n"
                + "	    AND STS.FACTORY = DEF.FACTORY	\n"
                + "	    AND STS.FACTORY = '" + cdvFactory.Text + "'	\n"
                + "	    AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n"
                + "	    AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -6)), 'YYYYMMDD')||'220000'	\n"
                + "	    AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                + "	    AND STS.OPER_1 >= 'A1110'	\n"
                + "	    AND STS.OPER_1 <= 'A1150'	\n"
                + "	    AND CLOSE_FLAG IN ( ' ', 'Y')	\n"
                + "	    AND ABR_NO LIKE 'CCN%'	\n"
                + "	    AND STS.DEL_FLAG = ' '	\n"
                + "	    GROUP BY DEF.DESC_1	\n"
                + "	    UNION ALL	\n"
                + "	        SELECT 'SBA' AS OPER	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_1	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_2	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_3	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_4	\n"
                + "	        , 0 AS QTY_MM_1	\n"
                + "	        , 0 AS QTY_MM_2	\n"
                + "	        , 0 AS QTY_MM_3	\n"
                + "	        , 0 AS QTY_MM_4	\n"
                + "	        , 0 AS QTY_MM_5	\n"
                + "	        , 0 AS QTY_MM_6	\n"
                + "	    FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n"
                + "	    WHERE 1=1	\n"
                + "	    AND STS.FACTORY = DEF.FACTORY	\n"
                + "	    AND STS.FACTORY = '" + cdvFactory.Text + "'	\n"
                + "	    AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n"
                + "	    AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -13)), 'YYYYMMDD')||'220000'	\n"
                + "	    AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                + "	    AND STS.OPER_1 = 'A1300'	\n"
                + "	    AND CLOSE_FLAG IN ( ' ', 'Y')	\n"
                + "	    AND ABR_NO LIKE 'CCN%'	\n"
                + "	    AND STS.DEL_FLAG = ' '	\n"
                + "	    GROUP BY DEF.DESC_1	\n"
                + "	    UNION ALL	\n"
                + "	    SELECT 'SBA' AS OPER	\n"
                + "	        , 0 AS QTY_QQ_1	\n"
                + "	        , 0 AS QTY_QQ_2	\n"
                + "	        , 0 AS QTY_QQ_3	\n"
                + "	        , 0 AS QTY_QQ_4	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -6)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -5)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_1	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -5)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_2	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_3	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_4	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_5	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_6	\n"
                + "	    FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n"
                + "	    WHERE 1=1	\n"
                + "	    AND STS.FACTORY = DEF.FACTORY	\n"
                + "	    AND STS.FACTORY = '" + cdvFactory.Text + "'	\n"
                + "	    AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n"
                + "	    AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -6)), 'YYYYMMDD')||'220000'	\n"
                + "	    AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                + "	    AND STS.OPER_1 = 'A1300'	\n"
                + "	    AND CLOSE_FLAG IN ( ' ', 'Y')	\n"
                + "	    AND ABR_NO LIKE 'CCN%'	\n"
                + "	    AND STS.DEL_FLAG = ' '	\n"
                + "	    GROUP BY DEF.DESC_1	\n"
                + "	    UNION ALL	\n"
                + "	        SELECT 'SST' AS OPER	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_1	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_2	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_3	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_4	\n"
                + "	        , 0 AS QTY_MM_1	\n"
                + "	        , 0 AS QTY_MM_2	\n"
                + "	        , 0 AS QTY_MM_3	\n"
                + "	        , 0 AS QTY_MM_4	\n"
                + "	        , 0 AS QTY_MM_5	\n"
                + "	        , 0 AS QTY_MM_6	\n"
                + "	    FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n"
                + "	    WHERE 1=1	\n"
                + "	    AND STS.FACTORY = DEF.FACTORY	\n"
                + "	    AND STS.FACTORY = '" + cdvFactory.Text + "'	\n"
                + "	    AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n"
                + "	    AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -13)), 'YYYYMMDD')||'220000'	\n"
                + "	    AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                + "	    AND STS.OPER_1 >= 'A1720'	\n"
                + "	    AND STS.OPER_1 <= 'A1750'	\n"
                + "	    AND CLOSE_FLAG IN ( ' ', 'Y')	\n"
                + "	    AND ABR_NO LIKE 'CCN%'	\n"
                + "	    AND STS.DEL_FLAG = ' '	\n"
                + "	    GROUP BY DEF.DESC_1	\n"
                + "	    UNION ALL	\n"
                + "	    SELECT 'SBA' AS OPER	\n"
                + "	        , 0 AS QTY_QQ_1	\n"
                + "	        , 0 AS QTY_QQ_2	\n"
                + "	        , 0 AS QTY_QQ_3	\n"
                + "	        , 0 AS QTY_QQ_4	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -6)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -5)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_1	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -5)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_2	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_3	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_4	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_5	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_6	\n"
                + "	    FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n"
                + "	    WHERE 1=1	\n"
                + "	    AND STS.FACTORY = DEF.FACTORY	\n"
                + "	    AND STS.FACTORY = '" + cdvFactory.Text + "'	\n"
                + "	    AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n"
                + "	    AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -6)), 'YYYYMMDD')||'220000'	\n"
                + "	    AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                + "	    AND STS.OPER_1 >= 'A1720'	\n"
                + "	    AND STS.OPER_1 <= 'A1750'	\n"
                + "	    AND CLOSE_FLAG IN ( ' ', 'Y')	\n"
                + "	    AND ABR_NO LIKE 'CCN%'	\n"
                + "	    AND STS.DEL_FLAG = ' '	\n"
                + "	    GROUP BY DEF.DESC_1	\n"
                + "	    UNION ALL	\n"
                + "	        SELECT 'T/F' AS OPER	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_1	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_2	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_3	\n"
                + "	        , SUM(CASE TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'Q')	\n"
                + "	            WHEN '4' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'09', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '3' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'06', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '2' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')||'03', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	            WHEN '1' THEN 	\n"
                + "	                        CASE WHEN STS.STEP10_TIME >= TO_CHAR(LAST_DAY(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM')), 'YYYYMMDD')||'220000'	\n"
                + "	                                    AND STS.STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYY')-1||'12', 'YYYYMM'), 3)), 'YYYYMMDD')||'220000'	\n"
                + "	                            THEN 1	\n"
                + "	                            ELSE 0 	\n"
                + "	                        END	\n"
                + "	          END) AS QTY_QQ_4	\n"
                + "	        , 0 AS QTY_MM_1	\n"
                + "	        , 0 AS QTY_MM_2	\n"
                + "	        , 0 AS QTY_MM_3	\n"
                + "	        , 0 AS QTY_MM_4	\n"
                + "	        , 0 AS QTY_MM_5	\n"
                + "	        , 0 AS QTY_MM_6	\n"
                + "	    FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n"
                + "	    WHERE 1=1	\n"
                + "	    AND STS.FACTORY = DEF.FACTORY	\n"
                + "	    AND STS.FACTORY = '" + cdvFactory.Text + "'	\n"
                + "	    AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n"
                + "	    AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -13)), 'YYYYMMDD')||'220000'	\n"
                + "	    AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                + "	    AND STS.OPER_1 >= 'A1800'	\n"
                + "	    AND STS.OPER_1 <= 'A1900'	\n"
                + "	    AND CLOSE_FLAG IN ( ' ', 'Y')	\n"
                + "	    AND ABR_NO LIKE 'CCN%'	\n"
                + "	    AND STS.DEL_FLAG = ' '	\n"
                + "	    GROUP BY DEF.DESC_1	\n"
                + "	    UNION ALL	\n"
                + "	    SELECT 'T/F' AS OPER	\n"
                + "	        , 0 AS QTY_QQ_1	\n"
                + "	        , 0 AS QTY_QQ_2	\n"
                + "	        , 0 AS QTY_QQ_3	\n"
                + "	        , 0 AS QTY_QQ_4	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -6)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -5)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_1	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -5)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_2	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -4)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_3	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -3)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_4	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -2)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_5	\n"
                + "	        , SUM(CASE WHEN STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -1)), 'YYYYMMDD')||'220000'	\n"
                + "	                        AND STEP10_TIME < TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -0)), 'YYYYMMDD')||'220000'	\n"
                + "	                   THEN 1	\n"
                + "	                   ELSE 0	\n"
                + "	              END) AS QTY_MM_6	\n"
                + "	    FROM CABRLOTSTS@RPTTOMES STS, CABRDFTDEF@RPTTOMES DEF	\n"
                + "	    WHERE 1=1	\n"
                + "	    AND STS.FACTORY = DEF.FACTORY	\n"
                + "	    AND STS.FACTORY = '" + cdvFactory.Text + "'	\n"
                + "	    AND STS.DEFECT_CODE = DEF.DEFECT_CODE	\n"
                + "	    AND STEP10_TIME >= TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), -6)), 'YYYYMMDD')||'220000'	\n"
                + "	    AND STEP10_TIME < TO_CHAR(TO_DATE('" + date + "', 'YYYYMMDD HH24MISS'), 'YYYYMMDD')||'220000'	\n"
                + "	    AND STS.OPER_1 >= 'A1800'	\n"
                + "	    AND STS.OPER_1 <= 'A1900'	\n"
                + "	    AND CLOSE_FLAG IN ( ' ', 'Y')	\n"
                + "	    AND ABR_NO LIKE 'CCN%'	\n"
                + "	    AND STS.DEL_FLAG = ' '	\n"
                + "	    GROUP BY DEF.DESC_1	\n"
                + "	)GROUP BY ROLLUP (OPER)	\n";

            return QRY.Replace((char)Keys.Tab, ' ');
        }

        private void fnMakeChart(Miracom.SmartWeb.UI.Controls.udcFarPoint SS, int iselrow)
        {
            /****************************************************
             * Comment : SS의 데이터를 Chart에 표시한다.
             * 
             * Created By : 김선호(2012-08-10-금요일)
             * 
             * Modified By :
             ****************************************************/
            int[] ich_qq = new int[19]; int[] icols_qq = new int[19]; int[] irows_qq = new int[1]; string[] stitle_qq = new string[1];
            int[] ich_mm = new int[4]; int[] icols_mm = new int[4]; int[] irows_mm = new int[7]; string[] stitle_mm = new string[4];
            int[] ich_md = new int[4]; int[] icols_md = new int[4]; int[] irows_md = new int[9]; string[] stitle_md = new string[4];
            int icol = 0, irow = 0;
            try
            {
                Cursor.Current = Cursors.WaitCursor;
                // SS에 데이터가 없으면 종료한다.
                if (SS.Sheets[0].RowCount <= 0)
                {
                    return;
                }

                cf01.RPT_1_ChartInit();
                cf01.RPT_2_ClearData();
                cf01.ClearData(SoftwareFX.ChartFX.ClearDataFlag.AllData);

                switch (cboGraph.SelectedIndex)
                {
                    #region - CCN Total/월별 Trend

                    case 0:

                        iselrow = 2;

                        cf01.AxisX.Title.Text = "[CCN Total / Monthly Trend]";
                        cf01.AxisX.Staggered = false;

                        cf01.AxisY.Gridlines = true;
                        cf01.AxisY.Title.Text = "LRR(%)";
                        cf01.AxisY.Title.Alignment = StringAlignment.Far;
                        cf01.AxisY.DataFormat.Decimals = 2;

                        for (icol = 0; icol < ich_qq.Length; icol++)
                        {
                            ich_qq[icol] = icol + 1;
                            icols_qq[icol] = icol + 1;
                        }
                        // 2012-07-26-김선호 : 선택한 Row에서 아래로 1개의 Row만 Display한다.
                        for (irow = 0; irow < 1; irow++)
                        {
                            if ((iselrow + irow) >= SS.Sheets[0].RowCount)
                            {
                                break;
                            }
                            irows_qq[irow] = iselrow + irow;
                            stitle_qq[irow] = SS.Sheets[0].Cells[iselrow + irow, 0].Text;
                        }

                        cf01.Gallery = SoftwareFX.ChartFX.Gallery.Curve;
                        cf01.PointLabels = true;
                        //cf01.Series[0].PointLabelColor = Color.Black;
                        cf01.Series[0].PointLabelAlign = SoftwareFX.ChartFX.LabelAlign.Bottom;

                        cf01.RPT_3_OpenData(irows_qq.Length, icols_qq.Length);
                        cf01.RPT_4_AddData(SS, irows_qq, icols_qq, SeriseType.Rows);
                        cf01.RPT_5_CloseData();
                        cf01.RPT_7_SetXAsixTitleUsingSpreadHeader(SS, 0, icols_qq);
                        //cf01.RPT_8_SetSeriseLegend(stitle_qq, SoftwareFX.ChartFX.Docked.Top);
                        cf01.AxisY.Max = cf01.AxisY.Max * 1.1;
                        //cf01.AxisY.Step = 0.5;

                        break;

                    #endregion

                    #region - CCN 발생건수 불량 현황(Front / Back-end)

                    case 1:

                        cf01.AxisX.Title.Text = "[ CCN 발생건수 불량 현황 : " + cboOper.SelectedItem.ToString() + " ]";
                        cf01.Gallery = SoftwareFX.ChartFX.Gallery.Bar;

                        cf01.AxisY.Gridlines = true;
                        cf01.AxisY.Title.Text = "(Count)";
                        cf01.AxisY.Title.Alignment = StringAlignment.Far;
                        cf01.AxisY.DataFormat.Decimals = 0;

                        cf01.AxisX.Staggered = false;

                        cf01.PointLabels = true;
                        for (icol = 0; icol < ich_mm.Length; icol++)
                        {
                            ich_mm[icol] = icol + 7;
                            icols_mm[icol] = icol + 7;
                            stitle_mm[icol] = SS.Sheets[0].ColumnHeader.Cells[0, icol + 7].Text;
                        }
                        for (irow = 0; irow < 7; irow++)
                        {
                            irows_mm[irow] = iselrow + irow;
                        }
                        cf01.RPT_3_OpenData(icols_mm.Length, irows_mm.Length);
                        cf01.RPT_4_AddData(SS, irows_mm, icols_mm, SeriseType.Column);
                        cf01.RPT_5_CloseData();
                        cf01.RPT_7_SetXAsixTitleUsingSpread(SS, irows_mm, 0);
                        cf01.RPT_8_SetSeriseLegend(stitle_mm, SoftwareFX.ChartFX.Docked.Top);
                        cf01.AxisY.Max = cf01.AxisY.Max * 1.1;

                        break;

                    #endregion

                    #region - CCN 발생 공정현황

                    case 2:

                        cf01.AxisX.Title.Text = "[CCN generation process status]";
                        cf01.Gallery = SoftwareFX.ChartFX.Gallery.Bar;

                        cf01.AxisY.Gridlines = true;
                        cf01.AxisY.Title.Text = "(Count)";
                        cf01.AxisY.Title.Alignment = StringAlignment.Far;
                        cf01.AxisY.DataFormat.Decimals = 0;

                        cf01.AxisX.Staggered = false;

                        cf01.PointLabels = true;
                        for (icol = 0; icol < ich_md.Length; icol++)
                        {
                            ich_md[icol] = icol + 7;
                            icols_md[icol] = icol + 7;
                            stitle_md[icol] = SS.Sheets[0].ColumnHeader.Cells[0, icol + 7].Text;
                        }
                        for (irow = 0; irow < 9; irow++)
                        {
                            irows_md[irow] = iselrow + irow;
                        }
                        cf01.RPT_3_OpenData(icols_md.Length, irows_md.Length);
                        cf01.RPT_4_AddData(SS, irows_md, icols_md, SeriseType.Column);
                        cf01.RPT_5_CloseData();
                        cf01.RPT_7_SetXAsixTitleUsingSpread(SS, irows_md, 0);
                        cf01.RPT_8_SetSeriseLegend(stitle_md, SoftwareFX.ChartFX.Docked.Top);
                        cf01.AxisY.Max = cf01.AxisY.Max * 1.1;
                        break;

                    #endregion
                }
                
            }
            catch (Exception ex)
            {
                CmnFunction.ShowMsgBox(ex.Message);
                return;
            }
            finally
            {
                Cursor.Current = Cursors.Default;
            }
        }

        #endregion


        #region " Form Event "

        private void btnView_Click(object sender, EventArgs e)
        {
            /****************************************************
             * Comment : View Button을 클릭하면
             * 
             * Created By : 김선호(2012-08-10-금요일)
             * 
             * Modified By : 
             ****************************************************/
            try
            {
                Cursor.Current = Cursors.WaitCursor;

                fnSSInitial(spdData);

                fnDataFind();
            }
            catch (Exception ex)
            {
                CmnFunction.ShowMsgBox(ex.Message);
                return;
            }
            finally
            {
                Cursor.Current = Cursors.Default;
            }
        }

        private void btnExcelExport_Click(object sender, EventArgs e)
        {
            /****************************************************
             * Comment : Excel Export Button을 클릭하면
             * 
             * Created By : 김선호(2012-08-10-금요일)
             * 
             * Modified By :
             ****************************************************/
            try
            {
                Cursor.Current = Cursors.WaitCursor;

                spdData.ExportExcel();
            }
            catch (Exception ex)
            {
                CmnFunction.ShowMsgBox(ex.Message);
                return;
            }
            finally
            {
                Cursor.Current = Cursors.Default;
            }
        }

        private void cboGraph_SelectedIndexChanged(object sender, EventArgs e)
        {
            switch (cboGraph.SelectedIndex)
            {
                case 0:
                    lblOperImg.Visible = false;
                    lblOper.Visible = false;
                    cboOper.Visible = false;
                    //splitContainer1.SplitterDistance = 500;
                    break;

                case 1:
                    lblOperImg.Visible = true;
                    lblOper.Visible = true;
                    cboOper.Visible = true;
                    //splitContainer1.SplitterDistance = 350;
                    break;

                case 2:
                    lblOperImg.Visible = false;
                    lblOper.Visible = false;
                    cboOper.Visible = false;
                    //splitContainer1.SplitterDistance = 350;
                    break;
            }

            cboOper.SelectedIndex = 0;
        }

        #endregion

    }
}
